/*! For license information please see 119.js.LICENSE.txt */
(()=>{"use strict";var e,t,n={958146:(e,t,n)=>{n.d(t,{$N:()=>C,$O:()=>L,$j:()=>ze,Ad:()=>x,BW:()=>N,C8:()=>_e,D6:()=>J,DH:()=>k,Dp:()=>f,EK:()=>Ke,E_:()=>I,Ey:()=>y,Gb:()=>Ie,IT:()=>Qe,J5:()=>W,Jo:()=>O,Kt:()=>ee,Ky:()=>Ee,M3:()=>ne,M7:()=>R,MR:()=>S,Mz:()=>Pe,NH:()=>Te,OD:()=>fe,On:()=>g,Re:()=>U,SB:()=>h,TD:()=>Oe,U4:()=>b,V3:()=>Ue,Wy:()=>$e,XS:()=>ue,YI:()=>j,YN:()=>m,YP:()=>we,Z8:()=>w,ZG:()=>ve,ZU:()=>xe,Zi:()=>ye,Zn:()=>He,_q:()=>se,ai:()=>ie,c$:()=>Y,ch:()=>V,dw:()=>Xe,fq:()=>M,g1:()=>et,gP:()=>Be,gV:()=>Me,gw:()=>E,hk:()=>Ve,iJ:()=>F,kV:()=>je,nt:()=>Ye,oA:()=>G,p$:()=>tt,rQ:()=>ot,rt:()=>A,u7:()=>v,uS:()=>H,vs:()=>ce,w_:()=>z,zh:()=>ke});var r=n(975955),i=n(374212),o=n(466894),s=n(620113),a=n(30805),c=n(271314),d=n(43963),l=n(40573),u=n(748755),p=n(250080);const h=Symbol.for("@effect/schema/annotation/Brand"),f=Symbol.for("@effect/schema/annotation/Type"),m=Symbol.for("@effect/schema/annotation/Message"),y=Symbol.for("@effect/schema/annotation/MissingMessage"),g=Symbol.for("@effect/schema/annotation/Identifier"),w=Symbol.for("@effect/schema/annotation/Title"),N=Symbol.for("@effect/schema/annotation/Description"),b=Symbol.for("@effect/schema/annotation/Examples"),v=Symbol.for("@effect/schema/annotation/Default"),x=Symbol.for("@effect/schema/annotation/JSONSchema"),k=Symbol.for("@effect/schema/annotation/Documentation"),S=Symbol.for("@effect/schema/annotation/Concurrency"),O=Symbol.for("@effect/schema/annotation/Batching"),W=Symbol.for("@effect/schema/annotation/ParseIssueTitle"),I=Symbol.for("@effect/schema/annotation/ParseOptions"),q=Symbol.for("@effect/schema/annotation/Surrogate"),T=Symbol.for("@effect/schema/annotation/StableFilter"),E=(0,i.XY)(2,((e,t)=>Object.prototype.hasOwnProperty.call(e.annotations,t)?a.zN(e.annotations[t]):a.dv())),C=E(h),L=E(m),A=E(y),D=E(w),B=E(g),P=E(N),M=E(S),F=E(O),R=E(W),U=E(I),j=E(q),_=E(T),$=Symbol.for("@effect/schema/annotation/JSONIdentifier"),Q=E($);class J{typeParameters;decodeUnknown;encodeUnknown;annotations;_tag="Declaration";constructor(e,t,n,r={}){this.typeParameters=e,this.decodeUnknown=t,this.encodeUnknown=n,this.annotations=r}toString(){return a.WL(ut(this),(()=>"<declaration schema>"))}toJSON(){return{_tag:this._tag,typeParameters:this.typeParameters.map((e=>e.toJSON())),annotations:st(this.annotations)}}}const K=e=>t=>t._tag===e;class H{literal;annotations;_tag="Literal";constructor(e,t={}){this.literal=e,this.annotations=t}toString(){return a.WL(ut(this),(()=>p.eA(this.literal)))}toJSON(){return{_tag:this._tag,literal:d.sI(this.literal)?String(this.literal):this.literal,annotations:st(this.annotations)}}}const Y=K("Literal"),V=new H(null,{[g]:"null"});class z{symbol;annotations;_tag="UniqueSymbol";constructor(e,t={}){this.symbol=e,this.annotations=t}toString(){return a.WL(ut(this),(()=>p.eA(this.symbol)))}toJSON(){return{_tag:this._tag,symbol:String(this.symbol),annotations:st(this.annotations)}}}class X{annotations;_tag="UndefinedKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const G=new X({[w]:"undefined"});class Z{annotations;_tag="VoidKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const ee=new Z({[w]:"void"});class te{annotations;_tag="NeverKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const ne=new te({[w]:"never"});class re{annotations;_tag="UnknownKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const ie=new re({[w]:"unknown"});class oe{annotations;_tag="AnyKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const se=new oe({[w]:"any"});class ae{annotations;_tag="StringKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const ce=new ae({[w]:"string",[N]:"a string"}),de=K("StringKeyword");class le{annotations;_tag="NumberKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const ue=new le({[w]:"number",[N]:"a number"}),pe=K("NumberKeyword");class he{annotations;_tag="BooleanKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const fe=new he({[w]:"boolean",[N]:"a boolean"});class me{annotations;_tag="BigIntKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const ye=new me({[w]:"bigint",[N]:"a bigint"});class ge{annotations;_tag="SymbolKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const we=new ge({[w]:"symbol",[N]:"a symbol"}),Ne=K("SymbolKeyword");class be{annotations;_tag="ObjectKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const ve=new be({[g]:"object",[w]:"object",[N]:"an object in the TypeScript meaning, i.e. the `object` type"});class xe{type;annotations;constructor(e,t={}){this.type=e,this.annotations=t}toJSON(){return{type:this.type.toJSON(),annotations:st(this.annotations)}}toString(){return String(this.type)}}class ke extends xe{isOptional;constructor(e,t,n={}){super(e,n),this.isOptional=t}toJSON(){return{type:this.type.toJSON(),isOptional:this.isOptional,annotations:st(this.annotations)}}toString(){return String(this.type)+(this.isOptional?"?":"")}}const Se=e=>e.map((e=>e.type));class Oe{elements;rest;isReadonly;annotations;_tag="TupleType";constructor(e,t,n,r={}){this.elements=e,this.rest=t,this.isReadonly=n,this.annotations=r;let i=!1,o=!1;for(const t of e)if(t.isOptional)i=!0;else if(i){o=!0;break}if(o||i&&t.length>1)throw new Error(u.YW)}toString(){return a.WL(ut(this),(()=>We(this)))}toJSON(){return{_tag:this._tag,elements:this.elements.map((e=>e.toJSON())),rest:this.rest.map((e=>e.toJSON())),isReadonly:this.isReadonly,annotations:st(this.annotations)}}}const We=e=>{const t=e.elements.map(String).join(", ");return r.nc(e.rest,{onEmpty:()=>`readonly [${t}]`,onNonEmpty:(n,r)=>{const i=String(n),o=i.includes(" | ")?`(${i})`:i;if(r.length>0){const n=r.map(String).join(", ");return e.elements.length>0?`readonly [${t}, ...${o}[], ${n}]`:`readonly [...${o}[], ${n}]`}return e.elements.length>0?`readonly [${t}, ...${o}[]]`:`ReadonlyArray<${i}>`}})};class Ie extends ke{name;isReadonly;constructor(e,t,n,r,i){super(t,n,i),this.name=e,this.isReadonly=r}toJSON(){return{name:String(this.name),type:this.type.toJSON(),isOptional:this.isOptional,isReadonly:this.isReadonly,annotations:st(this.annotations)}}}const qe=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return!0;case"Refinement":return qe(e.from)}return!1};class Te{type;isReadonly;parameter;constructor(e,t,n){if(this.type=t,this.isReadonly=n,!qe(e))throw new Error(u.D4);this.parameter=e}toJSON(){return{parameter:this.parameter.toJSON(),type:this.type.toJSON(),isReadonly:this.isReadonly}}}class Ee{annotations;_tag="TypeLiteral";propertySignatures;indexSignatures;constructor(e,t,n={}){this.annotations=n;const r={};for(let t=0;t<e.length;t++){const n=e[t].name;if(Object.prototype.hasOwnProperty.call(r,n))throw new Error(u.eT(n));r[n]=null}const i={string:!1,symbol:!1};for(let e=0;e<t.length;e++){const n=dt(t[e].parameter);if(de(n)){if(i.string)throw new Error(u.DB("string"));i.string=!0}else if(Ne(n)){if(i.symbol)throw new Error(u.DB("symbol"));i.symbol=!0}}this.propertySignatures=at(e),this.indexSignatures=ct(t)}toString(){return a.WL(ut(this),(()=>Ce(this)))}toJSON(){return{_tag:this._tag,propertySignatures:this.propertySignatures.map((e=>e.toJSON())),indexSignatures:this.indexSignatures.map((e=>e.toJSON())),annotations:st(this.annotations)}}}const Ce=e=>{const t=e.propertySignatures.map((e=>(e.isReadonly?"readonly ":"")+String(e.name)+(e.isOptional?"?":"")+": "+e.type)).join("; ");if(e.indexSignatures.length>0){const n=e.indexSignatures.map((e=>(e.isReadonly?"readonly ":"")+`[x: ${dt(e.parameter)}]: ${e.type}`)).join("; ");return e.propertySignatures.length>0?`{ ${t}; ${n} }`:`{ ${n} }`}return e.propertySignatures.length>0?`{ ${t} }`:"{}"},Le=r.di(c.zQ(s.pH,(e=>{switch(e._tag){case"AnyKeyword":return 0;case"UnknownKeyword":return 1;case"ObjectKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3}return 4}))),Ae={string:"StringKeyword",number:"NumberKeyword",boolean:"BooleanKeyword",bigint:"BigIntKeyword"},De=e=>r.qI(e,(e=>Fe(e)?De(e.types):[e]));class Be{types;annotations;static make=(e,t)=>{const n=[],r=new Set;for(let t=0;t<e.length;t++){const i=e[t];i===ne||r.has(i)||(r.add(i),n.push(i))}return Be.union(n,t)};static members=(e,t)=>Be.union((e=>e.filter((e=>!(e===ne))))(e),t);static unify=(e,t)=>Be.union((e=>{const t=Le(e),n=[],r={},i=[];for(const e of t)switch(e._tag){case"NeverKeyword":break;case"AnyKeyword":return[se];case"UnknownKeyword":return[ie];case"ObjectKeyword":case"UndefinedKeyword":case"VoidKeyword":case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":r[e._tag]||(r[e._tag]=e,n.push(e));break;case"Literal":{const t=typeof e.literal;switch(t){case"string":case"number":case"bigint":case"boolean":r[Ae[t]]||i.includes(e.literal)||(i.push(e.literal),n.push(e));break;case"object":i.includes(e.literal)||(i.push(e.literal),n.push(e))}break}case"UniqueSymbol":r.SymbolKeyword||i.includes(e.symbol)||(i.push(e.symbol),n.push(e));break;case"TupleType":r.ObjectKeyword||n.push(e);break;case"TypeLiteral":0===e.propertySignatures.length&&0===e.indexSignatures.length?r["{}"]||(r["{}"]=e,n.push(e)):r.ObjectKeyword||n.push(e);break;default:n.push(e)}return n})(De(e)),t);static union=(e,t)=>Me(e)?new Be(e,t):1===e.length?e[0]:ne;_tag="Union";constructor(e,t={}){this.types=e,this.annotations=t}toString(){return a.WL(ut(this),(()=>this.types.map(String).join(" | ")))}toJSON(){return{_tag:this._tag,types:this.types.map((e=>e.toJSON())),annotations:st(this.annotations)}}}const Pe=(e,t)=>e.map(t),Me=e=>e.length>1,Fe=K("Union"),Re=(0,o.V)(Symbol.for("@effect/schema/AST/toJSONMemoMap"),(()=>new WeakMap));class Ue{f;annotations;_tag="Suspend";constructor(e,t={}){this.f=e,this.annotations=t,this.f=p.Z4(e)}toString(){return ut(this).pipe(a.NW((()=>a.qI(a.IB(this.f)(),(e=>ut(e))))),a.WL((()=>"<suspended schema>")))}toJSON(){const e=this.f();let t=Re.get(e);return t||(Re.set(e,{_tag:this._tag}),t={_tag:this._tag,ast:e.toJSON(),annotations:st(this.annotations)},Re.set(e,t),t)}}class je{from;filter;annotations;_tag="Refinement";constructor(e,t,n={}){this.from=e,this.filter=t,this.annotations=n}toString(){return a.WL(ut(this),(()=>`{ ${this.from} | filter }`))}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),annotations:st(this.annotations)}}}const _e=K("Refinement"),$e={};class Qe{from;to;transformation;annotations;_tag="Transformation";constructor(e,t,n,r={}){this.from=e,this.to=t,this.transformation=n,this.annotations=r}toString(){return a.WL(ut(this),(()=>`(${String(this.from)} <-> ${String(this.to)})`))}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),to:this.to.toJSON(),annotations:st(this.annotations)}}}const Je=K("Transformation");class Ke{decode;encode;_tag="FinalTransformation";constructor(e,t){this.decode=e,this.encode=t}}class He{from;to;decode;encode;constructor(e,t,n,r){this.from=e,this.to=t,this.decode=n,this.encode=r}}class Ye{propertySignatureTransformations;_tag="TypeLiteralTransformation";constructor(e){this.propertySignatureTransformations=e;const t={},n={};for(const r of e){const e=r.from;if(t[e])throw new Error(u.NJ(e));t[e]=!0;const i=r.to;if(n[i])throw new Error(u.NJ(i));n[i]=!0}}}const Ve=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e);return n.annotations.value={...e.annotations,...t},Object.create(Object.getPrototypeOf(e),n)},ze=e=>{let t=`^${l.i(e.head)}`;for(const n of e.spans)de(n.type)?t+=".*":pe(n.type)&&(t+="[+-]?\\d*\\.?\\d+(?:[Ee][+-]?\\d+)?"),t+=l.i(n.literal);return t+="$",new RegExp(t)},Xe=e=>{switch(e._tag){case"Declaration":{const t=j(e);if(a.Ru(t))return Xe(t.value);break}case"TypeLiteral":return e.propertySignatures.slice();case"Suspend":return Xe(e.f())}return Ze(e).map((t=>Ge(e,t)))},Ge=(e,t)=>{switch(e._tag){case"Declaration":{const n=j(e);if(a.Ru(n))return Ge(n.value,t);break}case"TypeLiteral":{const n=r.i8(e.propertySignatures,(e=>e.name===t));if(a.Ru(n))return n.value;if(d.Kg(t))for(const n of e.indexSignatures){const e=dt(n.parameter);switch(e._tag){case"TemplateLiteral":if(ze(e).test(t))return new Ie(t,n.type,!1,!0);break;case"StringKeyword":return new Ie(t,n.type,!1,!0)}}else if(d.Bm(t))for(const n of e.indexSignatures){const e=dt(n.parameter);if(Ne(e))return new Ie(t,n.type,!1,!0)}break}case"Union":return new Ie(t,Be.make(e.types.map((e=>Ge(e,t).type))),!1,!0);case"Suspend":return Ge(e.f(),t)}return new Ie(t,ne,!1,!0)},Ze=e=>{switch(e._tag){case"Declaration":{const t=j(e);if(a.Ru(t))return Ze(t.value);break}case"TypeLiteral":return e.propertySignatures.map((e=>e.name));case"Suspend":return Ze(e.f());case"Union":return e.types.slice(1).reduce(((e,t)=>r.E$(e,Ze(t))),Ze(e.types[0]));case"Transformation":return Ze(e.to)}return[]},et=(e,t)=>{const n=[],r=[],i=e=>{switch(e._tag){case"NeverKeyword":break;case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":case"Refinement":r.push(new Te(e,t,!0));break;case"Literal":if(!d.Kg(e.literal)&&!d.Et(e.literal))throw new Error(u.Bd(e.literal));n.push(new Ie(e.literal,t,!1,!0));break;case"Enums":for(const[r,i]of e.enums)n.push(new Ie(i,t,!1,!0));break;case"UniqueSymbol":n.push(new Ie(e.symbol,t,!1,!0));break;case"Union":e.types.forEach(i);break;default:throw new Error(u.yK(e))}};return i(e),{propertySignatures:n,indexSignatures:r}},tt=e=>{switch(e._tag){case"Declaration":{const t=rt(e.typeParameters,tt);return t===e.typeParameters?e:new J(t,e.decodeUnknown,e.encodeUnknown,e.annotations)}case"TupleType":{const t=rt(e.elements,(e=>{const t=tt(e.type);return t===e.type?e:new ke(t,e.isOptional)})),n=Se(e.rest),r=rt(n,tt);return t===e.elements&&r===n?e:new Oe(t,r.map((e=>new xe(e))),e.isReadonly,e.annotations)}case"TypeLiteral":{const t=rt(e.propertySignatures,(e=>{const t=tt(e.type);return t===e.type?e:new Ie(e.name,t,e.isOptional,e.isReadonly)})),n=rt(e.indexSignatures,(e=>{const t=tt(e.type);return t===e.type?e:new Te(e.parameter,t,e.isReadonly)}));return t===e.propertySignatures&&n===e.indexSignatures?e:new Ee(t,n,e.annotations)}case"Union":{const t=rt(e.types,tt);return t===e.types?e:Be.make(t,e.annotations)}case"Suspend":return new Ue((()=>tt(e.f())),e.annotations);case"Refinement":{const t=tt(e.from);return t===e.from?e:new je(t,e.filter,e.annotations)}case"Transformation":return tt(e.to)}return e},nt=e=>a.YW((e=>a.NW(Q(e),(()=>B(e))))(e),{onNone:()=>{},onSome:e=>({[$]:e})});function rt(e,t){let n=!1;const i=r.CN(e.length);for(let r=0;r<e.length;r++){const o=e[r],s=t(o);s!==o&&(n=!0),i[r]=s}return n?i:e}const it=(e,t)=>{switch(e._tag){case"Declaration":{const n=rt(e.typeParameters,(e=>it(e,t)));return n===e.typeParameters?e:new J(n,e.decodeUnknown,e.encodeUnknown,e.annotations)}case"TupleType":{const n=rt(e.elements,(e=>{const n=it(e.type,t);return n===e.type?e:new ke(n,e.isOptional)})),r=Se(e.rest),i=rt(r,(e=>it(e,t)));return n===e.elements&&i===r?e:new Oe(n,i.map((e=>new xe(e))),e.isReadonly,nt(e))}case"TypeLiteral":{const n=rt(e.propertySignatures,(e=>{const n=it(e.type,t);return n===e.type?e:new Ie(e.name,n,e.isOptional,e.isReadonly)})),r=rt(e.indexSignatures,(e=>{const n=it(e.type,t);return n===e.type?e:new Te(e.parameter,n,e.isReadonly)}));return n===e.propertySignatures&&r===e.indexSignatures?e:new Ee(n,r,nt(e))}case"Union":{const n=rt(e.types,(e=>it(e,t)));return n===e.types?e:Be.make(n,nt(e))}case"Suspend":return new Ue((()=>it(e.f(),t)),nt(e));case"Refinement":{const n=it(e.from,t);if(t){if(n===e.from)return e;if(!Je(e.from)){const t=_(e);if(a.Ru(t)&&!0===t.value)return new je(n,e.filter)}}return n}case"Transformation":return it(e.from,t)}return e},ot=e=>it(e,!1),st=e=>{const t={};for(const n of Object.getOwnPropertySymbols(e))t[String(n)]=e[n];return t},at=r.di(c.zQ(s.pH,(e=>(e=>{switch(e._tag){case"NeverKeyword":return 0;case"Literal":case"UndefinedKeyword":case"VoidKeyword":case"UniqueSymbol":return 1;case"BooleanKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3;case"ObjectKeyword":return 5;case"UnknownKeyword":case"AnyKeyword":return 6;default:return 4}})(e.type)))),ct=r.di(c.zQ(s.pH,(e=>{switch(dt(e.parameter)._tag){case"StringKeyword":return 2;case"SymbolKeyword":return 3;case"TemplateLiteral":return 1}}))),dt=(s.pH,s.pH,s.pH,e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return e;case"Refinement":return dt(e.from)}}),lt=e=>a.WL(ut(e),(()=>e._tag)),ut=e=>B(e).pipe(a.NW((()=>D(e))),a.NW((()=>P(e))))},156340:(e,t,n)=>{n.d(t,{Kc:()=>$,Py:()=>W,ZU:()=>v,dF:()=>R,eC:()=>w,eq:()=>j,fJ:()=>I,gm:()=>m,is:()=>_,k9:()=>U,lN:()=>F,sV:()=>q,u$:()=>O,wG:()=>M,xm:()=>C});var r=n(975955),i=n(334188),o=n(200093),s=n(237965),a=n(374212),c=n(466894),d=n(755642),l=n(30805),u=n(43963),p=n(958146),h=n(250080),f=n(870512);class m{path;actual;issue;_tag="Pointer";constructor(e,t,n){this.path=e,this.actual=t,this.issue=n}}class y{actual;message;_tag="Unexpected";constructor(e,t){this.actual=e,this.message=t}}class g{ast;message;_tag="Missing";actual=void 0;constructor(e,t){this.ast=e,this.message=t}}class w{ast;actual;issues;output;_tag="Composite";constructor(e,t,n,r){this.ast=e,this.actual=t,this.issues=n,this.output=r}}class N{ast;actual;kind;issue;_tag="Refinement";constructor(e,t,n,r){this.ast=e,this.actual=t,this.kind=n,this.issue=r}}class b{ast;actual;kind;issue;_tag="Transformation";constructor(e,t,n,r){this.ast=e,this.actual=t,this.kind=n,this.issue=r}}class v{ast;actual;message;_tag="Type";constructor(e,t,n){this.ast=e,this.actual=t,this.message=n}}class x{ast;actual;message;_tag="Forbidden";constructor(e,t,n){this.ast=e,this.actual=t,this.message=n}}const k=Symbol.for("@effect/schema/ParseErrorTypeId");class S extends((0,i.rN)("ParseError")){[k]=k;get message(){return this.toString()}toString(){return f.Im(this.issue)}toJSON(){return{_id:"ParseError",message:this.toString()}}[d.FX](){return this.toJSON()}}const O=e=>new S({issue:e}),W=s.pG,I=s.kb,q=(s.Sv,s.sV),T=(0,a.XY)(2,((e,t)=>{const n=e;return"Left"===n._tag?n:"Right"===n._tag?t(n.right):o.flatMap(e,t)})),E=(0,a.XY)(2,((e,t)=>{const n=e;return"Left"===n._tag?n:"Right"===n._tag?s.pG(t(n.right)):o.map(e,t)})),C=(0,a.XY)(2,((e,t)=>{const n=e;return"Left"===n._tag?s.kb(t(n.left)):"Right"===n._tag?n:o.mapError(e,t)})),L=e=>{const t=e;if("Left"===t._tag||"Right"===t._tag)return t},A=(e,t)=>void 0===t||u.Et(t)?e:void 0===e?t:{...e,...t},D=(e,t,n)=>{const r=K(e,t);return(e,t)=>r(e,A(n,t))},B=(e,t,n)=>{const r=D(e,t,n);return(e,t)=>s.Gu(r(e,t),O)},P=(e,t,n)=>{const r=K(e,t);return(e,t)=>r(e,{...A(n,t),isEffectAllowed:!0})},M=(e,t)=>D(e.ast,!0,t),F=(e,t)=>P(e.ast,!0,t),R=(e,t)=>P(e.ast,!1,t),U=(e,t)=>B(e.ast,!0,t),j=(e,t)=>B(p.p$(e.ast),!0,t),_=(e,t)=>{const n=K(p.p$(e.ast),!0);return(e,r)=>s.FG(n(e,{exact:!0,...A(t,r)}))},$=(e,t)=>B(e.ast,!1,t),Q=(0,c.V)(Symbol.for("@effect/schema/Parser/decodeMemoMap"),(()=>new WeakMap)),J=(0,c.V)(Symbol.for("@effect/schema/Parser/encodeMemoMap"),(()=>new WeakMap)),K=(e,t)=>{const n=t?Q:J,r=n.get(e);if(r)return r;const i=V(e,t),o=p.Re(e),s=l.Ru(o)?(e,t)=>i(e,A(t,o.value)):i;return n.set(e,s),s},H=e=>l.Y6(p.fq(e)),Y=e=>l.Y6(p.iJ(e)),V=(e,t)=>{switch(e._tag){case"Refinement":if(t){const t=K(e.from,!0);return(n,r)=>ee(T(C(t(n,r),(t=>new N(e,n,"From",t))),(t=>l.YW(e.filter(t,r??p.Wy,e),{onNone:()=>s.pG(t),onSome:t=>s.kb(new N(e,n,"Predicate",t))}))),e,n,r)}{const t=K(p.p$(e),!0),n=K(Z(e.from),!1);return(r,i)=>ee(T(t(r,i),(e=>n(e,i))),e,r,i)}case"Transformation":{const n=re(e.transformation,t),r=t?K(e.from,!0):K(e.to,!1),i=t?K(e.to,!0):K(e.from,!1);return(o,s)=>ee(T(C(r(o,s),(n=>new b(e,o,t?"Encoded":"Type",n))),(r=>T(C(n(r,s??p.Wy,e),(t=>new b(e,o,"Transformation",t))),(n=>C(i(n,s),(n=>new b(e,o,t?"Type":"Encoded",n))))))),e,o,s)}case"Declaration":{const n=t?e.decodeUnknown(...e.typeParameters):e.encodeUnknown(...e.typeParameters);return(t,r)=>ee(n(t,r??p.Wy,e),e,t,r)}case"Literal":return z(e,(t=>t===e.literal));case"UniqueSymbol":return z(e,(t=>t===e.symbol));case"UndefinedKeyword":case"VoidKeyword":return z(e,u.b0);case"NeverKeyword":return z(e,u.Pd);case"UnknownKeyword":case"AnyKeyword":return s.pG;case"StringKeyword":return z(e,u.Kg);case"NumberKeyword":return z(e,u.Et);case"BooleanKeyword":return z(e,u.Lm);case"BigIntKeyword":return z(e,u.sI);case"SymbolKeyword":return z(e,u.Bm);case"ObjectKeyword":return z(e,u.Gv);case"Enums":return z(e,(t=>e.enums.some((([e,n])=>n===t))));case"TemplateLiteral":{const t=p.$j(e);return z(e,(e=>u.Kg(e)&&t.test(e)))}case"TupleType":{const n=e.elements.map((e=>K(e.type,t))),i=e.rest.map((e=>K(e.type,t)));let a=e.elements.filter((e=>!e.isOptional));e.rest.length>0&&(a=a.concat(e.rest.slice(1)));const c=a.length,d=e.elements.length>0?e.elements.map(((e,t)=>t)).join(" | "):"never",l=H(e),u=Y(e);return(t,p)=>{if(!r.cy(t))return s.kb(new v(e,t));const h="all"===p?.errors,f=[];let N=0;const b=[],x=t.length;for(let n=x;n<=c-1;n++){const r=new m(n,t,new g(a[n-x]));if(!h)return s.kb(new w(e,t,r,b));f.push([N++,r])}if(0===e.rest.length)for(let n=e.elements.length;n<=x-1;n++){const r=new m(n,t,new y(t[n],`is unexpected, expected: ${d}`));if(!h)return s.kb(new w(e,t,r,b));f.push([N++,r])}let k,S=0;for(;S<n.length;S++)if(x<S+1){if(e.elements[S].isOptional)continue}else{const r=(0,n[S])(t[S],p),i=L(r);if(i){if(s.OC(i)){const n=new m(S,t,i.left);if(h){f.push([N++,n]);continue}return s.kb(new w(e,t,n,ne(b)))}b.push([N++,i.right])}else{const n=N++,i=S;k||(k=[]),k.push((({es:a,output:c})=>o.flatMap(o.either(r),(r=>{if(s.OC(r)){const d=new m(i,t,r.left);return h?(a.push([n,d]),o.void):s.kb(new w(e,t,d,ne(c)))}return c.push([n,r.right]),o.void}))))}}if(r.iI(i)){const[n,...r]=i;for(;S<x-r.length;S++){const r=n(t[S],p),i=L(r);if(i){if(s.OC(i)){const n=new m(S,t,i.left);if(h){f.push([N++,n]);continue}return s.kb(new w(e,t,n,ne(b)))}b.push([N++,i.right])}else{const n=N++,i=S;k||(k=[]),k.push((({es:a,output:c})=>o.flatMap(o.either(r),(r=>{if(s.OC(r)){const d=new m(i,t,r.left);return h?(a.push([n,d]),o.void):s.kb(new w(e,t,d,ne(c)))}return c.push([n,r.right]),o.void}))))}}for(let n=0;n<r.length;n++)if(S+=n,!(x<S+1)){const i=r[n](t[S],p),a=L(i);if(a){if(s.OC(a)){const n=new m(S,t,a.left);if(h){f.push([N++,n]);continue}return s.kb(new w(e,t,n,ne(b)))}b.push([N++,a.right])}else{const n=N++,r=S;k||(k=[]),k.push((({es:a,output:c})=>o.flatMap(o.either(i),(i=>{if(s.OC(i)){const d=new m(r,t,i.left);return h?(a.push([n,d]),o.void):s.kb(new w(e,t,d,ne(c)))}return c.push([n,i.right]),o.void}))))}}}const O=({es:n,output:i})=>r.EI(n)?s.kb(new w(e,t,ne(n),ne(i))):s.pG(ne(i));if(k&&k.length>0){const e=k;return o.suspend((()=>{const t={es:r.C(f),output:r.C(b)};return o.flatMap(o.forEach(e,(e=>e(t)),{concurrency:l,batching:u,discard:!0}),(()=>O(t)))}))}return O({output:b,es:f})}}case"TypeLiteral":{if(0===e.propertySignatures.length&&0===e.indexSignatures.length)return z(e,u.$y);const n=[],i={},a=[];for(const r of e.propertySignatures)n.push([K(r.type,t),r]),i[r.name]=null,a.push(r.name);const c=e.indexSignatures.map((e=>[K(e.parameter,t),K(e.type,t),e.parameter])),d=p.gP.make(e.indexSignatures.map((e=>e.parameter)).concat(a.map((e=>u.Bm(e)?new p.w_(e):new p.uS(e))))),l=K(d,t),f=H(e),N=Y(e);return(t,p)=>{if(!u.u4(t))return s.kb(new v(e,t));const b="all"===p?.errors,x=[];let k=0;const S="error"===p?.onExcessProperty,O={};let W,I;if(S||"preserve"===p?.onExcessProperty){W=h.Hs(t);for(const n of W){const r=L(l(n,p));if(s.OC(r)){if(S){const r=new m(n,t,new y(t[n],`is unexpected, expected: ${String(d)}`));if(b){x.push([k++,r]);continue}return s.kb(new w(e,t,r,O))}O[n]=t[n]}}}const q=!0===p?.exact;for(let r=0;r<n.length;r++){const i=n[r][1],a=i.name,c=Object.prototype.hasOwnProperty.call(t,a);if(!c){if(i.isOptional)continue;if(q){const n=new m(a,t,new g(i));if(b){x.push([k++,n]);continue}return s.kb(new w(e,t,n,O))}}const d=(0,n[r][0])(t[a],p),l=L(d);if(l){if(s.OC(l)){const n=new m(a,t,c?l.left:new g(i));if(b){x.push([k++,n]);continue}return s.kb(new w(e,t,n,O))}O[a]=l.right}else{const n=k++,r=a;I||(I=[]),I.push((({es:a,output:l})=>o.flatMap(o.either(d),(d=>{if(s.OC(d)){const u=new m(r,t,c?d.left:new g(i));return b?(a.push([n,u]),o.void):s.kb(new w(e,t,u,l))}return l[r]=d.right,o.void}))))}}for(let n=0;n<c.length;n++){const r=c[n],a=r[0],d=r[1],l=h.SC(t,r[2]);for(const n of l){const r=L(a(n,p));if(r&&s.FG(r)){const r=d(t[n],p),a=L(r);if(a){if(s.OC(a)){const r=new m(n,t,a.left);if(b){x.push([k++,r]);continue}return s.kb(new w(e,t,r,O))}Object.prototype.hasOwnProperty.call(i,n)||(O[n]=a.right)}else{const a=k++,c=n;I||(I=[]),I.push((({es:d,output:l})=>o.flatMap(o.either(r),(r=>{if(s.OC(r)){const n=new m(c,t,r.left);return b?(d.push([a,n]),o.void):s.kb(new w(e,t,n,l))}return Object.prototype.hasOwnProperty.call(i,n)||(l[n]=r.right),o.void}))))}}}}const T=({es:n,output:i})=>{if(r.EI(n))return s.kb(new w(e,t,ne(n),i));if("original"===p?.propertyOrder){const e=W||h.Hs(t);for(const t of a)-1===e.indexOf(t)&&e.push(t);const n={};for(const t of e)Object.prototype.hasOwnProperty.call(i,t)&&(n[t]=i[t]);return s.pG(n)}return s.pG(i)};if(I&&I.length>0){const e=I;return o.suspend((()=>{const t={es:r.C(x),output:Object.assign({},O)};return o.flatMap(o.forEach(e,(e=>e(t)),{concurrency:f,batching:N,discard:!0}),(()=>T(t)))}))}return T({es:x,output:O})}}case"Union":{const n=G(e.types,t),i=h.Hs(n.keys),a=i.length,c=new Map;for(let n=0;n<e.types.length;n++)c.set(e.types[n],K(e.types[n],t));const d=H(e)??1,l=Y(e);return(t,h)=>{const f=[];let y,N=0,b=[];if(a>0)if(u.u4(t))for(let e=0;e<a;e++){const r=i[e],o=n.keys[r].buckets;if(Object.prototype.hasOwnProperty.call(t,r)){const e=String(t[r]);if(Object.prototype.hasOwnProperty.call(o,e))b=b.concat(o[e]);else{const e=p.gP.make(n.keys[r].literals);f.push([N++,new w(new p.Ky([new p.Gb(r,e,!1,!0)],[]),t,new m(r,t,new v(e,t[r])))])}}else{const e=p.gP.make(n.keys[r].literals),i=new p.Gb(r,e,!1,!0);f.push([N++,new w(new p.Ky([i],[]),t,new m(r,t,new g(i)))])}}else f.push([N++,new v(e,t)]);n.otherwise.length>0&&(b=b.concat(n.otherwise));for(let e=0;e<b.length;e++){const n=b[e],r=c.get(n)(t,h),i=y&&0!==y.length?void 0:L(r);if(i){if(s.FG(i))return s.pG(i.right);f.push([N++,i.left])}else{const e=N++;y||(y=[]),y.push((t=>o.suspend((()=>"finalResult"in t?o.void:o.flatMap(o.either(r),(n=>(s.FG(n)?t.finalResult=s.pG(n.right):t.es.push([e,n.left]),o.void)))))))}}const x=n=>r.EI(n)?1===n.length&&"Type"===n[0][1]._tag?s.kb(n[0][1]):s.kb(new w(e,t,ne(n))):s.kb(new v(e,t));if(y&&y.length>0){const e=y;return o.suspend((()=>{const t={es:r.C(f)};return o.flatMap(o.forEach(e,(e=>e(t)),{concurrency:d,batching:l,discard:!0}),(()=>"finalResult"in t?t.finalResult:x(t.es)))}))}return x(f)}}case"Suspend":{const n=h.Z4((()=>K(p.hk(e.f(),e.annotations),t)));return(e,t)=>n()(e,t)}}},z=(e,t)=>n=>t(n)?s.pG(n):s.kb(new v(e,n)),X=(e,t)=>{switch(e._tag){case"Declaration":{const n=p.YI(e);if(l.Ru(n))return X(n.value,t);break}case"TypeLiteral":{const n=[];for(let r=0;r<e.propertySignatures.length;r++){const i=e.propertySignatures[r],o=t?p.rQ(i.type):p.p$(i.type);p.c$(o)&&!i.isOptional&&n.push([i.name,o])}return n}case"Refinement":return X(e.from,t);case"Suspend":return X(e.f(),t);case"Transformation":return X(t?e.from:e.to,t)}return[]},G=(e,t)=>{const n={},r=[];for(let i=0;i<e.length;i++){const o=e[i],s=X(o,t);if(s.length>0)for(let e=0;e<s.length;e++){const[t,r]=s[e],i=String(r.literal);n[t]=n[t]||{buckets:{},literals:[]};const a=n[t].buckets;if(!Object.prototype.hasOwnProperty.call(a,i)){a[i]=[o],n[t].literals.push(r);break}e<s.length-1||(a[i].push(o),n[t].literals.push(r))}else r.push(o)}return{keys:n,otherwise:r}},Z=e=>p.C8(e)?Z(e.from):e,ee=(e,t,n,r)=>{const i=L(e);if(i)return i;if(!0===r?.isEffectAllowed)return e;try{return o.runSync(o.either(e))}catch(e){return s.kb(new x(t,n,"cannot be be resolved synchronously, this is caused by using runSync on an effect that performs async work"))}},te=([e],[t])=>e>t?1:e<t?-1:0;function ne(e){return e.sort(te).map((e=>e[1]))}const re=(e,t)=>{switch(e._tag){case"FinalTransformation":return t?e.decode:e.encode;case"ComposeTransformation":return s.pG;case"TypeLiteralTransformation":return n=>{let r=s.pG(n);for(const n of e.propertySignatureTransformations){const[e,i]=t?[n.from,n.to]:[n.to,n.from],o=t?n.decode:n.encode,s=t=>{const n=o(Object.prototype.hasOwnProperty.call(t,e)?l.zN(t[e]):l.dv());return delete t[e],l.Ru(n)&&(t[i]=n.value),t};r=E(r,s)}return r}}}},622867:(e,t,n)=>{n.d(t,{BpQ:()=>Se,D4M:()=>A,EGw:()=>D,L8n:()=>W,MM$:()=>Ve,O31:()=>ne,QfV:()=>H,Ru6:()=>xe,T16:()=>We,TqQ:()=>rt,Whr:()=>Ge,XeB:()=>et,_kM:()=>ae,gPz:()=>G,jJo:()=>ct,lFO:()=>C,lNp:()=>L,mKk:()=>qe,mSG:()=>de,pbD:()=>ye,pdi:()=>Ne,rdN:()=>ee,wNn:()=>Y,wkx:()=>ue,xeR:()=>F,yjt:()=>ot});var r=n(975955),i=n(2833),o=n(656599),s=n(165446),a=n(972e3),c=n(237965),d=n(643085),l=n(545422),u=n(617194),p=n(487529),h=n(374212),f=n(620113),m=n(30805),y=n(977148),g=n(43963),w=n(711312),N=n(958146),b=n(920902),v=n(586521),x=n(250080),k=n(156340),S=n(356004);const O=Symbol.for("@effect/schema/Schema"),W=e=>class{[O]=I;static Type;static Encoded;static[O]=I;static ast=e;static annotations(e){return W(T(this.ast,e))}static pipe(){return(0,y.t)(this,arguments)}static toString(){return String(e)}},I={_A:e=>e,_I:e=>e,_R:e=>e},q=e=>{if(!e)return{};const t={},n=Object.getOwnPropertySymbols(e);for(const r of n)t[r]=e[r];if(void 0!==e.typeId){const n=e.typeId;"object"==typeof n?(t[N.Dp]=n.id,t[n.id]=n.annotation):t[N.Dp]=n}const r=(n,r)=>{void 0!==e[n]&&(t[r]=e[n])};return r("message",N.YN),r("missingMessage",N.Ey),r("identifier",N.On),r("title",N.Z8),r("description",N.BW),r("examples",N.U4),r("default",N.u7),r("documentation",N.DH),r("jsonSchema",N.Ad),r("arbitrary",w.B1),r("pretty",S.jo),r("equivalence",b.tI),r("concurrency",N.MR),r("batching",N.Jo),r("parseIssueTitle",N.J5),r("parseOptions",N.E_),t},T=(e,t)=>N.hk(e,q(t)),E=(e,t)=>{const n=k.dF(e,t);return(e,t)=>k.xm(n(e,t),k.u$)},C=E,L=(e,t)=>{const n=k.lN(e,t);return(e,t)=>k.xm(n(e,t),k.u$)},A=L,D=(e,t)=>{const n=k.wG(e,t);return(e,t)=>c.qE(n(e,t),k.u$)},B=e=>g.i5(e,O)&&g.Gv(e[O]),P=(e,t=(e=>N.gV(e)?N.gP.make(N.Mz(e,(e=>new N.uS(e)))):new N.uS(e[0]))(e))=>class extends(W(t)){static annotations(e){return P(this.literals,T(this.ast,e))}static literals=[...e]};function M(...e){return r.iI(e)?P(e):_}const F=function(){if(Array.isArray(arguments[0])){return((e,t,n)=>W(new N.D6(e.map((e=>e.ast)),((...e)=>t.decode(...e.map(W))),((...e)=>t.encode(...e.map(W))),q(n))))(arguments[0],arguments[1],arguments[2])}return((e,t)=>{const n=()=>(t,n,r)=>e(t)?k.Py(t):k.fJ(new k.ZU(r,t)),r=n;return W(new N.D6([],n,r,q(t)))})(arguments[0],arguments[1])};class R extends(W(N.oA)){static annotations=super.annotations}class U extends(W(N.Kt)){static annotations=super.annotations}class j extends(W(N.ch)){static annotations=super.annotations}class _ extends(W(N.M3)){static annotations=super.annotations}class $ extends(W(N.ai)){static annotations=super.annotations}class Q extends(W(N._q)){static annotations=super.annotations}class J extends(W(N.Zi)){static annotations=super.annotations}class K extends(W(N.YP)){static annotations=super.annotations}class H extends(W(N.vs)){static annotations=super.annotations}class Y extends(W(N.XS)){static annotations=super.annotations}class V extends(W(N.OD)){static annotations=super.annotations}class z extends(W(N.ZG)){static annotations=super.annotations}const X=(e,t=(e=>N.gP.members(e.map((e=>e.ast))))(e))=>class extends(W(t)){static annotations(e){return X(this.members,T(this.ast,e))}static members=[...e]};function G(...e){return N.gV(e)?X(e):r.iI(e)?e[0]:_}const Z=(e,t,n=((e,t)=>new N.TD(e.map((e=>B(e)?new N.zh(e.ast,!1):e.ast)),t.map((e=>B(e)?new N.ZU(e.ast):e.ast)),!0))(e,t))=>class extends(W(n)){static annotations(e){return Z(this.elements,this.rest,T(this.ast,e))}static elements=[...e];static rest=[...t]};function ee(...e){return Array.isArray(e[0])?Z(e[0],e.slice(1)):Z(e,[])}const te=(e,t)=>class extends(Z([],[e],t)){static annotations(e){return te(this.value,T(this.ast,e))}static value=e},ne=e=>te(e);N.zh;N.zh;N.zh;const re=Symbol.for("@effect/schema/PropertySignature");const ie=e=>g.i5(e,re),oe=(e,t)=>{const n=x.Hs(e);for(const r of n){const n=e[r];if(void 0===t[r]&&ie(n)){const e=n.ast,i="PropertySignatureDeclaration"===e._tag?e.defaultValue:e.to.defaultValue;void 0!==i&&(t[r]=i())}}return t},se=(e,t,n=((e,t)=>{const n=x.Hs(e),i=[];if(n.length>0){const o=[],s=[],a=[];for(let t=0;t<n.length;t++){const r=n[t],c=e[r];if(ie(c)){const e=c.ast;switch(e._tag){case"PropertySignatureDeclaration":{const t=e.type,n=e.isOptional,a=e.annotations;o.push(new N.Gb(r,t,n,!0)),s.push(new N.Gb(r,N.p$(t),n,!0,a)),i.push(new N.Gb(r,t,n,!0,a));break}case"PropertySignatureTransformation":{const t=e.from.fromKey??r;o.push(new N.Gb(t,e.from.type,e.from.isOptional,!0,e.from.annotations)),s.push(new N.Gb(r,e.to.type,e.to.isOptional,!0,e.to.annotations)),a.push(new N.Zn(t,r,e.decode,e.encode));break}}}else o.push(new N.Gb(r,c.ast,!1,!0)),s.push(new N.Gb(r,N.p$(c.ast),!1,!0)),i.push(new N.Gb(r,c.ast,!1,!0))}if(r.iI(a)){const e=[],n=[];for(const r of t){const{indexSignatures:t,propertySignatures:i}=N.g1(r.key.ast,r.value.ast);i.forEach((e=>{o.push(e),s.push(new N.Gb(e.name,N.p$(e.type),e.isOptional,e.isReadonly,e.annotations))})),t.forEach((t=>{e.push(t),n.push(new N.NH(t.parameter,N.p$(t.type),t.isReadonly))}))}return new N.IT(new N.Ky(o,e,{[N.Z8]:"Struct (Encoded side)"}),new N.Ky(s,n,{[N.Z8]:"Struct (Type side)"}),new N.nt(a))}}const o=[];for(const e of t){const{indexSignatures:t,propertySignatures:n}=N.g1(e.key.ast,e.value.ast);n.forEach((e=>i.push(e))),t.forEach((e=>o.push(e)))}return new N.Ky(i,o)})(e,t))=>class extends(W(n)){static annotations(e){return se(this.fields,this.records,T(this.ast,e))}static fields={...e};static records=[...t];static make=(t,n)=>{const r=oe(e,{...t});return jt(n)?r:k.eq(this)(r)}};function ae(e,...t){return se(e,t)}const ce=(e,t,n)=>class extends(se({},[{key:e,value:t}],n)){static annotations(n){return ce(e,t,T(this.ast,n))}static key=e;static value=t},de=(e,t)=>ce(e,t),le=e=>class extends(W(e)){static annotations(e){return le(T(this.ast,e))}static make=(e,t)=>jt(t)?e:k.eq(this)(e)},ue=(e,t)=>n=>{const r=m.YW(N.$N(n.ast),{onNone:()=>[e],onSome:t=>[...t,e]}),i=N.hk(n.ast,q({title:String(n.ast)+` & Brand<${x.eA(e)}>`,...t,[N.SB]:r}));return le(i)},pe=e=>W(new N.V3((()=>e().ast))),he=(e,t,n)=>class extends(W(n)){static annotations(e){return he(this.from,this.filter,T(this.ast,e))}static from=e;static filter=t;static make=(e,t)=>jt(t)?e:k.eq(this)(e)},fe=(e,t,n)=>{if(g.Lm(e))return e?m.dv():m.zN(new k.ZU(t,n));if(g.Kg(e))return m.zN(new k.ZU(t,n,e));if(void 0!==e){if("_tag"in e)return m.zN(e);const i=new k.ZU(t,n,e.message);return m.zN(r.iI(e.path)?new k.gm(e.path,n,i):i)}return m.dv()},me=(e,t,n)=>{if(x.vX(e))return fe(e,t,n);if(r.iI(e)){const i=r.x1(e,(e=>fe(e,t,n)));if(r.iI(i))return m.zN(1===i.length?i[0]:new k.eC(t,n,i))}return m.dv()};function ye(e,t){return n=>{function r(t,n,r){return me(e(t,n,r),r,t)}const i=new N.kV(n.ast,r,q(t));return he(n,r,i)}}const ge=(e,t,n)=>class extends(W(n)){static annotations(e){return ge(this.from,this.to,T(this.ast,e))}static from=e;static to=t},we=(0,h.XY)((e=>B(e[0])&&B(e[1])),((e,t,n)=>ge(e,t,new N.IT(e.ast,t.ast,new N.EK(n.decode,n.encode))))),Ne=(0,h.XY)((e=>B(e[0])&&B(e[1])),((e,t,n)=>we(e,t,{decode:e=>k.Py(n.decode(e)),encode:e=>k.Py(n.encode(e))})));const be=Symbol.for("@effect/schema/TypeId/Trimmed"),ve=v.Qp,xe=(e,t)=>n=>n.pipe(ye((t=>t.length<=e),{typeId:ve,description:`a string at most ${e} character(s) long`,jsonSchema:{maxLength:e},...t})),ke=v.Wz,Se=(e,t)=>n=>n.pipe(ye((t=>t.length>=e),{typeId:ke,description:`a string at least ${e} character(s) long`,jsonSchema:{minLength:e},...t})),Oe=Symbol.for("@effect/schema/TypeId/Pattern"),We=(e,t)=>n=>{const r=e.source;return n.pipe(ye((t=>(e.lastIndex=0,e.test(t))),{typeId:{id:Oe,annotation:{regex:e}},description:`a string matching the pattern ${r}`,jsonSchema:{pattern:r},arbitrary:()=>t=>t.stringMatching(e),...t}))},Ie=Symbol.for("@effect/schema/TypeId/Includes"),qe=(e,t)=>n=>n.pipe(ye((t=>t.includes(e)),{typeId:{id:Ie,annotation:{includes:e}},description:`a string including ${JSON.stringify(e)}`,jsonSchema:{pattern:`.*${e}.*`},...t})),Te=Symbol.for("@effect/schema/TypeId/Lowercased");class Ee extends(H.pipe((e=>t=>t.pipe(ye((e=>e===e.toLowerCase()),{typeId:Te,description:"a lowercase string",...e})))({identifier:"Lowercased",title:"Lowercased"}))){static annotations=super.annotations}const Ce=Symbol.for("@effect/schema/TypeId/Uppercased");class Le extends(H.pipe((e=>t=>t.pipe(ye((e=>e===e.toUpperCase()),{typeId:Ce,description:"an uppercase string",...e})))({identifier:"Uppercased",title:"Uppercased"}))){static annotations=super.annotations}const Ae=v.Ij;class De extends(H.pipe(((e,t)=>n=>{const r=g.Gv(e)?Math.max(0,Math.floor(e.min)):Math.max(0,Math.floor(e)),i=g.Gv(e)?Math.max(r,Math.floor(e.max)):r;return r!==i?n.pipe(ye((e=>e.length>=r&&e.length<=i),{typeId:Ae,description:`a string at least ${r} character(s) and at most ${i} character(s) long`,jsonSchema:{minLength:r,maxLength:i},...t})):n.pipe(ye((e=>e.length===r),{typeId:Ae,description:1===r?"a single character":`a string ${r} character(s) long`,jsonSchema:{minLength:r,maxLength:r},...t}))})(1,{identifier:"Char"}))){static annotations=super.annotations}class Be extends(Ne(H,Ee,{decode:e=>e.toLowerCase(),encode:h.D_}).annotations({identifier:"Lowercase"})){static annotations=super.annotations}class Pe extends(Ne(H,Le,{decode:e=>e.toUpperCase(),encode:h.D_}).annotations({identifier:"Uppercase"})){static annotations=super.annotations}class Me extends(H.pipe((e=>t=>t.pipe(ye((e=>e===e.trim()),{typeId:be,description:"a string with no leading or trailing whitespace",jsonSchema:{pattern:"^\\S[\\s\\S]*\\S$|^\\S$|^$"},...e})))({identifier:"Trimmed",title:"Trimmed"}))){static annotations=super.annotations}class Fe extends(Ne(H,Me,{decode:e=>e.trim(),encode:h.D_}).annotations({identifier:"Trim"})){static annotations=super.annotations}N.On,N.Z8,N.BW;class Re extends(H.pipe((e=>Se(1,{description:"a non empty string",...e}))({identifier:"NonEmpty",title:"NonEmpty"}))){static annotations=super.annotations}const Ue=Symbol.for("@effect/schema/TypeId/UUID"),je=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i;class _e extends(H.pipe(We(je,{typeId:Ue,identifier:"UUID",title:"UUID",description:"a Universally Unique Identifier",arbitrary:()=>e=>e.uuid()}))){static annotations=super.annotations}const $e=Symbol.for("@effect/schema/TypeId/ULID"),Qe=/^[0-7][0-9A-HJKMNP-TV-Z]{25}$/i;class Je extends(H.pipe(We(Qe,{typeId:$e,identifier:"ULID",title:"ULID",description:"a Universally Unique Lexicographically Sortable Identifier",arbitrary:()=>e=>e.ulid()}))){static annotations=super.annotations}const Ke=Symbol.for("@effect/schema/TypeId/Finite"),He=e=>t=>t.pipe(ye((e=>Number.isFinite(e)),{typeId:Ke,description:"a finite number",...e})),Ye=v.$_,Ve=(e,t)=>n=>n.pipe(ye((t=>t>e),{typeId:Ye,description:0===e?"a positive number":`a number greater than ${e}`,jsonSchema:{exclusiveMinimum:e},...t})),ze=v.ft,Xe=v.Xe,Ge=e=>t=>t.pipe(ye((e=>Number.isSafeInteger(e)),{typeId:Xe,title:"integer",description:"an integer",jsonSchema:{type:"integer"},...e})),Ze=v.IO,et=(e,t)=>n=>n.pipe(ye((t=>t<e),{typeId:Ze,description:0===e?"a negative number":`a number less than ${e}`,jsonSchema:{exclusiveMaximum:e},...t})),tt=v._b,nt=v._F,rt=(e,t,n)=>r=>r.pipe(ye((n=>n>=e&&n<=t),{typeId:nt,description:`a number between ${e} and ${t}`,jsonSchema:{maximum:t,minimum:e},...n})),it=Symbol.for("@effect/schema/TypeId/NonNaN"),ot=e=>Ve(0,e),st=e=>((e,t)=>n=>n.pipe(ye((t=>t<=e),{typeId:tt,description:0===e?"a non-positive number":`a number less than or equal to ${e}`,jsonSchema:{maximum:e},...t})))(0,e),at=e=>((e,t)=>n=>n.pipe(ye((t=>t>=e),{typeId:ze,description:0===e?"a non-negative number":`a number greater than or equal to ${e}`,jsonSchema:{minimum:e},...t})))(0,e);class ct extends((e=>we(e,Y,{strict:!1,decode:(e,t,n)=>k.sV(f.qg(e),(()=>new k.ZU(n,e))),encode:e=>k.Py(String(e))}))(H).annotations({identifier:"NumberFromString"})){static annotations=super.annotations}class dt extends(Y.pipe(He({identifier:"Finite",title:"Finite"}))){static annotations=super.annotations}class lt extends(Y.pipe(Ge({identifier:"Int",title:"Int"}))){static annotations=super.annotations}class ut extends(Y.pipe((e=>t=>t.pipe(ye((e=>!Number.isNaN(e)),{typeId:it,description:"a number excluding NaN",...e})))({identifier:"NonNaN",title:"NonNaN"}))){static annotations=super.annotations}class pt extends(Y.pipe(ot({identifier:"Positive",title:"Positive"}))){static annotations=super.annotations}class ht extends(Y.pipe((e=>et(0,e))({identifier:"Negative",title:"Negative"}))){static annotations=super.annotations}class ft extends(Y.pipe(st({identifier:"NonPositive",title:"NonPositive"}))){static annotations=super.annotations}class mt extends(Y.pipe(at({identifier:"NonNegative",title:"NonNegative"}))){static annotations=super.annotations}const yt=Symbol.for("@effect/schema/TypeId/JsonNumber");class gt extends(Y.pipe(ye((e=>!Number.isNaN(e)&&Number.isFinite(e)),{typeId:yt,identifier:"JsonNumber",title:"JSON-compatible number",description:"a JSON-compatible number, excluding NaN, +Infinity, and -Infinity",jsonSchema:{type:"number"}}))){static annotations=super.annotations}class wt extends(Ne(V,V,{decode:s.AU,encode:s.AU})){static annotations=super.annotations}class Nt extends(Ne(H,K,{strict:!1,decode:e=>Symbol.for(e),encode:e=>e.description}).annotations({identifier:"symbol"})){static annotations=super.annotations}v.uy,v.wO,v.pU,v.$H,v.tg;class bt extends(we(H,J,{decode:(e,t,n)=>k.sV(o.sH(e),(()=>new k.ZU(n,e))),encode:e=>k.Py(String(e))}).annotations({identifier:"bigint"})){static annotations=super.annotations}class vt extends(we(Y,J,{decode:(e,t,n)=>k.sV(o.oB(e),(()=>new k.ZU(n,e))),encode:(e,t,n)=>k.sV(o.Ro(e),(()=>new k.ZU(n,e)))}).annotations({identifier:"BigintFromNumber"})){static annotations=super.annotations}class xt extends(F(a.n$,{identifier:"DurationFromSelf",pretty:()=>String,arbitrary:()=>e=>e.oneof(e.constant(a.Tn),e.bigUint().map((e=>a.cF(e))),e.bigUint().map((e=>a.SY(e))),e.maxSafeNat().map((e=>a.ne(e))),e.maxSafeNat().map((e=>a.YA(e))),e.maxSafeNat().map((e=>a.Gx(e))),e.maxSafeNat().map((e=>a.c$(e))),e.maxSafeNat().map((e=>a._3(e))),e.maxSafeNat().map((e=>a.QM(e)))),equivalence:()=>a.rs})){static annotations=super.annotations}class kt extends(we(J,xt,{decode:e=>k.Py(a.cF(e)),encode:(e,t,n)=>m.YW(a.tb(e),{onNone:()=>k.fJ(new k.ZU(n,e)),onSome:e=>k.Py(e)})}).annotations({identifier:"DurationFromNanos"})){static annotations=super.annotations}class St extends(Ne(Y,xt,{decode:e=>a.ne(e),encode:e=>a.kE(e)}).annotations({identifier:"DurationFromMillis"})){static annotations=super.annotations}const Ot=ee(mt.pipe(He({[N.Z8]:"seconds",[N.BW]:"seconds"})),mt.pipe(He({[N.Z8]:"nanos",[N.BW]:"nanos"})));class Wt extends(Ne(Ot,xt,{decode:([e,t])=>a.cF(BigInt(e)*BigInt(1e9)+BigInt(t)),encode:e=>a.Zr(e)}).annotations({identifier:"Duration"})){static annotations=super.annotations}const It=F(g.mg,{identifier:"Uint8ArrayFromSelf",pretty:()=>e=>`new Uint8Array(${JSON.stringify(Array.from(e))})`,arbitrary:()=>e=>e.uint8Array(),equivalence:()=>r.bt(l.aI)}),qt=(e,t,n)=>we(H,It,{decode:(e,n,r)=>c.qE(t(e),(t=>new k.ZU(r,e,t.message))),encode:e=>k.Py(n(e))}).annotations({identifier:e}),Tt=(d.y4,d.WG,d.$X,d.DX,d.EF,d.mU,v.mO,v.EM,v.Ls,Symbol.for("@effect/schema/TypeId/ValidDate")),Et=e=>t=>t.pipe(ye((e=>!Number.isNaN(e.getTime())),{typeId:Tt,description:"a valid Date",...e}));class Ct extends(F(g.$P,{identifier:"DateFromSelf",description:"a potentially invalid Date instance",pretty:()=>e=>`new Date(${JSON.stringify(e)})`,arbitrary:()=>e=>e.date({noInvalidDate:!1}),equivalence:()=>u.n9})){static annotations=super.annotations}class Lt extends(Ct.pipe(Et({identifier:"ValidDateFromSelf",description:"a valid Date instance"}))){static annotations=super.annotations}class At extends(Ne(H,Ct,{decode:e=>new Date(e),encode:e=>e.toISOString()}).annotations({identifier:"DateFromString"})){static annotations=super.annotations}class Dt extends(At.pipe(Et({identifier:"Date"}))){static annotations=super.annotations}class Bt extends(Ne(Y,Ct,{decode:e=>new Date(e),encode:e=>e.getTime()}).annotations({identifier:"DateFromNumber"})){static annotations=super.annotations}const Pt=()=>e=>`BigDecimal(${i.GP(i.S8(e))})`,Mt=()=>e=>e.tuple(e.bigInt(),e.integer()).map((([e,t])=>i.L8(e,t)));class Ft extends(F(i.s5,{identifier:"BigDecimalFromSelf",pretty:Pt,arbitrary:Mt,equivalence:()=>i.rs})){static annotations=super.annotations}class Rt extends(we(H,Ft,{decode:(e,t,n)=>i.sH(e).pipe(m.YW({onNone:()=>k.fJ(new k.ZU(n,e)),onSome:e=>k.Py(i.S8(e))})),encode:e=>k.Py(i.GP(i.S8(e)))}).annotations({identifier:"BigDecimal"})){static annotations=super.annotations}class Ut extends(we(Y,Ft,{decode:e=>k.Py(i.oB(e)),encode:e=>k.Py(i.Di(e))}).annotations({identifier:"BigDecimalFromNumber"})){static annotations=super.annotations}const jt=e=>g.Lm(e)?e:e?.disableValidation??!1,_t=G(ae({_tag:M("None")}).annotations({identifier:"FiberIdNoneEncoded"}),ae({_tag:M("Runtime"),id:lt.annotations({title:"id",description:"id"}),startTimeMillis:lt.annotations({title:"startTimeMillis",description:"startTimeMillis"})}).annotations({identifier:"FiberIdRuntimeEncoded"}),ae({_tag:M("Composite"),left:pe((()=>_t)),right:pe((()=>_t))}).annotations({identifier:"FiberIdCompositeEncoded"})).annotations({identifier:"FiberIdEncoded"}),$t=e=>e.letrec((t=>({None:e.record({_tag:e.constant("None")}),Runtime:e.record({_tag:e.constant("Runtime"),id:e.integer(),startTimeMillis:e.integer()}),Composite:e.record({_tag:e.constant("Composite"),left:t("FiberId"),right:t("FiberId")}),FiberId:e.oneof(t("None"),t("Runtime"),t("Composite"))}))).FiberId.map(Kt),Qt=e=>{switch(e._tag){case"None":return"FiberId.none";case"Runtime":return`FiberId.runtime(${e.id}, ${e.startTimeMillis})`;case"Composite":return`FiberId.composite(${Qt(e.right)}, ${Qt(e.left)})`}};class Jt extends(F(p.gb,{identifier:"FiberIdFromSelf",pretty:()=>Qt,arbitrary:()=>$t})){static annotations=super.annotations}const Kt=e=>{switch(e._tag){case"None":return p.dv;case"Runtime":return p.fA(e.id,e.startTimeMillis);case"Composite":return p.sN(Kt(e.left),Kt(e.right))}},Ht=e=>{switch(e._tag){case"None":return{_tag:"None"};case"Runtime":return{_tag:"Runtime",id:e.id,startTimeMillis:e.startTimeMillis};case"Composite":return{_tag:"Composite",left:Ht(e.left),right:Ht(e.right)}}};class Yt extends(Ne(_t,Jt,{decode:Kt,encode:Ht}).annotations({identifier:"FiberId"})){static annotations=super.annotations}class Vt extends(Ne($,V,{decode:g.zz,encode:h.D_}).annotations({identifier:"BooleanFromUnknown"})){static annotations=super.annotations}},845119:(e,t,n)=>{var r=n(689210),i=n(319819),o=n(396244),s=n(156340),a=n(622867),c=n(718034),d=n(858592),l=n(257844),u=n(975955),p=n(703225),h=n(319407),f=n(200093),m=n(374212),y=n(30805),g=n(43963),w=n(796031),N=n(770324),b=n(147494),v=n(684550),x=n(494400);const k=p.Io("Config"),S={reloadUrl:"/",syncUrl:"https://evolu.world",name:"Evolu",maxDrift:3e5,minimumLogLevel:"none"},O=e=>{const t={...S,...e},n=w.Py(k,t),r=x.Uq(t.minimumLogLevel).pipe(x.z7("debug",(()=>N.y)),x.z7("none",(()=>N.NV)),x.z7("trace",(()=>N.Cn)),x.z7("warning",(()=>N.N5)),x.T1),i="none"===t.minimumLogLevel?n:w.Um(n,b.dl(r),b.HC(b.Um,W(t.name)));return v.L(i)},W=e=>b.L8((({logLevel:t,message:n,date:r})=>{const i="Warning"===t._tag?"warn":"Error"===t._tag?"error":"log",o=`${r.getHours().toString().padStart(2,"0")}:${r.getMinutes().toString().padStart(2,"0")}:${r.getSeconds().toString().padStart(2,"0")}:${r.getMilliseconds().toString().padStart(3,"0")}`,s=Array.isArray(n)?n:[n];globalThis.console[i](`${o} [${e}]`,...s)}));var I=n(237965),q=n(620113),T=n(326237),E=n(962100);function C(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`positive integer expected, not ${e}`)}function L(e,...t){if(!((n=e)instanceof Uint8Array||null!=n&&"object"==typeof n&&"Uint8Array"===n.constructor.name))throw new Error("Uint8Array expected");var n;if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function A(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");C(e.outputLen),C(e.blockLen)}function D(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function B(e,t){L(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}var P=n(375689);const M=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);new Uint8Array(new Uint32Array([287454020]).buffer)[0];function F(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}(e)),L(e),e}class R{clone(){return this._cloneInto()}}function U(e){const t=t=>e().update(F(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}class j extends R{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,A(e);const n=F(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,i=new Uint8Array(r);i.set(n.length>r?e.create().update(n).digest():n);for(let e=0;e<i.length;e++)i[e]^=54;this.iHash.update(i),this.oHash=e.create();for(let e=0;e<i.length;e++)i[e]^=106;this.oHash.update(i),i.fill(0)}update(e){return D(this),this.iHash.update(e),this}digestInto(e){D(this),L(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:r,destroyed:i,blockLen:o,outputLen:s}=this;return e.finished=r,e.destroyed=i,e.blockLen=o,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const _=(e,t,n)=>new j(e,t).update(n).digest();_.create=(e,t)=>new j(e,t);class $ extends R{constructor(e,t,n,r){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=M(this.buffer)}update(e){D(this);const{view:t,buffer:n,blockLen:r}=this,i=(e=F(e)).length;for(let o=0;o<i;){const s=Math.min(r-this.pos,i-o);if(s!==r)n.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===r&&(this.process(t,0),this.pos=0);else{const t=M(e);for(;r<=i-o;o+=r)this.process(t,o)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){D(this),B(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>r-o&&(this.process(n,0),o=0);for(let e=o;e<r;e++)t[e]=0;!function(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);const i=BigInt(32),o=BigInt(4294967295),s=Number(n>>i&o),a=Number(n&o),c=r?4:0,d=r?0:4;e.setUint32(t+c,s,r),e.setUint32(t+d,a,r)}(n,r-8,BigInt(8*this.length),i),this.process(n,0);const s=M(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,d=this.get();if(c>d.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)s.setUint32(4*e,d[e],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:i,destroyed:o,pos:s}=this;return e.length=r,e.pos=s,e.finished=i,e.destroyed=o,r%t&&e.buffer.set(n),e}}const Q=BigInt(2**32-1),J=BigInt(32);function K(e,t=!1){return t?{h:Number(e&Q),l:Number(e>>J&Q)}:{h:0|Number(e>>J&Q),l:0|Number(e&Q)}}const H={fromBig:K,split:function(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let i=0;i<e.length;i++){const{h:o,l:s}=K(e[i],t);[n[i],r[i]]=[o,s]}return[n,r]},toBig:(e,t)=>BigInt(e>>>0)<<J|BigInt(t>>>0),shrSH:(e,t,n)=>e>>>n,shrSL:(e,t,n)=>e<<32-n|t>>>n,rotrSH:(e,t,n)=>e>>>n|t<<32-n,rotrSL:(e,t,n)=>e<<32-n|t>>>n,rotrBH:(e,t,n)=>e<<64-n|t>>>n-32,rotrBL:(e,t,n)=>e>>>n-32|t<<64-n,rotr32H:(e,t)=>t,rotr32L:(e,t)=>e,rotlSH:(e,t,n)=>e<<n|t>>>32-n,rotlSL:(e,t,n)=>t<<n|e>>>32-n,rotlBH:(e,t,n)=>t<<n-32|e>>>64-n,rotlBL:(e,t,n)=>e<<n-32|t>>>64-n,add:function(e,t,n,r){const i=(t>>>0)+(r>>>0);return{h:e+n+(i/2**32|0)|0,l:0|i}},add3L:(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),add3H:(e,t,n,r)=>t+n+r+(e/2**32|0)|0,add4L:(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),add4H:(e,t,n,r,i)=>t+n+r+i+(e/2**32|0)|0,add5H:(e,t,n,r,i,o)=>t+n+r+i+o+(e/2**32|0)|0,add5L:(e,t,n,r,i)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(i>>>0)},[Y,V]=(()=>H.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((e=>BigInt(e)))))(),z=new Uint32Array(80),X=new Uint32Array(80);class G extends ${constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:r,Ch:i,Cl:o,Dh:s,Dl:a,Eh:c,El:d,Fh:l,Fl:u,Gh:p,Gl:h,Hh:f,Hl:m}=this;return[e,t,n,r,i,o,s,a,c,d,l,u,p,h,f,m]}set(e,t,n,r,i,o,s,a,c,d,l,u,p,h,f,m){this.Ah=0|e,this.Al=0|t,this.Bh=0|n,this.Bl=0|r,this.Ch=0|i,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|d,this.Fh=0|l,this.Fl=0|u,this.Gh=0|p,this.Gl=0|h,this.Hh=0|f,this.Hl=0|m}process(e,t){for(let n=0;n<16;n++,t+=4)z[n]=e.getUint32(t),X[n]=e.getUint32(t+=4);for(let e=16;e<80;e++){const t=0|z[e-15],n=0|X[e-15],r=H.rotrSH(t,n,1)^H.rotrSH(t,n,8)^H.shrSH(t,n,7),i=H.rotrSL(t,n,1)^H.rotrSL(t,n,8)^H.shrSL(t,n,7),o=0|z[e-2],s=0|X[e-2],a=H.rotrSH(o,s,19)^H.rotrBH(o,s,61)^H.shrSH(o,s,6),c=H.rotrSL(o,s,19)^H.rotrBL(o,s,61)^H.shrSL(o,s,6),d=H.add4L(i,c,X[e-7],X[e-16]),l=H.add4H(d,r,a,z[e-7],z[e-16]);z[e]=0|l,X[e]=0|d}let{Ah:n,Al:r,Bh:i,Bl:o,Ch:s,Cl:a,Dh:c,Dl:d,Eh:l,El:u,Fh:p,Fl:h,Gh:f,Gl:m,Hh:y,Hl:g}=this;for(let e=0;e<80;e++){const t=H.rotrSH(l,u,14)^H.rotrSH(l,u,18)^H.rotrBH(l,u,41),w=H.rotrSL(l,u,14)^H.rotrSL(l,u,18)^H.rotrBL(l,u,41),N=l&p^~l&f,b=u&h^~u&m,v=H.add5L(g,w,b,V[e],X[e]),x=H.add5H(v,y,t,N,Y[e],z[e]),k=0|v,S=H.rotrSH(n,r,28)^H.rotrBH(n,r,34)^H.rotrBH(n,r,39),O=H.rotrSL(n,r,28)^H.rotrBL(n,r,34)^H.rotrBL(n,r,39),W=n&i^n&s^i&s,I=r&o^r&a^o&a;y=0|f,g=0|m,f=0|p,m=0|h,p=0|l,h=0|u,({h:l,l:u}=H.add(0|c,0|d,0|x,0|k)),c=0|s,d=0|a,s=0|i,a=0|o,i=0|n,o=0|r;const q=H.add3L(k,O,I);n=H.add3H(q,x,S,W),r=0|q}({h:n,l:r}=H.add(0|this.Ah,0|this.Al,0|n,0|r)),({h:i,l:o}=H.add(0|this.Bh,0|this.Bl,0|i,0|o)),({h:s,l:a}=H.add(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l:d}=H.add(0|this.Dh,0|this.Dl,0|c,0|d)),({h:l,l:u}=H.add(0|this.Eh,0|this.El,0|l,0|u)),({h:p,l:h}=H.add(0|this.Fh,0|this.Fl,0|p,0|h)),({h:f,l:m}=H.add(0|this.Gh,0|this.Gl,0|f,0|m)),({h:y,l:g}=H.add(0|this.Hh,0|this.Hl,0|y,0|g)),this.set(n,r,i,o,s,a,c,d,l,u,p,h,f,m,y,g)}roundClean(){z.fill(0),X.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Z=U((()=>new G));function ee(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`positive integer expected, not ${e}`)}function te(e,...t){if(!((n=e)instanceof Uint8Array||null!=n&&"object"==typeof n&&"Uint8Array"===n.constructor.name))throw new Error("Uint8Array expected");var n;if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function ne(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");ee(e.outputLen),ee(e.blockLen)}function re(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function ie(e,t){te(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const oe="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;const se=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),ae=(e,t)=>e<<32-t|e>>>t;new Uint8Array(new Uint32Array([287454020]).buffer)[0];function ce(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}(e)),te(e),e}class de{clone(){return this._cloneInto()}}const le={}.toString;function ue(e){const t=t=>e().update(ce(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}class pe extends de{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,ne(e);const n=ce(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,i=new Uint8Array(r);i.set(n.length>r?e.create().update(n).digest():n);for(let e=0;e<i.length;e++)i[e]^=54;this.iHash.update(i),this.oHash=e.create();for(let e=0;e<i.length;e++)i[e]^=106;this.oHash.update(i),i.fill(0)}update(e){return re(this),this.iHash.update(e),this}digestInto(e){re(this),te(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:r,destroyed:i,blockLen:o,outputLen:s}=this;return e.finished=r,e.destroyed=i,e.blockLen=o,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const he=(e,t,n)=>new pe(e,t).update(n).digest();function fe(e,t,n,r){ne(e);const i=function(e,t){if(void 0!==t&&"[object Object]"!==le.call(t))throw new Error("Options should be object or undefined");return Object.assign(e,t)}({dkLen:32,asyncTick:10},r),{c:o,dkLen:s,asyncTick:a}=i;if(ee(o),ee(s),ee(a),o<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const c=ce(t),d=ce(n),l=new Uint8Array(s),u=he.create(e,c),p=u._cloneInto().update(d);return{c:o,dkLen:s,asyncTick:a,DK:l,PRF:u,PRFSalt:p}}function me(e,t,n,r,i){return e.destroy(),t.destroy(),r&&r.destroy(),i.fill(0),n}he.create=(e,t)=>new pe(e,t);const ye=(e,t,n)=>e&t^e&n^t&n;class ge extends de{constructor(e,t,n,r){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=se(this.buffer)}update(e){re(this);const{view:t,buffer:n,blockLen:r}=this,i=(e=ce(e)).length;for(let o=0;o<i;){const s=Math.min(r-this.pos,i-o);if(s!==r)n.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===r&&(this.process(t,0),this.pos=0);else{const t=se(e);for(;r<=i-o;o+=r)this.process(t,o)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){re(this),ie(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>r-o&&(this.process(n,0),o=0);for(let e=o;e<r;e++)t[e]=0;!function(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);const i=BigInt(32),o=BigInt(4294967295),s=Number(n>>i&o),a=Number(n&o),c=r?4:0,d=r?0:4;e.setUint32(t+c,s,r),e.setUint32(t+d,a,r)}(n,r-8,BigInt(8*this.length),i),this.process(n,0);const s=se(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,d=this.get();if(c>d.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)s.setUint32(4*e,d[e],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:i,destroyed:o,pos:s}=this;return e.length=r,e.pos=s,e.finished=i,e.destroyed=o,r%t&&e.buffer.set(n),e}}const we=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ne=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),be=new Uint32Array(64);class ve extends ge{constructor(){super(64,32,8,!1),this.A=0|Ne[0],this.B=0|Ne[1],this.C=0|Ne[2],this.D=0|Ne[3],this.E=0|Ne[4],this.F=0|Ne[5],this.G=0|Ne[6],this.H=0|Ne[7]}get(){const{A:e,B:t,C:n,D:r,E:i,F:o,G:s,H:a}=this;return[e,t,n,r,i,o,s,a]}set(e,t,n,r,i,o,s,a){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(e,t){for(let n=0;n<16;n++,t+=4)be[n]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=be[e-15],n=be[e-2],r=ae(t,7)^ae(t,18)^t>>>3,i=ae(n,17)^ae(n,19)^n>>>10;be[e]=i+be[e-7]+r+be[e-16]|0}let{A:n,B:r,C:i,D:o,E:s,F:a,G:c,H:d}=this;for(let e=0;e<64;e++){const t=d+(ae(s,6)^ae(s,11)^ae(s,25))+((l=s)&a^~l&c)+we[e]+be[e]|0,u=(ae(n,2)^ae(n,13)^ae(n,22))+ye(n,r,i)|0;d=c,c=a,a=s,s=o+t|0,o=i,i=r,r=n,n=t+u|0}var l;n=n+this.A|0,r=r+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,d=d+this.H|0,this.set(n,r,i,o,s,a,c,d)}roundClean(){be.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const xe=ue((()=>new ve)),ke=BigInt(2**32-1),Se=BigInt(32);function Oe(e,t=!1){return t?{h:Number(e&ke),l:Number(e>>Se&ke)}:{h:0|Number(e>>Se&ke),l:0|Number(e&ke)}}const We={fromBig:Oe,split:function(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let i=0;i<e.length;i++){const{h:o,l:s}=Oe(e[i],t);[n[i],r[i]]=[o,s]}return[n,r]},toBig:(e,t)=>BigInt(e>>>0)<<Se|BigInt(t>>>0),shrSH:(e,t,n)=>e>>>n,shrSL:(e,t,n)=>e<<32-n|t>>>n,rotrSH:(e,t,n)=>e>>>n|t<<32-n,rotrSL:(e,t,n)=>e<<32-n|t>>>n,rotrBH:(e,t,n)=>e<<64-n|t>>>n-32,rotrBL:(e,t,n)=>e>>>n-32|t<<64-n,rotr32H:(e,t)=>t,rotr32L:(e,t)=>e,rotlSH:(e,t,n)=>e<<n|t>>>32-n,rotlSL:(e,t,n)=>t<<n|e>>>32-n,rotlBH:(e,t,n)=>t<<n-32|e>>>64-n,rotlBL:(e,t,n)=>e<<n-32|t>>>64-n,add:function(e,t,n,r){const i=(t>>>0)+(r>>>0);return{h:e+n+(i/2**32|0)|0,l:0|i}},add3L:(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),add3H:(e,t,n,r)=>t+n+r+(e/2**32|0)|0,add4L:(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),add4H:(e,t,n,r,i)=>t+n+r+i+(e/2**32|0)|0,add5H:(e,t,n,r,i,o)=>t+n+r+i+o+(e/2**32|0)|0,add5L:(e,t,n,r,i)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(i>>>0)},[Ie,qe]=(()=>We.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((e=>BigInt(e)))))(),Te=new Uint32Array(80),Ee=new Uint32Array(80);class Ce extends ge{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:r,Ch:i,Cl:o,Dh:s,Dl:a,Eh:c,El:d,Fh:l,Fl:u,Gh:p,Gl:h,Hh:f,Hl:m}=this;return[e,t,n,r,i,o,s,a,c,d,l,u,p,h,f,m]}set(e,t,n,r,i,o,s,a,c,d,l,u,p,h,f,m){this.Ah=0|e,this.Al=0|t,this.Bh=0|n,this.Bl=0|r,this.Ch=0|i,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|d,this.Fh=0|l,this.Fl=0|u,this.Gh=0|p,this.Gl=0|h,this.Hh=0|f,this.Hl=0|m}process(e,t){for(let n=0;n<16;n++,t+=4)Te[n]=e.getUint32(t),Ee[n]=e.getUint32(t+=4);for(let e=16;e<80;e++){const t=0|Te[e-15],n=0|Ee[e-15],r=We.rotrSH(t,n,1)^We.rotrSH(t,n,8)^We.shrSH(t,n,7),i=We.rotrSL(t,n,1)^We.rotrSL(t,n,8)^We.shrSL(t,n,7),o=0|Te[e-2],s=0|Ee[e-2],a=We.rotrSH(o,s,19)^We.rotrBH(o,s,61)^We.shrSH(o,s,6),c=We.rotrSL(o,s,19)^We.rotrBL(o,s,61)^We.shrSL(o,s,6),d=We.add4L(i,c,Ee[e-7],Ee[e-16]),l=We.add4H(d,r,a,Te[e-7],Te[e-16]);Te[e]=0|l,Ee[e]=0|d}let{Ah:n,Al:r,Bh:i,Bl:o,Ch:s,Cl:a,Dh:c,Dl:d,Eh:l,El:u,Fh:p,Fl:h,Gh:f,Gl:m,Hh:y,Hl:g}=this;for(let e=0;e<80;e++){const t=We.rotrSH(l,u,14)^We.rotrSH(l,u,18)^We.rotrBH(l,u,41),w=We.rotrSL(l,u,14)^We.rotrSL(l,u,18)^We.rotrBL(l,u,41),N=l&p^~l&f,b=u&h^~u&m,v=We.add5L(g,w,b,qe[e],Ee[e]),x=We.add5H(v,y,t,N,Ie[e],Te[e]),k=0|v,S=We.rotrSH(n,r,28)^We.rotrBH(n,r,34)^We.rotrBH(n,r,39),O=We.rotrSL(n,r,28)^We.rotrBL(n,r,34)^We.rotrBL(n,r,39),W=n&i^n&s^i&s,I=r&o^r&a^o&a;y=0|f,g=0|m,f=0|p,m=0|h,p=0|l,h=0|u,({h:l,l:u}=We.add(0|c,0|d,0|x,0|k)),c=0|s,d=0|a,s=0|i,a=0|o,i=0|n,o=0|r;const q=We.add3L(k,O,I);n=We.add3H(q,x,S,W),r=0|q}({h:n,l:r}=We.add(0|this.Ah,0|this.Al,0|n,0|r)),({h:i,l:o}=We.add(0|this.Bh,0|this.Bl,0|i,0|o)),({h:s,l:a}=We.add(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l:d}=We.add(0|this.Dh,0|this.Dl,0|c,0|d)),({h:l,l:u}=We.add(0|this.Eh,0|this.El,0|l,0|u)),({h:p,l:h}=We.add(0|this.Fh,0|this.Fl,0|p,0|h)),({h:f,l:m}=We.add(0|this.Gh,0|this.Gl,0|f,0|m)),({h:y,l:g}=We.add(0|this.Hh,0|this.Hl,0|y,0|g)),this.set(n,r,i,o,s,a,c,d,l,u,p,h,f,m,y,g)}roundClean(){Te.fill(0),Ee.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Le=ue((()=>new Ce));function Ae(e){if(!Number.isSafeInteger(e))throw new Error(`Wrong integer: ${e}`)}function De(e){return e instanceof Uint8Array||null!=e&&"object"==typeof e&&"Uint8Array"===e.constructor.name}function Be(...e){const t=e=>e,n=(e,t)=>n=>e(t(n));return{encode:e.map((e=>e.encode)).reduceRight(n,t),decode:e.map((e=>e.decode)).reduce(n,t)}}function Pe(e){return{encode:t=>{if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw new Error("alphabet.encode input should be an array of numbers");return t.map((t=>{if(Ae(t),t<0||t>=e.length)throw new Error(`Digit index outside alphabet: ${t} (alphabet: ${e.length})`);return e[t]}))},decode:t=>{if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("alphabet.decode input should be array of strings");return t.map((t=>{if("string"!=typeof t)throw new Error(`alphabet.decode: not string element=${t}`);const n=e.indexOf(t);if(-1===n)throw new Error(`Unknown letter: "${t}". Allowed: ${e}`);return n}))}}}function Me(e=""){if("string"!=typeof e)throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("join.encode input should be array of strings");for(let e of t)if("string"!=typeof e)throw new Error(`join.encode: non-string input=${e}`);return t.join(e)},decode:t=>{if("string"!=typeof t)throw new Error("join.decode input should be string");return t.split(e)}}}function Fe(e,t="="){if(Ae(e),"string"!=typeof t)throw new Error("padding chr should be string");return{encode(n){if(!Array.isArray(n)||n.length&&"string"!=typeof n[0])throw new Error("padding.encode input should be array of strings");for(let e of n)if("string"!=typeof e)throw new Error(`padding.encode: non-string input=${e}`);for(;n.length*e%8;)n.push(t);return n},decode(n){if(!Array.isArray(n)||n.length&&"string"!=typeof n[0])throw new Error("padding.encode input should be array of strings");for(let e of n)if("string"!=typeof e)throw new Error(`padding.decode: non-string input=${e}`);let r=n.length;if(r*e%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if(!((r-1)*e%8))throw new Error("Invalid padding: string has too much padding");return n.slice(0,r)}}}function Re(e){if("function"!=typeof e)throw new Error("normalize fn should be function");return{encode:e=>e,decode:t=>e(t)}}function Ue(e,t,n){if(t<2)throw new Error(`convertRadix: wrong from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: wrong to=${n}, base cannot be less than 2`);if(!Array.isArray(e))throw new Error("convertRadix: data should be array");if(!e.length)return[];let r=0;const i=[],o=Array.from(e);for(o.forEach((e=>{if(Ae(e),e<0||e>=t)throw new Error(`Wrong integer: ${e}`)}));;){let e=0,s=!0;for(let i=r;i<o.length;i++){const a=o[i],c=t*e+a;if(!Number.isSafeInteger(c)||t*e/t!==e||c-a!=t*e)throw new Error("convertRadix: carry overflow");e=c%n;const d=Math.floor(c/n);if(o[i]=d,!Number.isSafeInteger(d)||d*n+e!==c)throw new Error("convertRadix: carry overflow");s&&(d?s=!1:r=i)}if(i.push(e),s)break}for(let t=0;t<e.length-1&&0===e[t];t++)i.push(0);return i.reverse()}const je=(e,t)=>t?je(t,e%t):e,_e=(e,t)=>e+(t-je(e,t));function $e(e,t,n,r){if(!Array.isArray(e))throw new Error("convertRadix2: data should be array");if(t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(_e(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${_e(t,n)}`);let i=0,o=0;const s=2**n-1,a=[];for(const r of e){if(Ae(r),r>=2**t)throw new Error(`convertRadix2: invalid data word=${r} from=${t}`);if(i=i<<t|r,o+t>32)throw new Error(`convertRadix2: carry overflow pos=${o} from=${t}`);for(o+=t;o>=n;o-=n)a.push((i>>o-n&s)>>>0);i&=2**o-1}if(i=i<<n-o&s,!r&&o>=t)throw new Error("Excess padding");if(!r&&i)throw new Error(`Non-zero padding: ${i}`);return r&&o>0&&a.push(i>>>0),a}function Qe(e){return Ae(e),{encode:t=>{if(!De(t))throw new Error("radix.encode input should be Uint8Array");return Ue(Array.from(t),256,e)},decode:t=>{if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw new Error("radix.decode input should be array of numbers");return Uint8Array.from(Ue(t,e,256))}}}function Je(e,t=!1){if(Ae(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(_e(8,e)>32||_e(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!De(n))throw new Error("radix2.encode input should be Uint8Array");return $e(Array.from(n),8,e,!t)},decode:n=>{if(!Array.isArray(n)||n.length&&"number"!=typeof n[0])throw new Error("radix2.decode input should be array of numbers");return Uint8Array.from($e(n,e,8,t))}}}function Ke(e,t){if(Ae(e),"function"!=typeof t)throw new Error("checksum fn should be function");return{encode(n){if(!De(n))throw new Error("checksum.encode: input should be Uint8Array");const r=t(n).slice(0,e),i=new Uint8Array(n.length+e);return i.set(n),i.set(r,n.length),i},decode(n){if(!De(n))throw new Error("checksum.decode: input should be Uint8Array");const r=n.slice(0,-e),i=t(r).slice(0,e),o=n.slice(-e);for(let t=0;t<e;t++)if(i[t]!==o[t])throw new Error("Invalid checksum");return r}}}const He={alphabet:Pe,chain:Be,checksum:Ke,convertRadix:Ue,convertRadix2:$e,radix:Qe,radix2:Je,join:Me,padding:Fe},Ye=Be(Je(4),Pe("0123456789ABCDEF"),Me("")),Ve=Be(Je(5),Pe("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),Fe(5),Me("")),ze=(Je(5),Pe("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),Me(""),Je(5),Pe("0123456789ABCDEFGHIJKLMNOPQRSTUV"),Fe(5),Me(""),Je(5),Pe("0123456789ABCDEFGHIJKLMNOPQRSTUV"),Me(""),Je(5),Pe("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),Me(""),Re((e=>e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))),Be(Je(6),Pe("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Fe(6),Me(""))),Xe=(Je(6),Pe("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Me(""),Be(Je(6),Pe("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),Fe(6),Me(""))),Ge=(Je(6),Pe("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),Me(""),e=>Be(Qe(58),Pe(e),Me(""))),Ze=Ge("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),et=[0,2,3,5,6,7,9,10,11],tt={encode(e){let t="";for(let n=0;n<e.length;n+=8){const r=e.subarray(n,n+8);t+=Ze.encode(r).padStart(et[r.length],"1")}return t},decode(e){let t=[];for(let n=0;n<e.length;n+=11){const r=e.slice(n,n+11),i=et.indexOf(r.length),o=Ze.decode(r);for(let e=0;e<o.length-i;e++)if(0!==o[e])throw new Error("base58xmr: wrong padding");t=t.concat(Array.from(o.slice(o.length-i)))}return Uint8Array.from(t)}};Pe("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),Me("");const nt={encode:e=>(new TextDecoder).decode(e),decode:e=>(new TextEncoder).encode(e)},rt=(Je(4),Pe("0123456789abcdef"),Me(""),Re((e=>{if("string"!=typeof e||e.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()})),e=>"あいこくしん"===e[0]);function it(e){if("string"!=typeof e)throw new TypeError("Invalid mnemonic type: "+typeof e);return e.normalize("NFKD")}function ot(e){const t=it(e),n=t.split(" ");if(![12,15,18,21,24].includes(n.length))throw new Error("Invalid mnemonic");return{nfkd:t,words:n}}function st(e){te(e,16,20,24,28,32)}function at(e,t=128){if(ee(t),t%32!=0||t>256)throw new TypeError("Invalid entropy");return function(e,t){st(e);const n=dt(t).encode(e);return n.join(rt(t)?"　":" ")}(function(e=32){if(oe&&"function"==typeof oe.getRandomValues)return oe.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}(t/8),e)}const ct=e=>{const t=8-e.length/4;return new Uint8Array([xe(e)[0]>>t<<t])};function dt(e){if(!Array.isArray(e)||2048!==e.length||"string"!=typeof e[0])throw new Error("Wordlist: expected array of 2048 strings");return e.forEach((e=>{if("string"!=typeof e)throw new Error(`Wordlist: non-string element: ${e}`)})),He.chain(He.checksum(1,ct),He.radix2(11,!0),He.alphabet(e))}const lt=e=>it(`mnemonic${e}`);function ut(e,t=""){return function(e,t,n,r){const{c:i,dkLen:o,DK:s,PRF:a,PRFSalt:c}=fe(e,t,n,r);let d;const l=new Uint8Array(4),u=se(l),p=new Uint8Array(a.outputLen);for(let e=1,t=0;t<o;e++,t+=a.outputLen){const n=s.subarray(t,t+a.outputLen);u.setInt32(0,e,!1),(d=c._cloneInto(d)).update(l).digestInto(p),n.set(p.subarray(0,n.length));for(let e=1;e<i;e++){a._cloneInto(d).update(p).digestInto(p);for(let e=0;e<n.length;e++)n[e]^=p[e]}}return me(a,c,s,d,p)}(Le,ot(e).nfkd,lt(t),{c:2048,dkLen:64})}const pt="abandon\nability\nable\nabout\nabove\nabsent\nabsorb\nabstract\nabsurd\nabuse\naccess\naccident\naccount\naccuse\nachieve\nacid\nacoustic\nacquire\nacross\nact\naction\nactor\nactress\nactual\nadapt\nadd\naddict\naddress\nadjust\nadmit\nadult\nadvance\nadvice\naerobic\naffair\nafford\nafraid\nagain\nage\nagent\nagree\nahead\naim\nair\nairport\naisle\nalarm\nalbum\nalcohol\nalert\nalien\nall\nalley\nallow\nalmost\nalone\nalpha\nalready\nalso\nalter\nalways\namateur\namazing\namong\namount\namused\nanalyst\nanchor\nancient\nanger\nangle\nangry\nanimal\nankle\nannounce\nannual\nanother\nanswer\nantenna\nantique\nanxiety\nany\napart\napology\nappear\napple\napprove\napril\narch\narctic\narea\narena\nargue\narm\narmed\narmor\narmy\naround\narrange\narrest\narrive\narrow\nart\nartefact\nartist\nartwork\nask\naspect\nassault\nasset\nassist\nassume\nasthma\nathlete\natom\nattack\nattend\nattitude\nattract\nauction\naudit\naugust\naunt\nauthor\nauto\nautumn\naverage\navocado\navoid\nawake\naware\naway\nawesome\nawful\nawkward\naxis\nbaby\nbachelor\nbacon\nbadge\nbag\nbalance\nbalcony\nball\nbamboo\nbanana\nbanner\nbar\nbarely\nbargain\nbarrel\nbase\nbasic\nbasket\nbattle\nbeach\nbean\nbeauty\nbecause\nbecome\nbeef\nbefore\nbegin\nbehave\nbehind\nbelieve\nbelow\nbelt\nbench\nbenefit\nbest\nbetray\nbetter\nbetween\nbeyond\nbicycle\nbid\nbike\nbind\nbiology\nbird\nbirth\nbitter\nblack\nblade\nblame\nblanket\nblast\nbleak\nbless\nblind\nblood\nblossom\nblouse\nblue\nblur\nblush\nboard\nboat\nbody\nboil\nbomb\nbone\nbonus\nbook\nboost\nborder\nboring\nborrow\nboss\nbottom\nbounce\nbox\nboy\nbracket\nbrain\nbrand\nbrass\nbrave\nbread\nbreeze\nbrick\nbridge\nbrief\nbright\nbring\nbrisk\nbroccoli\nbroken\nbronze\nbroom\nbrother\nbrown\nbrush\nbubble\nbuddy\nbudget\nbuffalo\nbuild\nbulb\nbulk\nbullet\nbundle\nbunker\nburden\nburger\nburst\nbus\nbusiness\nbusy\nbutter\nbuyer\nbuzz\ncabbage\ncabin\ncable\ncactus\ncage\ncake\ncall\ncalm\ncamera\ncamp\ncan\ncanal\ncancel\ncandy\ncannon\ncanoe\ncanvas\ncanyon\ncapable\ncapital\ncaptain\ncar\ncarbon\ncard\ncargo\ncarpet\ncarry\ncart\ncase\ncash\ncasino\ncastle\ncasual\ncat\ncatalog\ncatch\ncategory\ncattle\ncaught\ncause\ncaution\ncave\nceiling\ncelery\ncement\ncensus\ncentury\ncereal\ncertain\nchair\nchalk\nchampion\nchange\nchaos\nchapter\ncharge\nchase\nchat\ncheap\ncheck\ncheese\nchef\ncherry\nchest\nchicken\nchief\nchild\nchimney\nchoice\nchoose\nchronic\nchuckle\nchunk\nchurn\ncigar\ncinnamon\ncircle\ncitizen\ncity\ncivil\nclaim\nclap\nclarify\nclaw\nclay\nclean\nclerk\nclever\nclick\nclient\ncliff\nclimb\nclinic\nclip\nclock\nclog\nclose\ncloth\ncloud\nclown\nclub\nclump\ncluster\nclutch\ncoach\ncoast\ncoconut\ncode\ncoffee\ncoil\ncoin\ncollect\ncolor\ncolumn\ncombine\ncome\ncomfort\ncomic\ncommon\ncompany\nconcert\nconduct\nconfirm\ncongress\nconnect\nconsider\ncontrol\nconvince\ncook\ncool\ncopper\ncopy\ncoral\ncore\ncorn\ncorrect\ncost\ncotton\ncouch\ncountry\ncouple\ncourse\ncousin\ncover\ncoyote\ncrack\ncradle\ncraft\ncram\ncrane\ncrash\ncrater\ncrawl\ncrazy\ncream\ncredit\ncreek\ncrew\ncricket\ncrime\ncrisp\ncritic\ncrop\ncross\ncrouch\ncrowd\ncrucial\ncruel\ncruise\ncrumble\ncrunch\ncrush\ncry\ncrystal\ncube\nculture\ncup\ncupboard\ncurious\ncurrent\ncurtain\ncurve\ncushion\ncustom\ncute\ncycle\ndad\ndamage\ndamp\ndance\ndanger\ndaring\ndash\ndaughter\ndawn\nday\ndeal\ndebate\ndebris\ndecade\ndecember\ndecide\ndecline\ndecorate\ndecrease\ndeer\ndefense\ndefine\ndefy\ndegree\ndelay\ndeliver\ndemand\ndemise\ndenial\ndentist\ndeny\ndepart\ndepend\ndeposit\ndepth\ndeputy\nderive\ndescribe\ndesert\ndesign\ndesk\ndespair\ndestroy\ndetail\ndetect\ndevelop\ndevice\ndevote\ndiagram\ndial\ndiamond\ndiary\ndice\ndiesel\ndiet\ndiffer\ndigital\ndignity\ndilemma\ndinner\ndinosaur\ndirect\ndirt\ndisagree\ndiscover\ndisease\ndish\ndismiss\ndisorder\ndisplay\ndistance\ndivert\ndivide\ndivorce\ndizzy\ndoctor\ndocument\ndog\ndoll\ndolphin\ndomain\ndonate\ndonkey\ndonor\ndoor\ndose\ndouble\ndove\ndraft\ndragon\ndrama\ndrastic\ndraw\ndream\ndress\ndrift\ndrill\ndrink\ndrip\ndrive\ndrop\ndrum\ndry\nduck\ndumb\ndune\nduring\ndust\ndutch\nduty\ndwarf\ndynamic\neager\neagle\nearly\nearn\nearth\neasily\neast\neasy\necho\necology\neconomy\nedge\nedit\neducate\neffort\negg\neight\neither\nelbow\nelder\nelectric\nelegant\nelement\nelephant\nelevator\nelite\nelse\nembark\nembody\nembrace\nemerge\nemotion\nemploy\nempower\nempty\nenable\nenact\nend\nendless\nendorse\nenemy\nenergy\nenforce\nengage\nengine\nenhance\nenjoy\nenlist\nenough\nenrich\nenroll\nensure\nenter\nentire\nentry\nenvelope\nepisode\nequal\nequip\nera\nerase\nerode\nerosion\nerror\nerupt\nescape\nessay\nessence\nestate\neternal\nethics\nevidence\nevil\nevoke\nevolve\nexact\nexample\nexcess\nexchange\nexcite\nexclude\nexcuse\nexecute\nexercise\nexhaust\nexhibit\nexile\nexist\nexit\nexotic\nexpand\nexpect\nexpire\nexplain\nexpose\nexpress\nextend\nextra\neye\neyebrow\nfabric\nface\nfaculty\nfade\nfaint\nfaith\nfall\nfalse\nfame\nfamily\nfamous\nfan\nfancy\nfantasy\nfarm\nfashion\nfat\nfatal\nfather\nfatigue\nfault\nfavorite\nfeature\nfebruary\nfederal\nfee\nfeed\nfeel\nfemale\nfence\nfestival\nfetch\nfever\nfew\nfiber\nfiction\nfield\nfigure\nfile\nfilm\nfilter\nfinal\nfind\nfine\nfinger\nfinish\nfire\nfirm\nfirst\nfiscal\nfish\nfit\nfitness\nfix\nflag\nflame\nflash\nflat\nflavor\nflee\nflight\nflip\nfloat\nflock\nfloor\nflower\nfluid\nflush\nfly\nfoam\nfocus\nfog\nfoil\nfold\nfollow\nfood\nfoot\nforce\nforest\nforget\nfork\nfortune\nforum\nforward\nfossil\nfoster\nfound\nfox\nfragile\nframe\nfrequent\nfresh\nfriend\nfringe\nfrog\nfront\nfrost\nfrown\nfrozen\nfruit\nfuel\nfun\nfunny\nfurnace\nfury\nfuture\ngadget\ngain\ngalaxy\ngallery\ngame\ngap\ngarage\ngarbage\ngarden\ngarlic\ngarment\ngas\ngasp\ngate\ngather\ngauge\ngaze\ngeneral\ngenius\ngenre\ngentle\ngenuine\ngesture\nghost\ngiant\ngift\ngiggle\nginger\ngiraffe\ngirl\ngive\nglad\nglance\nglare\nglass\nglide\nglimpse\nglobe\ngloom\nglory\nglove\nglow\nglue\ngoat\ngoddess\ngold\ngood\ngoose\ngorilla\ngospel\ngossip\ngovern\ngown\ngrab\ngrace\ngrain\ngrant\ngrape\ngrass\ngravity\ngreat\ngreen\ngrid\ngrief\ngrit\ngrocery\ngroup\ngrow\ngrunt\nguard\nguess\nguide\nguilt\nguitar\ngun\ngym\nhabit\nhair\nhalf\nhammer\nhamster\nhand\nhappy\nharbor\nhard\nharsh\nharvest\nhat\nhave\nhawk\nhazard\nhead\nhealth\nheart\nheavy\nhedgehog\nheight\nhello\nhelmet\nhelp\nhen\nhero\nhidden\nhigh\nhill\nhint\nhip\nhire\nhistory\nhobby\nhockey\nhold\nhole\nholiday\nhollow\nhome\nhoney\nhood\nhope\nhorn\nhorror\nhorse\nhospital\nhost\nhotel\nhour\nhover\nhub\nhuge\nhuman\nhumble\nhumor\nhundred\nhungry\nhunt\nhurdle\nhurry\nhurt\nhusband\nhybrid\nice\nicon\nidea\nidentify\nidle\nignore\nill\nillegal\nillness\nimage\nimitate\nimmense\nimmune\nimpact\nimpose\nimprove\nimpulse\ninch\ninclude\nincome\nincrease\nindex\nindicate\nindoor\nindustry\ninfant\ninflict\ninform\ninhale\ninherit\ninitial\ninject\ninjury\ninmate\ninner\ninnocent\ninput\ninquiry\ninsane\ninsect\ninside\ninspire\ninstall\nintact\ninterest\ninto\ninvest\ninvite\ninvolve\niron\nisland\nisolate\nissue\nitem\nivory\njacket\njaguar\njar\njazz\njealous\njeans\njelly\njewel\njob\njoin\njoke\njourney\njoy\njudge\njuice\njump\njungle\njunior\njunk\njust\nkangaroo\nkeen\nkeep\nketchup\nkey\nkick\nkid\nkidney\nkind\nkingdom\nkiss\nkit\nkitchen\nkite\nkitten\nkiwi\nknee\nknife\nknock\nknow\nlab\nlabel\nlabor\nladder\nlady\nlake\nlamp\nlanguage\nlaptop\nlarge\nlater\nlatin\nlaugh\nlaundry\nlava\nlaw\nlawn\nlawsuit\nlayer\nlazy\nleader\nleaf\nlearn\nleave\nlecture\nleft\nleg\nlegal\nlegend\nleisure\nlemon\nlend\nlength\nlens\nleopard\nlesson\nletter\nlevel\nliar\nliberty\nlibrary\nlicense\nlife\nlift\nlight\nlike\nlimb\nlimit\nlink\nlion\nliquid\nlist\nlittle\nlive\nlizard\nload\nloan\nlobster\nlocal\nlock\nlogic\nlonely\nlong\nloop\nlottery\nloud\nlounge\nlove\nloyal\nlucky\nluggage\nlumber\nlunar\nlunch\nluxury\nlyrics\nmachine\nmad\nmagic\nmagnet\nmaid\nmail\nmain\nmajor\nmake\nmammal\nman\nmanage\nmandate\nmango\nmansion\nmanual\nmaple\nmarble\nmarch\nmargin\nmarine\nmarket\nmarriage\nmask\nmass\nmaster\nmatch\nmaterial\nmath\nmatrix\nmatter\nmaximum\nmaze\nmeadow\nmean\nmeasure\nmeat\nmechanic\nmedal\nmedia\nmelody\nmelt\nmember\nmemory\nmention\nmenu\nmercy\nmerge\nmerit\nmerry\nmesh\nmessage\nmetal\nmethod\nmiddle\nmidnight\nmilk\nmillion\nmimic\nmind\nminimum\nminor\nminute\nmiracle\nmirror\nmisery\nmiss\nmistake\nmix\nmixed\nmixture\nmobile\nmodel\nmodify\nmom\nmoment\nmonitor\nmonkey\nmonster\nmonth\nmoon\nmoral\nmore\nmorning\nmosquito\nmother\nmotion\nmotor\nmountain\nmouse\nmove\nmovie\nmuch\nmuffin\nmule\nmultiply\nmuscle\nmuseum\nmushroom\nmusic\nmust\nmutual\nmyself\nmystery\nmyth\nnaive\nname\nnapkin\nnarrow\nnasty\nnation\nnature\nnear\nneck\nneed\nnegative\nneglect\nneither\nnephew\nnerve\nnest\nnet\nnetwork\nneutral\nnever\nnews\nnext\nnice\nnight\nnoble\nnoise\nnominee\nnoodle\nnormal\nnorth\nnose\nnotable\nnote\nnothing\nnotice\nnovel\nnow\nnuclear\nnumber\nnurse\nnut\noak\nobey\nobject\noblige\nobscure\nobserve\nobtain\nobvious\noccur\nocean\noctober\nodor\noff\noffer\noffice\noften\noil\nokay\nold\nolive\nolympic\nomit\nonce\none\nonion\nonline\nonly\nopen\nopera\nopinion\noppose\noption\norange\norbit\norchard\norder\nordinary\norgan\norient\noriginal\norphan\nostrich\nother\noutdoor\nouter\noutput\noutside\noval\noven\nover\nown\nowner\noxygen\noyster\nozone\npact\npaddle\npage\npair\npalace\npalm\npanda\npanel\npanic\npanther\npaper\nparade\nparent\npark\nparrot\nparty\npass\npatch\npath\npatient\npatrol\npattern\npause\npave\npayment\npeace\npeanut\npear\npeasant\npelican\npen\npenalty\npencil\npeople\npepper\nperfect\npermit\nperson\npet\nphone\nphoto\nphrase\nphysical\npiano\npicnic\npicture\npiece\npig\npigeon\npill\npilot\npink\npioneer\npipe\npistol\npitch\npizza\nplace\nplanet\nplastic\nplate\nplay\nplease\npledge\npluck\nplug\nplunge\npoem\npoet\npoint\npolar\npole\npolice\npond\npony\npool\npopular\nportion\nposition\npossible\npost\npotato\npottery\npoverty\npowder\npower\npractice\npraise\npredict\nprefer\nprepare\npresent\npretty\nprevent\nprice\npride\nprimary\nprint\npriority\nprison\nprivate\nprize\nproblem\nprocess\nproduce\nprofit\nprogram\nproject\npromote\nproof\nproperty\nprosper\nprotect\nproud\nprovide\npublic\npudding\npull\npulp\npulse\npumpkin\npunch\npupil\npuppy\npurchase\npurity\npurpose\npurse\npush\nput\npuzzle\npyramid\nquality\nquantum\nquarter\nquestion\nquick\nquit\nquiz\nquote\nrabbit\nraccoon\nrace\nrack\nradar\nradio\nrail\nrain\nraise\nrally\nramp\nranch\nrandom\nrange\nrapid\nrare\nrate\nrather\nraven\nraw\nrazor\nready\nreal\nreason\nrebel\nrebuild\nrecall\nreceive\nrecipe\nrecord\nrecycle\nreduce\nreflect\nreform\nrefuse\nregion\nregret\nregular\nreject\nrelax\nrelease\nrelief\nrely\nremain\nremember\nremind\nremove\nrender\nrenew\nrent\nreopen\nrepair\nrepeat\nreplace\nreport\nrequire\nrescue\nresemble\nresist\nresource\nresponse\nresult\nretire\nretreat\nreturn\nreunion\nreveal\nreview\nreward\nrhythm\nrib\nribbon\nrice\nrich\nride\nridge\nrifle\nright\nrigid\nring\nriot\nripple\nrisk\nritual\nrival\nriver\nroad\nroast\nrobot\nrobust\nrocket\nromance\nroof\nrookie\nroom\nrose\nrotate\nrough\nround\nroute\nroyal\nrubber\nrude\nrug\nrule\nrun\nrunway\nrural\nsad\nsaddle\nsadness\nsafe\nsail\nsalad\nsalmon\nsalon\nsalt\nsalute\nsame\nsample\nsand\nsatisfy\nsatoshi\nsauce\nsausage\nsave\nsay\nscale\nscan\nscare\nscatter\nscene\nscheme\nschool\nscience\nscissors\nscorpion\nscout\nscrap\nscreen\nscript\nscrub\nsea\nsearch\nseason\nseat\nsecond\nsecret\nsection\nsecurity\nseed\nseek\nsegment\nselect\nsell\nseminar\nsenior\nsense\nsentence\nseries\nservice\nsession\nsettle\nsetup\nseven\nshadow\nshaft\nshallow\nshare\nshed\nshell\nsheriff\nshield\nshift\nshine\nship\nshiver\nshock\nshoe\nshoot\nshop\nshort\nshoulder\nshove\nshrimp\nshrug\nshuffle\nshy\nsibling\nsick\nside\nsiege\nsight\nsign\nsilent\nsilk\nsilly\nsilver\nsimilar\nsimple\nsince\nsing\nsiren\nsister\nsituate\nsix\nsize\nskate\nsketch\nski\nskill\nskin\nskirt\nskull\nslab\nslam\nsleep\nslender\nslice\nslide\nslight\nslim\nslogan\nslot\nslow\nslush\nsmall\nsmart\nsmile\nsmoke\nsmooth\nsnack\nsnake\nsnap\nsniff\nsnow\nsoap\nsoccer\nsocial\nsock\nsoda\nsoft\nsolar\nsoldier\nsolid\nsolution\nsolve\nsomeone\nsong\nsoon\nsorry\nsort\nsoul\nsound\nsoup\nsource\nsouth\nspace\nspare\nspatial\nspawn\nspeak\nspecial\nspeed\nspell\nspend\nsphere\nspice\nspider\nspike\nspin\nspirit\nsplit\nspoil\nsponsor\nspoon\nsport\nspot\nspray\nspread\nspring\nspy\nsquare\nsqueeze\nsquirrel\nstable\nstadium\nstaff\nstage\nstairs\nstamp\nstand\nstart\nstate\nstay\nsteak\nsteel\nstem\nstep\nstereo\nstick\nstill\nsting\nstock\nstomach\nstone\nstool\nstory\nstove\nstrategy\nstreet\nstrike\nstrong\nstruggle\nstudent\nstuff\nstumble\nstyle\nsubject\nsubmit\nsubway\nsuccess\nsuch\nsudden\nsuffer\nsugar\nsuggest\nsuit\nsummer\nsun\nsunny\nsunset\nsuper\nsupply\nsupreme\nsure\nsurface\nsurge\nsurprise\nsurround\nsurvey\nsuspect\nsustain\nswallow\nswamp\nswap\nswarm\nswear\nsweet\nswift\nswim\nswing\nswitch\nsword\nsymbol\nsymptom\nsyrup\nsystem\ntable\ntackle\ntag\ntail\ntalent\ntalk\ntank\ntape\ntarget\ntask\ntaste\ntattoo\ntaxi\nteach\nteam\ntell\nten\ntenant\ntennis\ntent\nterm\ntest\ntext\nthank\nthat\ntheme\nthen\ntheory\nthere\nthey\nthing\nthis\nthought\nthree\nthrive\nthrow\nthumb\nthunder\nticket\ntide\ntiger\ntilt\ntimber\ntime\ntiny\ntip\ntired\ntissue\ntitle\ntoast\ntobacco\ntoday\ntoddler\ntoe\ntogether\ntoilet\ntoken\ntomato\ntomorrow\ntone\ntongue\ntonight\ntool\ntooth\ntop\ntopic\ntopple\ntorch\ntornado\ntortoise\ntoss\ntotal\ntourist\ntoward\ntower\ntown\ntoy\ntrack\ntrade\ntraffic\ntragic\ntrain\ntransfer\ntrap\ntrash\ntravel\ntray\ntreat\ntree\ntrend\ntrial\ntribe\ntrick\ntrigger\ntrim\ntrip\ntrophy\ntrouble\ntruck\ntrue\ntruly\ntrumpet\ntrust\ntruth\ntry\ntube\ntuition\ntumble\ntuna\ntunnel\nturkey\nturn\nturtle\ntwelve\ntwenty\ntwice\ntwin\ntwist\ntwo\ntype\ntypical\nugly\numbrella\nunable\nunaware\nuncle\nuncover\nunder\nundo\nunfair\nunfold\nunhappy\nuniform\nunique\nunit\nuniverse\nunknown\nunlock\nuntil\nunusual\nunveil\nupdate\nupgrade\nuphold\nupon\nupper\nupset\nurban\nurge\nusage\nuse\nused\nuseful\nuseless\nusual\nutility\nvacant\nvacuum\nvague\nvalid\nvalley\nvalve\nvan\nvanish\nvapor\nvarious\nvast\nvault\nvehicle\nvelvet\nvendor\nventure\nvenue\nverb\nverify\nversion\nvery\nvessel\nveteran\nviable\nvibrant\nvicious\nvictory\nvideo\nview\nvillage\nvintage\nviolin\nvirtual\nvirus\nvisa\nvisit\nvisual\nvital\nvivid\nvocal\nvoice\nvoid\nvolcano\nvolume\nvote\nvoyage\nwage\nwagon\nwait\nwalk\nwall\nwalnut\nwant\nwarfare\nwarm\nwarrior\nwash\nwasp\nwaste\nwater\nwave\nway\nwealth\nweapon\nwear\nweasel\nweather\nweb\nwedding\nweekend\nweird\nwelcome\nwest\nwet\nwhale\nwhat\nwheat\nwheel\nwhen\nwhere\nwhip\nwhisper\nwide\nwidth\nwife\nwild\nwill\nwin\nwindow\nwine\nwing\nwink\nwinner\nwinter\nwire\nwisdom\nwise\nwish\nwitness\nwolf\nwoman\nwonder\nwood\nwool\nword\nwork\nworld\nworry\nworth\nwrap\nwreck\nwrestle\nwrist\nwrite\nwrong\nyard\nyear\nyellow\nyou\nyoung\nyouth\nzebra\nzero\nzone\nzoo".split("\n");class ht extends(p.vw("NanoIdGenerator")()){}const ft=a.QfV.pipe(a.T16(/^[\w-]{16}$/),a.wkx("NodeId")),mt=(e,t)=>f.sync((()=>{let n=_(Z,"Symmetric key seed",e);for(let e=0;e<t.length;e++){const r=(new TextEncoder).encode(t[e]),i=new Uint8Array(r.byteLength+1);i[0]=0,i.set(r,1),n=_(Z,n.slice(0,32),i)}return n.slice(32,64)}));class yt extends(p.vw("SecretBox")()){}yt.Live=w.Py(yt,yt.of({seal:(e,t)=>f.sync((()=>{const n=function(e=32){if(P.E&&"function"==typeof P.E.getRandomValues)return P.E.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}(24),r=(0,E.EY)(e,n).seal(t);return(0,c.Id)(n,r)})),open:(e,t)=>f.sync((()=>{const n=t.subarray(0,24),r=t.subarray(24);return(0,E.EY)(e,n).open(r)}))}));const gt=860934419999,wt=258280326e4,Nt=a.wNn.pipe(a.MM$(gt),a.XeB(wt),a.wkx("Millis")),bt=s.k9(Nt)(gt+1),vt=a.wNn.pipe(a.TqQ(0,65535),a.wkx("Counter")),xt=s.k9(vt)(0),kt=e=>[new Date(e.millis).toISOString(),e.counter.toString(16).toUpperCase().padStart(4,"0"),e.node].join("-"),St=e=>{const t=e.split("-");return{millis:Date.parse(t.slice(0,3).join("-")).valueOf(),counter:parseInt(t[3],16),node:t[4]}},Ot=s.k9(ft)("0000000000000000"),Wt=(e=bt)=>({millis:e,counter:xt,node:Ot}),It=ht.pipe(f.flatMap((({nodeId:e})=>e)),f.map((e=>({millis:bt,counter:xt,node:e}))));class qt extends(p.vw("Time")()){}qt.Live=w.Py(qt,{now:f.suspend((()=>a.D4M(Nt)(Date.now()))).pipe(f.catchTag("ParseError",(()=>f.fail({_tag:"TimestampTimeOutOfRangeError"}))))});const Tt=e=>f.gen((function*(){const t=yield*qt,n=yield*k,r=yield*t.now,i=Math.max(r,...e);return i-r>n.maxDrift&&(yield*f.fail({_tag:"TimestampDriftError",now:r,next:i})),i})),Et=e=>(0,m.Fs)(q.GV(e),a.EGw(vt),I.qE((()=>({_tag:"TimestampCounterOverflowError"})))),Ct=s.k9(vt)(0),Lt=Object.create(null),At=(e,t)=>(e||0)^t,Dt=(e,t,n)=>{if(0===t.length)return e;const r=t[0],i=e[r]||{};return{...e,[r]:{...i,...Dt(i,t.slice(1),n),hash:At(i.hash,n)}}},Bt=(e,t)=>{const n=(r=t.millis,Math.floor(r/1e3/60).toString(3).split(""));var r;const i=((e,t=0)=>{let n,r,i,o;const s=3&e.length,a=e.length-s;n=t;const c=3432918353,d=461845907;for(o=0;o<a;)i=255&e.charCodeAt(o)|(255&e.charCodeAt(++o))<<8|(255&e.charCodeAt(++o))<<16|(255&e.charCodeAt(++o))<<24,++o,i=(65535&i)*c+(((i>>>16)*c&65535)<<16)&4294967295,i=i<<15|i>>>17,i=(65535&i)*d+(((i>>>16)*d&65535)<<16)&4294967295,n^=i,n=n<<13|n>>>19,r=5*(65535&n)+((5*(n>>>16)&65535)<<16)&4294967295,n=27492+(65535&r)+((58964+(r>>>16)&65535)<<16);switch(i=0,s){case 3:i^=(255&e.charCodeAt(o+2))<<16;case 2:i^=(255&e.charCodeAt(o+1))<<8;case 1:i^=255&e.charCodeAt(o),i=(65535&i)*c+(((i>>>16)*c&65535)<<16)&4294967295,i=i<<15|i>>>17,i=(65535&i)*d+(((i>>>16)*d&65535)<<16)&4294967295,n^=i}return n^=e.length,n^=n>>>16,n=2246822507*(65535&n)+((2246822507*(n>>>16)&65535)<<16)&4294967295,n^=n>>>13,n=3266489909*(65535&n)+((3266489909*(n>>>16)&65535)<<16)&4294967295,n^=n>>>16,n>>>0})(kt(t));return Dt({...e,hash:At(e.hash,i)},n,i)},Pt=["0","1","2"],Mt=e=>Pt.filter((t=>t in e)),Ft=e=>JSON.stringify(e),Rt=p.Io("Owner"),Ut=e=>f.gen((function*(t){null==e&&(e=at(pt,128));const n=(e=>ut(e))(e),r=yield*f.map(mt(n,["Evolu","Owner Id"]),(e=>{let t="";for(let n=0;n<21;n++)t+=jt[63&e[n]];return t})),i=yield*mt(n,["Evolu","Encryption Key"]);return{mnemonic:e,id:r,encryptionKey:i}})),jt="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";var _t=n(868075);const $t=p.Io("Sync"),Qt={_tag:"SyncStateInitial"};class Jt extends(p.vw("SyncFactory")()){}f.gen((function*(){const e=p.Ie().pipe(p.WQ(yt,yield*yt)),t=yield*h.L8();return $t.of({init:n=>f.logDebug(["Sync init",{owner:n}]).pipe(f.tap(h.Py(t,e.pipe(p.WQ(Rt,n))))),sync:({merkleTree:e,timestamp:n,messages:s})=>f.gen((function*(){yield*f.logDebug(["Sync request",{merkleTree:e,timestamp:n,messages:s}]);const t=yield*yt,a=yield*Rt,c=yield*k;return yield*f.forEach(s||[],(({timestamp:e,...n})=>f.map(t.seal(a.encryptionKey,Kt(n)),(t=>({timestamp:e,content:t}))))).pipe(f.map((t=>_t.Vr.toBinary({messages:t,userId:a.id,nodeId:n.node,merkleTree:Ft(e)},Vt))),f.flatMap((e=>r.bE(c.syncUrl).pipe(r.mu(e,"application/x-protobuf"),i.vd,o.sv))),f.map((e=>_t.fZ.fromBinary(new Uint8Array(e),zt))),f.flatMap((e=>f.forEach(e.messages,(e=>f.map(t.open(a.encryptionKey,e.content),(t=>[t,e.timestamp])))).pipe(f.map(u.x1((([e,t])=>y.Tj(Xt(e),(e=>({...e,timestamp:t})))))),f.map((t=>{return{messages:t,merkleTree:(n=e.merkleTree,JSON.parse(n))};var n})),f.tap((e=>f.logDebug(["Sync response",e])))))),f.catchTag("RequestError",(()=>f.fail({_tag:"SyncStateIsNotSynced",error:{_tag:"NetworkError"}}))),f.catchTag("ResponseError",(({response:{status:e}})=>402===e?f.fail({_tag:"SyncStateIsNotSynced",error:{_tag:"PaymentRequiredError"}}):f.fail({_tag:"SyncStateIsNotSynced",error:{_tag:"ServerError",status:e}}))))})).pipe((e=>f.flatMap(h.Tx(t),(t=>f.provide(e,t)))))})}));const Kt=({value:e,...t})=>(0,c.Id)(Ht,_t.PV.toBinary({value:Yt(e),...t},Vt)),Ht=new Uint8Array([0,1]),Yt=e=>{switch(typeof e){case"string":return{oneofKind:"stringValue",stringValue:e};case"number":return{oneofKind:"numberValue",numberValue:s.Kc(a.jJo)(e)}}return null==e?{oneofKind:void 0}:g.mg(e)?{oneofKind:"bytesValue",bytesValue:e}:{oneofKind:"jsonValue",jsonValue:JSON.stringify(e)}},Vt={writerFactory:()=>new d.f({encode:e=>(new TextEncoder).encode(e)})},zt={readerFactory:e=>new l.V(e,{decode:e=>(new TextDecoder).decode(e)})},Xt=e=>{if(!Gt(e,Ht))return y.dv();const{value:t,...n}=_t.PV.fromBinary(e.slice(Ht.length),zt);return y.zN({value:Zt(t),...n})},Gt=(e,t)=>{if(t.length>e.length)return!1;for(let n=0;n<t.length;n++)if(e[n]!==t[n])return!1;return!0},Zt=e=>{switch(e.oneofKind){case"numberValue":return s.k9(a.jJo)(e.numberValue);case"stringValue":return e.stringValue;case"bytesValue":return e.bytesValue;case"jsonValue":return JSON.parse(e.jsonValue);case void 0:return null;default:return(0,m.GQ)(e)}};var en=n(608111),tn=n(119153);tn.ii,tn.MG,en.QW,en.oV,en.un,en.vA,en.IU,en.U9,en.Ts,en.Yz,en.y_,en.BU,en.z3,en.Os,en.pq;const nn=en.Rm;en.tp,en.kB,en.al,en.uP,en.R8,en.I1,en.CE;var rn=n(836783),on=n(332665),sn=n(338265),an=n(360643),cn=n(617437);sn.KX;const dn=sn.PJ,ln=an.Jt,un=(an.C2,an.Ru,cn.cH),pn=(an.$N,cn.Y3,cn.JP,cn.Gt,an.ni,cn.sY,an.hZ,an._c,an.yo,cn.BQ,an.lF,cn.Wz,an.gH,cn.pu,an.VH,sn.oD,sn.Do,(e,t)=>e.reduce(((e,t)=>{switch(t.op){case"replaceAll":return t.value;case"replaceAt":return u.HC(e,t.index,t.value)}}),t)),hn=(e,t)=>{if(void 0===e)return[{op:"replaceAll",value:t}];if(e.length!==t.length)return[{op:"replaceAll",value:t}];const n=e.length,r=[];for(let i=0;i<n;i++){const n=e[i],o=t[i];for(const e in n)if(!fn(n[e],o[e])){r.push({op:"replaceAt",value:o,index:i});break}}return n>0&&r.length===n?[{op:"replaceAll",value:t}]:r},fn=(e,t)=>{if(e===t)return!0;if(typeof e!=typeof t)return!1;if("object"==typeof e&&null!==e&&null!==t){const n=g.mg(e),r=g.mg(t);if(n&&r){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}const i=u.cy(e),o=u.cy(t);if(i&&o){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!fn(e[n],t[n]))return!1;return!0}if(!(n||r||i||o)){const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const r of n)if(!fn(e[r],t[r]))return!1;return!0}}return!1},mn=e=>({_tag:"UnexpectedError",error:e}),yn=e=>e instanceof Error?{message:e.message,name:e.name,stack:e.stack}:e;var gn=n(217076);const wn=p.Io("Sqlite");class Nn extends(p.vw("SqliteFactory")()){}Nn.Common=w.QZ(Nn,f.map(Nn,(e=>({createSqlite:f.logTrace("SqliteFactory createSqlite").pipe(f.zipRight(e.createSqlite),f.map((e=>({...e,exec:t=>e.exec(t).pipe(f.tap((e=>{vn(e.rows)})),f.tap((e=>["begin","rollback","commit"].includes(t.sql)?f.logDebug(`SQLiteCommon ${t.sql} transaction`):f.logDebug(["SQLiteCommon exec",t,e])))),transaction:t=>n=>"shared"===t?e.transaction(t)(n):f.flatMap(wn,(e=>f.acquireUseRelease(e.exec({sql:"begin"}),(()=>n),((t,n)=>gn.N6(n)?e.exec({sql:"rollback"}):e.exec({sql:"commit"}))))).pipe(e.transaction(t))}))))}))));const bn=e=>null!==e&&"object"==typeof e&&!g.mg(e),vn=e=>{xn(e)},xn=e=>{for(let t=0;t<e.length;++t)e[t]=kn(e[t]);return e},kn=e=>g.Kg(e)?Sn(e):Array.isArray(e)?xn(e):"object"!=typeof e||null===e||g.mg(e)?e:Wn(e),Sn=e=>{if(On(e))try{return kn(JSON.parse(e))}catch(e){}return e},On=e=>null!=e.match(/^[[{]/),Wn=e=>{for(const t in e)e[t]=kn(e[t]);return e},In=new RegExp(`\\b(${["alter","create","delete","drop","insert","replace","update"].join("|")})\\b`),qn=(a.QfV.pipe(a.T16(/^[\w-]{21}$/),a.wkx("Id")),a.QfV.pipe(a.pbD((e=>!isNaN(Date.parse(e)))),a.wkx("SqliteDate"))),Tn=a.wNn.pipe(a.Whr(),a.pbD((e=>0===e||1===e)),a.wkx("SqliteBoolean"));function En(e){return"boolean"==typeof e?!0===e?1:0:"number"==typeof e?1===e:e instanceof Date?e.toISOString():new Date(e)}a._kM({createdAt:qn,updatedAt:qn,isDeleted:Tn}),a._kM;const Cn=a.QfV.pipe(a.pbD((e=>{if(!On(e))return!0;try{JSON.parse(e)}catch(e){return!0}return!1}),{message:()=>"a string that is not stringified JSON"}),a.wkx("String")),Ln=(Cn.pipe(a.Ru6(1e3),a.wkx("String1000")),Cn.pipe(a.BpQ(1),a.Ru6(1e3),a.wkx("NonEmptyString1000")),a.wNn.pipe(a.Whr(),a.yjt(),a.wkx("PositiveInt")),p.Io("FlushSync"));class An extends(p.vw("AppState")()){}class Dn extends(p.vw("SyncLock")()){}class Bn{constructor(){this._tag="SyncLockAlreadySyncingError"}}const Pn={sql:'select "id", "mnemonic", "encryptionKey" from "evolu_owner"'},Mn={sql:'create table "evolu_message" ("timestamp" blob primary key, "table" blob, "row" blob, "column" blob, "value" blob)'},Fn={sql:'create index "index_evolu_message" on "evolu_message" ("table", "row", "column", "timestamp" desc)'},Rn={sql:'create table "evolu_owner" ("id" blob, "mnemonic" blob, "encryptionKey" blob, "timestamp" blob, "merkleTree" blob)'},Un={sql:'insert into "evolu_owner" ("id", "mnemonic", "encryptionKey", "timestamp", "merkleTree") values (?, ?, ?, ?, ?)'},jn={sql:'select "timestamp", "merkleTree" from "evolu_owner"'},_n={sql:'select "timestamp" from "evolu_message" where "table" = ? and "row" = ? and "column" = ? order by "timestamp" desc limit ?'},$n={sql:'insert into "evolu_message" ("timestamp", "table", "row", "column", "value") values (?, ?, ?, ?, ?) on conflict do nothing'},Qn={sql:'update "evolu_owner" set "merkleTree" = ?, "timestamp" = ?'},Jn={sql:'select * from "evolu_message" where "timestamp" >= ? order by "timestamp"'};a._kM({name:a.QfV,sql:a.QfV});class Kn extends(p.vw("DbFactory")()){}const Hn=f.gen((function*(){const{createSqlite:e}=yield*Nn,{createSync:t}=yield*Jt,n=p.Ie().pipe(p.WQ(ht,yield*ht),p.WQ(qt,yield*qt),p.WQ(Dn,yield*Dn)),r=yield*h.L8(),i=e=>t=>f.flatMap(h.Tx(r),(n=>f.flatMap(wn,(n=>n.transaction(e.transaction)(t))).pipe(f.provide(n)))),o=yield*dn(new Map),s={init:(i,o,s,a,c,d)=>f.gen((function*(){yield*f.logDebug(["Db init",{schema:i}]);const l=yield*e,u=p.WQ(n,wn,l),m=yield*Xn.pipe(f.tap(Gn(i)),f.flatMap((e=>e.tables.map((e=>e.name)).includes("evolu_owner")?er:tr(d).pipe(f.tap(nr(o))))),l.transaction("exclusive"),f.provide(u)),y=yield*t.pipe(f.provide(n));return yield*y.init(m),h.dz(r,f.succeed(u.pipe(p.WQ(Rt,m),p.WQ($t,y),p.WQ(Yn,{onError:s,onSyncStateChange:a,onReceive:c})))),m})),loadQueries:e=>f.logDebug(["Db loadQueries",{queries:e}]).pipe(f.zipRight(Vn(e,o)),i({transaction:"shared"})),mutate:(e,t)=>f.gen((function*(){yield*f.logDebug(["Db mutate",{mutations:e,queriesToRefresh:t}]);const n=yield*qt,r=yield*wn,[i,s]=u.jB(e,(e=>e.table.startsWith("_")));for(const e of s){if(ir(e).some((({column:e,value:t})=>"isDeleted"===e&&1===t)))yield*r.exec({sql:`delete from "${e.table}" where "id" = ?;`,parameters:[e.id]});else{const t=ir(e);for(const e of t){const r=yield*n.now;yield*sr(e,t,r)}}}return i.length>0&&(yield*f.tap(nr(i),ur)),yield*Vn(t,o)})).pipe(i({transaction:"exclusive"})),resetOwner:()=>f.logTrace("Db resetOwner").pipe(f.tap(lr),i({transaction:"last"})),restoreOwner:(e,t)=>f.logTrace("Db restoreOwner").pipe(f.tap(lr),f.tap(f.flatMap(Xn,Gn(e))),f.tap(tr(t)),i({transaction:"last"})),ensureSchema:e=>Xn.pipe(f.flatMap(Gn(e)),i({transaction:"exclusive"})),sync:e=>f.logDebug(["Db sync",{queriesToRefresh:e}]).pipe(f.zipRight(ur()),f.zipRight(Vn(e,o)),i({transaction:"shared"})),exportDatabase:()=>f.logTrace("Db exportDatabase").pipe(f.zipRight(wn),f.flatMap((e=>e.export())),i({transaction:"exclusive"}))};return s})),Yn=p.Io("Callbacks"),Vn=(e,t)=>f.gen((function*(){const n=yield*wn,r=yield*un(t,(t=>f.map(f.forEach(e,(e=>{const t=fr(e);return n.exec(t).pipe(f.tap(zn(t)),f.map((({rows:t})=>[e,t])))})),(e=>new Map([...t,...e]))))),i=yield*ln(t);return e.map((e=>({query:e,patches:hn(r.get(e),i.get(e)||[])})))})),zn=e=>e.options?.logExplainQueryPlan?wn.pipe(f.flatMap((t=>t.exec({...e,sql:`EXPLAIN QUERY PLAN ${e.sql}`}))),f.tap(nn("ExplainQueryPlan",e)),f.tap((({rows:e})=>nn((e=>e.map((t=>{let n=t.parent,r=0;for(;;){const t=e.find((e=>e.id===n));if(!t)break;n=t.parent,r++}return`${"  ".repeat(r)}${t.detail}`})).join("\n"))(e)))),f.map(m.Yi)):f.void,Xn=f.gen((function*(e){yield*f.logTrace("Db getSchema");const t=yield*wn;return{tables:yield*f.map(t.exec({sql:"\nselect\n  sqlite_master.name as tableName,\n  table_info.name as columnName\nfrom\n  sqlite_master\n  join pragma_table_info(sqlite_master.name) as table_info\n    ".trim()}),(({rows:e})=>{const t=new Map;return e.forEach((e=>{const{tableName:n,columnName:r}=e;t.has(n)||t.set(n,[]),t.get(n)?.push(r)})),globalThis.Array.from(t,(([e,t])=>({name:e,columns:t})))})),indexes:yield*f.map(t.exec({sql:"\nselect\n  name, sql\nfrom\n  sqlite_master\nwhere\n  type='index' and\n  name not like 'sqlite_%' and\n  name not like 'index_evolu_%'\n".trim()}),(e=>u.Tj(e.rows,(e=>({name:e.name,sql:e.sql.replace("CREATE INDEX","create index")})))))}})),Gn=e=>t=>f.gen((function*(){yield*f.logTrace("Db ensureSchema");const n=[];if(e.tables.forEach((e=>{const r=t.tables.find((t=>t.name===e.name));r?u.Mo(T.rs)(e.columns,r.columns).forEach((t=>{n.push(`alter table "${e.name}" add column "${t}" blob;`)})):n.push(`\n  create table ${e.name} (\n    "id" text primary key,\n    ${e.columns.filter((e=>"id"!==e)).map((e=>`"${e}" blob`)).join(", ")}\n  );`.trim())})),u.Mo(Zn)(t.indexes,u.kP(Zn)(t.indexes,e.indexes)).forEach((e=>{n.push(`drop index "${e.name}";`)})),u.Mo(Zn)(e.indexes,t.indexes).forEach((e=>{n.push(`${e.sql};`)})),n.length>0){const e=yield*wn;yield*e.exec({sql:n.join("\n")})}})),Zn=(e,t)=>e.name===t.name&&e.sql===t.sql,er=f.logTrace("Db readOwner").pipe(f.zipRight(wn),f.flatMap((e=>e.exec(Pn))),f.map((({rows:[e]})=>({id:e.id,mnemonic:e.mnemonic,encryptionKey:e.encryptionKey})))),tr=e=>f.logTrace("Db createOwner").pipe(f.zipRight(f.all([Ut(e),wn,It])),f.tap((([e,t,n])=>f.all([t.exec(Mn),t.exec(Fn),t.exec(Rn),t.exec({...Un,parameters:[e.id,e.mnemonic,e.encryptionKey,kt(n),Ft(Lt)]})]))),f.map((([e])=>e))),nr=e=>f.gen((function*(t){const{timestamp:n,merkleTree:r}=yield*rr,[i,o]=yield*f.mapAccum(e.flatMap(ir),n,((e,t)=>f.map((e=>f.gen((function*(){const t=yield*Tt([e.millis]),n=t===e.millis?yield*Et(e.counter):Ct;return{...e,millis:t,counter:n}})))(e),(e=>[e,{...t,timestamp:kt(e)}])))),s=yield*or(r,o);return yield*dr(i,s),o})),rr=wn.pipe(f.flatMap((e=>e.exec(jn))),f.map((({rows:[{timestamp:e,merkleTree:t}]})=>({timestamp:St(e),merkleTree:t})))),ir=e=>(0,m.Fs)(Object.entries(e.values),u.x1((([t,n])=>void 0===n||e.isInsert&&null==n?y.dv():y.zN([t,n]))),u.Tj((([t,n])=>({table:e.table,row:e.id,column:t,value:"boolean"==typeof n||n instanceof Date?En(n):n})))),or=(e,t)=>f.gen((function*(){const n=yield*wn;for(const r of t){const i=St(r.timestamp),o=yield*f.map(n.exec({..._n,parameters:[r.table,r.row,r.column,1]}),(({rows:e})=>e.length>0?e[0].timestamp:null));if((null==o||o<r.timestamp)&&(yield*sr(r,t,i.millis)),null==o||o!==r.timestamp){const{changes:t}=yield*n.exec({...$n,parameters:[r.timestamp,r.table,r.row,r.column,r.value]});1===t&&(e=Bt(e,i))}}return e})),sr=(e,t,n)=>wn.pipe(f.map((t=>{const r=En(new Date(n));return t.exec({sql:`\n    insert into\n      "${e.table}" ("id", "${e.column}", "createdAt", "updatedAt")\n    values\n      (?, ?, ?, ?)\n    on conflict do update set\n      "${e.column}" = ?,\n      "updatedAt" = ?\n        `.trim(),parameters:[e.row,e.value,r,r,e.value,r]})})),f.flatMap((e=>f.catchSomeDefect(e,(n=>s.is(ar)(n)?y.zN(cr(t).pipe(f.zipRight(e))):y.dv()))))),ar=a._kM({message:a.gPz(a.QfV.pipe(a.mKk("no such table")),a.QfV.pipe(a.mKk("no such column")),a.QfV.pipe(a.mKk("has no column")))}),cr=e=>f.gen((function*(){const t=new Map;e.forEach((e=>{const n=t.get(e.table);null!=n?n.columns.includes(e.column)||t.set(e.table,{name:e.table,columns:n.columns.concat(e.column)}):t.set(e.table,{name:e.table,columns:[e.column,"createdAt","updatedAt"]})}));const n=u.Ts(t.values());yield*f.flatMap(Xn,Gn({tables:n,indexes:[]}))})),dr=(e,t)=>f.flatMap(wn,(n=>n.exec({...Qn,parameters:[Ft(t),kt(e)]}))),lr=f.gen((function*(){yield*f.logTrace("Db dropAllTables");const e=yield*wn,t=yield*Xn;yield*f.forEach(t.tables,(t=>e.exec({sql:`drop table "${t.name}"`})))})),ur=(e=[])=>Dn.pipe(f.flatMap((e=>e.tryAcquire)),f.matchEffect({onFailure:()=>f.void,onSuccess:()=>pr(e)}),f.scoped,f.forkDaemon),pr=(e=[])=>f.gen((function*(t){const n=yield*wn,r=yield*$t,i=yield*Yn,o=yield*qt,s=yield*rr.pipe(n.transaction("shared"),f.map((t=>({...t,messages:e}))),f.flatMap(rn.L8));i.onSyncStateChange({_tag:"SyncStateIsSyncing"}),yield*rn.Jt(s).pipe(f.flatMap(r.sync),f.flatMap(hr),f.repeat({schedule:on.t5(50),until:y.YW({onNone:()=>f.gen((function*(){return i.onSyncStateChange({_tag:"SyncStateIsSynced",time:yield*o.now}),!0})),onSome:e=>f.gen((function*(){return yield*rn.hZ(s,e),!1}))})}),f.catchAllDefect((e=>f.fail(mn(yn(e))))),f.catchTag("SyncStateIsNotSynced",(e=>f.succeed(i.onSyncStateChange(e)))),f.catchAll((e=>f.succeed(i.onError(e)))))})),hr=e=>f.flatMap(wn,(t=>f.gen((function*(n){const{onReceive:r}=yield*Yn,i=yield*rr,o=yield*f.reduce(e.messages,i.timestamp,((e,t)=>(({local:e,remote:t})=>f.gen((function*(n){e.node===t.node&&(yield*f.fail({_tag:"TimestampDuplicateNodeError",node:e.node}));const r=yield*Tt([e.millis,t.millis]),i=yield*r===e.millis&&r===t.millis?Et(Math.max(e.counter,t.counter)):r===e.millis?Et(e.counter):r===t.millis?Et(t.counter):I.pG(Ct);return{...e,millis:r,counter:i}})))({local:e,remote:St(t.timestamp)}))),s=yield*or(i.merkleTree,e.messages);return e.messages.length>0&&(yield*dr(o,s),r()),yield*((e,t)=>{if(e.hash===t.hash)return y.dv();let n=e,r=t,i=[];for(;;){const e=u.w8(Mt(n).concat(Mt(r)),T.rs);let t=null;for(let i=0;i<e.length;i++){const o=e[i],s=n[o],a=r[o];if(!s||!a)break;if(s.hash!==a.hash){t=o;break}}if(!t)return y.zN(0===(o=i).length?bt:1e3*parseInt(o.join("").padEnd(16,"0"),3)*60);i=[...i,t],n=n[t]||Lt,r=r[t]||Lt}var o;return y.dv()})(e.merkleTree,s).pipe(f.flatMap((e=>t.exec({...Jn,parameters:[kt(Wt(e))]}))),f.map((({rows:e})=>({messages:e,merkleTree:s,timestamp:o}))),f.option)})).pipe(t.transaction("exclusive")))),fr=e=>{const t=JSON.parse(e);return{...t,parameters:t.parameters.map((e=>u.cy(e)?new Uint8Array(e):"object"==typeof e&&null!=e?e.json:e))}},mr=[],yr=()=>mr,gr=new WeakMap,wr=e=>{let t=gr.get(e);return null==t&&(t={rows:e,row:e[0]},gr.set(e,t)),t};let Nr=e=>crypto.getRandomValues(new Uint8Array(e)),br=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+=(t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_"),"");const vr=((e,t)=>{const n=e("0123456789abcdef",16);return w.Py(ht,ht.of({nanoid:f.sync((()=>t())),nodeId:f.sync((()=>n())),rowId:f.sync((()=>t()))}))})(((e,t=21)=>((e,t,n)=>{let r=(2<<Math.log(e.length-1)/Math.LN2)-1,i=-~(1.6*r*t/e.length);return(o=t)=>{let s="";for(;;){let t=n(i),a=i;for(;a--;)if(s+=e[t[a]&r]||"",s.length===o)return s}}})(e,t,Nr)),br);var xr=n(958146),kr=n(370817);function Sr(e){return void 0===e||void 0===e}function Or(e){return"string"==typeof e}function Wr(e){return"number"==typeof e}function Ir(e){return"boolean"==typeof e}function qr(e){return null===e}function Tr(e){return e instanceof Date}function Er(e){return"bigint"==typeof e}function Cr(e){return"function"==typeof e}function Lr(e){return"object"==typeof e&&null!==e}function Ar(e){return Object.freeze(e)}function Dr(e){return Br(e)?e:[e]}function Br(e){return Array.isArray(e)}function Pr(e){return e}const Mr=Ar({is:e=>"AlterTableNode"===e.kind,create:e=>Ar({kind:"AlterTableNode",table:e}),cloneWithTableProps:(e,t)=>Ar({...e,...t}),cloneWithColumnAlteration:(e,t)=>Ar({...e,columnAlterations:e.columnAlterations?[...e.columnAlterations,t]:[t]})}),Fr=Ar({is:e=>"IdentifierNode"===e.kind,create:e=>Ar({kind:"IdentifierNode",name:e})}),Rr=Ar({is:e=>"CreateIndexNode"===e.kind,create:e=>Ar({kind:"CreateIndexNode",name:Fr.create(e)}),cloneWith:(e,t)=>Ar({...e,...t}),cloneWithColumns:(e,t)=>Ar({...e,columns:[...e.columns||[],...t]})}),Ur=Ar({is:e=>"CreateSchemaNode"===e.kind,create:(e,t)=>Ar({kind:"CreateSchemaNode",schema:Fr.create(e),...t}),cloneWith:(e,t)=>Ar({...e,...t})}),jr=["preserve rows","delete rows","drop"],_r=Ar({is:e=>"CreateTableNode"===e.kind,create:e=>Ar({kind:"CreateTableNode",table:e,columns:Ar([])}),cloneWithColumn:(e,t)=>Ar({...e,columns:Ar([...e.columns,t])}),cloneWithConstraint:(e,t)=>Ar({...e,constraints:e.constraints?Ar([...e.constraints,t]):Ar([t])}),cloneWithFrontModifier:(e,t)=>Ar({...e,frontModifiers:e.frontModifiers?Ar([...e.frontModifiers,t]):Ar([t])}),cloneWithEndModifier:(e,t)=>Ar({...e,endModifiers:e.endModifiers?Ar([...e.endModifiers,t]):Ar([t])}),cloneWith:(e,t)=>Ar({...e,...t})}),$r=Ar({is:e=>"SchemableIdentifierNode"===e.kind,create:e=>Ar({kind:"SchemableIdentifierNode",identifier:Fr.create(e)}),createWithSchema:(e,t)=>Ar({kind:"SchemableIdentifierNode",schema:Fr.create(e),identifier:Fr.create(t)})}),Qr=Ar({is:e=>"DropIndexNode"===e.kind,create:(e,t)=>Ar({kind:"DropIndexNode",name:$r.create(e),...t}),cloneWith:(e,t)=>Ar({...e,...t})}),Jr=Ar({is:e=>"DropSchemaNode"===e.kind,create:(e,t)=>Ar({kind:"DropSchemaNode",schema:Fr.create(e),...t}),cloneWith:(e,t)=>Ar({...e,...t})}),Kr=Ar({is:e=>"DropTableNode"===e.kind,create:(e,t)=>Ar({kind:"DropTableNode",table:e,...t}),cloneWith:(e,t)=>Ar({...e,...t})}),Hr=Ar({is:e=>"AliasNode"===e.kind,create:(e,t)=>Ar({kind:"AliasNode",node:e,alias:t})}),Yr=Ar({is:e=>"TableNode"===e.kind,create:e=>Ar({kind:"TableNode",table:$r.create(e)}),createWithSchema:(e,t)=>Ar({kind:"TableNode",table:$r.createWithSchema(e,t)})});function Vr(e){return Lr(e)&&Cr(e.toOperationNode)}const zr=Ar({is:e=>"SelectModifierNode"===e.kind,create:(e,t)=>Ar({kind:"SelectModifierNode",modifier:e,of:t}),createWithExpression:e=>Ar({kind:"SelectModifierNode",rawModifier:e})}),Xr=Ar({is:e=>"AndNode"===e.kind,create:(e,t)=>Ar({kind:"AndNode",left:e,right:t})}),Gr=Ar({is:e=>"OrNode"===e.kind,create:(e,t)=>Ar({kind:"OrNode",left:e,right:t})}),Zr=Ar({is:e=>"OnNode"===e.kind,create:e=>Ar({kind:"OnNode",on:e}),cloneWithOperation:(e,t,n)=>Ar({...e,on:"And"===t?Xr.create(e.on,n):Gr.create(e.on,n)})}),ei=Ar({is:e=>"JoinNode"===e.kind,create:(e,t)=>Ar({kind:"JoinNode",joinType:e,table:t,on:void 0}),createWithOn:(e,t,n)=>Ar({kind:"JoinNode",joinType:e,table:t,on:Zr.create(n)}),cloneWithOn:(e,t)=>Ar({...e,on:e.on?Zr.cloneWithOperation(e.on,"And",t):Zr.create(t)})}),ti=Ar({is:e=>"BinaryOperationNode"===e.kind,create:(e,t,n)=>Ar({kind:"BinaryOperationNode",leftOperand:e,operator:t,rightOperand:n})}),ni=["=","==","!=","<>",">",">=","<","<=","in","not in","is","is not","like","not like","match","ilike","not ilike","@>","<@","&&","?","?&","!<","!>","<=>","!~","~","~*","!~*","@@","@@@","!!","<->","regexp","is distinct from","is not distinct from"],ri=["+","-","*","/","%","^","&","|","#","<<",">>"],ii=["->","->>"],oi=[...ni,...ri,"&&","||"],si=["not","-","exists","not exists"],ai=[...oi,...ii,...si,"between","between symmetric"],ci=Ar({is:e=>"OperatorNode"===e.kind,create:e=>Ar({kind:"OperatorNode",operator:e})});function di(e){return Or(e)&&ii.includes(e)}const li=Ar({is:e=>"ColumnNode"===e.kind,create:e=>Ar({kind:"ColumnNode",column:Fr.create(e)})}),ui=Ar({is:e=>"SelectAllNode"===e.kind,create:()=>Ar({kind:"SelectAllNode"})}),pi=Ar({is:e=>"ReferenceNode"===e.kind,create:(e,t)=>Ar({kind:"ReferenceNode",table:t,column:e}),createSelectAll:e=>Ar({kind:"ReferenceNode",table:e,column:ui.create()})});class hi{#e;get dynamicReference(){return this.#e}get refType(){}constructor(e){this.#e=e}toOperationNode(){return Si(this.#e)}}function fi(e){return Lr(e)&&Vr(e)&&Or(e.dynamicReference)}const mi=Ar({is:e=>"OrderByItemNode"===e.kind,create:(e,t)=>Ar({kind:"OrderByItemNode",orderBy:e,direction:t})}),yi=Ar({is:e=>"RawNode"===e.kind,create:(e,t)=>Ar({kind:"RawNode",sqlFragments:Ar(e),parameters:Ar(t)}),createWithSql:e=>yi.create([e],[]),createWithChild:e=>yi.create(["",""],[e]),createWithChildren:e=>yi.create(new Array(e.length+1).fill(""),e)});function gi(e){return"asc"===e||"desc"===e}function wi(e){if(2===e.length)return[Ni(e[0],e[1])];if(1===e.length){const[t]=e;return Array.isArray(t)?t.map((e=>Ni(e))):[Ni(t)]}throw new Error(`Invalid number of arguments at order by! expected 1-2, received ${e.length}`)}function Ni(e,t){const n=function(e){if(ia(e))return na(e);if(fi(e))return e.toOperationNode();const[t,n]=e.split(" ");if(n){if(!gi(n))throw new Error(`Invalid order by direction: ${n}`);return mi.create(Ii(t),bi(n))}return Ii(e)}(e);if(mi.is(n)){if(t)throw new Error("Cannot specify direction twice!");return n}return mi.create(n,bi(t))}function bi(e){if(e)return"asc"===e||"desc"===e?yi.createWithSql(e):e.toOperationNode()}const vi=Ar({is:e=>"JSONReferenceNode"===e.kind,create:(e,t)=>Ar({kind:"JSONReferenceNode",reference:e,traversal:t}),cloneWithTraversal:(e,t)=>Ar({...e,traversal:t})}),xi=Ar({is:e=>"JSONOperatorChainNode"===e.kind,create:e=>Ar({kind:"JSONOperatorChainNode",operator:e,values:Ar([])}),cloneWithValue:(e,t)=>Ar({...e,values:Ar([...e.values,t])})}),ki=Ar({is:e=>"JSONPathNode"===e.kind,create:e=>Ar({kind:"JSONPathNode",inOperator:e,pathLegs:Ar([])}),cloneWithLeg:(e,t)=>Ar({...e,pathLegs:Ar([...e.pathLegs,t])})});function Si(e){return Or(e)?Ii(e):e.toOperationNode()}function Oi(e){return Br(e)?e.map((e=>Wi(e))):[Wi(e)]}function Wi(e){return ia(e)?na(e):Si(e)}function Ii(e){if(!e.includes("."))return pi.create(li.create(e));const t=e.split(".").map(Ei);if(3===t.length)return function(e){const[t,n,r]=e;return pi.create(li.create(r),Yr.createWithSchema(t,n))}(t);if(2===t.length)return function(e){const[t,n]=e;return pi.create(li.create(n),Yr.create(t))}(t);throw new Error(`invalid column reference ${e}`)}function qi(e){return li.create(e)}function Ti(e){if(e.includes(" ")){const[t,n]=e.split(" ").map(Ei);if(!gi(n))throw new Error(`invalid order direction "${n}" next to "${t}"`);return wi([t,n])[0]}return qi(e)}function Ei(e){return e.trim()}const Ci=Ar({is:e=>"PrimitiveValueListNode"===e.kind,create:e=>Ar({kind:"PrimitiveValueListNode",values:Ar([...e])})}),Li=Ar({is:e=>"ValueListNode"===e.kind,create:e=>Ar({kind:"ValueListNode",values:Ar(e)})}),Ai=Ar({is:e=>"ValueNode"===e.kind,create:e=>Ar({kind:"ValueNode",value:e}),createImmediate:e=>Ar({kind:"ValueNode",value:e,immediate:!0})});function Di(e){return Br(e)?function(e){if(e.some(ia))return Li.create(e.map((e=>Bi(e))));return Ci.create(e)}(e):Bi(e)}function Bi(e){return ia(e)?na(e):Ai.create(e)}function Pi(e){return Wr(e)||Ir(e)||qr(e)}function Mi(e){if(!Pi(e))throw new Error(`unsafe immediate value ${JSON.stringify(e)}`);return Ai.createImmediate(e)}const Fi=Ar({is:e=>"ParensNode"===e.kind,create:e=>Ar({kind:"ParensNode",node:e})});function Ri(e){if(3===e.length)return Ui(e[0],e[1],e[2]);if(1===e.length)return Bi(e[0]);throw new Error(`invalid arguments: ${JSON.stringify(e)}`)}function Ui(e,t,n){return function(e){return"is"===e||"is not"===e}(t)&&Qi(n)?ti.create(Wi(e),Ji(t),Ai.createImmediate(n)):ti.create(Wi(e),Ji(t),Di(n))}function ji(e,t,n){return ti.create(Wi(e),Ji(t),Wi(n))}function _i(e,t){return $i(Object.entries(e).filter((([,e])=>!Sr(e))).map((([e,t])=>Ui(e,Qi(t)?"is":"=",t))),t)}function $i(e,t,n=!0){const r="and"===t?Xr.create:Gr.create;if(0===e.length)return ti.create(Ai.createImmediate(1),ci.create("="),Ai.createImmediate("and"===t?1:0));let i=Ki(e[0]);for(let t=1;t<e.length;++t)i=r(i,Ki(e[t]));return e.length>1&&n?Fi.create(i):i}function Qi(e){return qr(e)||Ir(e)}function Ji(e){if(Or(e)&&ai.includes(e))return ci.create(e);if(Vr(e))return e.toOperationNode();throw new Error(`invalid operator ${JSON.stringify(e)}`)}function Ki(e){return Vr(e)?e.toOperationNode():e}const Hi=Ar({is:e=>"OrderByNode"===e.kind,create:e=>Ar({kind:"OrderByNode",items:Ar([...e])}),cloneWithItems:(e,t)=>Ar({...e,items:Ar([...e.items,...t])})}),Yi=Ar({is:e=>"PartitionByNode"===e.kind,create:e=>Ar({kind:"PartitionByNode",items:Ar(e)}),cloneWithItems:(e,t)=>Ar({...e,items:Ar([...e.items,...t])})}),Vi=Ar({is:e=>"OverNode"===e.kind,create:()=>Ar({kind:"OverNode"}),cloneWithOrderByItems:(e,t)=>Ar({...e,orderBy:e.orderBy?Hi.cloneWithItems(e.orderBy,t):Hi.create(t)}),cloneWithPartitionByItems:(e,t)=>Ar({...e,partitionBy:e.partitionBy?Yi.cloneWithItems(e.partitionBy,t):Yi.create(t)})});function zi(e,t){Object.defineProperties(e.prototype,{then:{enumerable:!1,value:()=>{throw new Error(t)}}})}class Xi{#t;constructor(e){this.#t=Ar(e)}on(...e){return new Xi({...this.#t,joinNode:ei.cloneWithOn(this.#t.joinNode,Ri(e))})}onRef(e,t,n){return new Xi({...this.#t,joinNode:ei.cloneWithOn(this.#t.joinNode,ji(e,t,n))})}onTrue(){return new Xi({...this.#t,joinNode:ei.cloneWithOn(this.#t.joinNode,yi.createWithSql("true"))})}$call(e){return e(this)}toOperationNode(){return this.#t.joinNode}}zi(Xi,"don't await JoinBuilder instances. They are never executed directly and are always just a part of a query.");const Gi=Ar({is:e=>"PartitionByItemNode"===e.kind,create:e=>Ar({kind:"PartitionByItemNode",partitionBy:e})});function Zi(e){return Oi(e).map(Gi.create)}class eo{#t;constructor(e){this.#t=Ar(e)}orderBy(e,t){return new eo({overNode:Vi.cloneWithOrderByItems(this.#t.overNode,wi([e,t]))})}partitionBy(e){return new eo({overNode:Vi.cloneWithPartitionByItems(this.#t.overNode,Zi(e))})}$call(e){return e(this)}toOperationNode(){return this.#t.overNode}}zi(eo,"don't await OverBuilder instances. They are never executed directly and are always just a part of a query.");const to=Ar({is:e=>"SelectionNode"===e.kind,create:e=>Ar({kind:"SelectionNode",selection:e}),createSelectAll:()=>Ar({kind:"SelectionNode",selection:ui.create()}),createSelectAllFromTable:e=>Ar({kind:"SelectionNode",selection:pi.createSelectAll(e)})});function no(e){return Cr(e)?no(e(ta())):Br(e)?e.map((e=>ro(e))):[ro(e)]}function ro(e){return Or(e)?to.create(function(e){const t=" as ";if(e.includes(t)){const[n,r]=e.split(t).map(Ei);return Hr.create(Ii(n),Fr.create(r))}return Ii(e)}(e)):fi(e)?to.create(e.toOperationNode()):to.create(ra(e))}function io(e){return e?Array.isArray(e)?e.map(oo):[oo(e)]:[to.createSelectAll()]}function oo(e){if(Or(e))return to.createSelectAllFromTable(ca(e));throw new Error(`invalid value selectAll expression: ${JSON.stringify(e)}`)}const so=Ar({is:e=>"ValuesNode"===e.kind,create:e=>Ar({kind:"ValuesNode",values:Ar(e)})}),ao=Ar({is:e=>"DefaultInsertValueNode"===e.kind,create:()=>Ar({kind:"DefaultInsertValueNode"})});function co(e){const t=Cr(e)?e(ta()):e;return function(e){const t=function(e){const t=new Map;for(const n of e){const e=Object.keys(n);for(const r of e)t.has(r)||void 0===n[r]||t.set(r,t.size)}return t}(e);return[Ar([...t.keys()].map(li.create)),so.create(e.map((e=>function(e,t){const n=Object.keys(e),r=Array.from({length:t.size});let i=!1;for(const o of n){const n=t.get(o);if(Sr(n))continue;const s=e[o];(Sr(s)||ia(s))&&(i=!0),r[n]=s}const o=n.length<t.size;if(o||i){const e=ao.create();return Li.create(r.map((t=>Sr(t)?e:Bi(t))))}return Ci.create(r)}(e,t))))]}(Br(t)?t:Ar([t]))}const lo=Ar({is:e=>"InsertQueryNode"===e.kind,create:(e,t,n)=>Ar({kind:"InsertQueryNode",into:e,...t&&{with:t},replace:n}),createWithoutInto:()=>Ar({kind:"InsertQueryNode"}),cloneWith:(e,t)=>Ar({...e,...t})}),uo=Ar({is:e=>"FromNode"===e.kind,create:e=>Ar({kind:"FromNode",froms:Ar(e)}),cloneWithFroms:(e,t)=>Ar({...e,froms:Ar([...e.froms,...t])})}),po=Ar({is:e=>"GroupByNode"===e.kind,create:e=>Ar({kind:"GroupByNode",items:Ar(e)}),cloneWithItems:(e,t)=>Ar({...e,items:Ar([...e.items,...t])})}),ho=Ar({is:e=>"HavingNode"===e.kind,create:e=>Ar({kind:"HavingNode",having:e}),cloneWithOperation:(e,t,n)=>Ar({...e,having:"And"===t?Xr.create(e.having,n):Gr.create(e.having,n)})}),fo=Ar({is:e=>"SelectQueryNode"===e.kind,create:e=>Ar({kind:"SelectQueryNode",...e&&{with:e}}),createFrom:(e,t)=>Ar({kind:"SelectQueryNode",from:uo.create(e),...t&&{with:t}}),cloneWithSelections:(e,t)=>Ar({...e,selections:e.selections?Ar([...e.selections,...t]):Ar(t)}),cloneWithDistinctOn:(e,t)=>Ar({...e,distinctOn:e.distinctOn?Ar([...e.distinctOn,...t]):Ar(t)}),cloneWithFrontModifier:(e,t)=>Ar({...e,frontModifiers:e.frontModifiers?Ar([...e.frontModifiers,t]):Ar([t])}),cloneWithEndModifier:(e,t)=>Ar({...e,endModifiers:e.endModifiers?Ar([...e.endModifiers,t]):Ar([t])}),cloneWithOrderByItems:(e,t)=>Ar({...e,orderBy:e.orderBy?Hi.cloneWithItems(e.orderBy,t):Hi.create(t)}),cloneWithGroupByItems:(e,t)=>Ar({...e,groupBy:e.groupBy?po.cloneWithItems(e.groupBy,t):po.create(t)}),cloneWithLimit:(e,t)=>Ar({...e,limit:t}),cloneWithOffset:(e,t)=>Ar({...e,offset:t}),cloneWithFetch:(e,t)=>Ar({...e,fetch:t}),cloneWithHaving:(e,t)=>Ar({...e,having:e.having?ho.cloneWithOperation(e.having,"And",t):ho.create(t)}),cloneWithSetOperations:(e,t)=>Ar({...e,setOperations:e.setOperations?Ar([...e.setOperations,...t]):Ar([...t])}),cloneWithoutSelections:e=>Ar({...e,selections:[]}),cloneWithoutLimit:e=>Ar({...e,limit:void 0}),cloneWithoutOffset:e=>Ar({...e,offset:void 0}),cloneWithoutOrderBy:e=>Ar({...e,orderBy:void 0})}),mo=Ar({is:e=>"UpdateQueryNode"===e.kind,create:(e,t)=>Ar({kind:"UpdateQueryNode",table:e,...t&&{with:t}}),createWithoutTable:()=>Ar({kind:"UpdateQueryNode"}),cloneWithFromItems:(e,t)=>Ar({...e,from:e.from?uo.cloneWithFroms(e.from,t):uo.create(t)}),cloneWithUpdates:(e,t)=>Ar({...e,updates:e.updates?Ar([...e.updates,...t]):t}),cloneWithLimit:(e,t)=>Ar({...e,limit:t})}),yo=Ar({is:e=>"UsingNode"===e.kind,create:e=>Ar({kind:"UsingNode",tables:Ar(e)}),cloneWithTables:(e,t)=>Ar({...e,tables:Ar([...e.tables,...t])})}),go=Ar({is:e=>"DeleteQueryNode"===e.kind,create:(e,t)=>Ar({kind:"DeleteQueryNode",from:uo.create(e),...t&&{with:t}}),cloneWithOrderByItems:(e,t)=>Ar({...e,orderBy:e.orderBy?Hi.cloneWithItems(e.orderBy,t):Hi.create(t)}),cloneWithoutOrderBy:e=>Ar({...e,orderBy:void 0}),cloneWithLimit:(e,t)=>Ar({...e,limit:t}),cloneWithoutLimit:e=>Ar({...e,limit:void 0}),cloneWithUsing:(e,t)=>Ar({...e,using:void 0!==e.using?yo.cloneWithTables(e.using,t):yo.create(t)})}),wo=Ar({is:e=>"WhereNode"===e.kind,create:e=>Ar({kind:"WhereNode",where:e}),cloneWithOperation:(e,t,n)=>Ar({...e,where:"And"===t?Xr.create(e.where,n):Gr.create(e.where,n)})}),No=Ar({is:e=>"ReturningNode"===e.kind,create:e=>Ar({kind:"ReturningNode",selections:Ar(e)}),cloneWithSelections:(e,t)=>Ar({...e,selections:e.selections?Ar([...e.selections,...t]):Ar(t)})}),bo=Ar({is:e=>"ExplainNode"===e.kind,create:(e,t)=>Ar({kind:"ExplainNode",format:e,options:t})}),vo=Ar({is:e=>"WhenNode"===e.kind,create:e=>Ar({kind:"WhenNode",condition:e}),cloneWithResult:(e,t)=>Ar({...e,result:t})}),xo=Ar({is:e=>"MergeQueryNode"===e.kind,create:(e,t)=>Ar({kind:"MergeQueryNode",into:e,...t&&{with:t}}),cloneWithUsing:(e,t)=>Ar({...e,using:t}),cloneWithWhen:(e,t)=>Ar({...e,whens:e.whens?Ar([...e.whens,t]):Ar([t])}),cloneWithThen:(e,t)=>Ar({...e,whens:e.whens?Ar([...e.whens.slice(0,-1),vo.cloneWithResult(e.whens[e.whens.length-1],t)]):void 0})}),ko=Ar({is:e=>fo.is(e)||lo.is(e)||mo.is(e)||go.is(e)||xo.is(e),cloneWithWhere:(e,t)=>Ar({...e,where:e.where?wo.cloneWithOperation(e.where,"And",t):wo.create(t)}),cloneWithJoin:(e,t)=>Ar({...e,joins:e.joins?Ar([...e.joins,t]):Ar([t])}),cloneWithReturning:(e,t)=>Ar({...e,returning:e.returning?No.cloneWithSelections(e.returning,t):No.create(t)}),cloneWithoutReturning:e=>Ar({...e,returning:void 0}),cloneWithoutWhere:e=>Ar({...e,where:void 0}),cloneWithExplain:(e,t,n)=>Ar({...e,explain:bo.create(t,n?.toOperationNode())}),cloneWithTop:(e,t)=>Ar({...e,top:t})}),So=Ar({is:e=>"ColumnUpdateNode"===e.kind,create:(e,t)=>Ar({kind:"ColumnUpdateNode",column:e,value:t})});function Oo(...e){return 2===e.length?[So.create(Wi(e[0]),Bi(e[1]))]:Wo(e[0])}function Wo(e){const t=Cr(e)?e(ta()):e;return Object.entries(t).filter((([e,t])=>void 0!==t)).map((([e,t])=>So.create(li.create(e),Bi(t))))}const Io=Ar({is:e=>"OnDuplicateKeyNode"===e.kind,create:e=>Ar({kind:"OnDuplicateKeyNode",updates:e})});class qo{insertId;numInsertedOrUpdatedRows;constructor(e,t){this.insertId=e,this.numInsertedOrUpdatedRows=t}}class To extends Error{node;constructor(e){super("no result"),this.node=e}}function Eo(e){return Object.prototype.hasOwnProperty.call(e,"prototype")}const Co=Ar({is:e=>"OnConflictNode"===e.kind,create:()=>Ar({kind:"OnConflictNode"}),cloneWith:(e,t)=>Ar({...e,...t}),cloneWithIndexWhere:(e,t)=>Ar({...e,indexWhere:e.indexWhere?wo.cloneWithOperation(e.indexWhere,"And",t):wo.create(t)}),cloneWithIndexOrWhere:(e,t)=>Ar({...e,indexWhere:e.indexWhere?wo.cloneWithOperation(e.indexWhere,"Or",t):wo.create(t)}),cloneWithUpdateWhere:(e,t)=>Ar({...e,updateWhere:e.updateWhere?wo.cloneWithOperation(e.updateWhere,"And",t):wo.create(t)}),cloneWithUpdateOrWhere:(e,t)=>Ar({...e,updateWhere:e.updateWhere?wo.cloneWithOperation(e.updateWhere,"Or",t):wo.create(t)}),cloneWithoutIndexWhere:e=>Ar({...e,indexWhere:void 0}),cloneWithoutUpdateWhere:e=>Ar({...e,updateWhere:void 0})});class Lo{#t;constructor(e){this.#t=Ar(e)}column(e){const t=li.create(e);return new Lo({...this.#t,onConflictNode:Co.cloneWith(this.#t.onConflictNode,{columns:this.#t.onConflictNode.columns?Ar([...this.#t.onConflictNode.columns,t]):Ar([t])})})}columns(e){const t=e.map(li.create);return new Lo({...this.#t,onConflictNode:Co.cloneWith(this.#t.onConflictNode,{columns:this.#t.onConflictNode.columns?Ar([...this.#t.onConflictNode.columns,...t]):Ar(t)})})}constraint(e){return new Lo({...this.#t,onConflictNode:Co.cloneWith(this.#t.onConflictNode,{constraint:Fr.create(e)})})}expression(e){return new Lo({...this.#t,onConflictNode:Co.cloneWith(this.#t.onConflictNode,{indexExpression:e.toOperationNode()})})}where(...e){return new Lo({...this.#t,onConflictNode:Co.cloneWithIndexWhere(this.#t.onConflictNode,Ri(e))})}whereRef(e,t,n){return new Lo({...this.#t,onConflictNode:Co.cloneWithIndexWhere(this.#t.onConflictNode,ji(e,t,n))})}clearWhere(){return new Lo({...this.#t,onConflictNode:Co.cloneWithoutIndexWhere(this.#t.onConflictNode)})}doNothing(){return new Ao({...this.#t,onConflictNode:Co.cloneWith(this.#t.onConflictNode,{doNothing:!0})})}doUpdateSet(e){return new Do({...this.#t,onConflictNode:Co.cloneWith(this.#t.onConflictNode,{updates:Wo(e)})})}$call(e){return e(this)}}zi(Lo,"don't await OnConflictBuilder instances.");class Ao{#t;constructor(e){this.#t=Ar(e)}toOperationNode(){return this.#t.onConflictNode}}zi(Ao,"don't await OnConflictDoNothingBuilder instances.");class Do{#t;constructor(e){this.#t=Ar(e)}where(...e){return new Do({...this.#t,onConflictNode:Co.cloneWithUpdateWhere(this.#t.onConflictNode,Ri(e))})}whereRef(e,t,n){return new Do({...this.#t,onConflictNode:Co.cloneWithUpdateWhere(this.#t.onConflictNode,ji(e,t,n))})}clearWhere(){return new Do({...this.#t,onConflictNode:Co.cloneWithoutUpdateWhere(this.#t.onConflictNode)})}$call(e){return e(this)}toOperationNode(){return this.#t.onConflictNode}}zi(Do,"don't await OnConflictUpdateBuilder instances.");const Bo=Ar({is:e=>"TopNode"===e.kind,create:(e,t)=>Ar({kind:"TopNode",expression:e,modifiers:t})});function Po(e,t){if(!Wr(e)&&!Er(e))throw new Error(`Invalid top expression: ${e}`);if(!Sr(t)&&!function(e){return"percent"===e||"with ties"===e||"percent with ties"===e}(t))throw new Error(`Invalid top modifiers: ${t}`);return Bo.create(e,t)}class Mo{#t;constructor(e){this.#t=Ar(e)}values(e){const[t,n]=co(e);return new Mo({...this.#t,queryNode:lo.cloneWith(this.#t.queryNode,{columns:t,values:n})})}columns(e){return new Mo({...this.#t,queryNode:lo.cloneWith(this.#t.queryNode,{columns:Ar(e.map(li.create))})})}expression(e){return new Mo({...this.#t,queryNode:lo.cloneWith(this.#t.queryNode,{values:na(e)})})}defaultValues(){return new Mo({...this.#t,queryNode:lo.cloneWith(this.#t.queryNode,{defaultValues:!0})})}ignore(){return new Mo({...this.#t,queryNode:lo.cloneWith(this.#t.queryNode,{ignore:!0})})}top(e,t){return new Mo({...this.#t,queryNode:ko.cloneWithTop(this.#t.queryNode,Po(e,t))})}onConflict(e){return new Mo({...this.#t,queryNode:lo.cloneWith(this.#t.queryNode,{onConflict:e(new Lo({onConflictNode:Co.create()})).toOperationNode()})})}onDuplicateKeyUpdate(e){return new Mo({...this.#t,queryNode:lo.cloneWith(this.#t.queryNode,{onDuplicateKey:Io.create(Wo(e))})})}returning(e){return new Mo({...this.#t,queryNode:ko.cloneWithReturning(this.#t.queryNode,no(e))})}returningAll(){return new Mo({...this.#t,queryNode:ko.cloneWithReturning(this.#t.queryNode,io())})}clearReturning(){return new Mo({...this.#t,queryNode:ko.cloneWithoutReturning(this.#t.queryNode)})}$call(e){return e(this)}$if(e,t){return e?t(this):new Mo({...this.#t})}$castTo(){return new Mo(this.#t)}$narrowType(){return new Mo(this.#t)}$assertType(){return new Mo(this.#t)}withPlugin(e){return new Mo({...this.#t,executor:this.#t.executor.withPlugin(e)})}toOperationNode(){return this.#t.executor.transformQuery(this.#t.queryNode,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){const e=this.compile(),t=e.query,n=await this.#t.executor.executeQuery(e,this.#t.queryId);return this.#t.executor.adapter.supportsReturning&&t.returning?n.rows:[new qo(n.insertId,n.numAffectedRows??n.numUpdatedOrDeletedRows)]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=To){const t=await this.executeTakeFirst();if(void 0===t){throw Eo(e)?new e(this.toOperationNode()):e(this.toOperationNode())}return t}async*stream(e=100){const t=this.compile(),n=this.#t.executor.stream(t,e,this.#t.queryId);for await(const e of n)yield*e.rows}async explain(e,t){const n=new Mo({...this.#t,queryNode:ko.cloneWithExplain(this.#t.queryNode,e,t)});return await n.execute()}}zi(Mo,"don't await InsertQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");class Fo{numDeletedRows;constructor(e){this.numDeletedRows=e}}const Ro=Ar({is:e=>"LimitNode"===e.kind,create:e=>Ar({kind:"LimitNode",limit:e})});class Uo{#t;constructor(e){this.#t=Ar(e)}where(...e){return new Uo({...this.#t,queryNode:ko.cloneWithWhere(this.#t.queryNode,Ri(e))})}whereRef(e,t,n){return new Uo({...this.#t,queryNode:ko.cloneWithWhere(this.#t.queryNode,ji(e,t,n))})}clearWhere(){return new Uo({...this.#t,queryNode:ko.cloneWithoutWhere(this.#t.queryNode)})}top(e,t){return new Uo({...this.#t,queryNode:ko.cloneWithTop(this.#t.queryNode,Po(e,t))})}using(e){return new Uo({...this.#t,queryNode:go.cloneWithUsing(this.#t.queryNode,oa(e))})}innerJoin(...e){return new Uo({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("InnerJoin",e))})}leftJoin(...e){return new Uo({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("LeftJoin",e))})}rightJoin(...e){return new Uo({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("RightJoin",e))})}fullJoin(...e){return new Uo({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("FullJoin",e))})}returning(e){return new Uo({...this.#t,queryNode:ko.cloneWithReturning(this.#t.queryNode,no(e))})}returningAll(e){return new Uo({...this.#t,queryNode:ko.cloneWithReturning(this.#t.queryNode,io(e))})}clearReturning(){return new Uo({...this.#t,queryNode:ko.cloneWithoutReturning(this.#t.queryNode)})}clearLimit(){return new Uo({...this.#t,queryNode:go.cloneWithoutLimit(this.#t.queryNode)})}clearOrderBy(){return new Uo({...this.#t,queryNode:go.cloneWithoutOrderBy(this.#t.queryNode)})}orderBy(e,t){return new Uo({...this.#t,queryNode:go.cloneWithOrderByItems(this.#t.queryNode,wi([e,t]))})}limit(e){return new Uo({...this.#t,queryNode:go.cloneWithLimit(this.#t.queryNode,Ro.create(Bi(e)))})}$call(e){return e(this)}$if(e,t){return e?t(this):new Uo({...this.#t})}$castTo(){return new Uo(this.#t)}$narrowType(){return new Uo(this.#t)}$assertType(){return new Uo(this.#t)}withPlugin(e){return new Uo({...this.#t,executor:this.#t.executor.withPlugin(e)})}toOperationNode(){return this.#t.executor.transformQuery(this.#t.queryNode,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){const e=this.compile(),t=e.query,n=await this.#t.executor.executeQuery(e,this.#t.queryId);return this.#t.executor.adapter.supportsReturning&&t.returning?n.rows:[new Fo(n.numAffectedRows??n.numUpdatedOrDeletedRows??BigInt(0))]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=To){const t=await this.executeTakeFirst();if(void 0===t){throw Eo(e)?new e(this.toOperationNode()):e(this.toOperationNode())}return t}async*stream(e=100){const t=this.compile(),n=this.#t.executor.stream(t,e,this.#t.queryId);for await(const e of n)yield*e.rows}async explain(e,t){const n=new Uo({...this.#t,queryNode:ko.cloneWithExplain(this.#t.queryNode,e,t)});return await n.execute()}}zi(Uo,"don't await DeleteQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");class jo{numUpdatedRows;numChangedRows;constructor(e,t){this.numUpdatedRows=e,this.numChangedRows=t}}class _o{#t;constructor(e){this.#t=Ar(e)}where(...e){return new _o({...this.#t,queryNode:ko.cloneWithWhere(this.#t.queryNode,Ri(e))})}whereRef(e,t,n){return new _o({...this.#t,queryNode:ko.cloneWithWhere(this.#t.queryNode,ji(e,t,n))})}clearWhere(){return new _o({...this.#t,queryNode:ko.cloneWithoutWhere(this.#t.queryNode)})}top(e,t){return new _o({...this.#t,queryNode:ko.cloneWithTop(this.#t.queryNode,Po(e,t))})}from(e){return new _o({...this.#t,queryNode:mo.cloneWithFromItems(this.#t.queryNode,oa(e))})}innerJoin(...e){return new _o({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("InnerJoin",e))})}leftJoin(...e){return new _o({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("LeftJoin",e))})}rightJoin(...e){return new _o({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("RightJoin",e))})}fullJoin(...e){return new _o({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("FullJoin",e))})}limit(e){return new _o({...this.#t,queryNode:mo.cloneWithLimit(this.#t.queryNode,Ro.create(Bi(e)))})}set(...e){return new _o({...this.#t,queryNode:mo.cloneWithUpdates(this.#t.queryNode,Oo(...e))})}returning(e){return new _o({...this.#t,queryNode:ko.cloneWithReturning(this.#t.queryNode,no(e))})}returningAll(){return new _o({...this.#t,queryNode:ko.cloneWithReturning(this.#t.queryNode,io())})}clearReturning(){return new _o({...this.#t,queryNode:ko.cloneWithoutReturning(this.#t.queryNode)})}$call(e){return e(this)}$if(e,t){return e?t(this):new _o({...this.#t})}$castTo(){return new _o(this.#t)}$narrowType(){return new _o(this.#t)}$assertType(){return new _o(this.#t)}withPlugin(e){return new _o({...this.#t,executor:this.#t.executor.withPlugin(e)})}toOperationNode(){return this.#t.executor.transformQuery(this.#t.queryNode,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){const e=this.compile(),t=e.query,n=await this.#t.executor.executeQuery(e,this.#t.queryId);return this.#t.executor.adapter.supportsReturning&&t.returning?n.rows:[new jo(n.numAffectedRows??n.numUpdatedOrDeletedRows??BigInt(0),n.numChangedRows)]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=To){const t=await this.executeTakeFirst();if(void 0===t){throw Eo(e)?new e(this.toOperationNode()):e(this.toOperationNode())}return t}async*stream(e=100){const t=this.compile(),n=this.#t.executor.stream(t,e,this.#t.queryId);for await(const e of n)yield*e.rows}async explain(e,t){const n=new _o({...this.#t,queryNode:ko.cloneWithExplain(this.#t.queryNode,e,t)});return await n.execute()}}zi(_o,"don't await UpdateQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");const $o=Ar({is:e=>"CommonTableExpressionNameNode"===e.kind,create:(e,t)=>Ar({kind:"CommonTableExpressionNameNode",table:Yr.create(e),columns:t?Ar(t.map(li.create)):void 0})}),Qo=Ar({is:e=>"CommonTableExpressionNode"===e.kind,create:(e,t)=>Ar({kind:"CommonTableExpressionNode",name:e,expression:t}),cloneWith:(e,t)=>Ar({...e,...t})});class Jo{#t;constructor(e){this.#t=Ar(e)}materialized(){return new Jo({...this.#t,node:Qo.cloneWith(this.#t.node,{materialized:!0})})}notMaterialized(){return new Jo({...this.#t,node:Qo.cloneWith(this.#t.node,{materialized:!1})})}toOperationNode(){return this.#t.node}}function Ko(e,t){const n=t(new ys({executor:ls})).toOperationNode();return Cr(e)?e(function(e){return t=>new Jo({node:Qo.create(Ho(t),e)})}(n)).toOperationNode():Qo.create(Ho(e),n)}function Ho(e){if(e.includes("(")){const t=e.split(/[\(\)]/),n=t[0],r=t[1].split(",").map((e=>e.trim()));return $o.create(n,r)}return $o.create(e)}zi(Jo,"don't await CTEBuilder instances. They are never executed directly and are always just a part of a query.");const Yo=Ar({is:e=>"WithNode"===e.kind,create:(e,t)=>Ar({kind:"WithNode",expressions:Ar([e]),...t}),cloneWithExpression:(e,t)=>Ar({...e,expressions:Ar([...e.expressions,t])})}),Vo=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"];function zo(){return new Xo}class Xo{#n;get queryId(){return void 0===this.#n&&(this.#n=function(e){let t="";for(let n=0;n<e;++n)t+=Vo[~~(Math.random()*Vo.length)];return t}(8)),this.#n}}class Go{nodeStack=[];#r=Ar({AliasNode:this.transformAlias.bind(this),ColumnNode:this.transformColumn.bind(this),IdentifierNode:this.transformIdentifier.bind(this),SchemableIdentifierNode:this.transformSchemableIdentifier.bind(this),RawNode:this.transformRaw.bind(this),ReferenceNode:this.transformReference.bind(this),SelectQueryNode:this.transformSelectQuery.bind(this),SelectionNode:this.transformSelection.bind(this),TableNode:this.transformTable.bind(this),FromNode:this.transformFrom.bind(this),SelectAllNode:this.transformSelectAll.bind(this),AndNode:this.transformAnd.bind(this),OrNode:this.transformOr.bind(this),ValueNode:this.transformValue.bind(this),ValueListNode:this.transformValueList.bind(this),PrimitiveValueListNode:this.transformPrimitiveValueList.bind(this),ParensNode:this.transformParens.bind(this),JoinNode:this.transformJoin.bind(this),OperatorNode:this.transformOperator.bind(this),WhereNode:this.transformWhere.bind(this),InsertQueryNode:this.transformInsertQuery.bind(this),DeleteQueryNode:this.transformDeleteQuery.bind(this),ReturningNode:this.transformReturning.bind(this),CreateTableNode:this.transformCreateTable.bind(this),AddColumnNode:this.transformAddColumn.bind(this),ColumnDefinitionNode:this.transformColumnDefinition.bind(this),DropTableNode:this.transformDropTable.bind(this),DataTypeNode:this.transformDataType.bind(this),OrderByNode:this.transformOrderBy.bind(this),OrderByItemNode:this.transformOrderByItem.bind(this),GroupByNode:this.transformGroupBy.bind(this),GroupByItemNode:this.transformGroupByItem.bind(this),UpdateQueryNode:this.transformUpdateQuery.bind(this),ColumnUpdateNode:this.transformColumnUpdate.bind(this),LimitNode:this.transformLimit.bind(this),OffsetNode:this.transformOffset.bind(this),OnConflictNode:this.transformOnConflict.bind(this),OnDuplicateKeyNode:this.transformOnDuplicateKey.bind(this),CreateIndexNode:this.transformCreateIndex.bind(this),DropIndexNode:this.transformDropIndex.bind(this),ListNode:this.transformList.bind(this),PrimaryKeyConstraintNode:this.transformPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.transformUniqueConstraint.bind(this),ReferencesNode:this.transformReferences.bind(this),CheckConstraintNode:this.transformCheckConstraint.bind(this),WithNode:this.transformWith.bind(this),CommonTableExpressionNode:this.transformCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.transformCommonTableExpressionName.bind(this),HavingNode:this.transformHaving.bind(this),CreateSchemaNode:this.transformCreateSchema.bind(this),DropSchemaNode:this.transformDropSchema.bind(this),AlterTableNode:this.transformAlterTable.bind(this),DropColumnNode:this.transformDropColumn.bind(this),RenameColumnNode:this.transformRenameColumn.bind(this),AlterColumnNode:this.transformAlterColumn.bind(this),ModifyColumnNode:this.transformModifyColumn.bind(this),AddConstraintNode:this.transformAddConstraint.bind(this),DropConstraintNode:this.transformDropConstraint.bind(this),ForeignKeyConstraintNode:this.transformForeignKeyConstraint.bind(this),CreateViewNode:this.transformCreateView.bind(this),DropViewNode:this.transformDropView.bind(this),GeneratedNode:this.transformGenerated.bind(this),DefaultValueNode:this.transformDefaultValue.bind(this),OnNode:this.transformOn.bind(this),ValuesNode:this.transformValues.bind(this),SelectModifierNode:this.transformSelectModifier.bind(this),CreateTypeNode:this.transformCreateType.bind(this),DropTypeNode:this.transformDropType.bind(this),ExplainNode:this.transformExplain.bind(this),DefaultInsertValueNode:this.transformDefaultInsertValue.bind(this),AggregateFunctionNode:this.transformAggregateFunction.bind(this),OverNode:this.transformOver.bind(this),PartitionByNode:this.transformPartitionBy.bind(this),PartitionByItemNode:this.transformPartitionByItem.bind(this),SetOperationNode:this.transformSetOperation.bind(this),BinaryOperationNode:this.transformBinaryOperation.bind(this),UnaryOperationNode:this.transformUnaryOperation.bind(this),UsingNode:this.transformUsing.bind(this),FunctionNode:this.transformFunction.bind(this),CaseNode:this.transformCase.bind(this),WhenNode:this.transformWhen.bind(this),JSONReferenceNode:this.transformJSONReference.bind(this),JSONPathNode:this.transformJSONPath.bind(this),JSONPathLegNode:this.transformJSONPathLeg.bind(this),JSONOperatorChainNode:this.transformJSONOperatorChain.bind(this),TupleNode:this.transformTuple.bind(this),MergeQueryNode:this.transformMergeQuery.bind(this),MatchedNode:this.transformMatched.bind(this),AddIndexNode:this.transformAddIndex.bind(this),CastNode:this.transformCast.bind(this),FetchNode:this.transformFetch.bind(this),TopNode:this.transformTop.bind(this)});transformNode(e){if(!e)return e;this.nodeStack.push(e);const t=this.transformNodeImpl(e);return this.nodeStack.pop(),Ar(t)}transformNodeImpl(e){return this.#r[e.kind](e)}transformNodeList(e){return e?Ar(e.map((e=>this.transformNode(e)))):e}transformSelectQuery(e){return{kind:"SelectQueryNode",from:this.transformNode(e.from),selections:this.transformNodeList(e.selections),distinctOn:this.transformNodeList(e.distinctOn),joins:this.transformNodeList(e.joins),groupBy:this.transformNode(e.groupBy),orderBy:this.transformNode(e.orderBy),where:this.transformNode(e.where),frontModifiers:this.transformNodeList(e.frontModifiers),endModifiers:this.transformNodeList(e.endModifiers),limit:this.transformNode(e.limit),offset:this.transformNode(e.offset),with:this.transformNode(e.with),having:this.transformNode(e.having),explain:this.transformNode(e.explain),setOperations:this.transformNodeList(e.setOperations),fetch:this.transformNode(e.fetch),top:this.transformNode(e.top)}}transformSelection(e){return{kind:"SelectionNode",selection:this.transformNode(e.selection)}}transformColumn(e){return{kind:"ColumnNode",column:this.transformNode(e.column)}}transformAlias(e){return{kind:"AliasNode",node:this.transformNode(e.node),alias:this.transformNode(e.alias)}}transformTable(e){return{kind:"TableNode",table:this.transformNode(e.table)}}transformFrom(e){return{kind:"FromNode",froms:this.transformNodeList(e.froms)}}transformReference(e){return{kind:"ReferenceNode",column:this.transformNode(e.column),table:this.transformNode(e.table)}}transformAnd(e){return{kind:"AndNode",left:this.transformNode(e.left),right:this.transformNode(e.right)}}transformOr(e){return{kind:"OrNode",left:this.transformNode(e.left),right:this.transformNode(e.right)}}transformValueList(e){return{kind:"ValueListNode",values:this.transformNodeList(e.values)}}transformParens(e){return{kind:"ParensNode",node:this.transformNode(e.node)}}transformJoin(e){return{kind:"JoinNode",joinType:e.joinType,table:this.transformNode(e.table),on:this.transformNode(e.on)}}transformRaw(e){return{kind:"RawNode",sqlFragments:Ar([...e.sqlFragments]),parameters:this.transformNodeList(e.parameters)}}transformWhere(e){return{kind:"WhereNode",where:this.transformNode(e.where)}}transformInsertQuery(e){return{kind:"InsertQueryNode",into:this.transformNode(e.into),columns:this.transformNodeList(e.columns),values:this.transformNode(e.values),returning:this.transformNode(e.returning),onConflict:this.transformNode(e.onConflict),onDuplicateKey:this.transformNode(e.onDuplicateKey),with:this.transformNode(e.with),ignore:e.ignore,replace:e.replace,explain:this.transformNode(e.explain),defaultValues:e.defaultValues,top:this.transformNode(e.top)}}transformValues(e){return{kind:"ValuesNode",values:this.transformNodeList(e.values)}}transformDeleteQuery(e){return{kind:"DeleteQueryNode",from:this.transformNode(e.from),using:this.transformNode(e.using),joins:this.transformNodeList(e.joins),where:this.transformNode(e.where),returning:this.transformNode(e.returning),with:this.transformNode(e.with),orderBy:this.transformNode(e.orderBy),limit:this.transformNode(e.limit),explain:this.transformNode(e.explain),top:this.transformNode(e.top)}}transformReturning(e){return{kind:"ReturningNode",selections:this.transformNodeList(e.selections)}}transformCreateTable(e){return{kind:"CreateTableNode",table:this.transformNode(e.table),columns:this.transformNodeList(e.columns),constraints:this.transformNodeList(e.constraints),temporary:e.temporary,ifNotExists:e.ifNotExists,onCommit:e.onCommit,frontModifiers:this.transformNodeList(e.frontModifiers),endModifiers:this.transformNodeList(e.endModifiers),selectQuery:this.transformNode(e.selectQuery)}}transformColumnDefinition(e){return{kind:"ColumnDefinitionNode",column:this.transformNode(e.column),dataType:this.transformNode(e.dataType),references:this.transformNode(e.references),primaryKey:e.primaryKey,autoIncrement:e.autoIncrement,unique:e.unique,notNull:e.notNull,unsigned:e.unsigned,defaultTo:this.transformNode(e.defaultTo),check:this.transformNode(e.check),generated:this.transformNode(e.generated),frontModifiers:this.transformNodeList(e.frontModifiers),endModifiers:this.transformNodeList(e.endModifiers),nullsNotDistinct:e.nullsNotDistinct,identity:e.identity}}transformAddColumn(e){return{kind:"AddColumnNode",column:this.transformNode(e.column)}}transformDropTable(e){return{kind:"DropTableNode",table:this.transformNode(e.table),ifExists:e.ifExists,cascade:e.cascade}}transformOrderBy(e){return{kind:"OrderByNode",items:this.transformNodeList(e.items)}}transformOrderByItem(e){return{kind:"OrderByItemNode",orderBy:this.transformNode(e.orderBy),direction:this.transformNode(e.direction)}}transformGroupBy(e){return{kind:"GroupByNode",items:this.transformNodeList(e.items)}}transformGroupByItem(e){return{kind:"GroupByItemNode",groupBy:this.transformNode(e.groupBy)}}transformUpdateQuery(e){return{kind:"UpdateQueryNode",table:this.transformNode(e.table),from:this.transformNode(e.from),joins:this.transformNodeList(e.joins),where:this.transformNode(e.where),updates:this.transformNodeList(e.updates),returning:this.transformNode(e.returning),with:this.transformNode(e.with),explain:this.transformNode(e.explain),limit:this.transformNode(e.limit),top:this.transformNode(e.top)}}transformColumnUpdate(e){return{kind:"ColumnUpdateNode",column:this.transformNode(e.column),value:this.transformNode(e.value)}}transformLimit(e){return{kind:"LimitNode",limit:this.transformNode(e.limit)}}transformOffset(e){return{kind:"OffsetNode",offset:this.transformNode(e.offset)}}transformOnConflict(e){return{kind:"OnConflictNode",columns:this.transformNodeList(e.columns),constraint:this.transformNode(e.constraint),indexExpression:this.transformNode(e.indexExpression),indexWhere:this.transformNode(e.indexWhere),updates:this.transformNodeList(e.updates),updateWhere:this.transformNode(e.updateWhere),doNothing:e.doNothing}}transformOnDuplicateKey(e){return{kind:"OnDuplicateKeyNode",updates:this.transformNodeList(e.updates)}}transformCreateIndex(e){return{kind:"CreateIndexNode",name:this.transformNode(e.name),table:this.transformNode(e.table),columns:this.transformNodeList(e.columns),unique:e.unique,using:this.transformNode(e.using),ifNotExists:e.ifNotExists,where:this.transformNode(e.where),nullsNotDistinct:e.nullsNotDistinct}}transformList(e){return{kind:"ListNode",items:this.transformNodeList(e.items)}}transformDropIndex(e){return{kind:"DropIndexNode",name:this.transformNode(e.name),table:this.transformNode(e.table),ifExists:e.ifExists,cascade:e.cascade}}transformPrimaryKeyConstraint(e){return{kind:"PrimaryKeyConstraintNode",columns:this.transformNodeList(e.columns),name:this.transformNode(e.name)}}transformUniqueConstraint(e){return{kind:"UniqueConstraintNode",columns:this.transformNodeList(e.columns),name:this.transformNode(e.name),nullsNotDistinct:e.nullsNotDistinct}}transformForeignKeyConstraint(e){return{kind:"ForeignKeyConstraintNode",columns:this.transformNodeList(e.columns),references:this.transformNode(e.references),name:this.transformNode(e.name),onDelete:e.onDelete,onUpdate:e.onUpdate}}transformSetOperation(e){return{kind:"SetOperationNode",operator:e.operator,expression:this.transformNode(e.expression),all:e.all}}transformReferences(e){return{kind:"ReferencesNode",table:this.transformNode(e.table),columns:this.transformNodeList(e.columns),onDelete:e.onDelete,onUpdate:e.onUpdate}}transformCheckConstraint(e){return{kind:"CheckConstraintNode",expression:this.transformNode(e.expression),name:this.transformNode(e.name)}}transformWith(e){return{kind:"WithNode",expressions:this.transformNodeList(e.expressions),recursive:e.recursive}}transformCommonTableExpression(e){return{kind:"CommonTableExpressionNode",name:this.transformNode(e.name),materialized:e.materialized,expression:this.transformNode(e.expression)}}transformCommonTableExpressionName(e){return{kind:"CommonTableExpressionNameNode",table:this.transformNode(e.table),columns:this.transformNodeList(e.columns)}}transformHaving(e){return{kind:"HavingNode",having:this.transformNode(e.having)}}transformCreateSchema(e){return{kind:"CreateSchemaNode",schema:this.transformNode(e.schema),ifNotExists:e.ifNotExists}}transformDropSchema(e){return{kind:"DropSchemaNode",schema:this.transformNode(e.schema),ifExists:e.ifExists,cascade:e.cascade}}transformAlterTable(e){return{kind:"AlterTableNode",table:this.transformNode(e.table),renameTo:this.transformNode(e.renameTo),setSchema:this.transformNode(e.setSchema),columnAlterations:this.transformNodeList(e.columnAlterations),addConstraint:this.transformNode(e.addConstraint),dropConstraint:this.transformNode(e.dropConstraint),addIndex:this.transformNode(e.addIndex),dropIndex:this.transformNode(e.dropIndex)}}transformDropColumn(e){return{kind:"DropColumnNode",column:this.transformNode(e.column)}}transformRenameColumn(e){return{kind:"RenameColumnNode",column:this.transformNode(e.column),renameTo:this.transformNode(e.renameTo)}}transformAlterColumn(e){return{kind:"AlterColumnNode",column:this.transformNode(e.column),dataType:this.transformNode(e.dataType),dataTypeExpression:this.transformNode(e.dataTypeExpression),setDefault:this.transformNode(e.setDefault),dropDefault:e.dropDefault,setNotNull:e.setNotNull,dropNotNull:e.dropNotNull}}transformModifyColumn(e){return{kind:"ModifyColumnNode",column:this.transformNode(e.column)}}transformAddConstraint(e){return{kind:"AddConstraintNode",constraint:this.transformNode(e.constraint)}}transformDropConstraint(e){return{kind:"DropConstraintNode",constraintName:this.transformNode(e.constraintName),ifExists:e.ifExists,modifier:e.modifier}}transformCreateView(e){return{kind:"CreateViewNode",name:this.transformNode(e.name),temporary:e.temporary,orReplace:e.orReplace,ifNotExists:e.ifNotExists,materialized:e.materialized,columns:this.transformNodeList(e.columns),as:this.transformNode(e.as)}}transformDropView(e){return{kind:"DropViewNode",name:this.transformNode(e.name),ifExists:e.ifExists,materialized:e.materialized,cascade:e.cascade}}transformGenerated(e){return{kind:"GeneratedNode",byDefault:e.byDefault,always:e.always,identity:e.identity,stored:e.stored,expression:this.transformNode(e.expression)}}transformDefaultValue(e){return{kind:"DefaultValueNode",defaultValue:this.transformNode(e.defaultValue)}}transformOn(e){return{kind:"OnNode",on:this.transformNode(e.on)}}transformSelectModifier(e){return{kind:"SelectModifierNode",modifier:e.modifier,rawModifier:this.transformNode(e.rawModifier),of:this.transformNodeList(e.of)}}transformCreateType(e){return{kind:"CreateTypeNode",name:this.transformNode(e.name),enum:this.transformNode(e.enum)}}transformDropType(e){return{kind:"DropTypeNode",name:this.transformNode(e.name),ifExists:e.ifExists}}transformExplain(e){return{kind:"ExplainNode",format:e.format,options:this.transformNode(e.options)}}transformSchemableIdentifier(e){return{kind:"SchemableIdentifierNode",schema:this.transformNode(e.schema),identifier:this.transformNode(e.identifier)}}transformAggregateFunction(e){return{kind:"AggregateFunctionNode",aggregated:this.transformNodeList(e.aggregated),distinct:e.distinct,filter:this.transformNode(e.filter),func:e.func,over:this.transformNode(e.over)}}transformOver(e){return{kind:"OverNode",orderBy:this.transformNode(e.orderBy),partitionBy:this.transformNode(e.partitionBy)}}transformPartitionBy(e){return{kind:"PartitionByNode",items:this.transformNodeList(e.items)}}transformPartitionByItem(e){return{kind:"PartitionByItemNode",partitionBy:this.transformNode(e.partitionBy)}}transformBinaryOperation(e){return{kind:"BinaryOperationNode",leftOperand:this.transformNode(e.leftOperand),operator:this.transformNode(e.operator),rightOperand:this.transformNode(e.rightOperand)}}transformUnaryOperation(e){return{kind:"UnaryOperationNode",operator:this.transformNode(e.operator),operand:this.transformNode(e.operand)}}transformUsing(e){return{kind:"UsingNode",tables:this.transformNodeList(e.tables)}}transformFunction(e){return{kind:"FunctionNode",func:e.func,arguments:this.transformNodeList(e.arguments)}}transformCase(e){return{kind:"CaseNode",value:this.transformNode(e.value),when:this.transformNodeList(e.when),else:this.transformNode(e.else),isStatement:e.isStatement}}transformWhen(e){return{kind:"WhenNode",condition:this.transformNode(e.condition),result:this.transformNode(e.result)}}transformJSONReference(e){return{kind:"JSONReferenceNode",reference:this.transformNode(e.reference),traversal:this.transformNode(e.traversal)}}transformJSONPath(e){return{kind:"JSONPathNode",inOperator:this.transformNode(e.inOperator),pathLegs:this.transformNodeList(e.pathLegs)}}transformJSONPathLeg(e){return{kind:"JSONPathLegNode",type:e.type,value:e.value}}transformJSONOperatorChain(e){return{kind:"JSONOperatorChainNode",operator:this.transformNode(e.operator),values:this.transformNodeList(e.values)}}transformTuple(e){return{kind:"TupleNode",values:this.transformNodeList(e.values)}}transformMergeQuery(e){return{kind:"MergeQueryNode",into:this.transformNode(e.into),using:this.transformNode(e.using),whens:this.transformNodeList(e.whens),with:this.transformNode(e.with),top:this.transformNode(e.top)}}transformMatched(e){return{kind:"MatchedNode",not:e.not,bySource:e.bySource}}transformAddIndex(e){return{kind:"AddIndexNode",name:this.transformNode(e.name),columns:this.transformNodeList(e.columns),unique:e.unique,using:this.transformNode(e.using),ifNotExists:e.ifNotExists}}transformCast(e){return{kind:"CastNode",expression:this.transformNode(e.expression),dataType:this.transformNode(e.dataType)}}transformFetch(e){return{kind:"FetchNode",rowCount:this.transformNode(e.rowCount),modifier:e.modifier}}transformTop(e){return{kind:"TopNode",expression:e.expression,modifiers:e.modifiers}}transformDataType(e){return e}transformSelectAll(e){return e}transformIdentifier(e){return e}transformValue(e){return e}transformPrimitiveValueList(e){return e}transformOperator(e){return e}transformDefaultInsertValue(e){return e}}const Zo=Ar({AlterTableNode:!0,CreateIndexNode:!0,CreateSchemaNode:!0,CreateTableNode:!0,CreateTypeNode:!0,CreateViewNode:!0,DeleteQueryNode:!0,DropIndexNode:!0,DropSchemaNode:!0,DropTableNode:!0,DropTypeNode:!0,DropViewNode:!0,InsertQueryNode:!0,RawNode:!0,SelectQueryNode:!0,UpdateQueryNode:!0,MergeQueryNode:!0});class es extends Go{#i;#o=new Set;#s=new Set;constructor(e){super(),this.#i=e}transformNodeImpl(e){if(!this.#a(e))return super.transformNodeImpl(e);const t=this.#c(e);for(const e of t)this.#s.add(e);const n=this.#d(e);for(const e of n)this.#o.add(e);const r=super.transformNodeImpl(e);for(const e of n)this.#o.delete(e);for(const e of t)this.#s.delete(e);return r}transformSchemableIdentifier(e){const t=super.transformSchemableIdentifier(e);return t.schema||!this.#o.has(e.identifier.name)?t:{...t,schema:Fr.create(this.#i)}}transformReferences(e){const t=super.transformReferences(e);return t.table.table.schema?t:{...t,table:Yr.createWithSchema(this.#i,t.table.table.identifier.name)}}#a(e){return e.kind in Zo}#d(e){const t=new Set;if("name"in e&&e.name&&$r.is(e.name)&&this.#l(e.name,t),"from"in e&&e.from)for(const n of e.from.froms)this.#u(n,t);if("into"in e&&e.into&&this.#u(e.into,t),"table"in e&&e.table&&this.#u(e.table,t),"joins"in e&&e.joins)for(const n of e.joins)this.#u(n.table,t);return"using"in e&&e.using&&this.#u(e.using,t),t}#c(e){const t=new Set;return"with"in e&&e.with&&this.#p(e.with,t),t}#u(e,t){const n=Yr.is(e)?e:Hr.is(e)&&Yr.is(e.node)?e.node:null;n&&this.#l(n.table,t)}#l(e,t){const n=e.identifier.name;this.#o.has(n)||this.#s.has(n)||t.add(n)}#p(e,t){for(const n of e.expressions){const e=n.name.table.table.identifier.name;this.#s.has(e)||t.add(e)}}}class ts{#h;constructor(e){this.#h=new es(e)}transformQuery(e){return this.#h.transformNode(e.node)}async transformResult(e){return e.result}}const ns=Ar({is:e=>"MatchedNode"===e.kind,create:(e,t=!1)=>Ar({kind:"MatchedNode",not:e,bySource:t})});function rs(e,t,n){return vo.create($i([ns.create(!e.isMatched,e.bySource),...t&&t.length>0?[3===t.length&&n?ji(t[0],t[1],t[2]):Ri(t)]:[]],"and",!1))}function is(e){return Or(e)?yi.create([e],[]):Vr(e)?e.toOperationNode():e}class os{#f;#m;#y;constructor(){this.#f=new Promise(((e,t)=>{this.#y=t,this.#m=e}))}get promise(){return this.#f}resolve=e=>{this.#m&&this.#m(e)};reject=e=>{this.#y&&this.#y(e)}}const ss=new Set;const as=Ar([]);class cs{#g;constructor(e=as){this.#g=e}get plugins(){return this.#g}transformQuery(e,t){for(const n of this.#g){const r=n.transformQuery({node:e,queryId:t});if(r.kind!==e.kind)throw new Error(["KyselyPlugin.transformQuery must return a node","of the same kind that was given to it.",`The plugin was given a ${e.kind}`,`but it returned a ${r.kind}`].join(" "));e=r}return e}async executeQuery(e,t){return await this.provideConnection((async n=>{const r=await n.executeQuery(e),i=await this.#w(r,t);return function(e,t){const{numAffectedRows:n}=e;if(void 0===n&&void 0===e.numUpdatedOrDeletedRows||void 0!==n&&void 0!==t.numAffectedRows)return;r="kysely:warning: outdated driver/plugin detected! QueryResult.numUpdatedOrDeletedRows is deprecated and will be removed in a future release.",ss.has(r)||ss.add(r);var r}(r,i),i}))}async*stream(e,t,n){const r=new os,i=new os;this.provideConnection((async e=>(r.resolve(e),await i.promise))).catch((e=>r.reject(e)));const o=await r.promise;try{for await(const r of o.streamQuery(e,t))yield await this.#w(r,n)}finally{i.resolve()}}async#w(e,t){for(const n of this.#g)e=await n.transformResult({result:e,queryId:t});return e}}class ds extends cs{get adapter(){throw new Error("this query cannot be compiled to SQL")}compileQuery(){throw new Error("this query cannot be compiled to SQL")}provideConnection(){throw new Error("this query cannot be executed")}withConnectionProvider(){throw new Error("this query cannot have a connection provider")}withPlugin(e){return new ds([...this.plugins,e])}withPlugins(e){return new ds([...this.plugins,...e])}withPluginAtFront(e){return new ds([e,...this.plugins])}withoutPlugins(){return new ds([])}}const ls=new ds;class us{numChangedRows;constructor(e){this.numChangedRows=e}}class ps{#t;constructor(e){this.#t=Ar(e)}top(e,t){return new ps({...this.#t,queryNode:ko.cloneWithTop(this.#t.queryNode,Po(e,t))})}using(...e){return new hs({...this.#t,queryNode:xo.cloneWithUsing(this.#t.queryNode,gs("Using",e))})}}zi(ps,"don't await MergeQueryBuilder instances directly. To execute the query you need to call `execute` when available.");class hs{#t;constructor(e){this.#t=Ar(e)}top(e,t){return new hs({...this.#t,queryNode:ko.cloneWithTop(this.#t.queryNode,Po(e,t))})}whenMatched(){return this.#N([])}whenMatchedAnd(...e){return this.#N(e)}whenMatchedAndRef(e,t,n){return this.#N([e,t,n],!0)}#N(e,t){return new fs({...this.#t,queryNode:xo.cloneWithWhen(this.#t.queryNode,rs({isMatched:!0},e,t))})}whenNotMatched(){return this.#b([])}whenNotMatchedAnd(...e){return this.#b(e)}whenNotMatchedAndRef(e,t,n){return this.#b([e,t,n],!0)}whenNotMatchedBySource(){return this.#b([],!1,!0)}whenNotMatchedBySourceAnd(...e){return this.#b(e,!1,!0)}whenNotMatchedBySourceAndRef(e,t,n){return this.#b([e,t,n],!0,!0)}#b(e,t=!1,n=!1){const r={...this.#t,queryNode:xo.cloneWithWhen(this.#t.queryNode,rs({isMatched:!1,bySource:n},e,t))};return new(n?fs:ms)(r)}$call(e){return e(this)}$if(e,t){return e?t(this):new hs({...this.#t})}toOperationNode(){return this.#t.executor.transformQuery(this.#t.queryNode,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.#t.queryNode,this.#t.queryId)}async execute(){const e=this.compile(),t=await this.#t.executor.executeQuery(e,this.#t.queryId);return[new us(t.numAffectedRows)]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=To){const t=await this.executeTakeFirst();if(void 0===t){throw Eo(e)?new e(this.toOperationNode()):e(this.toOperationNode())}return t}}zi(hs,"don't await WheneableMergeQueryBuilder instances directly. To execute the query you need to call `execute`.");class fs{#t;constructor(e){this.#t=Ar(e)}thenDelete(){return new hs({...this.#t,queryNode:xo.cloneWithThen(this.#t.queryNode,is("delete"))})}thenDoNothing(){return new hs({...this.#t,queryNode:xo.cloneWithThen(this.#t.queryNode,is("do nothing"))})}thenUpdate(e){return new hs({...this.#t,queryNode:xo.cloneWithThen(this.#t.queryNode,is(e(new _o({queryId:this.#t.queryId,executor:ls,queryNode:mo.createWithoutTable()}))))})}thenUpdateSet(...e){return this.thenUpdate((t=>t.set(...e)))}}zi(fs,"don't await MatchedThenableMergeQueryBuilder instances directly. To execute the query you need to call `execute` when available.");class ms{#t;constructor(e){this.#t=Ar(e)}thenDoNothing(){return new hs({...this.#t,queryNode:xo.cloneWithThen(this.#t.queryNode,is("do nothing"))})}thenInsertValues(e){const[t,n]=co(e);return new hs({...this.#t,queryNode:xo.cloneWithThen(this.#t.queryNode,is(lo.cloneWith(lo.createWithoutInto(),{columns:t,values:n})))})}}zi(ms,"don't await NotMatchedThenableMergeQueryBuilder instances directly. To execute the query you need to call `execute` when available.");class ys{#t;constructor(e){this.#t=Ar(e)}selectFrom(e){return Es({queryId:zo(),executor:this.#t.executor,queryNode:fo.createFrom(oa(e),this.#t.withNode)})}selectNoFrom(e){return Es({queryId:zo(),executor:this.#t.executor,queryNode:fo.cloneWithSelections(fo.create(this.#t.withNode),no(e))})}insertInto(e){return new Mo({queryId:zo(),executor:this.#t.executor,queryNode:lo.create(ca(e),this.#t.withNode)})}replaceInto(e){return new Mo({queryId:zo(),executor:this.#t.executor,queryNode:lo.create(ca(e),this.#t.withNode,!0)})}deleteFrom(e){return new Uo({queryId:zo(),executor:this.#t.executor,queryNode:go.create(oa(e),this.#t.withNode)})}updateTable(e){return new _o({queryId:zo(),executor:this.#t.executor,queryNode:mo.create(sa(e),this.#t.withNode)})}mergeInto(e){return new ps({queryId:zo(),executor:this.#t.executor,queryNode:xo.create(aa(e),this.#t.withNode)})}with(e,t){const n=Ko(e,t);return new ys({...this.#t,withNode:this.#t.withNode?Yo.cloneWithExpression(this.#t.withNode,n):Yo.create(n)})}withRecursive(e,t){const n=Ko(e,t);return new ys({...this.#t,withNode:this.#t.withNode?Yo.cloneWithExpression(this.#t.withNode,n):Yo.create(n,{recursive:!0})})}withPlugin(e){return new ys({...this.#t,executor:this.#t.executor.withPlugin(e)})}withoutPlugins(){return new ys({...this.#t,executor:this.#t.executor.withoutPlugins()})}withSchema(e){return new ys({...this.#t,executor:this.#t.executor.withPluginAtFront(new ts(e))})}}function gs(e,t){if(3===t.length)return function(e,t,n,r){return ei.createWithOn(e,sa(t),ji(n,"=",r))}(e,t[0],t[1],t[2]);if(2===t.length)return function(e,t,n){return n(function(e,t){return new Xi({joinNode:ei.create(e,sa(t))})}(e,t)).toOperationNode()}(e,t[0],t[1]);throw new Error("not implemented")}const ws=Ar({is:e=>"OffsetNode"===e.kind,create:e=>Ar({kind:"OffsetNode",offset:e})}),Ns=Ar({is:e=>"GroupByItemNode"===e.kind,create:e=>Ar({kind:"GroupByItemNode",groupBy:e})});function bs(e){return Oi(e=Cr(e)?e(ta()):e).map(Ns.create)}const vs=Ar({is:e=>"SetOperationNode"===e.kind,create:(e,t,n)=>Ar({kind:"SetOperationNode",operator:e,expression:t,all:n})});function xs(e,t,n){return Cr(t)&&(t=t(ea())),Br(t)||(t=[t]),t.map((t=>vs.create(e,na(t),n)))}class ks{#v;constructor(e){this.#v=e}get expressionType(){}as(e){return new Ss(this,e)}or(...e){return new Os(Gr.create(this.#v,Ri(e)))}and(...e){return new Ws(Xr.create(this.#v,Ri(e)))}$castTo(){return new ks(this.#v)}$notNull(){return new ks(this.#v)}toOperationNode(){return this.#v}}class Ss{#x;#k;constructor(e,t){this.#x=e,this.#k=t}get expression(){return this.#x}get alias(){return this.#k}toOperationNode(){return Hr.create(this.#x.toOperationNode(),Vr(this.#k)?this.#k.toOperationNode():Fr.create(this.#k))}}class Os{#v;constructor(e){this.#v=e}get expressionType(){}as(e){return new Ss(this,e)}or(...e){return new Os(Gr.create(this.#v,Ri(e)))}$castTo(){return new Os(this.#v)}toOperationNode(){return Fi.create(this.#v)}}class Ws{#v;constructor(e){this.#v=e}get expressionType(){}as(e){return new Ss(this,e)}and(...e){return new Ws(Xr.create(this.#v,Ri(e)))}$castTo(){return new Ws(this.#v)}toOperationNode(){return Fi.create(this.#v)}}const Is={is:e=>"FetchNode"===e.kind,create:(e,t)=>({kind:"FetchNode",rowCount:Ai.create(e),modifier:t})};function qs(e,t){if(!Wr(e)&&!Er(e))throw new Error(`Invalid fetch row count: ${e}`);if("only"!==(n=t)&&"with ties"!==n)throw new Error(`Invalid fetch modifier: ${t}`);var n;return Is.create(e,t)}class Ts{#t;constructor(e){this.#t=Ar(e)}get expressionType(){}get isSelectQueryBuilder(){return!0}where(...e){return new Ts({...this.#t,queryNode:ko.cloneWithWhere(this.#t.queryNode,Ri(e))})}whereRef(e,t,n){return new Ts({...this.#t,queryNode:ko.cloneWithWhere(this.#t.queryNode,ji(e,t,n))})}having(...e){return new Ts({...this.#t,queryNode:fo.cloneWithHaving(this.#t.queryNode,Ri(e))})}havingRef(e,t,n){return new Ts({...this.#t,queryNode:fo.cloneWithHaving(this.#t.queryNode,ji(e,t,n))})}select(e){return new Ts({...this.#t,queryNode:fo.cloneWithSelections(this.#t.queryNode,no(e))})}distinctOn(e){return new Ts({...this.#t,queryNode:fo.cloneWithDistinctOn(this.#t.queryNode,Oi(e))})}modifyFront(e){return new Ts({...this.#t,queryNode:fo.cloneWithFrontModifier(this.#t.queryNode,zr.createWithExpression(e.toOperationNode()))})}modifyEnd(e){return new Ts({...this.#t,queryNode:fo.cloneWithEndModifier(this.#t.queryNode,zr.createWithExpression(e.toOperationNode()))})}distinct(){return new Ts({...this.#t,queryNode:fo.cloneWithFrontModifier(this.#t.queryNode,zr.create("Distinct"))})}forUpdate(e){return new Ts({...this.#t,queryNode:fo.cloneWithEndModifier(this.#t.queryNode,zr.create("ForUpdate",e?Dr(e).map(ca):void 0))})}forShare(e){return new Ts({...this.#t,queryNode:fo.cloneWithEndModifier(this.#t.queryNode,zr.create("ForShare",e?Dr(e).map(ca):void 0))})}forKeyShare(e){return new Ts({...this.#t,queryNode:fo.cloneWithEndModifier(this.#t.queryNode,zr.create("ForKeyShare",e?Dr(e).map(ca):void 0))})}forNoKeyUpdate(e){return new Ts({...this.#t,queryNode:fo.cloneWithEndModifier(this.#t.queryNode,zr.create("ForNoKeyUpdate",e?Dr(e).map(ca):void 0))})}skipLocked(){return new Ts({...this.#t,queryNode:fo.cloneWithEndModifier(this.#t.queryNode,zr.create("SkipLocked"))})}noWait(){return new Ts({...this.#t,queryNode:fo.cloneWithEndModifier(this.#t.queryNode,zr.create("NoWait"))})}selectAll(e){return new Ts({...this.#t,queryNode:fo.cloneWithSelections(this.#t.queryNode,io(e))})}innerJoin(...e){return new Ts({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("InnerJoin",e))})}leftJoin(...e){return new Ts({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("LeftJoin",e))})}rightJoin(...e){return new Ts({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("RightJoin",e))})}fullJoin(...e){return new Ts({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("FullJoin",e))})}innerJoinLateral(...e){return new Ts({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("LateralInnerJoin",e))})}leftJoinLateral(...e){return new Ts({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("LateralLeftJoin",e))})}orderBy(...e){return new Ts({...this.#t,queryNode:fo.cloneWithOrderByItems(this.#t.queryNode,wi(e))})}groupBy(e){return new Ts({...this.#t,queryNode:fo.cloneWithGroupByItems(this.#t.queryNode,bs(e))})}limit(e){return new Ts({...this.#t,queryNode:fo.cloneWithLimit(this.#t.queryNode,Ro.create(Bi(e)))})}offset(e){return new Ts({...this.#t,queryNode:fo.cloneWithOffset(this.#t.queryNode,ws.create(Bi(e)))})}fetch(e,t="only"){return new Ts({...this.#t,queryNode:fo.cloneWithFetch(this.#t.queryNode,qs(e,t))})}top(e,t){return new Ts({...this.#t,queryNode:ko.cloneWithTop(this.#t.queryNode,Po(e,t))})}union(e){return new Ts({...this.#t,queryNode:fo.cloneWithSetOperations(this.#t.queryNode,xs("union",e,!1))})}unionAll(e){return new Ts({...this.#t,queryNode:fo.cloneWithSetOperations(this.#t.queryNode,xs("union",e,!0))})}intersect(e){return new Ts({...this.#t,queryNode:fo.cloneWithSetOperations(this.#t.queryNode,xs("intersect",e,!1))})}intersectAll(e){return new Ts({...this.#t,queryNode:fo.cloneWithSetOperations(this.#t.queryNode,xs("intersect",e,!0))})}except(e){return new Ts({...this.#t,queryNode:fo.cloneWithSetOperations(this.#t.queryNode,xs("except",e,!1))})}exceptAll(e){return new Ts({...this.#t,queryNode:fo.cloneWithSetOperations(this.#t.queryNode,xs("except",e,!0))})}as(e){return new Cs(this,e)}clearSelect(){return new Ts({...this.#t,queryNode:fo.cloneWithoutSelections(this.#t.queryNode)})}clearWhere(){return new Ts({...this.#t,queryNode:ko.cloneWithoutWhere(this.#t.queryNode)})}clearLimit(){return new Ts({...this.#t,queryNode:fo.cloneWithoutLimit(this.#t.queryNode)})}clearOffset(){return new Ts({...this.#t,queryNode:fo.cloneWithoutOffset(this.#t.queryNode)})}clearOrderBy(){return new Ts({...this.#t,queryNode:fo.cloneWithoutOrderBy(this.#t.queryNode)})}$call(e){return e(this)}$if(e,t){return e?t(this):new Ts({...this.#t})}$castTo(){return new Ts(this.#t)}$narrowType(){return new Ts(this.#t)}$assertType(){return new Ts(this.#t)}$asTuple(){return new ks(this.toOperationNode())}withPlugin(e){return new Ts({...this.#t,executor:this.#t.executor.withPlugin(e)})}toOperationNode(){return this.#t.executor.transformQuery(this.#t.queryNode,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){const e=this.compile();return(await this.#t.executor.executeQuery(e,this.#t.queryId)).rows}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=To){const t=await this.executeTakeFirst();if(void 0===t){throw Eo(e)?new e(this.toOperationNode()):e(this.toOperationNode())}return t}async*stream(e=100){const t=this.compile(),n=this.#t.executor.stream(t,e,this.#t.queryId);for await(const e of n)yield*e.rows}async explain(e,t){const n=new Ts({...this.#t,queryNode:ko.cloneWithExplain(this.#t.queryNode,e,t)});return await n.execute()}}function Es(e){return new Ts(e)}zi(Ts,"don't await SelectQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");class Cs{#S;#k;constructor(e,t){this.#S=e,this.#k=t}get expression(){return this.#S}get alias(){return this.#k}get isAliasedSelectQueryBuilder(){return!0}toOperationNode(){return Hr.create(this.#S.toOperationNode(),Fr.create(this.#k))}}zi(Cs,"don't await AliasedSelectQueryBuilder instances directly. AliasedSelectQueryBuilder should never be executed directly since it's always a part of another query.");const Ls=Ar({is:e=>"AggregateFunctionNode"===e.kind,create:(e,t=[])=>Ar({kind:"AggregateFunctionNode",func:e,aggregated:t}),cloneWithDistinct:e=>Ar({...e,distinct:!0}),cloneWithFilter:(e,t)=>Ar({...e,filter:e.filter?wo.cloneWithOperation(e.filter,"And",t):wo.create(t)}),cloneWithOrFilter:(e,t)=>Ar({...e,filter:e.filter?wo.cloneWithOperation(e.filter,"Or",t):wo.create(t)}),cloneWithOver:(e,t)=>Ar({...e,over:t})}),As=Ar({is:e=>"FunctionNode"===e.kind,create:(e,t)=>Ar({kind:"FunctionNode",func:e,arguments:t})});class Ds{#t;constructor(e){this.#t=Ar(e)}get expressionType(){}as(e){return new Bs(this,e)}distinct(){return new Ds({...this.#t,aggregateFunctionNode:Ls.cloneWithDistinct(this.#t.aggregateFunctionNode)})}filterWhere(...e){return new Ds({...this.#t,aggregateFunctionNode:Ls.cloneWithFilter(this.#t.aggregateFunctionNode,Ri(e))})}filterWhereRef(e,t,n){return new Ds({...this.#t,aggregateFunctionNode:Ls.cloneWithFilter(this.#t.aggregateFunctionNode,ji(e,t,n))})}over(e){const t=new eo({overNode:Vi.create()});return new Ds({...this.#t,aggregateFunctionNode:Ls.cloneWithOver(this.#t.aggregateFunctionNode,(e?e(t):t).toOperationNode())})}$call(e){return e(this)}$castTo(){return new Ds(this.#t)}$notNull(){return new Ds(this.#t)}toOperationNode(){return this.#t.aggregateFunctionNode}}zi(Ds,"don't await AggregateFunctionBuilder instances. They are never executed directly and are always just a part of a query.");class Bs{#O;#k;constructor(e,t){this.#O=e,this.#k=t}get expression(){return this.#O}get alias(){return this.#k}toOperationNode(){return Hr.create(this.#O.toOperationNode(),Fr.create(this.#k))}}function Ps(){const e=(e,t)=>new ks(As.create(e,Oi(t??[]))),t=(e,t)=>new Ds({aggregateFunctionNode:Ls.create(e,t?Oi(t):void 0)});return Object.assign(e,{agg:t,avg:e=>t("avg",[e]),coalesce:(...t)=>e("coalesce",t),count:e=>t("count",[e]),countAll:e=>new Ds({aggregateFunctionNode:Ls.create("count",io(e))}),max:e=>t("max",[e]),min:e=>t("min",[e]),sum:e=>t("sum",[e]),any:t=>e("any",[t]),jsonAgg:e=>new Ds({aggregateFunctionNode:Ls.create("json_agg",[Or(e)?ca(e):e.toOperationNode()])}),toJson:e=>new ks(As.create("to_json",[Or(e)?ca(e):e.toOperationNode()]))})}const Ms=Ar({is:e=>"UnaryOperationNode"===e.kind,create:(e,t)=>Ar({kind:"UnaryOperationNode",operator:e,operand:t})});function Fs(e,t){return Ms.create(ci.create(e),Wi(t))}const Rs=Ar({is:e=>"CaseNode"===e.kind,create:e=>Ar({kind:"CaseNode",value:e}),cloneWithWhen:(e,t)=>Ar({...e,when:Ar(e.when?[...e.when,t]:[t])}),cloneWithThen:(e,t)=>Ar({...e,when:e.when?Ar([...e.when.slice(0,-1),vo.cloneWithResult(e.when[e.when.length-1],t)]):void 0}),cloneWith:(e,t)=>Ar({...e,...t})});class Us{#t;constructor(e){this.#t=Ar(e)}when(...e){return new js({...this.#t,node:Rs.cloneWithWhen(this.#t.node,vo.create(Ri(e)))})}}class js{#t;constructor(e){this.#t=Ar(e)}then(e){return new _s({...this.#t,node:Rs.cloneWithThen(this.#t.node,Pi(e)?Mi(e):Bi(e))})}}class _s{#t;constructor(e){this.#t=Ar(e)}when(...e){return new js({...this.#t,node:Rs.cloneWithWhen(this.#t.node,vo.create(Ri(e)))})}else(e){return new $s({...this.#t,node:Rs.cloneWith(this.#t.node,{else:Pi(e)?Mi(e):Bi(e)})})}end(){return new ks(Rs.cloneWith(this.#t.node,{isStatement:!1}))}endCase(){return new ks(Rs.cloneWith(this.#t.node,{isStatement:!0}))}}class $s{#t;constructor(e){this.#t=Ar(e)}end(){return new ks(Rs.cloneWith(this.#t.node,{isStatement:!1}))}endCase(){return new ks(Rs.cloneWith(this.#t.node,{isStatement:!0}))}}const Qs=Ar({is:e=>"JSONPathLegNode"===e.kind,create:(e,t)=>Ar({kind:"JSONPathLegNode",type:e,value:t})});class Js{#v;constructor(e){this.#v=e}at(e){return this.#W("ArrayLocation",e)}key(e){return this.#W("Member",e)}#W(e,t){return vi.is(this.#v)?new Ks(vi.cloneWithTraversal(this.#v,ki.is(this.#v.traversal)?ki.cloneWithLeg(this.#v.traversal,Qs.create(e,t)):xi.cloneWithValue(this.#v.traversal,Ai.createImmediate(t)))):new Ks(ki.cloneWithLeg(this.#v,Qs.create(e,t)))}}class Ks extends Js{#v;constructor(e){super(e),this.#v=e}get expressionType(){}as(e){return new Hs(this,e)}$castTo(){return new Js(this.#v)}$notNull(){return new Js(this.#v)}toOperationNode(){return this.#v}}class Hs{#I;#k;constructor(e,t){this.#I=e,this.#k=t}get expression(){return this.#I}get alias(){return this.#k}toOperationNode(){return Hr.create(this.#I.toOperationNode(),Vr(this.#k)?this.#k.toOperationNode():Fr.create(this.#k))}}const Ys=Ar({is:e=>"TupleNode"===e.kind,create:e=>Ar({kind:"TupleNode",values:Ar(e)})}),Vs=["varchar","char","text","integer","int2","int4","int8","smallint","bigint","boolean","real","double precision","float4","float8","decimal","numeric","binary","bytea","date","datetime","time","timetz","timestamp","timestamptz","serial","bigserial","uuid","json","jsonb","blob"],zs=[/^varchar\(\d+\)$/,/^char\(\d+\)$/,/^decimal\(\d+, \d+\)$/,/^numeric\(\d+, \d+\)$/,/^binary\(\d+\)$/,/^datetime\(\d+\)$/,/^time\(\d+\)$/,/^timez\(\d+\)$/,/^timestamp\(\d+\)$/,/^timestamptz\(\d+\)$/],Xs=Ar({is:e=>"DataTypeNode"===e.kind,create:e=>Ar({kind:"DataTypeNode",dataType:e})});function Gs(e){if(Vr(e))return e.toOperationNode();if(function(e){return!!Vs.includes(e)||!!zs.some((t=>t.test(e)))}(e))return Xs.create(e);throw new Error(`invalid column data type ${JSON.stringify(e)}`)}const Zs=Ar({is:e=>"CastNode"===e.kind,create:(e,t)=>Ar({kind:"CastNode",expression:e,dataType:t})});function ea(e=ls){function t(e,t){return new ks(Fs(e,t))}const n=Object.assign((function(e,t,n){return new ks(Ui(e,t,n))}),{fn:void 0,eb:void 0,selectFrom:t=>Es({queryId:zo(),executor:e,queryNode:fo.createFrom(oa(t))}),case:e=>new Us({node:Rs.create(Sr(e)?void 0:Wi(e))}),ref:(e,t)=>Sr(t)?new ks(Ii(e)):new Js(function(e,t){const n=Ii(e);if(di(t))return vi.create(n,xi.create(ci.create(t)));const r=t.slice(0,-1);if(di(r))return vi.create(n,ki.create(ci.create(r)));throw new Error(`Invalid JSON operator: ${t}`)}(e,t)),jsonPath:()=>new Js(ki.create()),table:e=>new ks(ca(e)),val:e=>new ks(Bi(e)),refTuple:(...e)=>new ks(Ys.create(e.map(Wi))),tuple:(...e)=>new ks(Ys.create(e.map(Bi))),lit:e=>new ks(Mi(e)),unary:t,not:e=>t("not",e),exists:e=>t("exists",e),neg:e=>t("-",e),between:(e,t,n)=>new ks(ti.create(Wi(e),ci.create("between"),Xr.create(Bi(t),Bi(n)))),betweenSymmetric:(e,t,n)=>new ks(ti.create(Wi(e),ci.create("between symmetric"),Xr.create(Bi(t),Bi(n)))),and:e=>Br(e)?new ks($i(e,"and")):new ks(_i(e,"and")),or:e=>Br(e)?new ks($i(e,"or")):new ks(_i(e,"or")),parens(...e){const t=Ri(e);return Fi.is(t)?new ks(t):new ks(Fi.create(t))},cast:(e,t)=>new ks(Zs.create(Wi(e),Gs(t))),withSchema:t=>ea(e.withPluginAtFront(new ts(t)))});return n.fn=Ps(),n.eb=n,n}function ta(e){return ea()}function na(e){if(Vr(e))return e.toOperationNode();if(Cr(e))return e(ta()).toOperationNode();throw new Error(`invalid expression: ${JSON.stringify(e)}`)}function ra(e){if(Vr(e))return e.toOperationNode();if(Cr(e))return e(ta()).toOperationNode();throw new Error(`invalid aliased expression: ${JSON.stringify(e)}`)}function ia(e){return function(e){return Lr(e)&&"expressionType"in e&&Vr(e)}(e)||function(e){return Lr(e)&&"expression"in e&&Or(e.alias)&&Vr(e)}(e)||Cr(e)}function oa(e){return Br(e)?e.map((e=>sa(e))):[sa(e)]}function sa(e){return Or(e)?aa(e):ra(e)}function aa(e){const t=" as ";if(e.includes(t)){const[n,r]=e.split(t).map(da);return Hr.create(ca(n),Fr.create(r))}return ca(e)}function ca(e){if(e.includes(".")){const[t,n]=e.split(".").map(da);return Yr.createWithSchema(t,n)}return Yr.create(e)}function da(e){return e.trim()}const la=Ar({is:e=>"AddColumnNode"===e.kind,create:e=>Ar({kind:"AddColumnNode",column:e})}),ua=Ar({is:e=>"ColumnDefinitionNode"===e.kind,create:(e,t)=>Ar({kind:"ColumnDefinitionNode",column:li.create(e),dataType:t}),cloneWithFrontModifier:(e,t)=>Ar({...e,frontModifiers:e.frontModifiers?Ar([...e.frontModifiers,t]):[t]}),cloneWithEndModifier:(e,t)=>Ar({...e,endModifiers:e.endModifiers?Ar([...e.endModifiers,t]):[t]}),cloneWith:(e,t)=>Ar({...e,...t})}),pa=Ar({is:e=>"DropColumnNode"===e.kind,create:e=>Ar({kind:"DropColumnNode",column:li.create(e)})}),ha=Ar({is:e=>"RenameColumnNode"===e.kind,create:(e,t)=>Ar({kind:"RenameColumnNode",column:li.create(e),renameTo:li.create(t)})}),fa=Ar({is:e=>"CheckConstraintNode"===e.kind,create:(e,t)=>Ar({kind:"CheckConstraintNode",expression:e,name:t?Fr.create(t):void 0})}),ma=["no action","restrict","cascade","set null","set default"],ya=Ar({is:e=>"ReferencesNode"===e.kind,create:(e,t)=>Ar({kind:"ReferencesNode",table:e,columns:Ar([...t])}),cloneWithOnDelete:(e,t)=>Ar({...e,onDelete:t}),cloneWithOnUpdate:(e,t)=>Ar({...e,onUpdate:t})});function ga(e){return Vr(e)?e.toOperationNode():Ai.createImmediate(e)}const wa=Ar({is:e=>"GeneratedNode"===e.kind,create:e=>Ar({kind:"GeneratedNode",...e}),createWithExpression:e=>Ar({kind:"GeneratedNode",always:!0,expression:e}),cloneWith:(e,t)=>Ar({...e,...t})}),Na=Ar({is:e=>"DefaultValueNode"===e.kind,create:e=>Ar({kind:"DefaultValueNode",defaultValue:e})});function ba(e){if(ma.includes(e))return e;throw new Error(`invalid OnModifyForeignAction ${e}`)}class va{#v;constructor(e){this.#v=e}autoIncrement(){return new va(ua.cloneWith(this.#v,{autoIncrement:!0}))}identity(){return new va(ua.cloneWith(this.#v,{identity:!0}))}primaryKey(){return new va(ua.cloneWith(this.#v,{primaryKey:!0}))}references(e){const t=Ii(e);if(!t.table||ui.is(t.column))throw new Error(`invalid call references('${e}'). The reference must have format table.column or schema.table.column`);return new va(ua.cloneWith(this.#v,{references:ya.create(t.table,[t.column])}))}onDelete(e){if(!this.#v.references)throw new Error("on delete constraint can only be added for foreign keys");return new va(ua.cloneWith(this.#v,{references:ya.cloneWithOnDelete(this.#v.references,ba(e))}))}onUpdate(e){if(!this.#v.references)throw new Error("on update constraint can only be added for foreign keys");return new va(ua.cloneWith(this.#v,{references:ya.cloneWithOnUpdate(this.#v.references,ba(e))}))}unique(){return new va(ua.cloneWith(this.#v,{unique:!0}))}notNull(){return new va(ua.cloneWith(this.#v,{notNull:!0}))}unsigned(){return new va(ua.cloneWith(this.#v,{unsigned:!0}))}defaultTo(e){return new va(ua.cloneWith(this.#v,{defaultTo:Na.create(ga(e))}))}check(e){return new va(ua.cloneWith(this.#v,{check:fa.create(e.toOperationNode())}))}generatedAlwaysAs(e){return new va(ua.cloneWith(this.#v,{generated:wa.createWithExpression(e.toOperationNode())}))}generatedAlwaysAsIdentity(){return new va(ua.cloneWith(this.#v,{generated:wa.create({identity:!0,always:!0})}))}generatedByDefaultAsIdentity(){return new va(ua.cloneWith(this.#v,{generated:wa.create({identity:!0,byDefault:!0})}))}stored(){if(!this.#v.generated)throw new Error("stored() can only be called after generatedAlwaysAs");return new va(ua.cloneWith(this.#v,{generated:wa.cloneWith(this.#v.generated,{stored:!0})}))}modifyFront(e){return new va(ua.cloneWithFrontModifier(this.#v,e.toOperationNode()))}nullsNotDistinct(){return new va(ua.cloneWith(this.#v,{nullsNotDistinct:!0}))}modifyEnd(e){return new va(ua.cloneWithEndModifier(this.#v,e.toOperationNode()))}$call(e){return e(this)}toOperationNode(){return this.#v}}zi(va,"don't await ColumnDefinitionBuilder instances directly.");const xa=Ar({is:e=>"ModifyColumnNode"===e.kind,create:e=>Ar({kind:"ModifyColumnNode",column:e})}),ka=Ar({is:e=>"ForeignKeyConstraintNode"===e.kind,create:(e,t,n,r)=>Ar({kind:"ForeignKeyConstraintNode",columns:e,references:ya.create(t,n),name:r?Fr.create(r):void 0}),cloneWith:(e,t)=>Ar({...e,...t})});class Sa{#v;constructor(e){this.#v=e}onDelete(e){return new Sa(ka.cloneWith(this.#v,{onDelete:ba(e)}))}onUpdate(e){return new Sa(ka.cloneWith(this.#v,{onUpdate:ba(e)}))}$call(e){return e(this)}toOperationNode(){return this.#v}}zi(Sa,"don't await ForeignKeyConstraintBuilder instances directly.");const Oa=Ar({is:e=>"AddConstraintNode"===e.kind,create:e=>Ar({kind:"AddConstraintNode",constraint:e})}),Wa=Ar({is:e=>"UniqueConstraintNode"===e.kind,create:(e,t,n)=>Ar({kind:"UniqueConstraintNode",columns:Ar(e.map(li.create)),name:t?Fr.create(t):void 0,nullsNotDistinct:n}),cloneWith:(e,t)=>Ar({...e,...t})}),Ia=Ar({is:e=>"DropConstraintNode"===e.kind,create:e=>Ar({kind:"DropConstraintNode",constraintName:Fr.create(e)}),cloneWith:(e,t)=>Ar({...e,...t})}),qa=Ar({is:e=>"AlterColumnNode"===e.kind,create:(e,t,n)=>Ar({kind:"AlterColumnNode",column:li.create(e),[t]:n})});class Ta{#q;constructor(e){this.#q=e}setDataType(e){return new Ea(qa.create(this.#q,"dataType",Gs(e)))}setDefault(e){return new Ea(qa.create(this.#q,"setDefault",ga(e)))}dropDefault(){return new Ea(qa.create(this.#q,"dropDefault",!0))}setNotNull(){return new Ea(qa.create(this.#q,"setNotNull",!0))}dropNotNull(){return new Ea(qa.create(this.#q,"dropNotNull",!0))}$call(e){return e(this)}}class Ea{#T;constructor(e){this.#T=e}toOperationNode(){return this.#T}}class Ca{#t;constructor(e){this.#t=Ar(e)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}zi(Ca,"don't await AlterTableExecutor instances directly. To execute the query you need to call `execute`");class La{#t;constructor(e){this.#t=Ar(e)}onDelete(e){return new La({...this.#t,constraintBuilder:this.#t.constraintBuilder.onDelete(e)})}onUpdate(e){return new La({...this.#t,constraintBuilder:this.#t.constraintBuilder.onUpdate(e)})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(Mr.cloneWithTableProps(this.#t.node,{addConstraint:Oa.create(this.#t.constraintBuilder.toOperationNode())}),this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}zi(La,"don't await AlterTableAddForeignKeyConstraintBuilder instances directly. To execute the query you need to call `execute`");class Aa{#t;constructor(e){this.#t=Ar(e)}ifExists(){return new Aa({...this.#t,node:Mr.cloneWithTableProps(this.#t.node,{dropConstraint:Ia.cloneWith(this.#t.node.dropConstraint,{ifExists:!0})})})}cascade(){return new Aa({...this.#t,node:Mr.cloneWithTableProps(this.#t.node,{dropConstraint:Ia.cloneWith(this.#t.node.dropConstraint,{modifier:"cascade"})})})}restrict(){return new Aa({...this.#t,node:Mr.cloneWithTableProps(this.#t.node,{dropConstraint:Ia.cloneWith(this.#t.node.dropConstraint,{modifier:"restrict"})})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}zi(Aa,"don't await AlterTableDropConstraintBuilder instances directly. To execute the query you need to call `execute`");const Da=Ar({is:e=>"PrimaryKeyConstraintNode"===e.kind,create:(e,t)=>Ar({kind:"PrimaryKeyConstraintNode",columns:Ar(e.map(li.create)),name:t?Fr.create(t):void 0})}),Ba=Ar({is:e=>"AddIndexNode"===e.kind,create:e=>Ar({kind:"AddIndexNode",name:Fr.create(e)}),cloneWith:(e,t)=>Ar({...e,...t}),cloneWithColumns:(e,t)=>Ar({...e,columns:[...e.columns||[],...t]})});class Pa{#t;constructor(e){this.#t=Ar(e)}unique(){return new Pa({...this.#t,node:Mr.cloneWithTableProps(this.#t.node,{addIndex:Ba.cloneWith(this.#t.node.addIndex,{unique:!0})})})}column(e){return new Pa({...this.#t,node:Mr.cloneWithTableProps(this.#t.node,{addIndex:Ba.cloneWithColumns(this.#t.node.addIndex,[Ti(e)])})})}columns(e){return new Pa({...this.#t,node:Mr.cloneWithTableProps(this.#t.node,{addIndex:Ba.cloneWithColumns(this.#t.node.addIndex,e.map(Ti))})})}expression(e){return new Pa({...this.#t,node:Mr.cloneWithTableProps(this.#t.node,{addIndex:Ba.cloneWithColumns(this.#t.node.addIndex,[e.toOperationNode()])})})}using(e){return new Pa({...this.#t,node:Mr.cloneWithTableProps(this.#t.node,{addIndex:Ba.cloneWith(this.#t.node.addIndex,{using:yi.createWithSql(e)})})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}zi(Pa,"don't await AlterTableAddIndexBuilder instances directly. To execute the query you need to call `execute`");class Ma{#v;constructor(e){this.#v=e}toOperationNode(){return this.#v}nullsNotDistinct(){return new Ma(Wa.cloneWith(this.#v,{nullsNotDistinct:!0}))}}zi(Ma,"don't await UniqueConstraintNodeBuilder instances directly.");class Fa{#t;constructor(e){this.#t=Ar(e)}renameTo(e){return new Ca({...this.#t,node:Mr.cloneWithTableProps(this.#t.node,{renameTo:ca(e)})})}setSchema(e){return new Ca({...this.#t,node:Mr.cloneWithTableProps(this.#t.node,{setSchema:Fr.create(e)})})}alterColumn(e,t){const n=t(new Ta(e));return new Ra({...this.#t,node:Mr.cloneWithColumnAlteration(this.#t.node,n.toOperationNode())})}dropColumn(e){return new Ra({...this.#t,node:Mr.cloneWithColumnAlteration(this.#t.node,pa.create(e))})}renameColumn(e,t){return new Ra({...this.#t,node:Mr.cloneWithColumnAlteration(this.#t.node,ha.create(e,t))})}addColumn(e,t,n=Pr){const r=n(new va(ua.create(e,Gs(t))));return new Ra({...this.#t,node:Mr.cloneWithColumnAlteration(this.#t.node,la.create(r.toOperationNode()))})}modifyColumn(e,t,n=Pr){const r=n(new va(ua.create(e,Gs(t))));return new Ra({...this.#t,node:Mr.cloneWithColumnAlteration(this.#t.node,xa.create(r.toOperationNode()))})}addUniqueConstraint(e,t,n=Pr){const r=n(new Ma(Wa.create(t,e)));return new Ca({...this.#t,node:Mr.cloneWithTableProps(this.#t.node,{addConstraint:Oa.create(r.toOperationNode())})})}addCheckConstraint(e,t){return new Ca({...this.#t,node:Mr.cloneWithTableProps(this.#t.node,{addConstraint:Oa.create(fa.create(t.toOperationNode(),e))})})}addForeignKeyConstraint(e,t,n,r){return new La({...this.#t,constraintBuilder:new Sa(ka.create(t.map(li.create),ca(n),r.map(li.create),e))})}addPrimaryKeyConstraint(e,t){return new Ca({...this.#t,node:Mr.cloneWithTableProps(this.#t.node,{addConstraint:Oa.create(Da.create(t,e))})})}dropConstraint(e){return new Aa({...this.#t,node:Mr.cloneWithTableProps(this.#t.node,{dropConstraint:Ia.create(e)})})}addIndex(e){return new Pa({...this.#t,node:Mr.cloneWithTableProps(this.#t.node,{addIndex:Ba.create(e)})})}dropIndex(e){return new Ca({...this.#t,node:Mr.cloneWithTableProps(this.#t.node,{dropIndex:Qr.create(e)})})}$call(e){return e(this)}}class Ra{#t;constructor(e){this.#t=Ar(e)}alterColumn(e,t){const n=t(new Ta(e));return new Ra({...this.#t,node:Mr.cloneWithColumnAlteration(this.#t.node,n.toOperationNode())})}dropColumn(e){return new Ra({...this.#t,node:Mr.cloneWithColumnAlteration(this.#t.node,pa.create(e))})}renameColumn(e,t){return new Ra({...this.#t,node:Mr.cloneWithColumnAlteration(this.#t.node,ha.create(e,t))})}addColumn(e,t,n=Pr){const r=n(new va(ua.create(e,Gs(t))));return new Ra({...this.#t,node:Mr.cloneWithColumnAlteration(this.#t.node,la.create(r.toOperationNode()))})}modifyColumn(e,t,n=Pr){const r=n(new va(ua.create(e,Gs(t))));return new Ra({...this.#t,node:Mr.cloneWithColumnAlteration(this.#t.node,xa.create(r.toOperationNode()))})}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}zi(Fa,"don't await AlterTableBuilder instances"),zi(Ta,"don't await AlterColumnBuilder instances"),zi(Ra,"don't await AlterTableColumnAlteringBuilder instances directly. To execute the query you need to call `execute`");class Ua extends Go{transformValue(e){return{...super.transformValue(e),immediate:!0}}}class ja{#t;constructor(e){this.#t=Ar(e)}ifNotExists(){return new ja({...this.#t,node:Rr.cloneWith(this.#t.node,{ifNotExists:!0})})}unique(){return new ja({...this.#t,node:Rr.cloneWith(this.#t.node,{unique:!0})})}nullsNotDistinct(){return new ja({...this.#t,node:Rr.cloneWith(this.#t.node,{nullsNotDistinct:!0})})}on(e){return new ja({...this.#t,node:Rr.cloneWith(this.#t.node,{table:ca(e)})})}column(e){return new ja({...this.#t,node:Rr.cloneWithColumns(this.#t.node,[Ti(e)])})}columns(e){return new ja({...this.#t,node:Rr.cloneWithColumns(this.#t.node,e.map(Ti))})}expression(e){return new ja({...this.#t,node:Rr.cloneWithColumns(this.#t.node,[e.toOperationNode()])})}using(e){return new ja({...this.#t,node:Rr.cloneWith(this.#t.node,{using:yi.createWithSql(e)})})}where(...e){const t=new Ua;return new ja({...this.#t,node:ko.cloneWithWhere(this.#t.node,t.transformNode(Ri(e)))})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}zi(ja,"don't await CreateIndexBuilder instances directly. To execute the query you need to call `execute`");class _a{#t;constructor(e){this.#t=Ar(e)}ifNotExists(){return new _a({...this.#t,node:Ur.cloneWith(this.#t.node,{ifNotExists:!0})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}function $a(e){if(jr.includes(e))return e;throw new Error(`invalid OnCommitAction ${e}`)}zi(_a,"don't await CreateSchemaBuilder instances directly. To execute the query you need to call `execute`");class Qa{#t;constructor(e){this.#t=Ar(e)}temporary(){return new Qa({...this.#t,node:_r.cloneWith(this.#t.node,{temporary:!0})})}onCommit(e){return new Qa({...this.#t,node:_r.cloneWith(this.#t.node,{onCommit:$a(e)})})}ifNotExists(){return new Qa({...this.#t,node:_r.cloneWith(this.#t.node,{ifNotExists:!0})})}addColumn(e,t,n=Pr){const r=n(new va(ua.create(e,Gs(t))));return new Qa({...this.#t,node:_r.cloneWithColumn(this.#t.node,r.toOperationNode())})}addPrimaryKeyConstraint(e,t){return new Qa({...this.#t,node:_r.cloneWithConstraint(this.#t.node,Da.create(t,e))})}addUniqueConstraint(e,t,n=Pr){const r=n(new Ma(Wa.create(t,e)));return new Qa({...this.#t,node:_r.cloneWithConstraint(this.#t.node,r.toOperationNode())})}addCheckConstraint(e,t){return new Qa({...this.#t,node:_r.cloneWithConstraint(this.#t.node,fa.create(t.toOperationNode(),e))})}addForeignKeyConstraint(e,t,n,r,i=Pr){const o=i(new Sa(ka.create(t.map(li.create),ca(n),r.map(li.create),e)));return new Qa({...this.#t,node:_r.cloneWithConstraint(this.#t.node,o.toOperationNode())})}modifyFront(e){return new Qa({...this.#t,node:_r.cloneWithFrontModifier(this.#t.node,e.toOperationNode())})}modifyEnd(e){return new Qa({...this.#t,node:_r.cloneWithEndModifier(this.#t.node,e.toOperationNode())})}as(e){return new Qa({...this.#t,node:_r.cloneWith(this.#t.node,{selectQuery:na(e)})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}zi(Qa,"don't await CreateTableBuilder instances directly. To execute the query you need to call `execute`");class Ja{#t;constructor(e){this.#t=Ar(e)}on(e){return new Ja({...this.#t,node:Qr.cloneWith(this.#t.node,{table:ca(e)})})}ifExists(){return new Ja({...this.#t,node:Qr.cloneWith(this.#t.node,{ifExists:!0})})}cascade(){return new Ja({...this.#t,node:Qr.cloneWith(this.#t.node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}zi(Ja,"don't await DropIndexBuilder instances directly. To execute the query you need to call `execute`");class Ka{#t;constructor(e){this.#t=Ar(e)}ifExists(){return new Ka({...this.#t,node:Jr.cloneWith(this.#t.node,{ifExists:!0})})}cascade(){return new Ka({...this.#t,node:Jr.cloneWith(this.#t.node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}zi(Ka,"don't await DropSchemaBuilder instances directly. To execute the query you need to call `execute`");class Ha{#t;constructor(e){this.#t=Ar(e)}ifExists(){return new Ha({...this.#t,node:Kr.cloneWith(this.#t.node,{ifExists:!0})})}cascade(){return new Ha({...this.#t,node:Kr.cloneWith(this.#t.node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}zi(Ha,"don't await DropTableBuilder instances directly. To execute the query you need to call `execute`");const Ya=Ar({is:e=>"CreateViewNode"===e.kind,create:e=>Ar({kind:"CreateViewNode",name:$r.create(e)}),cloneWith:(e,t)=>Ar({...e,...t})});class Va{#h=new Ua;transformQuery(e){return this.#h.transformNode(e.node)}transformResult(e){return Promise.resolve(e.result)}}class za{#t;constructor(e){this.#t=Ar(e)}temporary(){return new za({...this.#t,node:Ya.cloneWith(this.#t.node,{temporary:!0})})}materialized(){return new za({...this.#t,node:Ya.cloneWith(this.#t.node,{materialized:!0})})}ifNotExists(){return new za({...this.#t,node:Ya.cloneWith(this.#t.node,{ifNotExists:!0})})}orReplace(){return new za({...this.#t,node:Ya.cloneWith(this.#t.node,{orReplace:!0})})}columns(e){return new za({...this.#t,node:Ya.cloneWith(this.#t.node,{columns:e.map(qi)})})}as(e){const t=e.withPlugin(new Va).toOperationNode();return new za({...this.#t,node:Ya.cloneWith(this.#t.node,{as:t})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}zi(za,"don't await CreateViewBuilder instances directly. To execute the query you need to call `execute`");const Xa=Ar({is:e=>"DropViewNode"===e.kind,create:e=>Ar({kind:"DropViewNode",name:$r.create(e)}),cloneWith:(e,t)=>Ar({...e,...t})});class Ga{#t;constructor(e){this.#t=Ar(e)}materialized(){return new Ga({...this.#t,node:Xa.cloneWith(this.#t.node,{materialized:!0})})}ifExists(){return new Ga({...this.#t,node:Xa.cloneWith(this.#t.node,{ifExists:!0})})}cascade(){return new Ga({...this.#t,node:Xa.cloneWith(this.#t.node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}zi(Ga,"don't await DropViewBuilder instances directly. To execute the query you need to call `execute`");const Za=Ar({is:e=>"CreateTypeNode"===e.kind,create:e=>Ar({kind:"CreateTypeNode",name:e}),cloneWithEnum:(e,t)=>Ar({...e,enum:Li.create(t.map((e=>Ai.createImmediate(e))))})});class ec{#t;constructor(e){this.#t=Ar(e)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}asEnum(e){return new ec({...this.#t,node:Za.cloneWithEnum(this.#t.node,e)})}$call(e){return e(this)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}zi(ec,"don't await CreateTypeBuilder instances directly. To execute the query you need to call `execute`");const tc=Ar({is:e=>"DropTypeNode"===e.kind,create:e=>Ar({kind:"DropTypeNode",name:e}),cloneWith:(e,t)=>Ar({...e,...t})});class nc{#t;constructor(e){this.#t=Ar(e)}ifExists(){return new nc({...this.#t,node:tc.cloneWith(this.#t.node,{ifExists:!0})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}function rc(e){if(e.includes(".")){const t=e.split(".").map(ic);if(2===t.length)return $r.createWithSchema(t[0],t[1]);throw new Error(`invalid schemable identifier ${e}`)}return $r.create(e)}function ic(e){return e.trim()}zi(nc,"don't await DropTypeBuilder instances directly. To execute the query you need to call `execute`");class oc{#E;constructor(e){this.#E=e}createTable(e){return new Qa({queryId:zo(),executor:this.#E,node:_r.create(ca(e))})}dropTable(e){return new Ha({queryId:zo(),executor:this.#E,node:Kr.create(ca(e))})}createIndex(e){return new ja({queryId:zo(),executor:this.#E,node:Rr.create(e)})}dropIndex(e){return new Ja({queryId:zo(),executor:this.#E,node:Qr.create(e)})}createSchema(e){return new _a({queryId:zo(),executor:this.#E,node:Ur.create(e)})}dropSchema(e){return new Ka({queryId:zo(),executor:this.#E,node:Jr.create(e)})}alterTable(e){return new Fa({queryId:zo(),executor:this.#E,node:Mr.create(ca(e))})}createView(e){return new za({queryId:zo(),executor:this.#E,node:Ya.create(e)})}dropView(e){return new Ga({queryId:zo(),executor:this.#E,node:Xa.create(e)})}createType(e){return new ec({queryId:zo(),executor:this.#E,node:Za.create(rc(e))})}dropType(e){return new nc({queryId:zo(),executor:this.#E,node:tc.create(rc(e))})}withPlugin(e){return new oc(this.#E.withPlugin(e))}withoutPlugins(){return new oc(this.#E.withoutPlugins())}withSchema(e){return new oc(this.#E.withPluginAtFront(new ts(e)))}}class sc{ref(e){return new hi(e)}}class ac{#C;constructor(e){this.#C=e}async provideConnection(e){const t=await this.#C.acquireConnection();try{return await e(t)}finally{await this.#C.releaseConnection(t)}}}class cc extends cs{#L;#A;#D;constructor(e,t,n,r=[]){super(r),this.#L=e,this.#A=t,this.#D=n}get adapter(){return this.#A}compileQuery(e){return this.#L.compileQuery(e)}provideConnection(e){return this.#D.provideConnection(e)}withPlugins(e){return new cc(this.#L,this.#A,this.#D,[...this.plugins,...e])}withPlugin(e){return new cc(this.#L,this.#A,this.#D,[...this.plugins,e])}withPluginAtFront(e){return new cc(this.#L,this.#A,this.#D,[e,...this.plugins])}withConnectionProvider(e){return new cc(this.#L,this.#A,e,[...this.plugins])}withoutPlugins(){return new cc(this.#L,this.#A,this.#D,[])}}function dc(){return"undefined"!=typeof performance&&Cr(performance.now)?performance.now():Date.now()}class lc{#C;#B;#P;#M;#F;#R=new WeakSet;constructor(e,t){this.#M=!1,this.#C=e,this.#B=t}async init(){if(this.#F)throw new Error("driver has already been destroyed");this.#P||(this.#P=this.#C.init().then((()=>{this.#M=!0})).catch((e=>(this.#P=void 0,Promise.reject(e))))),await this.#P}async acquireConnection(){if(this.#F)throw new Error("driver has already been destroyed");this.#M||await this.init();const e=await this.#C.acquireConnection();return this.#R.has(e)||(this.#U()&&this.#j(e),this.#R.add(e)),e}async releaseConnection(e){await this.#C.releaseConnection(e)}beginTransaction(e,t){return this.#C.beginTransaction(e,t)}commitTransaction(e){return this.#C.commitTransaction(e)}rollbackTransaction(e){return this.#C.rollbackTransaction(e)}async destroy(){this.#P&&(await this.#P,this.#F||(this.#F=this.#C.destroy().catch((e=>(this.#F=void 0,Promise.reject(e))))),await this.#F)}#U(){return this.#B.isLevelEnabled("query")||this.#B.isLevelEnabled("error")}#j(e){const t=e.executeQuery;e.executeQuery=async n=>{let r;const i=dc();try{return await t.call(e,n)}catch(e){throw r=e,await this.#_(e,n,i),e}finally{r||await this.#$(n,i)}}}async#_(e,t,n){await this.#B.error((()=>({level:"error",error:e,query:t,queryDurationMillis:this.#Q(n)})))}async#$(e,t){await this.#B.query((()=>({level:"query",query:e,queryDurationMillis:this.#Q(t)})))}#Q(e){return dc()-e}}const uc=()=>{};class pc{#J;#K;constructor(e){this.#J=e}async provideConnection(e){for(;this.#K;)await this.#K.catch(uc);return this.#K=this.#H(e).finally((()=>{this.#K=void 0})),this.#K}async#H(e){return await e(this.#J)}}const hc=["read uncommitted","read committed","repeatable read","serializable","snapshot"];Ar(["query","error"]);class fc{#Y;#V;constructor(e){Cr(e)?(this.#V=e,this.#Y=Ar({query:!0,error:!0})):(this.#V=mc,this.#Y=Ar({query:e.includes("query"),error:e.includes("error")}))}isLevelEnabled(e){return this.#Y[e]}async query(e){this.#Y.query&&await this.#V(e())}async error(e){this.#Y.error&&await this.#V(e())}}function mc(e){"query"===e.level?(e.query.sql,e.queryDurationMillis.toFixed(1)):"error"===e.level&&(e.error instanceof Error?console.error(`kysely:error: ${e.error.stack??e.error.message}`):console.error(`kysely:error: ${JSON.stringify({error:e.error,query:e.query.sql,queryDurationMillis:e.queryDurationMillis})}`))}class yc extends ys{#t;constructor(e){let t,n;if(Lr(r=e)&&Lr(r.config)&&Lr(r.driver)&&Lr(r.executor)&&Lr(r.dialect))t={executor:e.executor},n={...e};else{const r=e.dialect,i=r.createDriver(),o=r.createQueryCompiler(),s=r.createAdapter(),a=new fc(e.log??[]),c=new lc(i,a),d=new ac(c),l=new cc(o,s,d,e.plugins??[]);t={executor:l},n={config:e,executor:l,dialect:r,driver:c}}var r;super(t),this.#t=Ar(n)}get schema(){return new oc(this.#t.executor)}get dynamic(){return new sc}get introspection(){return this.#t.dialect.createIntrospector(this.withoutPlugins())}case(e){return new Us({node:Rs.create(Sr(e)?void 0:na(e))})}get fn(){return Ps()}transaction(){return new Nc({...this.#t})}connection(){return new wc({...this.#t})}withPlugin(e){return new yc({...this.#t,executor:this.#t.executor.withPlugin(e)})}withoutPlugins(){return new yc({...this.#t,executor:this.#t.executor.withoutPlugins()})}withSchema(e){return new yc({...this.#t,executor:this.#t.executor.withPluginAtFront(new ts(e))})}withTables(){return new yc({...this.#t})}async destroy(){await this.#t.driver.destroy()}get isTransaction(){return!1}getExecutor(){return this.#t.executor}executeQuery(e,t=zo()){const n=Lr(r=e)&&Cr(r.compile)?e.compile():e;var r;return this.getExecutor().executeQuery(n,t)}}class gc extends yc{#t;constructor(e){super(e),this.#t=e}get isTransaction(){return!0}transaction(){throw new Error("calling the transaction method for a Transaction is not supported")}connection(){throw new Error("calling the connection method for a Transaction is not supported")}async destroy(){throw new Error("calling the destroy method for a Transaction is not supported")}withPlugin(e){return new gc({...this.#t,executor:this.#t.executor.withPlugin(e)})}withoutPlugins(){return new gc({...this.#t,executor:this.#t.executor.withoutPlugins()})}withSchema(e){return new gc({...this.#t,executor:this.#t.executor.withPluginAtFront(new ts(e))})}withTables(){return new gc({...this.#t})}}class wc{#t;constructor(e){this.#t=Ar(e)}async execute(e){return this.#t.executor.provideConnection((async t=>{const n=this.#t.executor.withConnectionProvider(new pc(t)),r=new yc({...this.#t,executor:n});return await e(r)}))}}zi(wc,"don't await ConnectionBuilder instances directly. To execute the query you need to call the `execute` method");class Nc{#t;constructor(e){this.#t=Ar(e)}setIsolationLevel(e){return new Nc({...this.#t,isolationLevel:e})}async execute(e){const{isolationLevel:t,...n}=this.#t,r={isolationLevel:t};return function(e){if(e.isolationLevel&&!hc.includes(e.isolationLevel))throw new Error(`invalid transaction isolation level ${e.isolationLevel}`)}(r),this.#t.executor.provideConnection((async t=>{const i=this.#t.executor.withConnectionProvider(new pc(t)),o=new gc({...n,executor:i});try{await this.#t.driver.beginTransaction(t,r);const n=await e(o);return await this.#t.driver.commitTransaction(t),n}catch(e){throw await this.#t.driver.rollbackTransaction(t),e}}))}}zi(Nc,"don't await TransactionBuilder instances directly. To execute the transaction you need to call the `execute` method");class bc{get supportsCreateIfNotExists(){return!0}get supportsTransactionalDdl(){return!1}get supportsReturning(){return!1}}class vc extends bc{get supportsTransactionalDdl(){return!1}get supportsReturning(){return!0}async acquireMigrationLock(e,t){}async releaseMigrationLock(e,t){}}class xc{async init(){}async acquireConnection(){return new kc}async beginTransaction(){}async commitTransaction(){}async rollbackTransaction(){}async releaseConnection(){}async destroy(){}}class kc{async executeQuery(){return{rows:[]}}async*streamQuery(){}}class Sc{nodeStack=[];get parentNode(){return this.nodeStack[this.nodeStack.length-2]}#z=Ar({AliasNode:this.visitAlias.bind(this),ColumnNode:this.visitColumn.bind(this),IdentifierNode:this.visitIdentifier.bind(this),SchemableIdentifierNode:this.visitSchemableIdentifier.bind(this),RawNode:this.visitRaw.bind(this),ReferenceNode:this.visitReference.bind(this),SelectQueryNode:this.visitSelectQuery.bind(this),SelectionNode:this.visitSelection.bind(this),TableNode:this.visitTable.bind(this),FromNode:this.visitFrom.bind(this),SelectAllNode:this.visitSelectAll.bind(this),AndNode:this.visitAnd.bind(this),OrNode:this.visitOr.bind(this),ValueNode:this.visitValue.bind(this),ValueListNode:this.visitValueList.bind(this),PrimitiveValueListNode:this.visitPrimitiveValueList.bind(this),ParensNode:this.visitParens.bind(this),JoinNode:this.visitJoin.bind(this),OperatorNode:this.visitOperator.bind(this),WhereNode:this.visitWhere.bind(this),InsertQueryNode:this.visitInsertQuery.bind(this),DeleteQueryNode:this.visitDeleteQuery.bind(this),ReturningNode:this.visitReturning.bind(this),CreateTableNode:this.visitCreateTable.bind(this),AddColumnNode:this.visitAddColumn.bind(this),ColumnDefinitionNode:this.visitColumnDefinition.bind(this),DropTableNode:this.visitDropTable.bind(this),DataTypeNode:this.visitDataType.bind(this),OrderByNode:this.visitOrderBy.bind(this),OrderByItemNode:this.visitOrderByItem.bind(this),GroupByNode:this.visitGroupBy.bind(this),GroupByItemNode:this.visitGroupByItem.bind(this),UpdateQueryNode:this.visitUpdateQuery.bind(this),ColumnUpdateNode:this.visitColumnUpdate.bind(this),LimitNode:this.visitLimit.bind(this),OffsetNode:this.visitOffset.bind(this),OnConflictNode:this.visitOnConflict.bind(this),OnDuplicateKeyNode:this.visitOnDuplicateKey.bind(this),CreateIndexNode:this.visitCreateIndex.bind(this),DropIndexNode:this.visitDropIndex.bind(this),ListNode:this.visitList.bind(this),PrimaryKeyConstraintNode:this.visitPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.visitUniqueConstraint.bind(this),ReferencesNode:this.visitReferences.bind(this),CheckConstraintNode:this.visitCheckConstraint.bind(this),WithNode:this.visitWith.bind(this),CommonTableExpressionNode:this.visitCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.visitCommonTableExpressionName.bind(this),HavingNode:this.visitHaving.bind(this),CreateSchemaNode:this.visitCreateSchema.bind(this),DropSchemaNode:this.visitDropSchema.bind(this),AlterTableNode:this.visitAlterTable.bind(this),DropColumnNode:this.visitDropColumn.bind(this),RenameColumnNode:this.visitRenameColumn.bind(this),AlterColumnNode:this.visitAlterColumn.bind(this),ModifyColumnNode:this.visitModifyColumn.bind(this),AddConstraintNode:this.visitAddConstraint.bind(this),DropConstraintNode:this.visitDropConstraint.bind(this),ForeignKeyConstraintNode:this.visitForeignKeyConstraint.bind(this),CreateViewNode:this.visitCreateView.bind(this),DropViewNode:this.visitDropView.bind(this),GeneratedNode:this.visitGenerated.bind(this),DefaultValueNode:this.visitDefaultValue.bind(this),OnNode:this.visitOn.bind(this),ValuesNode:this.visitValues.bind(this),SelectModifierNode:this.visitSelectModifier.bind(this),CreateTypeNode:this.visitCreateType.bind(this),DropTypeNode:this.visitDropType.bind(this),ExplainNode:this.visitExplain.bind(this),DefaultInsertValueNode:this.visitDefaultInsertValue.bind(this),AggregateFunctionNode:this.visitAggregateFunction.bind(this),OverNode:this.visitOver.bind(this),PartitionByNode:this.visitPartitionBy.bind(this),PartitionByItemNode:this.visitPartitionByItem.bind(this),SetOperationNode:this.visitSetOperation.bind(this),BinaryOperationNode:this.visitBinaryOperation.bind(this),UnaryOperationNode:this.visitUnaryOperation.bind(this),UsingNode:this.visitUsing.bind(this),FunctionNode:this.visitFunction.bind(this),CaseNode:this.visitCase.bind(this),WhenNode:this.visitWhen.bind(this),JSONReferenceNode:this.visitJSONReference.bind(this),JSONPathNode:this.visitJSONPath.bind(this),JSONPathLegNode:this.visitJSONPathLeg.bind(this),JSONOperatorChainNode:this.visitJSONOperatorChain.bind(this),TupleNode:this.visitTuple.bind(this),MergeQueryNode:this.visitMergeQuery.bind(this),MatchedNode:this.visitMatched.bind(this),AddIndexNode:this.visitAddIndex.bind(this),CastNode:this.visitCast.bind(this),FetchNode:this.visitFetch.bind(this),TopNode:this.visitTop.bind(this)});visitNode=e=>{this.nodeStack.push(e),this.#z[e.kind](e),this.nodeStack.pop()}}class Oc extends Sc{#X="";#G=[];get numParameters(){return this.#G.length}compileQuery(e){return this.#X="",this.#G=[],this.visitNode(e),Ar({query:e,sql:this.getSql(),parameters:[...this.#G]})}getSql(){return this.#X}visitSelectQuery(e){const t=!(void 0===this.parentNode||Fi.is(this.parentNode)||lo.is(this.parentNode)||_r.is(this.parentNode)||Ya.is(this.parentNode)||vs.is(this.parentNode));void 0===this.parentNode&&e.explain&&(this.visitNode(e.explain),this.append(" ")),t&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append("select"),e.distinctOn&&(this.append(" "),this.compileDistinctOn(e.distinctOn)),e.frontModifiers?.length&&(this.append(" "),this.compileList(e.frontModifiers," ")),e.top&&(this.append(" "),this.visitNode(e.top)),e.selections&&(this.append(" "),this.compileList(e.selections)),e.from&&(this.append(" "),this.visitNode(e.from)),e.joins&&(this.append(" "),this.compileList(e.joins," ")),e.where&&(this.append(" "),this.visitNode(e.where)),e.groupBy&&(this.append(" "),this.visitNode(e.groupBy)),e.having&&(this.append(" "),this.visitNode(e.having)),e.setOperations&&(this.append(" "),this.compileList(e.setOperations," ")),e.orderBy&&(this.append(" "),this.visitNode(e.orderBy)),e.limit&&(this.append(" "),this.visitNode(e.limit)),e.offset&&(this.append(" "),this.visitNode(e.offset)),e.fetch&&(this.append(" "),this.visitNode(e.fetch)),e.endModifiers?.length&&(this.append(" "),this.compileList(this.sortSelectModifiers([...e.endModifiers])," ")),t&&this.append(")")}visitFrom(e){this.append("from "),this.compileList(e.froms)}visitSelection(e){this.visitNode(e.selection)}visitColumn(e){this.visitNode(e.column)}compileDistinctOn(e){this.append("distinct on ("),this.compileList(e),this.append(")")}compileList(e,t=", "){const n=e.length-1;for(let r=0;r<=n;r++)this.visitNode(e[r]),r<n&&this.append(t)}visitWhere(e){this.append("where "),this.visitNode(e.where)}visitHaving(e){this.append("having "),this.visitNode(e.having)}visitInsertQuery(e){const t=this.nodeStack.find(ko.is),n=t!==e;!n&&e.explain&&(this.visitNode(e.explain),this.append(" ")),n&&!xo.is(t)&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append(e.replace?"replace":"insert"),e.ignore&&this.append(" ignore"),e.top&&(this.append(" "),this.visitNode(e.top)),e.into&&(this.append(" into "),this.visitNode(e.into)),e.columns&&(this.append(" ("),this.compileList(e.columns),this.append(")")),e.values&&(this.append(" "),this.visitNode(e.values)),e.defaultValues&&(this.append(" "),this.append("default values")),e.onConflict&&(this.append(" "),this.visitNode(e.onConflict)),e.onDuplicateKey&&(this.append(" "),this.visitNode(e.onDuplicateKey)),e.returning&&(this.append(" "),this.visitNode(e.returning)),n&&!xo.is(t)&&this.append(")")}visitValues(e){this.append("values "),this.compileList(e.values)}visitDeleteQuery(e){const t=this.nodeStack.find(ko.is)!==e;!t&&e.explain&&(this.visitNode(e.explain),this.append(" ")),t&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append("delete "),e.top&&(this.visitNode(e.top),this.append(" ")),this.visitNode(e.from),e.using&&(this.append(" "),this.visitNode(e.using)),e.joins&&(this.append(" "),this.compileList(e.joins," ")),e.where&&(this.append(" "),this.visitNode(e.where)),e.orderBy&&(this.append(" "),this.visitNode(e.orderBy)),e.limit&&(this.append(" "),this.visitNode(e.limit)),e.returning&&(this.append(" "),this.visitNode(e.returning)),t&&this.append(")")}visitReturning(e){this.append("returning "),this.compileList(e.selections)}visitAlias(e){this.visitNode(e.node),this.append(" as "),this.visitNode(e.alias)}visitReference(e){e.table&&(this.visitNode(e.table),this.append(".")),this.visitNode(e.column)}visitSelectAll(e){this.append("*")}visitIdentifier(e){this.append(this.getLeftIdentifierWrapper()),this.compileUnwrappedIdentifier(e),this.append(this.getRightIdentifierWrapper())}compileUnwrappedIdentifier(e){if(!Or(e.name))throw new Error("a non-string identifier was passed to compileUnwrappedIdentifier.");this.append(this.sanitizeIdentifier(e.name))}visitAnd(e){this.visitNode(e.left),this.append(" and "),this.visitNode(e.right)}visitOr(e){this.visitNode(e.left),this.append(" or "),this.visitNode(e.right)}visitValue(e){e.immediate?this.appendImmediateValue(e.value):this.appendValue(e.value)}visitValueList(e){this.append("("),this.compileList(e.values),this.append(")")}visitTuple(e){this.append("("),this.compileList(e.values),this.append(")")}visitPrimitiveValueList(e){this.append("(");const{values:t}=e;for(let e=0;e<t.length;++e)this.appendValue(t[e]),e!==t.length-1&&this.append(", ");this.append(")")}visitParens(e){this.append("("),this.visitNode(e.node),this.append(")")}visitJoin(e){this.append(qc[e.joinType]),this.append(" "),this.visitNode(e.table),e.on&&(this.append(" "),this.visitNode(e.on))}visitOn(e){this.append("on "),this.visitNode(e.on)}visitRaw(e){const{sqlFragments:t,parameters:n}=e;for(let e=0;e<t.length;++e)this.append(t[e]),n.length>e&&this.visitNode(n[e])}visitOperator(e){this.append(e.operator)}visitTable(e){this.visitNode(e.table)}visitSchemableIdentifier(e){e.schema&&(this.visitNode(e.schema),this.append(".")),this.visitNode(e.identifier)}visitCreateTable(e){this.append("create "),e.frontModifiers&&e.frontModifiers.length>0&&(this.compileList(e.frontModifiers," "),this.append(" ")),e.temporary&&this.append("temporary "),this.append("table "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.table),e.selectQuery?(this.append(" as "),this.visitNode(e.selectQuery)):(this.append(" ("),this.compileList([...e.columns,...e.constraints??[]]),this.append(")"),e.onCommit&&(this.append(" on commit "),this.append(e.onCommit)),e.endModifiers&&e.endModifiers.length>0&&(this.append(" "),this.compileList(e.endModifiers," ")))}visitColumnDefinition(e){this.visitNode(e.column),this.append(" "),this.visitNode(e.dataType),e.unsigned&&this.append(" unsigned"),e.frontModifiers&&e.frontModifiers.length>0&&(this.append(" "),this.compileList(e.frontModifiers," ")),e.generated&&(this.append(" "),this.visitNode(e.generated)),e.identity&&this.append(" identity"),e.defaultTo&&(this.append(" "),this.visitNode(e.defaultTo)),e.notNull&&this.append(" not null"),e.unique&&this.append(" unique"),e.nullsNotDistinct&&this.append(" nulls not distinct"),e.primaryKey&&this.append(" primary key"),e.autoIncrement&&(this.append(" "),this.append(this.getAutoIncrement())),e.references&&(this.append(" "),this.visitNode(e.references)),e.check&&(this.append(" "),this.visitNode(e.check)),e.endModifiers&&e.endModifiers.length>0&&(this.append(" "),this.compileList(e.endModifiers," "))}getAutoIncrement(){return"auto_increment"}visitReferences(e){this.append("references "),this.visitNode(e.table),this.append(" ("),this.compileList(e.columns),this.append(")"),e.onDelete&&(this.append(" on delete "),this.append(e.onDelete)),e.onUpdate&&(this.append(" on update "),this.append(e.onUpdate))}visitDropTable(e){this.append("drop table "),e.ifExists&&this.append("if exists "),this.visitNode(e.table),e.cascade&&this.append(" cascade")}visitDataType(e){this.append(e.dataType)}visitOrderBy(e){this.append("order by "),this.compileList(e.items)}visitOrderByItem(e){this.visitNode(e.orderBy),e.direction&&(this.append(" "),this.visitNode(e.direction))}visitGroupBy(e){this.append("group by "),this.compileList(e.items)}visitGroupByItem(e){this.visitNode(e.groupBy)}visitUpdateQuery(e){const t=this.nodeStack.find(ko.is),n=t!==e;!n&&e.explain&&(this.visitNode(e.explain),this.append(" ")),n&&!xo.is(t)&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append("update "),e.top&&(this.visitNode(e.top),this.append(" ")),e.table&&(this.visitNode(e.table),this.append(" ")),this.append("set "),e.updates&&this.compileList(e.updates),e.from&&(this.append(" "),this.visitNode(e.from)),e.joins&&(this.append(" "),this.compileList(e.joins," ")),e.where&&(this.append(" "),this.visitNode(e.where)),e.limit&&(this.append(" "),this.visitNode(e.limit)),e.returning&&(this.append(" "),this.visitNode(e.returning)),n&&!xo.is(t)&&this.append(")")}visitColumnUpdate(e){this.visitNode(e.column),this.append(" = "),this.visitNode(e.value)}visitLimit(e){this.append("limit "),this.visitNode(e.limit)}visitOffset(e){this.append("offset "),this.visitNode(e.offset)}visitOnConflict(e){this.append("on conflict"),e.columns?(this.append(" ("),this.compileList(e.columns),this.append(")")):e.constraint?(this.append(" on constraint "),this.visitNode(e.constraint)):e.indexExpression&&(this.append(" ("),this.visitNode(e.indexExpression),this.append(")")),e.indexWhere&&(this.append(" "),this.visitNode(e.indexWhere)),!0===e.doNothing?this.append(" do nothing"):e.updates&&(this.append(" do update set "),this.compileList(e.updates),e.updateWhere&&(this.append(" "),this.visitNode(e.updateWhere)))}visitOnDuplicateKey(e){this.append("on duplicate key update "),this.compileList(e.updates)}visitCreateIndex(e){this.append("create "),e.unique&&this.append("unique "),this.append("index "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.name),e.table&&(this.append(" on "),this.visitNode(e.table)),e.using&&(this.append(" using "),this.visitNode(e.using)),e.columns&&(this.append(" ("),this.compileList(e.columns),this.append(")")),e.nullsNotDistinct&&this.append(" nulls not distinct"),e.where&&(this.append(" "),this.visitNode(e.where))}visitDropIndex(e){this.append("drop index "),e.ifExists&&this.append("if exists "),this.visitNode(e.name),e.table&&(this.append(" on "),this.visitNode(e.table)),e.cascade&&this.append(" cascade")}visitCreateSchema(e){this.append("create schema "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.schema)}visitDropSchema(e){this.append("drop schema "),e.ifExists&&this.append("if exists "),this.visitNode(e.schema),e.cascade&&this.append(" cascade")}visitPrimaryKeyConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("primary key ("),this.compileList(e.columns),this.append(")")}visitUniqueConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("unique"),e.nullsNotDistinct&&this.append(" nulls not distinct"),this.append(" ("),this.compileList(e.columns),this.append(")")}visitCheckConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("check ("),this.visitNode(e.expression),this.append(")")}visitForeignKeyConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("foreign key ("),this.compileList(e.columns),this.append(") "),this.visitNode(e.references),e.onDelete&&(this.append(" on delete "),this.append(e.onDelete)),e.onUpdate&&(this.append(" on update "),this.append(e.onUpdate))}visitList(e){this.compileList(e.items)}visitWith(e){this.append("with "),e.recursive&&this.append("recursive "),this.compileList(e.expressions)}visitCommonTableExpression(e){this.visitNode(e.name),this.append(" as "),Ir(e.materialized)&&(e.materialized||this.append("not "),this.append("materialized ")),this.visitNode(e.expression)}visitCommonTableExpressionName(e){this.visitNode(e.table),e.columns&&(this.append("("),this.compileList(e.columns),this.append(")"))}visitAlterTable(e){this.append("alter table "),this.visitNode(e.table),this.append(" "),e.renameTo&&(this.append("rename to "),this.visitNode(e.renameTo)),e.setSchema&&(this.append("set schema "),this.visitNode(e.setSchema)),e.addConstraint&&this.visitNode(e.addConstraint),e.dropConstraint&&this.visitNode(e.dropConstraint),e.columnAlterations&&this.compileColumnAlterations(e.columnAlterations),e.addIndex&&this.visitNode(e.addIndex),e.dropIndex&&this.visitNode(e.dropIndex)}visitAddColumn(e){this.append("add column "),this.visitNode(e.column)}visitRenameColumn(e){this.append("rename column "),this.visitNode(e.column),this.append(" to "),this.visitNode(e.renameTo)}visitDropColumn(e){this.append("drop column "),this.visitNode(e.column)}visitAlterColumn(e){this.append("alter column "),this.visitNode(e.column),this.append(" "),e.dataType&&(this.announcesNewColumnDataType()&&this.append("type "),this.visitNode(e.dataType),e.dataTypeExpression&&(this.append("using "),this.visitNode(e.dataTypeExpression))),e.setDefault&&(this.append("set default "),this.visitNode(e.setDefault)),e.dropDefault&&this.append("drop default"),e.setNotNull&&this.append("set not null"),e.dropNotNull&&this.append("drop not null")}visitModifyColumn(e){this.append("modify column "),this.visitNode(e.column)}visitAddConstraint(e){this.append("add "),this.visitNode(e.constraint)}visitDropConstraint(e){this.append("drop constraint "),e.ifExists&&this.append("if exists "),this.visitNode(e.constraintName),"cascade"===e.modifier?this.append(" cascade"):"restrict"===e.modifier&&this.append(" restrict")}visitSetOperation(e){this.append(e.operator),this.append(" "),e.all&&this.append("all "),this.visitNode(e.expression)}visitCreateView(e){this.append("create "),e.orReplace&&this.append("or replace "),e.materialized&&this.append("materialized "),e.temporary&&this.append("temporary "),this.append("view "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.name),this.append(" "),e.columns&&(this.append("("),this.compileList(e.columns),this.append(") ")),e.as&&(this.append("as "),this.visitNode(e.as))}visitDropView(e){this.append("drop "),e.materialized&&this.append("materialized "),this.append("view "),e.ifExists&&this.append("if exists "),this.visitNode(e.name),e.cascade&&this.append(" cascade")}visitGenerated(e){this.append("generated "),e.always&&this.append("always "),e.byDefault&&this.append("by default "),this.append("as "),e.identity&&this.append("identity"),e.expression&&(this.append("("),this.visitNode(e.expression),this.append(")")),e.stored&&this.append(" stored")}visitDefaultValue(e){this.append("default "),this.visitNode(e.defaultValue)}visitSelectModifier(e){e.rawModifier?this.visitNode(e.rawModifier):this.append(Wc[e.modifier]),e.of&&(this.append(" of "),this.compileList(e.of,", "))}visitCreateType(e){this.append("create type "),this.visitNode(e.name),e.enum&&(this.append(" as enum "),this.visitNode(e.enum))}visitDropType(e){this.append("drop type "),e.ifExists&&this.append("if exists "),this.visitNode(e.name)}visitExplain(e){this.append("explain"),(e.options||e.format)&&(this.append(" "),this.append(this.getLeftExplainOptionsWrapper()),e.options&&(this.visitNode(e.options),e.format&&this.append(this.getExplainOptionsDelimiter())),e.format&&(this.append("format"),this.append(this.getExplainOptionAssignment()),this.append(e.format)),this.append(this.getRightExplainOptionsWrapper()))}visitDefaultInsertValue(e){this.append("default")}visitAggregateFunction(e){this.append(e.func),this.append("("),e.distinct&&this.append("distinct "),this.compileList(e.aggregated),this.append(")"),e.filter&&(this.append(" filter("),this.visitNode(e.filter),this.append(")")),e.over&&(this.append(" "),this.visitNode(e.over))}visitOver(e){this.append("over("),e.partitionBy&&(this.visitNode(e.partitionBy),e.orderBy&&this.append(" ")),e.orderBy&&this.visitNode(e.orderBy),this.append(")")}visitPartitionBy(e){this.append("partition by "),this.compileList(e.items)}visitPartitionByItem(e){this.visitNode(e.partitionBy)}visitBinaryOperation(e){this.visitNode(e.leftOperand),this.append(" "),this.visitNode(e.operator),this.append(" "),this.visitNode(e.rightOperand)}visitUnaryOperation(e){this.visitNode(e.operator),this.isMinusOperator(e.operator)||this.append(" "),this.visitNode(e.operand)}isMinusOperator(e){return ci.is(e)&&"-"===e.operator}visitUsing(e){this.append("using "),this.compileList(e.tables)}visitFunction(e){this.append(e.func),this.append("("),this.compileList(e.arguments),this.append(")")}visitCase(e){this.append("case"),e.value&&(this.append(" "),this.visitNode(e.value)),e.when&&(this.append(" "),this.compileList(e.when," ")),e.else&&(this.append(" else "),this.visitNode(e.else)),this.append(" end"),e.isStatement&&this.append(" case")}visitWhen(e){this.append("when "),this.visitNode(e.condition),e.result&&(this.append(" then "),this.visitNode(e.result))}visitJSONReference(e){this.visitNode(e.reference),this.visitNode(e.traversal)}visitJSONPath(e){e.inOperator&&this.visitNode(e.inOperator),this.append("'$");for(const t of e.pathLegs)this.visitNode(t);this.append("'")}visitJSONPathLeg(e){const t="ArrayLocation"===e.type;this.append(t?"[":"."),this.append(String(e.value)),t&&this.append("]")}visitJSONOperatorChain(e){for(let t=0,n=e.values.length;t<n;t++)t===n-1?this.visitNode(e.operator):this.append("->"),this.visitNode(e.values[t])}visitMergeQuery(e){e.with&&(this.visitNode(e.with),this.append(" ")),this.append("merge "),e.top&&(this.visitNode(e.top),this.append(" ")),this.append("into "),this.visitNode(e.into),e.using&&(this.append(" "),this.visitNode(e.using)),e.whens&&(this.append(" "),this.compileList(e.whens))}visitMatched(e){e.not&&this.append("not "),this.append("matched"),e.bySource&&this.append(" by source")}visitAddIndex(e){this.append("add "),e.unique&&this.append("unique "),this.append("index "),this.visitNode(e.name),e.columns&&(this.append(" ("),this.compileList(e.columns),this.append(")")),e.using&&(this.append(" using "),this.visitNode(e.using))}visitCast(e){this.append("cast("),this.visitNode(e.expression),this.append(" as "),this.visitNode(e.dataType),this.append(")")}visitFetch(e){this.append("fetch next "),this.visitNode(e.rowCount),this.append(` rows ${e.modifier}`)}visitTop(e){this.append(`top(${e.expression})`),e.modifiers&&this.append(` ${e.modifiers}`)}append(e){this.#X+=e}appendValue(e){this.addParameter(e),this.append(this.getCurrentParameterPlaceholder())}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getCurrentParameterPlaceholder(){return"$"+this.numParameters}getLeftExplainOptionsWrapper(){return"("}getExplainOptionAssignment(){return" "}getExplainOptionsDelimiter(){return", "}getRightExplainOptionsWrapper(){return")"}sanitizeIdentifier(e){const t=this.getLeftIdentifierWrapper(),n=this.getRightIdentifierWrapper();let r="";for(const i of e)r+=i,i===t?r+=t:i===n&&(r+=n);return r}addParameter(e){this.#G.push(e)}appendImmediateValue(e){if(Or(e))this.append(`'${e}'`);else if(Wr(e)||Ir(e))this.append(e.toString());else if(qr(e))this.append("null");else if(Tr(e))this.appendImmediateValue(e.toISOString());else{if(!Er(e))throw new Error(`invalid immediate value ${e}`);this.appendImmediateValue(e.toString())}}sortSelectModifiers(e){return e.sort(((e,t)=>e.modifier&&t.modifier?Ic[e.modifier]-Ic[t.modifier]:1)),Ar(e)}compileColumnAlterations(e){this.compileList(e)}announcesNewColumnDataType(){return!0}}const Wc=Ar({ForKeyShare:"for key share",ForNoKeyUpdate:"for no key update",ForUpdate:"for update",ForShare:"for share",NoWait:"nowait",SkipLocked:"skip locked",Distinct:"distinct"}),Ic=Ar({ForKeyShare:1,ForNoKeyUpdate:1,ForUpdate:1,ForShare:1,NoWait:2,SkipLocked:2,Distinct:0}),qc=Ar({InnerJoin:"inner join",LeftJoin:"left join",RightJoin:"right join",FullJoin:"full join",LateralInnerJoin:"inner join lateral",LateralLeftJoin:"left join lateral",Using:"using"}),Tc=/"/g;class Ec extends Oc{getCurrentParameterPlaceholder(){return"?"}getLeftExplainOptionsWrapper(){return""}getRightExplainOptionsWrapper(){return""}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getAutoIncrement(){return"autoincrement"}sanitizeIdentifier(e){return e.replace(Tc,'""')}visitDefaultInsertValue(e){this.append("null")}}let Cc,Lc,Ac,Dc=!1;let Bc;const Pc=(e,t)=>{"string"!=typeof t.data&&!0!==Dc&&(clearTimeout(Cc),Cc=void 0,Cc=setTimeout((()=>{Dc=!0,e({refreshQueries:!0})(),clearTimeout(Cc),clearTimeout(Lc),Lc=setTimeout((()=>{Dc=!1}),500)}),500))},Mc=(e,t,n)=>t.externalWebsocketConnection?(t.externalWebsocketConnection.send(JSON.stringify({message:"subscribe",channelId:n.id})),t.externalWebsocketConnection.addEventListener("message",(t=>Pc(e,t))),t.externalWebsocketConnection):t.enableWebsocketConnection?(Bc=new WebSocket(t.syncUrl?.replace("http","ws")),Bc.addEventListener("message",(t=>Pc(e,t))),Bc.onerror=e=>{console.error("WebSocket error:",e)},Bc.onclose=()=>{Ac=setTimeout((()=>Mc(e,t,n)),3e3)},Bc.onopen=()=>{Bc.send(JSON.stringify({message:"subscribe",channelId:n.id})),clearTimeout(Ac)},Bc):void 0,Fc=e=>f.sync((()=>{const t=new Set;let n=e;return{subscribe:e=>(t.add(e),()=>{t.delete(e)}),getState:()=>n,setState:e=>f.sync((()=>{e!==n&&(n=e,t.forEach((e=>e())))}))}}));class Rc extends(p.vw("EvoluFactory")()){}Rc.Common=w.QZ(Rc,f.gen((function*(){const e=yield*f.map(f.serviceOption(Ln),y.WL((()=>e=>e()))),t=p.Ie().pipe(p.WQ(Kn,yield*Kn),p.WQ(ht,yield*ht),p.WQ(Ln,e),p.WQ(An,yield*An)),n=new Map;return Rc.of({createEvolu:(e,{indexes:r,initialData:i,mnemonic:o,...s}={})=>{const a=O(s),c=s?.name||S.name,d={tables:Uc(e),indexes:r||[]};let l=n.get(c);return null==l?(l=_c(d,a,i,o).pipe(f.provide(t),a.runSync),n.set(c,l)):l.ensureSchema(d),l}})})));const Uc=e=>(0,m.Fs)(jc(e),kr.Wo,u.Tj((([e,t])=>({name:e,columns:Object.keys(jc(t))})))),jc=e=>{const t={},n=xr.dw(e.ast);for(let e=0;e<n.length;e++){const r=n[e];t[r.name]=(0,a.L8n)(r.type)}return t},_c=(e,t,n,r)=>f.gen((function*(){yield*f.logTrace("EvoluFactory createEvolu");const i=yield*k,o=yield*Kn,s=yield*An,a=yield*ht,c=yield*Ln,d=yield*o.createDb,l=yield*Fc(null),p=yield*Fc(null),h=yield*Fc(new Map),y=yield*Fc(Qt),w=new Map,N=new Map,b=e=>e.pipe(f.catchAllDefect((e=>f.fail(mn(e)))),f.tapError(f.logError),f.tapError(l.setState)),v=(0,m.L3)(b,t.runFork),x=(0,m.L3)(b,t.runSync),S=(0,m.L3)(b,t.runPromise),O=yield*f.provideService($c(n),ht,a),W=({refreshQueries:e})=>()=>{f.flatMap(d.sync(e?[...N.keys()]:[]),C()).pipe(v)};d.init(e,O,(e=>{f.fail(e).pipe(v)}),(e=>{f.logDebug(["Evolu handleSyncStateChange",{state:e}]).pipe(f.zipRight(y.setState(e)),v)}),(()=>{f.gen((function*(){yield*f.logTrace("Evolu handleDbReceive"),D();const e=[...N.keys()];e.length>0&&(yield*f.flatMap(d.loadQueries(e),C()))})).pipe(v)}),r).pipe(f.tap(W({refreshQueries:!1})),f.flatMap(p.setState),f.catchTag("NotSupportedPlatformError",(()=>f.void)),v);let I=!1;const T=new Promise((e=>{p.subscribe((()=>{const t=p.getState();I||"string"!=typeof t?.id||(I=!0,e(Mc(W,i,t)))}))})),E=yield*s.init({onRequestSync:W({refreshQueries:!0}),reloadUrl:i.reloadUrl}),C=e=>t=>f.logDebug(["Evolu handlePatches",{patches:t}]).pipe(f.zipRight(L(t)),f.tap((e=>f.forEach(t,(({query:t})=>A(t,e.get(t)||yr()))))),f.tap((t=>{e?.flushSync?c((()=>{h.setState(t).pipe(x)})):h.setState(t).pipe(x)}))),L=e=>f.sync((()=>{const t=h.getState();if(0===e.length)return t;const n=u.Tj(e,(({query:e,patches:n})=>[e,pn(n,t.get(e)||yr())]));return new Map([...t,...n])})),A=(e,t)=>f.sync((()=>{const n=w.get(e);if(!n)return;const r=wr(t);"fulfilled"!==n.promise.status?n.resolve(r):n.promise=Promise.resolve(r),Object.assign(n.promise,{status:"fulfilled",value:r}),n.releaseOnResolve&&w.delete(e)})),D=()=>{[...w.entries()].filter((([e])=>!N.has(e))).forEach((([e,t])=>{"fulfilled"===t.promise.status?w.delete(e):t.releaseOnResolve=!0}))},B=(()=>{let e=[];return(t,{id:n,...r},i)=>{f.logDebug(["Evolu mutate",{table:t,id:n,values:r}]).pipe(x);const o=null==n;return o&&(n=a.rowId.pipe(x)),e=[...e,[{table:t,id:n,values:r,isInsert:o},i]],1===e.length&&queueMicrotask((()=>{const[t,n]=u.$1(e);e=[];const r=n.filter(g.EA);D(),d.mutate(t,[...N.keys()]).pipe(f.flatMap(C({flushSync:r.length>0})),f.tap((()=>{r.forEach((e=>e()))})),v)})),{id:n}}})(),P={socket:T,subscribeError:l.subscribe,getError:l.getState,createQuery:(e,t)=>(0,m.Fs)(e(Qc).compile(),(e=>{if(n=e.sql,In.test(n))throw new Error("SQL mutation (INSERT, UPDATE, DELETE, etc.) isn't allowed in the Evolu `createQuery` function. Kysely suggests it because there is no read-only Kysely yet, and removing such an API is not possible. For mutations, use Evolu mutation API.");var n;const r=e.parameters;return{sql:e.sql,parameters:r,...t&&{options:t}}}),(e=>(({sql:e,parameters:t=[],options:n})=>{const r={sql:e,parameters:t.map((e=>g.mg(e)?u.Ts(e):bn(e)?{json:e}:e)),...n&&{options:n}};return JSON.stringify(r)})(e))),loadQuery:(()=>{let e=[];return t=>{f.logDebug(["Evolu loadQuery",{query:fr(t)}]).pipe(x);let n=w.get(t);if(!n){let r=m.Yi;const i=new Promise((e=>{r=e}));n={resolve:r,promise:i,releaseOnResolve:!1},w.set(t,n),e=[...e,t],1===e.length&&queueMicrotask((()=>{d.loadQueries(u.Qq(e)).pipe(f.flatMap(C()),v),e=[]}))}return n.promise}})(),loadQueries:e=>e.map(P.loadQuery),subscribeQuery:e=>t=>{N.set(e,q.GV(N.get(e)??0));const n=h.subscribe(t);return()=>{const t=N.get(e);null!=t&&t>1?N.set(e,q.Kt(t)):N.delete(e),n()}},getQuery:e=>wr(h.getState().get(e)||yr()),subscribeOwner:p.subscribe,getOwner:p.getState,subscribeSyncState:y.subscribe,getSyncState:y.getState,create:B,update:B,createOrUpdate:B,resetOwner:e=>f.gen((function*(){yield*d.resetOwner(),!1!==e?.reload&&(yield*E.reset)})).pipe(S),restoreOwner:(t,n)=>f.gen((function*(){yield*d.restoreOwner(e,t),!1!==n?.reload&&(yield*E.reset)})).pipe(S),reloadApp:()=>{E.reset.pipe(v)},ensureSchema:e=>{d.ensureSchema(e).pipe(v)},exportDatabase:()=>d.exportDatabase().pipe(S)};return P})),$c=(e=m.Yi)=>f.map(ht,(t=>{const n=[],r=(e,{id:r,...i})=>(null==r&&(r=t.rowId.pipe(f.runSync)),n.push({isInsert:!0,id:r,table:e,values:i}),{id:r});return e({create:r,createOrUpdate:r}),n})),Qc=new yc({dialect:{createAdapter:()=>new vc,createDriver:()=>new xc,createIntrospector(){throw"Not implemeneted"},createQueryCompiler:()=>new Ec}}),Jc=(Qc.schema.createIndex.bind(Qc.schema),e=>f.map(k,(t=>`evolu:${t.name}:${e}`))),Kc=(w.Py(An,{init:({reloadUrl:e,onRequestSync:t})=>f.sync((()=>{if("undefined"==typeof document)return{reset:f.void};const n="evolu:reloadAllTabs",r=()=>{location.replace(e)};let i;window.addEventListener("storage",(e=>{e.key===n&&r()}));const o=()=>{null==i&&(t(),i=window.setTimeout((()=>{i=null}),50))};window.addEventListener("online",o),document.addEventListener("visibilitychange",(()=>{"hidden"!==document.visibilityState&&o()})),window.addEventListener("focus",o);return{reset:f.sync((()=>{localStorage.setItem(n,Date.now().toString()),r()}))}}))}),w.Py(Dn,{tryAcquire:f.gen((function*(){yield*f.logTrace("SyncLock tryAcquire");const e=yield*Jc("SyncLock"),t=f.async((t=>{navigator.locks.request(e,{ifAvailable:!0},(e=>{if(null!=e)return new Promise((e=>{f.logTrace("SyncLock acquired").pipe(f.zipRight(f.succeed({release:f.logTrace("SyncLock released").pipe(f.tap(f.sync(e)))})),t)}));f.logTrace("SyncLock not acquired").pipe(f.zipRight(f.fail(new Bn)),t)}))}));return yield*f.acquireRelease(t,(({release:e})=>e))}))}));var Hc=n(171733);globalThis.sqlite3Worker1Promiser=function e(t=e.defaultConfig){if(1===arguments.length&&"function"==typeof arguments[0]){const n=t;(t=Object.assign(Object.create(null),e.defaultConfig)).onready=n}else t=Object.assign(Object.create(null),e.defaultConfig,t);const n=Object.create(null),r=function(){},i=t.onerror||r,o=t.debug||r,s=t.generateMessageId?void 0:Object.create(null),a=t.generateMessageId||function(e){return e.type+"#"+(s[e.type]=(s[e.type]||0)+1)},c=(...e)=>{throw new Error(e.join(" "))};let d,l;return t.worker||(t.worker=e.defaultConfig.worker),"function"==typeof t.worker&&(t.worker=t.worker()),t.worker.onmessage=function(e){e=e.data,o("worker1.onmessage",e);let r=n[e.messageId];if(!r)return e&&"sqlite3-api"===e.type&&"worker1-ready"===e.result?void(t.onready&&t.onready(l)):(r=n[e.type],r&&r.onrow?void r.onrow(e):void(t.onunhandled?t.onunhandled(arguments[0]):i("sqlite3Worker1Promiser() unhandled worker message:",e)));switch(delete n[e.messageId],e.type){case"error":return void r.reject(e);case"open":d||(d=e.dbId);break;case"close":e.dbId===d&&(d=void 0)}try{r.resolve(e)}catch(e){r.reject(e)}},l=function(){let e;1===arguments.length?e=arguments[0]:2===arguments.length?(e=Object.create(null),e.type=arguments[0],e.args=arguments[1],e.dbId=e.args.dbId):c("Invalid arguments for sqlite3Worker1Promiser()-created factory."),e.dbId||"open"===e.type||(e.dbId=d),e.messageId=a(e),e.departureTime=performance.now();const r=Object.create(null);let i;r.message=e,"exec"===e.type&&e.args&&("function"==typeof e.args.callback?(i=e.messageId+":row",r.onrow=e.args.callback,e.args.callback=i,n[i]=r):"string"==typeof e.args.callback&&c("exec callback may not be a string when using the Promise interface."));let s=new Promise((function(i,s){r.resolve=i,r.reject=s,n[e.messageId]=r,o("Posting",e.type,"message to Worker dbId="+(d||"default")+":",e),t.worker.postMessage(e)}));return i&&(s=s.finally((()=>delete n[i]))),s}},globalThis.sqlite3Worker1Promiser.defaultConfig={worker:function(){return new Worker(new URL(n.p+n.u(65),n.b),{type:void 0})},onerror:(...e)=>console.error("worker1 promiser error",...e)},sqlite3Worker1Promiser.v2=function(e){let t;"function"==typeof e?(t=e,e={}):"function"==typeof e?.onready&&(t=e.onready,delete e.onready);const n=Object.create(null);e=Object.assign(e||Object.create(null),{onready:async function(e){try{t&&await t(e),n.resolve(e)}catch(e){n.reject(e)}}});const r=new Promise((function(e,t){n.resolve=e,n.reject=t}));try{this.original(e)}catch(e){n.reject(e)}return r}.bind({original:sqlite3Worker1Promiser});sqlite3Worker1Promiser.v2,self.sqlite3Worker1Promiser;const Yc=Hc.A;globalThis.sqlite3ApiConfig={warn:m.Yi};const Vc=w.QZ(Nn,f.gen((function*(){const e=yield*ht,t=Yc();return Nn.of({createSqlite:f.gen((function*(){const n=yield*f.flatMap(Jc("SqliteBroadcastChannel"),zc);n.onMessage=e=>{switch(e._tag){case"Exec":r=[...r,e];break;case"ExecError":case"ExecSuccess":r=u.pb(r,(t=>t.id!==e.id)),i(e);break;default:(0,m.GQ)(e)}};let r=[];const i=e=>{const t=o.get(e.id);t&&(t(e),o.delete(e.id))},o=new Map,s=yield*k,a=O(s);f.logTrace("SqliteWeb connection lock request").pipe(f.zipRight(Jc("SqliteConnection")),f.flatMap((e=>f.async((n=>{navigator.locks.request(e,(()=>new Promise((()=>{n(f.promise((()=>t)))}))))})))),f.tap(f.logTrace("SqliteWeb connection lock granted")),f.flatMap((e=>f.promise((()=>e.installOpfsSAHPoolVfs({name:s.name}))).pipe(f.map((t=>({sqlite:new t.OpfsSAHPoolDb("/evolu1.db"),sqlite3:e})))))),f.tap((({sqlite:e,sqlite3:t})=>{const o=(r,i)=>f.try({try:()=>{if(r.sql===Xc.sql){return[{file:t.capi.sqlite3_js_db_export(e)}]}return e.exec(r.sql,{returnValue:"resultRows",rowMode:"object",bind:(n=r.parameters||[],n.map((e=>bn(e)?JSON.stringify(e):e)))});var n},catch:yn}).pipe((e=>t=>e.options?.logQueryExecutionTime?f.Do.pipe(f.let("start",(()=>performance.now())),f.bind("result",(()=>t)),f.let("elapsed",(({start:e})=>performance.now()-e)),f.tap((({elapsed:t})=>nn(`QueryExecutionTime: ${t}ms`,e))),f.map((({result:e})=>e))):t)(r),f.match({onSuccess:t=>{n.postMessage({_tag:"ExecSuccess",id:i,result:{rows:t,changes:e.changes()}})},onFailure:e=>{n.postMessage({_tag:"ExecError",id:i,error:e})}}),a.runSync);n.onMessage=e=>{switch(e._tag){case"Exec":o(e.query,e.id);break;case"ExecSuccess":case"ExecError":i(e);break;default:(0,m.GQ)(e)}},r.forEach((e=>{o(e.query,e.id)})),r=[]}))).pipe(f.provideService(k,s),a.runPromise);const c=yield*Jc("SqliteTransaction");return wn.of({exec:t=>f.flatMap(e.nanoid,(e=>f.async((r=>{o.set(e,(e=>{switch(e._tag){case"ExecSuccess":r(f.succeed(e.result));break;case"ExecError":r(f.die(e.error))}})),n.postMessage({_tag:"Exec",id:e,query:t})})))),transaction:e=>t=>f.acquireUseRelease(f.async((t=>{navigator.locks.request(c,{mode:"last"===e?"exclusive":e},(()=>new Promise((e=>{t(f.succeed(e))}))))})),(()=>t),(t=>f.sync((()=>{"last"!==e&&t()})))),export:()=>f.flatMap(e.nanoid,(e=>f.async((t=>{o.set(e,(e=>{switch(e._tag){case"ExecSuccess":t(f.succeed(e.result.rows[0].file));break;case"ExecError":t(f.die(e.error))}})),n.postMessage({_tag:"Exec",id:e,query:Xc})}))))})}))})}))),zc=e=>f.sync((()=>{const t=new BroadcastChannel(e),n={postMessage:e=>{t.postMessage(e),n.onMessage(e)},onMessage:m.Yi};return t.onmessage=e=>{n.onMessage(e.data)},n})),Xc={sql:"export database"},Gc=w.Py(Jt,{createSync:f.sync((()=>(e=>{const t=new Map;e.onmessage=({data:e})=>{const n=t.get(e.id);n&&(n(e.response),t.delete(e.id))};const n=new Proxy(e,{get:(e,n)=>(...r)=>f.flatMap(k,(i=>f.async((o=>{const s=[],a=r.map((e=>{if("function"!=typeof e)return e;const t=new MessageChannel;return t.port1.onmessage=({data:t})=>{e(...t)},s.push(t.port2),t.port2})),c=br();t.set(c,(e=>{o(f[e._tag](e.value))}));const d={id:c,name:n,args:a,config:i};e.postMessage(d,s)}))))});return n})(new Worker(new URL(n.p+n.u(80),n.b),{type:void 0}))))});Hn.pipe(f.provide(w.Um(Nn.Common.pipe(w.Gt(Vc),w.Gt(vr)),vr,qt.Live,Gc,Kc)),f.runSync,(e=>{let t=null;onmessage=({data:{id:n,name:r,args:i,config:o}})=>{null==t&&(t=O(o));const s=i.map((e=>e instanceof MessagePort?(...t)=>{e.postMessage(t)}:e));t.runFork(e[r](...s).pipe(f.map((e=>({id:n,response:{_tag:"succeed",value:e}}))),f.catchAll((e=>f.succeed({id:n,response:{_tag:"fail",value:e}}))),f.catchAllDefect((e=>f.succeed({id:n,response:{_tag:"die",value:yn(e)}}))),f.tap((e=>postMessage(e)))))}}))},975955:(e,t,n)=>{n.d(t,{$1:()=>Y,$v:()=>q,BC:()=>N,BE:()=>Q,Bq:()=>le,C:()=>ee,CN:()=>h,D8:()=>y,E$:()=>ie,EI:()=>k,HC:()=>j,HV:()=>C,Hs:()=>w,Ie:()=>se,KC:()=>ne,Kl:()=>F,Ln:()=>B,Mo:()=>oe,OM:()=>ke,OY:()=>H,Ou:()=>V,Qq:()=>ve,Rm:()=>L,Rx:()=>A,TS:()=>ye,Tj:()=>ce,Ts:()=>m,Uk:()=>U,XK:()=>ge,Y6:()=>f,Yz:()=>he,bt:()=>Ne,cy:()=>v,d5:()=>T,di:()=>J,fj:()=>xe,g9:()=>M,gI:()=>G,gR:()=>X,gv:()=>P,i8:()=>R,iI:()=>S,jB:()=>me,kP:()=>re,mA:()=>pe,nc:()=>g,of:()=>ae,pb:()=>fe,qI:()=>de,t8:()=>we,u2:()=>b,v4:()=>E,w8:()=>be,x1:()=>ue,yU:()=>K});var r=n(545422),i=n(617194),o=n(374212),s=n(249687),a=n(319678),c=n(30805),d=n(271314),l=n(43963),u=n(370817),p=n(241892);const h=e=>new Array(e),f=(e,t)=>{const n=Math.max(1,Math.floor(e)),r=new Array(n);for(let e=0;e<n;e++)r[e]=t(e);return r},m=e=>Array.isArray(e)?e:Array.from(e),y=e=>Array.isArray(e)?e:[e],g=(u.Wo,c.$r,(0,o.XY)(2,((e,{onEmpty:t,onNonEmpty:n})=>S(e)?n(E(e),A(e)):t()))),w=(0,o.XY)(2,((e,t)=>[t,...e])),N=(0,o.XY)(2,((e,t)=>[...e,t])),b=(0,o.XY)(2,((e,t)=>m(e).concat(m(t)))),v=Array.isArray,x=e=>0===e.length,k=s.E,S=s.E,O=(e,t)=>e<0||e>=t.length,W=(e,t)=>Math.floor(Math.min(Math.max(0,e),t.length)),I=(0,o.XY)(2,((e,t)=>{const n=Math.floor(t);return O(n,e)?c.dv():c.zN(e[n])})),q=(0,o.XY)(2,((e,t)=>{const n=Math.floor(t);if(O(n,e))throw new Error(`Index ${n} out of bounds`);return e[n]})),T=I(0),E=q(0),C=e=>S(e)?c.zN(L(e)):c.dv(),L=e=>e[e.length-1],A=e=>e.slice(1),D=(e,t)=>{let n=0;for(const r of e){if(!t(r,n))break;n++}return n},B=(0,o.XY)(2,((e,t)=>G(e,D(e,t)))),P=(0,o.XY)(2,((e,t)=>{const n=m(e);return n.slice(W(t,n),n.length)})),M=(0,o.XY)(2,((e,t)=>{let n=0;for(const r of e){if(t(r,n))return c.zN(n);n++}return c.dv()})),F=(0,o.XY)(2,((e,t)=>{const n=m(e);for(let e=n.length-1;e>=0;e--)if(t(n[e],e))return c.zN(e);return c.dv()})),R=a.i8,U=(0,o.XY)(2,((e,t)=>{const n=m(e);for(let e=n.length-1;e>=0;e--){const r=n[e],i=t(r,e);if((0,l.Lm)(i)){if(i)return c.zN(r)}else if(c.Ru(i))return i}return c.dv()})),j=(0,o.XY)(3,((e,t,n)=>_(e,t,(()=>n)))),_=(0,o.XY)(3,((e,t,n)=>c.WL($(e,t,n),(()=>Array.from(e))))),$=(0,o.XY)(3,((e,t,n)=>{const r=Array.from(e);if(O(t,r))return c.dv();const i=n(r[t]);return r[t]=i,c.zN(r)})),Q=e=>Array.from(e).reverse(),J=(0,o.XY)(2,((e,t)=>{const n=Array.from(e);return n.sort(t),n})),K=(0,o.XY)(2,((e,t)=>H(e,t,p.L8))),H=(0,o.XY)(3,((e,t,n)=>{const r=m(e),i=m(t);if(S(r)&&S(i)){const e=[n(E(r),E(i))],t=Math.min(r.length,i.length);for(let o=1;o<t;o++)e[o]=n(r[o],i[o]);return e}return[]})),Y=e=>{const t=m(e);if(S(t)){const e=[t[0][0]],n=[t[0][1]];for(let r=1;r<t.length;r++)e[r]=t[r][0],n[r]=t[r][1];return[e,n]}return[[],[]]},V=e=>(0,o.XY)(2,((t,n)=>{for(const r of t)if(e(n,r))return!0;return!1})),z=r.XY(),X=V(z),G=(0,o.XY)(2,((e,t)=>{const n=Array.from(e),r=Math.floor(t);return S(n)?r>=1?Z(n,r):[[],n]:[n,[]]})),Z=(0,o.XY)(2,((e,t)=>{const n=Math.max(1,Math.floor(t));return n>=e.length?[ee(e),[]]:[w(e.slice(1,n),E(e)),e.slice(n)]})),ee=e=>e.slice(),te=(0,o.XY)(3,((e,t,n)=>{const r=m(e),i=m(t);if(S(r)){if(S(i)){return be(n)(b(r,i))}return r}return i})),ne=(0,o.XY)(2,((e,t)=>te(e,t,z))),re=e=>{const t=V(e);return(0,o.XY)(2,((e,n)=>m(e).filter((e=>t(n,e)))))},ie=re(z),oe=e=>{const t=V(e);return(0,o.XY)(2,((e,n)=>m(e).filter((e=>!t(n,e)))))},se=()=>[],ae=e=>[e],ce=(0,o.XY)(2,((e,t)=>e.map(t))),de=(0,o.XY)(2,((e,t)=>{if(x(e))return[];const n=[];for(let r=0;r<e.length;r++){const i=t(e[r],r);for(let e=0;e<i.length;e++)n.push(i[e])}return n})),le=de(o.D_),ue=(0,o.XY)(2,((e,t)=>{const n=m(e),r=[];for(let e=0;e<n.length;e++){const i=t(n[e],e);c.Ru(i)&&r.push(i.value)}return r})),pe=(0,o.XY)(2,((e,t)=>{let n=0;const r=[];for(const i of e){const e=t(i,n);if(!c.Ru(e))break;r.push(e.value),n++}return r})),he=ue(o.D_),fe=(0,o.XY)(2,((e,t)=>{const n=m(e),r=[];for(let e=0;e<n.length;e++)t(n[e],e)&&r.push(n[e]);return r})),me=(0,o.XY)(2,((e,t)=>{const n=[],r=[],i=m(e);for(let e=0;e<i.length;e++)t(i[e],e)?r.push(i[e]):n.push(i[e]);return[n,r]})),ye=(0,o.XY)(3,((e,t,n)=>m(e).reduce(((e,t,r)=>n(e,t,r)),t))),ge=(0,o.XY)(3,((e,t,n)=>m(e).reduceRight(((e,t,r)=>n(e,t,r)),t))),we=(e,t)=>{const n=[];let r,i=e;for(;c.Ru(r=t(i));){const[e,t]=r.value;n.push(e),i=t}return n},Ne=(d.YO,i.YO),be=(0,o.XY)(2,((e,t)=>{const n=m(e);if(S(n)){const e=[E(n)],r=A(n);for(const n of r)e.every((e=>!t(n,e)))&&e.push(n);return e}return[]})),ve=e=>be(e,r.XY()),xe=(0,o.XY)(2,((e,t)=>m(e).join(t))),ke=(0,o.XY)(3,((e,t,n)=>{let r=0,i=t;const o=[];for(const t of e){const e=n(i,t,r);i=e[0],o.push(e[1]),r++}return[i,o]}))},200093:(e,t,n)=>{n.r(t),n.d(t,{Do:()=>En,EffectTypeId:()=>g,Tag:()=>io,acquireRelease:()=>lt,acquireReleaseInterruptible:()=>ut,acquireUseRelease:()=>pt,addFinalizer:()=>ht,all:()=>S,allSuccesses:()=>W,allWith:()=>O,allowInterrupt:()=>Ue,andThen:()=>zn,annotateCurrentSpan:()=>$i,annotateLogs:()=>$r,annotateLogsScoped:()=>Qr,annotateSpans:()=>_i,ap:()=>Ii,as:()=>Xe,asSome:()=>Ge,asSomeError:()=>Ze,asVoid:()=>et,async:()=>V,asyncEffect:()=>z,awaitAllChildren:()=>Ot,bind:()=>Cn,bindTo:()=>Ln,blocked:()=>qi,cacheRequestResult:()=>Li,cached:()=>v,cachedFunction:()=>x,cachedInvalidateWithTTL:()=>b,cachedWithTTL:()=>N,catch:()=>ge,catchAll:()=>we,catchAllCause:()=>Ne,catchAllDefect:()=>be,catchIf:()=>ve,catchSome:()=>xe,catchSomeCause:()=>ke,catchSomeDefect:()=>Se,catchTag:()=>Oe,catchTags:()=>We,cause:()=>Ie,checkInterruptible:()=>je,clock:()=>Yt,clockWith:()=>Vt,configProviderWith:()=>pn,console:()=>Gt,consoleWith:()=>Zt,context:()=>mn,contextWith:()=>yn,contextWithEffect:()=>gn,currentParentSpan:()=>Ji,currentSpan:()=>Qi,custom:()=>X,daemonChildren:()=>Wt,delay:()=>nn,descriptor:()=>It,descriptorWith:()=>qt,die:()=>re,dieMessage:()=>ie,dieSync:()=>oe,diffFiberRefs:()=>Tt,disconnect:()=>_e,dropUntil:()=>I,dropWhile:()=>q,either:()=>Dn,ensuring:()=>ft,ensuringChild:()=>Et,ensuringChildren:()=>Ct,eventually:()=>qe,every:()=>T,exists:()=>E,exit:()=>Bn,fail:()=>Z,failCause:()=>te,failCauseSync:()=>ne,failSync:()=>ee,fiberId:()=>Lt,fiberIdWith:()=>At,filter:()=>C,filterMap:()=>L,filterOrDie:()=>Rn,filterOrDieMessage:()=>Un,filterOrElse:()=>jn,filterOrFail:()=>_n,finalizersMask:()=>wt,findFirst:()=>A,firstSuccessOf:()=>D,flatMap:()=>Vn,flatten:()=>Xn,flip:()=>tt,flipWith:()=>nt,forEach:()=>B,forever:()=>dr,fork:()=>Dt,forkAll:()=>Pt,forkDaemon:()=>Bt,forkIn:()=>Mt,forkScoped:()=>Ft,forkWithErrorHandler:()=>Rt,fromFiber:()=>Ut,fromFiberEffect:()=>jt,fromNullable:()=>no,functionWithSpan:()=>Zi,gen:()=>se,getFiberRefs:()=>Nr,getRuntimeFlags:()=>ri,head:()=>P,if:()=>Fn,ignore:()=>Te,ignoreLogged:()=>Ee,inheritFiberRefs:()=>br,interrupt:()=>$e,interruptWith:()=>Qe,interruptible:()=>Je,interruptibleMask:()=>Ke,intoDeferred:()=>Pn,isEffect:()=>w,isFailure:()=>qr,isSuccess:()=>Tr,iterate:()=>lr,labelMetrics:()=>ci,labelMetricsScoped:()=>li,let:()=>An,liftPredicate:()=>ze,linkSpans:()=>Yi,locally:()=>vr,locallyScoped:()=>kr,locallyScopedWith:()=>Sr,locallyWith:()=>xr,log:()=>Dr,logAnnotations:()=>Jr,logDebug:()=>Mr,logError:()=>Ur,logFatal:()=>jr,logInfo:()=>Fr,logTrace:()=>Pr,logWarning:()=>Rr,logWithLevel:()=>Br,loop:()=>ur,makeSemaphore:()=>fi,makeSpan:()=>Vi,makeSpanScoped:()=>zi,map:()=>rt,mapAccum:()=>it,mapBoth:()=>ot,mapError:()=>st,mapErrorCause:()=>at,mapInputContext:()=>wn,match:()=>Er,matchCause:()=>Cr,matchCauseEffect:()=>Lr,matchEffect:()=>Ar,merge:()=>ct,mergeAll:()=>M,metricLabels:()=>ui,negate:()=>dt,never:()=>ae,none:()=>ce,onError:()=>mt,onExit:()=>yt,onInterrupt:()=>He,once:()=>k,option:()=>Mn,optionFromOptional:()=>ro,orDie:()=>Hr,orDieWith:()=>Yr,orElse:()=>Vr,orElseFail:()=>zr,orElseSucceed:()=>Xr,parallelErrors:()=>Ce,parallelFinalizers:()=>gt,partition:()=>F,patchFiberRefs:()=>Or,patchRuntimeFlags:()=>ii,promise:()=>de,provide:()=>Nn,provideService:()=>bn,provideServiceEffect:()=>vn,race:()=>Zn,raceAll:()=>Gn,raceFirst:()=>er,raceWith:()=>tr,random:()=>Gr,randomWith:()=>Zr,reduce:()=>R,reduceEffect:()=>U,reduceRight:()=>j,reduceWhile:()=>_,repeat:()=>pr,repeatN:()=>hr,repeatOrElse:()=>fr,replicate:()=>$,replicateEffect:()=>Q,request:()=>Ci,retry:()=>Ae,retryOrElse:()=>De,runCallback:()=>yi,runFork:()=>mi,runPromise:()=>gi,runPromiseExit:()=>wi,runRequestBlock:()=>Ti,runSync:()=>Ni,runSyncExit:()=>bi,runtime:()=>ni,sandbox:()=>Le,schedule:()=>mr,scheduleForked:()=>yr,scheduleFrom:()=>gr,scope:()=>bt,scopeWith:()=>vt,scoped:()=>xt,sequentialFinalizers:()=>Nt,serviceConstants:()=>On,serviceFunction:()=>xn,serviceFunctionEffect:()=>kn,serviceFunctions:()=>Sn,serviceMembers:()=>Wn,serviceOption:()=>In,serviceOptional:()=>qn,setFiberRefs:()=>Wr,sleep:()=>rn,spanAnnotations:()=>Ki,spanLinks:()=>Hi,step:()=>Ei,succeed:()=>le,succeedNone:()=>ue,succeedSome:()=>pe,summarized:()=>nr,supervised:()=>_t,suspend:()=>he,sync:()=>fe,tagMetrics:()=>ai,tagMetricsScoped:()=>di,takeUntil:()=>J,takeWhile:()=>K,tap:()=>rr,tapBoth:()=>ir,tapDefect:()=>or,tapError:()=>sr,tapErrorCause:()=>cr,tapErrorTag:()=>ar,timed:()=>on,timedWith:()=>sn,timeout:()=>an,timeoutFail:()=>dn,timeoutFailCause:()=>ln,timeoutOption:()=>cn,timeoutTo:()=>un,tracer:()=>Pi,tracerWith:()=>Mi,transplant:()=>$t,try:()=>Be,tryMap:()=>Pe,tryMapPromise:()=>Me,tryPromise:()=>Fe,uninterruptible:()=>Ye,uninterruptibleMask:()=>Ve,unless:()=>$n,unlessEffect:()=>Qn,unsafeMakeSemaphore:()=>hi,unsandbox:()=>Re,updateFiberRefs:()=>Ir,updateService:()=>Tn,useSpan:()=>Xi,using:()=>kt,validate:()=>vi,validateAll:()=>H,validateFirst:()=>Y,validateWith:()=>xi,void:()=>me,when:()=>Jn,whenEffect:()=>Kn,whenFiberRef:()=>Hn,whenRef:()=>Yn,whileLoop:()=>wr,withClock:()=>Xt,withClockScoped:()=>zt,withConcurrency:()=>Qt,withConfigProvider:()=>hn,withConfigProviderScoped:()=>fn,withConsole:()=>tn,withConsoleScoped:()=>en,withEarlyRelease:()=>St,withFiberRuntime:()=>G,withLogSpan:()=>_r,withMaxOpsBeforeYield:()=>Ht,withMetric:()=>pi,withParentSpan:()=>to,withRandom:()=>ei,withRandomScoped:()=>ti,withRequestBatching:()=>Ai,withRequestCache:()=>Bi,withRequestCaching:()=>Di,withRuntimeFlagsPatch:()=>oi,withRuntimeFlagsPatchScoped:()=>si,withScheduler:()=>Jt,withSchedulingPriority:()=>Kt,withSpan:()=>Gi,withSpanScoped:()=>eo,withTracer:()=>Fi,withTracerEnabled:()=>Ui,withTracerScoped:()=>Ri,withTracerTiming:()=>ji,withUnhandledErrorLogLevel:()=>Kr,yieldNow:()=>ye,zip:()=>ki,zipLeft:()=>Si,zipRight:()=>Oi,zipWith:()=>Wi});var r=n(374212),i=n(608111),o=n(937957),s=n(648029),a=n(507503),c=n(266315),d=n(338265),l=n(426964),u=n(367442),p=n(960510),h=n(83902),f=n(387162),m=n(985455),y=n(345059);const g=a.$n1,w=a.yw5,N=d.PO,b=d.CJ,v=s.Bj,x=d.L_,k=s.Oo,S=l.Q7,O=l._y,W=l.XU,I=s.Cm,q=s.Hd,T=s.Si,E=l.t2,C=l.pb,L=s.x1,A=s.i8,D=s.Dd,B=l.jJ,P=s.d5,M=l.B1,F=l.jB,R=s.TS,U=l.GH,j=s.XK,_=s.KE,$=l.aA,Q=l.Xr,J=s.QK,K=s.v6,H=l.wM,Y=l.nO,V=a.bIC,z=h.a1,X=a.IeY,G=a.$we,Z=a.fJG,ee=a.gOk,te=a.ATB,ne=a.pVV,re=a.F_Q,ie=a.GSS,oe=a.Kbz,se=s.Jk,ae=a.ZmZ,ce=s.dv,de=s.iv,le=a.PyW,ue=s.lw,pe=s.nG,he=a.DYE,fe=a.OH5,me=a.rIH,ye=a.m9E,ge=s.nb,we=a.h9N,Ne=a.uPo,be=s.IK,ve=a.XWm,xe=a._Oy,ke=s.RJ,Se=s.Nu,Oe=s.Ku,We=s.lo,Ie=s.c1,qe=s.u4,Te=s.Xe,Ee=s.XP,Ce=s.Zk,Le=s._S,Ae=f.nn,De=f.H_,Be=s.bS,Pe=s.gZ,Me=s.xA,Fe=s.$m,Re=s.Pb,Ue=s.vV,je=a._5X,_e=l.Zf,$e=a.GaK,Qe=a.IPo,Je=a.Inz,Ke=a.eMl,He=a.nAr,Ye=a.rfi,Ve=a.FcF,ze=s.VW,Xe=a.as,Ge=s.Xx,Ze=s.t2,et=a.NLW,tt=a.UUz,nt=s.AA,rt=a.TjK,it=s.OM,ot=a.UcN,st=a.xm_,at=s.aW,ct=s.h1,dt=s.ze,lt=l.Q5,ut=l.p5,pt=a.jGc,ht=l.U9,ft=l.ye,mt=a.S5A,yt=a.cfM,gt=l.dJ,wt=l.ct,Nt=l.PO,bt=l.z8,vt=l.NB,xt=l.sZ,kt=l.v,St=l.lg,Ot=d.PC,Wt=l.e7,It=s.yu,qt=s.U$,Tt=s.Ek,Et=d.GR,Ct=d.jE,Lt=a.ABT,At=a.g1G,Dt=l.Zy,Bt=l.LX,Pt=d.Oy,Mt=d.ar,Ft=d.x6,Rt=l.Bh,Ut=d.$T,jt=d.qK,_t=d.Tg,$t=a.sK9,Qt=a.KyM,Jt=y.kW,Kt=a.FRe,Ht=a.jDN,Yt=s.pm,Vt=s.RK,zt=l.rh,Xt=c.V6,Gt=i.k2,Zt=i.un,en=i.Q_,tn=i.QW,nn=s.cb,rn=s.yy,on=s.ay,sn=s.yW,an=d.wR,cn=d.D5,dn=d.AN,ln=d.ny,un=d.nH,pn=c.aP,hn=c.gm,fn=l.Ek,mn=a._OA,yn=s.sx,gn=a.d_m,wn=a.kyh,Nn=u.up,bn=s.Pf,vn=s.c7,xn=s.A3,kn=s.p4,Sn=s.KO,On=s.XN,Wn=s.ZF,In=s.N,qn=s.gB,Tn=s.bU,En=s.Do,Cn=s.oI,Ln=s.Jr,An=s.zM,Dn=a.gPK,Bn=a.NS5,Pn=a._ig,Mn=s.uK,Fn=a.tDT,Rn=s.kr,Un=s.Nf,jn=s.Pm,_n=s.W$,$n=s.NJ,Qn=s.ix,Jn=s.z7,Kn=a.iK2,Hn=s.iz,Yn=s.mf,Vn=a.qIB,zn=a.hgn,Xn=a.Bqz,Gn=l.Vd,Zn=l.O4,er=d.KT,tr=l.wV,nr=s.Uy,rr=a.Mim,ir=s.Bi,or=s.nA,sr=s.sF,ar=s.TN,cr=s.Ly,dr=s.i4,lr=s.nl,ur=s.HW,pr=f.Mj,hr=s.wn,fr=f.g2,mr=f.mg,yr=d.Rq,gr=f.Av,wr=a.iMI,Nr=s.rQ,br=s.EN,vr=a.woH,xr=a.q1t,kr=l.Eq,Sr=l._1,Or=s.Bz,Wr=s.Z,Ir=s.En,qr=s.N6,Tr=s.oJ,Er=s.YW,Cr=a.D$$,Lr=a.khu,Ar=a.tvg,Dr=s.Rm,Br=(e,...t)=>s.lI(e)(...t),Pr=s.om,Mr=s.MD,Fr=s.fH,Rr=s.FF,Ur=s.Og,jr=s.Zc,_r=s.f1,$r=s.sw,Qr=l.gs,Jr=s.rr,Kr=a.EYO,Hr=a.QgK,Yr=a.kS9,Vr=a.NWQ,zr=s.xS,Xr=s.DM,Gr=s.yT,Zr=c.Gx,ei=c.Ii,ti=l.AA,ni=h.fA,ri=a.m$m,ii=a.$QS,oi=a.cay,si=l.qH,ai=s.G6,ci=s.Mw,di=l.Yt,li=l.oi,ui=a.SLb,pi=s.Xz,hi=d.RI,fi=d.VH,mi=h.C9,yi=h.HZ,gi=h.w$,wi=h.MN,Ni=h.wg,bi=h.ej,vi=l.tf,xi=l.xJ,ki=l.SJ,Si=l.Ne,Oi=l.OC,Wi=l.cw,Ii=(0,r.XY)(2,((e,t)=>Wi(e,t,((e,t)=>e(t))))),qi=a.Z5i,Ti=a.UFt,Ei=a.PMw,Ci=(0,r.XY)((e=>m.ks(e[0])),p.kc),Li=p.QA,Ai=a.mHP,Di=p.f0,Bi=p.Uj,Pi=s.kJ,Mi=c.wT,Fi=c._o,Ri=l.i4,Ui=a.nDN,ji=a.MaT,_i=s.Mu,$i=s.ww,Qi=s._3,Ji=s.Wj,Ki=s.Fu,Hi=s.Wb,Yi=s.A_,Vi=s.Z9,zi=l.Rd,Xi=s.gv,Gi=s.fR,Zi=s.RO,eo=l.zr,to=s.hq,no=s.k$,ro=s.SM,io=e=>()=>{const t=Error.stackTraceLimit;Error.stackTraceLimit=2;const n=new Error;function r(){}Error.stackTraceLimit=t,Object.setPrototypeOf(r,o.XI),r.key=e,Object.defineProperty(r,"stack",{get:()=>n.stack});const i=new Map;return new Proxy(r,{get(e,t,n){if("use"===t)return e=>a.hgn(r,e);if(t in r)return r[t];if(i.has(t))return i.get(t);const o=(...e)=>a.hgn(r,(n=>"function"==typeof n[t]?(i.set(t,((...e)=>a.hgn(r,(n=>n[t](...e))))),n[t](...e)):(i.set(t,a.hgn(r,(e=>e[t]))),n[t]))),s=a.hgn(r,(e=>e[t]));return Object.assign(o,s),Object.setPrototypeOf(o,Object.getPrototypeOf(s)),i.set(t,o),o}})}},374212:(e,t,n)=>{n.d(t,{D_:()=>o,Fs:()=>p,GQ:()=>u,L3:()=>h,MN:()=>d,Tn:()=>r,XY:()=>i,Yi:()=>l,dY:()=>s,f4:()=>c,ue:()=>a});const r=e=>"function"==typeof e,i=function(e,t){if("function"==typeof e)return function(){return e(arguments)?t.apply(this,arguments):e=>t(e,...arguments)};switch(e){case 0:case 1:throw new RangeError(`Invalid arity ${e}`);case 2:return function(e,n){return arguments.length>=2?t(e,n):function(n){return t(n,e)}};case 3:return function(e,n,r){return arguments.length>=3?t(e,n,r):function(r){return t(r,e,n)}};case 4:return function(e,n,r,i){return arguments.length>=4?t(e,n,r,i):function(i){return t(i,e,n,r)}};case 5:return function(e,n,r,i,o){return arguments.length>=5?t(e,n,r,i,o):function(o){return t(o,e,n,r,i)}};default:return function(){if(arguments.length>=e)return t.apply(this,arguments);const n=arguments;return function(e){return t(e,...n)}}}},o=e=>e,s=e=>()=>e,a=s(!0),c=s(!1),d=s(void 0),l=d,u=e=>{throw new Error("Called `absurd` function which should be uncallable")};function p(e,t,n,r,i,o,s,a,c){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return n(t(e));case 4:return r(n(t(e)));case 5:return i(r(n(t(e))));case 6:return o(i(r(n(t(e)))));case 7:return s(o(i(r(n(t(e))))));case 8:return a(s(o(i(r(n(t(e)))))));case 9:return c(a(s(o(i(r(n(t(e))))))));default:{let e=arguments[0];for(let t=1;t<arguments.length;t++)e=arguments[t](e);return e}}}function h(e,t,n,r,i,o,s,a,c){switch(arguments.length){case 1:return e;case 2:return function(){return t(e.apply(this,arguments))};case 3:return function(){return n(t(e.apply(this,arguments)))};case 4:return function(){return r(n(t(e.apply(this,arguments))))};case 5:return function(){return i(r(n(t(e.apply(this,arguments)))))};case 6:return function(){return o(i(r(n(t(e.apply(this,arguments))))))};case 7:return function(){return s(o(i(r(n(t(e.apply(this,arguments)))))))};case 8:return function(){return a(s(o(i(r(n(t(e.apply(this,arguments))))))))};case 9:return function(){return c(a(s(o(i(r(n(t(e.apply(this,arguments)))))))))}}}},796031:(e,t,n)=>{n.d(t,{Gt:()=>u,Py:()=>l,QZ:()=>a,Um:()=>d,_O:()=>s,h1:()=>c,jq:()=>o});var r=n(367442),i=n(871035);r.Lc,r.mH,r.IW,r.pL,r.sw,r.Mu;const o=r.jq,s=(r.LT,r.h9,r.uP,r._O),a=(r.F_,r.Kb,r.vf,r.uS),c=(r.AC,r.Nf,r.Ie,r.XE,r.fJ,r.gO,r.AT,r.pV,r.qI,r.Bq,r.pn,r.Xx,r.ql,r.Tj,r.xm,r.YW,r.D$,r.Bj,r.h1),d=r.Um,l=(r.Qg,r.NW,r.le,r.Cv,r.sk,r.wo,r.q1,r.Eq,r._1,r.L5,r.z8,r.P1,r.dm,r.qA,r.eu,r.Py),u=(r.Or,r.DY,r.OH,r.Jc,r.Mi,r.sF,r.Ly,r.Qf,r.Yp,r.Gt);r.S5,r.OY,r.vM,r.A2,i.e2,i.$5,i.cL,i.mv,r.fR,r.hq,r.vh,r.H7},620113:(e,t,n)=>{n.d(t,{GV:()=>s,Kt:()=>a,U5:()=>d,pH:()=>c,qg:()=>l});var r=n(617194),i=n(584129),o=n(271314);n(43963).Et;const s=e=>e+1,a=e=>e-1,c=(r.ai,o.ai),d=e=>{const t=Math.ceil(Math.log(e)/Math.log(2));return Math.max(Math.pow(2,t),2)},l=e=>{if("NaN"===e)return i.zN(NaN);if("Infinity"===e)return i.zN(1/0);if("-Infinity"===e)return i.zN(-1/0);if(""===e.trim())return i.dv;const t=Number(e);return Number.isNaN(t)?i.dv:i.zN(t)}},43963:(e,t,n)=>{n.d(t,{$J:()=>w,$P:()=>x,$X:()=>O,$y:()=>b,Bm:()=>d,EA:()=>p,Et:()=>s,Gv:()=>y,Kg:()=>o,Lm:()=>a,Pd:()=>f,Tn:()=>l,b0:()=>u,i5:()=>g,kZ:()=>h,mg:()=>v,sI:()=>c,u4:()=>S,wD:()=>N,xZ:()=>k,zz:()=>i});var r=n(374212);const i=e=>!!e,o=e=>"string"==typeof e,s=e=>"number"==typeof e,a=e=>"boolean"==typeof e,c=e=>"bigint"==typeof e,d=e=>"symbol"==typeof e,l=r.Tn,u=e=>void 0===e,p=e=>void 0!==e,h=e=>null===e,f=e=>!1,m=e=>"object"==typeof e&&null!==e,y=e=>m(e)||l(e),g=(0,r.XY)(2,((e,t)=>y(e)&&t in e)),w=(0,r.XY)(2,((e,t)=>g(e,"_tag")&&e._tag===t)),N=e=>null==e,b=e=>null!=e,v=e=>e instanceof Uint8Array,x=e=>e instanceof Date,k=e=>g(e,Symbol.iterator),S=e=>m(e)&&!Array.isArray(e),O=e=>g(e,"then")&&l(e.then)},332665:(e,t,n)=>{n.d(t,{Bd:()=>i,i4:()=>o,ji:()=>a,t5:()=>s});var r=n(387162);r.NU,r.rk,r.g7,r.VN,r.Y4,r.hg,r.y8,r.as,r.NL,r.FX,r.z6,r.ab,r.vt,r.IE,r.Fh,r.Mc,r.wu,r.tB,r.Zz,r.zQ,r.ky,r.K7,r.U9,r.BW,r.SD,r.mK,r.Nw,r.ol,r.iq,r.xA,r.Uc,r.$E;const i=r.Bd,o=(r.p0,r.gP,r.k$,r.vk,r.ye,r.EV,r.$_,r.Zu,r.i4),s=(r._E,r.Ht,r.Xx,r.cf,r.D_,r.y$,r.SV,r.et,r.q3,r.sn,r.Tj,r.WK,r.cM,r.y1,r.Nb,r.u1,r.Oo,r.le,r.Pp,r.Pf,r.oG,r.$y,r.Vf,r.O5,r.FP,r.fE,r.t5),a=(r.TS,r.GH,r.i4,r.Xu,r.yj,r.uw,r.eF,r.Qn,r.ji);r.ds,r.Py,r.OH,r.EM,r.NZ,r.t8,r.KC,r.q2,r.RY,r.GE,r.m$,r.HI,r.jB,r.O9,r.vm,r.v,r.ph,r.Ix,r.pi,r.aN,r.OY},608111:(e,t,n)=>{n.d(t,{BU:()=>v,CE:()=>L,I1:()=>C,IU:()=>y,Os:()=>k,QW:()=>p,Q_:()=>h,R8:()=>E,Rm:()=>O,Ts:()=>w,U9:()=>g,Yz:()=>N,al:()=>q,k2:()=>l,kB:()=>I,oV:()=>f,pq:()=>S,tp:()=>W,uP:()=>T,un:()=>u,vA:()=>m,y_:()=>b,z3:()=>x});var r=n(703225),i=n(374212),o=n(507503),s=n(266315),a=n(119153),c=n(426964),d=n(367442);const l=o.TjK(o.U8_(s.qJ),r.Jt(a.MG)),u=e=>o.uPR(s.qJ,(t=>e(r.Jt(t,a.MG)))),p=(0,i.XY)(2,((e,t)=>o.q1t(e,s.qJ,r.WQ(a.MG,t)))),h=e=>c._1(s.qJ,r.WQ(a.MG,e)),f=e=>d.dm(c._1(s.qJ,r.WQ(a.MG,e))),m=(e,...t)=>u((n=>n.assert(e,...t))),y=u((e=>e.clear)),g=e=>u((t=>t.count(e))),w=e=>u((t=>t.countReset(e))),N=(...e)=>u((t=>t.debug(...e))),b=(e,t)=>u((n=>n.dir(e,t))),v=(...e)=>u((t=>t.dirxml(...e))),x=(...e)=>u((t=>t.error(...e))),k=e=>u((t=>c.Q5(t.group(e),(()=>t.groupEnd)))),S=(...e)=>u((t=>t.info(...e))),O=(...e)=>u((t=>t.log(...e))),W=(e,t)=>u((n=>n.table(e,t))),I=e=>u((t=>c.Q5(t.time(e),(()=>t.timeEnd(e))))),q=(e,...t)=>u((n=>n.timeLog(e,...t))),T=(...e)=>u((t=>t.trace(...e))),E=(...e)=>u((t=>t.warn(...e))),C=(0,i.XY)((e=>o.yw5(e[0])),((e,t)=>u((n=>o.jGc(n.group(t),(()=>e),(()=>n.groupEnd)))))),L=(0,i.XY)((e=>o.yw5(e[0])),((e,t)=>u((n=>o.jGc(n.time(t),(()=>e),(()=>n.timeEnd(t)))))))},937957:(e,t,n)=>{n.d(t,{$v:()=>O,Ie:()=>x,Jt:()=>W,KA:()=>f,L8:()=>k,Sr:()=>u,Up:()=>T,WQ:()=>S,XI:()=>h,aE:()=>N,cJ:()=>E,dz:()=>b,h1:()=>q,ii:()=>y,og:()=>w,om:()=>I,vw:()=>m});var r=n(545422),i=n(374212),o=n(32388),s=n(755642),a=n(977148),c=n(43963),d=n(428461),l=n(584129);const u=Symbol.for("effect/Context/Tag"),p=Symbol.for("effect/STM"),h={...d.MS,_tag:"Tag",_op:"Tag",[p]:d.Hs,[u]:{_Service:e=>e,_Identifier:e=>e},toString(){return(0,s.GP)(this.toJSON())},toJSON(){return{_id:"Tag",key:this.key,stack:this.stack}},[s.FX](){return this.toJSON()},of:e=>e,context(e){return k(this,e)}},f=e=>{const t=Error.stackTraceLimit;Error.stackTraceLimit=2;const n=new Error;Error.stackTraceLimit=t;const r=Object.create(h);return Object.defineProperty(r,"stack",{get:()=>n.stack}),r.key=e,r},m=e=>()=>{const t=Error.stackTraceLimit;Error.stackTraceLimit=2;const n=new Error;function r(){}return Error.stackTraceLimit=t,Object.setPrototypeOf(r,h),r.key=e,Object.defineProperty(r,"stack",{get:()=>n.stack}),r},y=Symbol.for("effect/Context"),g={[y]:{_Services:e=>e},[r.HR](e){if(N(e)&&this.unsafeMap.size===e.unsafeMap.size){for(const t of this.unsafeMap.keys())if(!e.unsafeMap.has(t)||!r.aI(this.unsafeMap.get(t),e.unsafeMap.get(t)))return!1;return!0}return!1},[o.HR](){return o.PO(this,o.ai(this.unsafeMap.size))},pipe(){return(0,a.t)(this,arguments)},toString(){return(0,s.GP)(this.toJSON())},toJSON(){return{_id:"Context",services:Array.from(this.unsafeMap).map(s.U2)}},[s.FX](){return this.toJSON()}},w=e=>{const t=Object.create(g);return t.unsafeMap=e,t},N=e=>(0,c.i5)(e,y),b=e=>(0,c.i5)(e,u),v=w(new Map),x=()=>v,k=(e,t)=>w(new Map([[e.key,t]])),S=(0,i.XY)(3,((e,t,n)=>{const r=new Map(e.unsafeMap);return r.set(t.key,n),w(r)})),O=(0,i.XY)(2,((e,t)=>{if(!e.unsafeMap.has(t.key))throw(e=>{const t=new Error("Service not found"+(e.key?`: ${String(e.key)}`:""));if(e.stack){const n=e.stack.split("\n");if(n.length>2){const e=n[2].match(/at (.*)/);e&&(t.message=t.message+` (defined at ${e[1]})`)}}if(t.stack){const e=t.stack.split("\n");e.splice(1,3),t.stack=e.join("\n")}return t})(t);return e.unsafeMap.get(t.key)})),W=O,I=(0,i.XY)(2,((e,t)=>e.unsafeMap.has(t.key)?l.zN(e.unsafeMap.get(t.key)):l.dv)),q=(0,i.XY)(2,((e,t)=>{const n=new Map(e.unsafeMap);for(const[e,r]of t.unsafeMap)n.set(e,r);return w(n)})),T=(...e)=>t=>{const n=new Set(e.map((e=>e.key))),r=new Map;for(const[e,i]of t.unsafeMap.entries())n.has(e)&&r.set(e,i);return w(r)},E=(...e)=>t=>{const n=new Map(t.unsafeMap);for(const t of e)n.delete(t.key);return w(n)}},648029:(e,t,n)=>{n.d(t,{$m:()=>kt,A3:()=>Pt,AA:()=>le,A_:()=>Kt,Bi:()=>mt,Bj:()=>Re,Bz:()=>Ye,Cm:()=>X,DM:()=>Ke,Dd:()=>de,Do:()=>H,EN:()=>be,Ek:()=>K,En:()=>Tt,FF:()=>Te,Fu:()=>zt,G6:()=>ut,HW:()=>De,Hd:()=>G,IK:()=>D,Jk:()=>me,Jr:()=>V,KE:()=>tt,KO:()=>Mt,Ku:()=>M,Ly:()=>Nt,MD:()=>Ie,Mu:()=>$t,Mw:()=>pt,N:()=>Ut,N6:()=>ve,NJ:()=>Wt,Nf:()=>re,Nu:()=>P,OM:()=>Me,Og:()=>Ee,Oo:()=>$e,Pb:()=>qt,Pf:()=>ze,Pm:()=>ie,QK:()=>ht,RJ:()=>B,RK:()=>U,RO:()=>nn,Rm:()=>Oe,SM:()=>on,Si:()=>pe,TN:()=>wt,TS:()=>Ze,U$:()=>$,Uy:()=>lt,VW:()=>oe,W$:()=>se,Wb:()=>Xt,Wj:()=>Qt,XK:()=>et,XN:()=>Ft,XP:()=>Ne,Xe:()=>we,Xx:()=>E,Xz:()=>Dt,YW:()=>ue,Z:()=>st,Z9:()=>Vt,ZF:()=>Rt,Zc:()=>Ce,Zk:()=>He,_3:()=>Jt,_S:()=>ot,aW:()=>Fe,ay:()=>bt,bS:()=>L,bU:()=>Et,c1:()=>R,c7:()=>Xe,cb:()=>_,d5:()=>ge,dv:()=>_e,ex:()=>Gt,f1:()=>Le,fH:()=>qe,fR:()=>tn,gB:()=>jt,gZ:()=>St,gv:()=>Zt,h1:()=>Ue,hq:()=>en,i4:()=>fe,i8:()=>ae,iv:()=>Ve,ix:()=>It,iz:()=>Lt,k$:()=>rn,kJ:()=>xt,kr:()=>ne,lI:()=>Se,lo:()=>F,lw:()=>ct,mf:()=>At,nA:()=>yt,nG:()=>dt,nb:()=>A,nl:()=>ke,oI:()=>Y,oJ:()=>xe,om:()=>We,p4:()=>Bt,pm:()=>j,rQ:()=>ye,rr:()=>Ae,sF:()=>gt,sw:()=>T,sx:()=>Z,t2:()=>C,u4:()=>ee,uK:()=>Qe,v6:()=>ft,vV:()=>Q,wn:()=>rt,ww:()=>_t,x1:()=>te,xA:()=>Ot,xI:()=>Yt,xS:()=>Je,yT:()=>Ge,yW:()=>vt,yu:()=>J,yy:()=>at,z7:()=>Ct,zM:()=>z,ze:()=>je});var r=n(7663),i=n(975955),o=n(754603),s=n(460336),a=n(703225),c=n(972e3),d=n(700182),l=n(374212),u=n(594152),p=n(793414),h=n(934796),f=n(770324),m=n(722219),y=n(30805),g=n(43963),w=n(836783),N=n(211845),b=n(950379),v=n(134564),x=n(507503),k=n(266315),S=n(778263),O=n(386831),W=n(780329),I=n(431211),q=n(338753);const T=(0,l.XY)((e=>x.yw5(e[0])),(function(){const e=arguments;return x.q1t(e[0],x.Umi,"string"==typeof e[1]?u.hZ(e[1],e[2]):t=>Object.entries(e[1]).reduce(((e,[t,n])=>u.hZ(e,t,n)),t))})),E=e=>x.TjK(e,y.zN),C=e=>x.xm_(e,y.zN),L=e=>{let t,n;return"function"==typeof e?t=e:(t=e.try,n=e.catch),x.OH5((()=>{try{return t()}catch(e){throw x.eO_(b.fJ(n?n(e):new x.Uis(e)))}}))},A=(0,l.XY)(3,((e,t,n)=>x.h9N(e,(e=>g.i5(e,t)&&e[t]===n.failure?n.onFailure(e):x.fJG(e))))),D=(0,l.XY)(2,((e,t)=>x.uPo(e,(e=>{const n=b.I6(e,(e=>b.VY(e)?y.zN(e):y.dv()));switch(n._tag){case"None":return x.ATB(e);case"Some":return t(n.value.defect)}})))),B=(0,l.XY)(2,((e,t)=>x.khu(e,{onFailure:e=>{const n=t(e);switch(n._tag){case"None":return x.ATB(e);case"Some":return n.value}},onSuccess:x.PyW}))),P=(0,l.XY)(2,((e,t)=>x.uPo(e,(e=>{const n=b.I6(e,(e=>b.VY(e)?y.zN(e):y.dv()));switch(n._tag){case"None":return x.ATB(e);case"Some":{const r=t(n.value.defect);return"Some"===r._tag?r.value:x.ATB(e)}}})))),M=(0,l.XY)(3,((e,t,n)=>x.XWm(e,g.$J(t),n))),F=(0,l.XY)(2,((e,t)=>{let n;return x.XWm(e,(e=>(n??=Object.keys(t),g.i5(e,"_tag")&&g.Kg(e._tag)&&n.includes(e._tag))),(e=>t[e._tag](e)))})),R=e=>x.D$$(e,{onFailure:l.D_,onSuccess:()=>b.Ie}),U=s.RK,j=U(x.PyW),_=(0,l.XY)(2,((e,t)=>x.aNH(s.yy(t),e))),$=e=>x.$we(((t,n)=>e({id:t.id(),status:n,interruptors:b.ml(t.getFiberRef(x.LGt))}))),Q=$((e=>p.Ej(e.interruptors)>0?x.GaK:x.rIH)),J=$(x.PyW),K=e=>lt(e,ye,O.Ui),H=x.PyW({}),Y=S.oI(x.TjK,x.qIB),V=S.Jr(x.TjK),z=S.zM(x.TjK),X=(0,l.XY)(2,((e,t)=>x.DYE((()=>{const n=e[Symbol.iterator](),r=[];let i,o=x.PyW(!1),s=0;for(;(i=n.next())&&!i.done;){const e=i.value,n=s++;o=x.qIB(o,(i=>i?(r.push(e),x.PyW(!0)):t(e,n)))}return x.TjK(o,(()=>r))})))),G=(0,l.XY)(2,((e,t)=>x.DYE((()=>{const n=e[Symbol.iterator](),r=[];let i,o=x.PyW(!0),s=0;for(;(i=n.next())&&!i.done;){const e=i.value,n=s++;o=x.qIB(o,(i=>x.TjK(i?t(e,n):x.PyW(!1),(t=>(t||r.push(e),t)))))}return x.TjK(o,(()=>r))})))),Z=e=>x.TjK(x._OA(),e),ee=e=>x.NWQ(e,(()=>x.qIB(x.m9E(),(()=>ee(e))))),te=(0,l.XY)(2,((e,t)=>x.TjK(x.CFK(e,l.D_),i.x1(t)))),ne=(0,l.XY)(3,((e,t,n)=>ie(e,t,(e=>x.Kbz((()=>n(e))))))),re=(0,l.XY)(3,((e,t,n)=>ie(e,t,(()=>x.GSS(n))))),ie=(0,l.XY)(3,((e,t,n)=>x.qIB(e,(e=>t(e)?x.PyW(e):n(e))))),oe=(0,l.XY)(3,((e,t,n)=>x.DYE((()=>t(e)?x.PyW(e):x.fJG(n(e)))))),se=(0,l.XY)((e=>x.yw5(e[0])),((e,t,n)=>ie(e,t,(e=>void 0===n?x.fJG(new x.kJg):x.gOk((()=>n(e))))))),ae=(0,l.XY)(2,((e,t)=>x.DYE((()=>{const n=e[Symbol.iterator](),r=n.next();return r.done?x.PyW(y.dv()):ce(n,0,t,r.value)})))),ce=(e,t,n,r)=>x.qIB(n(r,t),(i=>{if(i)return x.PyW(y.zN(r));const o=e.next();return o.done?x.PyW(y.dv()):ce(e,t+1,n,o.value)})),de=e=>x.DYE((()=>{const t=o.Ts(e);return o.J_(t)?(0,l.Fs)(o.Rx(t),i.TS(o.v4(t),((e,t)=>x.NWQ(e,(()=>t))))):x.Kbz((()=>new x.nAV("Received an empty collection of effects")))})),le=(0,l.XY)(2,((e,t)=>x.UUz(t(x.UUz(e))))),ue=(0,l.XY)(2,((e,t)=>x.tvg(e,{onFailure:e=>x.PyW(t.onFailure(e)),onSuccess:e=>x.PyW(t.onSuccess(e))}))),pe=(0,l.XY)(2,((e,t)=>x.DYE((()=>he(e[Symbol.iterator](),0,t))))),he=(e,t,n)=>{const r=e.next();return r.done?x.PyW(!0):x.qIB(n(r.value,t),(r=>r?he(e,t+1,n):x.PyW(r)))},fe=e=>{const t=x.qIB(x.qIB(e,(()=>x.m9E())),(()=>t));return t},me=function(){let e;return e=1===arguments.length?arguments[0]:arguments[1].bind(arguments[0]),x.DYE((()=>{const t=e(l.Fs),n=(0,r.sn)((()=>t.next())),i=e=>e.done?x.PyW(e.value):x.qIB((0,r.ku)(e.value),(e=>i((0,r.sn)((()=>t.next(e))))));return i(n)}))},ye=x.$we((e=>x.PyW(e.getFiberRefs()))),ge=e=>x.qIB(e,(e=>{const t=e[Symbol.iterator]().next();return t.done?x.fJG(new x.kJg):x.PyW(t.value)})),we=e=>ue(e,{onFailure:l.Yi,onSuccess:l.Yi}),Ne=e=>x.khu(e,{onFailure:e=>Ie(e,"An error was silently ignored because it is not anticipated to be useful"),onSuccess:()=>x.rIH}),be=e=>Tt(((t,n)=>d.rl(n,t,e))),ve=e=>ue(e,{onFailure:l.ue,onSuccess:l.f4}),xe=e=>ue(e,{onFailure:l.f4,onSuccess:l.ue}),ke=(e,t)=>x.DYE((()=>t.while(e)?x.qIB(t.body(e),(e=>ke(e,t))):x.PyW(e))),Se=e=>(...t)=>{const n=y.k$(e);let r;for(let e=0,n=t.length;e<n;e++){const n=t[e];b.Aj(n)&&(r=void 0!==r?b.il(r,n):n,t=[...t.slice(0,e),...t.slice(e+1)],e--)}return void 0===r&&(r=b.Ie),x.$we((e=>(e.log(t,r,n),x.rIH)))},Oe=Se(),We=Se(f.Cn),Ie=Se(f.y),qe=Se(f.R2),Te=Se(f.N5),Ee=Se(f.$D),Ce=Se(f.Lj),Le=(0,l.XY)(2,((e,t)=>x.qIB(s.Ru,(n=>x.q1t(e,x.krO,h.Hs(m.L(t,n))))))),Ae=x.U8_(x.Umi),De=(e,t)=>t.discard?Pe(e,t.while,t.step,t.body):x.TjK(Be(e,t.while,t.step,t.body),i.Ts),Be=(e,t,n,r)=>x.DYE((()=>t(e)?x.qIB(r(e),(i=>x.TjK(Be(n(e),t,n,r),h.Hs(i)))):x.OH5((()=>h.Ie())))),Pe=(e,t,n,r)=>x.DYE((()=>t(e)?x.qIB(r(e),(()=>Pe(n(e),t,n,r))):x.rIH)),Me=(0,l.XY)(3,((e,t,n)=>x.DYE((()=>{const r=e[Symbol.iterator](),i=[];let o,s=x.PyW(t),a=0;for(;!(o=r.next()).done;){const e=a++,t=o.value;s=x.qIB(s,(r=>x.TjK(n(r,t,e),(([e,t])=>(i.push(t),e)))))}return x.TjK(s,(e=>[e,i]))})))),Fe=(0,l.XY)(2,((e,t)=>x.khu(e,{onFailure:e=>x.pVV((()=>t(e))),onSuccess:x.PyW}))),Re=e=>(0,l.Fs)(x.WW4(),x.qIB((t=>(0,l.Fs)((e=>lt(e,x.yU6(ye,x.m$m),(([e,t],[n,r])=>[O.Ui(e,n),I.Ui(t,r)])))(e),x._ig(t),$e,x.TjK((e=>x.aNH(e,(0,l.Fs)(x.gn0(t),x.qIB((([e,t])=>x.as(x.yU6(Ye(e[0]),x.$QS(e[1])),t))))))))))),Ue=e=>x.tvg(e,{onFailure:e=>x.PyW(e),onSuccess:x.PyW}),je=e=>x.TjK(e,(e=>!e)),_e=e=>x.qIB(e,(e=>{switch(e._tag){case"None":return x.rIH;case"Some":return x.fJG(new x.kJg)}})),$e=e=>x.TjK(w.L8(!0),(t=>x.NLW(x.iK2(e,w.C2(t,!1))))),Qe=e=>x.tvg(e,{onFailure:()=>x.PyW(y.dv()),onSuccess:e=>x.PyW(y.zN(e))}),Je=(0,l.XY)(2,((e,t)=>x.NWQ(e,(()=>x.gOk(t))))),Ke=(0,l.XY)(2,((e,t)=>x.NWQ(e,(()=>x.OH5(t))))),He=e=>x.khu(e,{onFailure:e=>{const t=i.Ts(b.e9(e));return 0===t.length?x.ATB(e):x.fJG(t)},onSuccess:x.PyW}),Ye=e=>Tt(((t,n)=>(0,l.Fs)(e,O.F6(t,n)))),Ve=e=>e.length>=1?x.bIC(((t,n)=>{e(n).then((e=>t(x.xtk(e))),(e=>t(x.V2G(e))))})):x.bIC((t=>{e().then((e=>t(x.xtk(e))),(e=>t(x.V2G(e))))})),ze=(0,l.XY)(3,((e,t,n)=>x.d_m((r=>x.PpN(e,a.WQ(r,t,n)))))),Xe=(0,l.XY)(3,((e,t,n)=>x.d_m((r=>x.qIB(n,(n=>x.PpN(e,(0,l.Fs)(r,a.WQ(t,n))))))))),Ge=k.Gx(x.PyW),Ze=(0,l.XY)(3,((e,t,n)=>i.Ts(e).reduce(((e,t,r)=>x.qIB(e,(e=>n(e,t,r)))),x.PyW(t)))),et=(0,l.XY)(3,((e,t,n)=>i.Ts(e).reduceRight(((e,t,r)=>x.qIB(e,(e=>n(t,e,r)))),x.PyW(t)))),tt=(0,l.XY)(3,((e,t,n)=>x.qIB(x.OH5((()=>e[Symbol.iterator]())),(e=>nt(e,0,t,n.while,n.body))))),nt=(e,t,n,r,i)=>{const o=e.next();return!o.done&&r(n)?x.qIB(i(n,o.value,t),(n=>nt(e,t+1,n,r,i))):x.PyW(n)},rt=(0,l.XY)(2,((e,t)=>x.DYE((()=>it(e,t))))),it=(e,t)=>x.qIB(e,(n=>t<=0?x.PyW(n):x.aNH(x.m9E(),it(e,t-1)))),ot=e=>x.khu(e,{onFailure:x.fJG,onSuccess:x.PyW}),st=e=>x.DYE((()=>d.Au(e))),at=s.yy,ct=x.PyW(y.dv()),dt=e=>x.PyW(y.zN(e)),lt=(0,l.XY)(3,((e,t,n)=>x.qIB(t,(r=>x.qIB(e,(e=>x.TjK(t,(t=>[n(r,t),e])))))))),ut=(0,l.XY)((e=>x.yw5(e[0])),(function(){return pt(arguments[0],"string"==typeof arguments[1]?[W.L8(arguments[1],arguments[2])]:Object.entries(arguments[1]).map((([e,t])=>W.L8(e,t))))})),pt=(0,l.XY)(2,((e,t)=>x.q1t(e,x.b1P,(e=>i.KC(e,t))))),ht=(0,l.XY)(2,((e,t)=>x.DYE((()=>{const n=e[Symbol.iterator](),r=[];let i,o=x.PyW(!1),s=0;for(;(i=n.next())&&!i.done;){const e=i.value,n=s++;o=x.qIB(o,(i=>i?x.PyW(!0):(r.push(e),t(e,n))))}return x.TjK(o,(()=>r))})))),ft=(0,l.XY)(2,((e,t)=>x.DYE((()=>{const n=e[Symbol.iterator](),r=[];let i,o=x.PyW(!0),s=0;for(;(i=n.next())&&!i.done;){const e=i.value,n=s++;o=x.qIB(o,(i=>(0,l.Fs)(i?t(e,n):x.PyW(!1),x.TjK((t=>(t&&r.push(e),t))))))}return x.TjK(o,(()=>r))})))),mt=(0,l.XY)(2,((e,{onFailure:t,onSuccess:n})=>x.khu(e,{onFailure:e=>{const n=b.vE(e);switch(n._tag){case"Left":return x.aNH(t(n.left),x.ATB(e));case"Right":return x.ATB(e)}},onSuccess:e=>x.as(n(e),e)}))),yt=(0,l.XY)(2,((e,t)=>x.uPo(e,(e=>y.YW(b.AW(e),{onNone:()=>x.ATB(e),onSome:n=>x.aNH(t(n),x.ATB(e))}))))),gt=(0,l.XY)(2,((e,t)=>x.khu(e,{onFailure:e=>{const n=b.vE(e);switch(n._tag){case"Left":return x.aNH(t(n.left),x.ATB(e));case"Right":return x.ATB(e)}},onSuccess:x.PyW}))),wt=(0,l.XY)(3,((e,t,n)=>gt(e,(e=>g.$J(e,t)?n(e):x.rIH)))),Nt=(0,l.XY)(2,((e,t)=>x.khu(e,{onFailure:e=>x.aNH(t(e),x.ATB(e)),onSuccess:x.PyW}))),bt=e=>vt(e,s.s0),vt=(0,l.XY)(2,((e,t)=>lt(e,t,((e,t)=>c.cF(t-e))))),xt=(0,N.wT)(x.PyW),kt=e=>{let t,n;return"function"==typeof e?t=e:(t=e.try,n=e.catch),t.length>=1?x.bIC(((e,r)=>{try{t(r).then((t=>e(x.xtk(t))),(t=>e(x.fJG(n?n(t):new x.Uis(t)))))}catch(t){e(x.fJG(n?n(t):new x.Uis(t)))}})):x.bIC((e=>{try{t().then((t=>e(x.xtk(t))),(t=>e(x.fJG(n?n(t):new x.Uis(t)))))}catch(t){e(x.fJG(n?n(t):new x.Uis(t)))}}))},St=(0,l.XY)(2,((e,t)=>x.qIB(e,(e=>L({try:()=>t.try(e),catch:t.catch}))))),Ot=(0,l.XY)(2,((e,t)=>x.qIB(e,(e=>kt({try:t.try.length>=1?n=>t.try(e,n):()=>t.try(e),catch:t.catch}))))),Wt=(0,l.XY)(2,((e,t)=>x.DYE((()=>t()?ct:E(e))))),It=(0,l.XY)(2,((e,t)=>x.qIB(t,(t=>t?ct:E(e))))),qt=e=>Fe(e,b.Bq),Tt=e=>x.$we((t=>(t.setFiberRefs(e(t.id(),t.getFiberRefs())),x.rIH))),Et=(0,l.XY)(3,((e,t,n)=>x.kyh(e,(e=>a.WQ(e,t,n(a.$v(e,t))))))),Ct=(0,l.XY)(2,((e,t)=>x.DYE((()=>t()?x.TjK(e,y.zN):x.PyW(y.dv()))))),Lt=(0,l.XY)(3,((e,t,n)=>x.qIB(x.U8_(t),(t=>n(t)?x.TjK(e,(e=>[t,y.zN(e)])):x.PyW([t,y.dv()]))))),At=(0,l.XY)(3,((e,t,n)=>x.qIB(w.Jt(t),(t=>n(t)?x.TjK(e,(e=>[t,y.zN(e)])):x.PyW([t,y.dv()]))))),Dt=(0,l.XY)(2,((e,t)=>t(e))),Bt=(e,t)=>(...n)=>x.qIB(e,(e=>t(e)(...n))),Pt=(e,t)=>(...n)=>x.TjK(e,(e=>t(e)(...n))),Mt=e=>new Proxy({},{get:(t,n,r)=>(...t)=>x.qIB(e,(e=>e[n](...t)))}),Ft=e=>new Proxy({},{get:(t,n,r)=>x.qIB(e,(e=>x.yw5(e[n])?e[n]:x.PyW(e[n])))}),Rt=e=>({functions:Mt(e),constants:Ft(e)}),Ut=e=>x.TjK(x._OA(),a.om(e)),jt=e=>x.qIB(x._OA(),a.om(e)),_t=function(){const e=arguments;return we(x.qIB(Jt,(t=>x.OH5((()=>{if("string"==typeof e[0])t.attribute(e[0],e[1]);else for(const n in e[0])t.attribute(n,e[0][n])})))))},$t=(0,l.XY)((e=>x.yw5(e[0])),(function(){const e=arguments;return x.q1t(e[0],x.BzD,"string"==typeof e[1]?u.hZ(e[1],e[2]):t=>Object.entries(e[1]).reduce(((e,[t,n])=>u.hZ(e,t,n)),t))})),Qt=jt(q.Te),Jt=x.qIB(x._OA(),(e=>{const t=e.unsafeMap.get(q.Te.key);return void 0!==t&&"Span"===t._tag?x.PyW(t):x.fJG(new x.kJg)})),Kt=(0,l.XY)((e=>x.yw5(e[0])),((e,t,n)=>x.q1t(e,x.s$T,o.BC({_tag:"SpanLink",span:t,attributes:n??{}})))),Ht=BigInt(0),Yt=(e,t,n)=>{if(!1===e.getFiberRef(x.MP9))return x.bVS(t);const r=e.getFiberRef(x.Fi1),c=e.getFiberRef(k.qJ),l=a.Jt(c,q.Ez),p=a.Jt(c,s.zD),h=e.getFiberRef(x.QYw),f=e.getFiberRefs(),m=d.Jt(f,x.BzD),g=d.Jt(f,x.s$T),w=n.parent?y.zN(n.parent):n.root?y.dv():a.om(r,q.Te),N="Some"===g._tag?void 0!==n.links?[...o.h3(g.value),...n.links??[]]:o.h3(g.value):n.links??i.Ie(),v=l.span(t,w,n.context??a.Ie(),N,h?p.unsafeCurrentTimeNanos():Ht,n.kind??"internal");return"function"==typeof n.captureStackTrace&&b.rF.set(v,n.captureStackTrace),"Some"===m._tag&&u.jJ(m.value,((e,t)=>v.attribute(t,e))),void 0!==n.attributes&&Object.entries(n.attributes).forEach((([e,t])=>v.attribute(e,t))),v},Vt=(e,t)=>(t=q.ZA(t),x.$we((n=>x.PyW(Yt(n,e,t))))),zt=x.U8_(x.BzD),Xt=x.U8_(x.s$T),Gt=(e,t,n,r)=>x.OH5((()=>{"Ended"!==e.status._tag&&(x.VE1(t)&&b.rF.has(e)&&e.attribute("code.stacktrace",b.rF.get(e)()),e.end(r?n.unsafeCurrentTimeNanos():Ht,t))})),Zt=(e,...t)=>{const n=q.ZA(1===t.length?void 0:t[0]),r=t[t.length-1];return x.$we((t=>{const i=Yt(t,e,n),o=t.getFiberRef(x.QYw),s=a.Jt(t.getFiberRef(k.qJ),v.hV);return x.cfM(r(i),(e=>Gt(i,e,s,o)))}))},en=(0,l.XY)(2,((e,t)=>ze(e,q.Te,t))),tn=function(){const e="string"!=typeof arguments[0],t=e?arguments[1]:arguments[0],n=q.ZA(e?arguments[2]:arguments[1]);if(e){const e=arguments[0];return Zt(t,n,(t=>en(e,t)))}return e=>Zt(t,n,(t=>en(e,t)))},nn=e=>function(){let t=e.captureStackTrace??!1;if(!1!==e.captureStackTrace){const e=Error.stackTraceLimit;Error.stackTraceLimit=2;const n=new Error;Error.stackTraceLimit=e;let r=!1;t=()=>{if(!1!==r)return r;if(n.stack){const e=n.stack.trim().split("\n");return r=e.slice(2).join("\n").trim(),r}}}return x.DYE((()=>{const n="function"==typeof e.options?e.options.apply(null,arguments):e.options;return tn(x.DYE((()=>(0,r.sn)((()=>e.body.apply(this,arguments))))),n.name,{...n,captureStackTrace:t})}))},rn=e=>null==e?x.fJG(new x.kJg):x.PyW(e),on=e=>x.h9N(x.TjK(e,y.zN),(e=>x.QRo(e)?ct:x.fJG(e)))},119153:(e,t,n)=>{n.d(t,{MG:()=>s,ii:()=>o,nS:()=>a});var r=n(703225),i=n(507503);const o=Symbol.for("effect/Console"),s=r.Io("effect/Console"),a={[o]:o,assert:(e,...t)=>i.OH5((()=>{console.assert(e,...t)})),clear:i.OH5((()=>{console.clear()})),count:e=>i.OH5((()=>{console.count(e)})),countReset:e=>i.OH5((()=>{console.countReset(e)})),debug:(...e)=>i.OH5((()=>{})),dir:(e,t)=>i.OH5((()=>{console.dir(e,t)})),dirxml:(...e)=>i.OH5((()=>{console.dirxml(...e)})),error:(...e)=>i.OH5((()=>{console.error(...e)})),group:e=>e?.collapsed?i.OH5((()=>console.groupCollapsed(e?.label))):i.OH5((()=>console.group(e?.label))),groupEnd:i.OH5((()=>{console.groupEnd()})),info:(...e)=>i.OH5((()=>{})),log:(...e)=>i.OH5((()=>{})),table:(e,t)=>i.OH5((()=>{console.table(e,t)})),time:e=>i.OH5((()=>console.time(e))),timeEnd:e=>i.OH5((()=>console.timeEnd(e))),timeLog:(e,...t)=>i.OH5((()=>{console.timeLog(e,...t)})),trace:(...e)=>i.OH5((()=>{console.trace(...e)})),warn:(...e)=>i.OH5((()=>{})),unsafe:console}},338265:(e,t,n)=>{n.d(t,{$T:()=>R,AN:()=>Y,CJ:()=>E,D5:()=>z,Do:()=>ne,GR:()=>D,KT:()=>Q,KX:()=>G,L_:()=>$,Oy:()=>P,PC:()=>q,PJ:()=>te,PO:()=>T,RI:()=>W,Rq:()=>J,S1:()=>ie,SH:()=>ae,Tg:()=>K,VH:()=>I,XJ:()=>oe,ar:()=>M,gh:()=>se,jE:()=>B,nH:()=>X,ny:()=>V,oD:()=>re,qK:()=>U,wR:()=>H,x6:()=>F});var r=n(972e3),i=n(545422),o=n(217076),s=n(487529),a=n(374212),c=n(32388),d=n(704928),l=n(30805),u=n(977148),p=n(43963),h=n(203956),f=n(345059),m=n(950379),y=n(648029),g=n(507503),w=n(999233),N=n(760852),b=n(426964),v=n(901006),x=n(360643),k=n(387162),S=n(997014);class O{permits;waiters=new Set;taken=0;constructor(e){this.permits=e}get free(){return this.permits-this.taken}take=e=>g.bIC((t=>{if(this.free<e){const n=()=>{this.free<e||(this.waiters.delete(n),this.taken+=e,t(g.PyW(e)))};return this.waiters.add(n),g.OH5((()=>{this.waiters.delete(n)}))}return this.taken+=e,t(g.PyW(e))}));updateTaken=e=>g.$we((t=>(this.taken=e(this.taken),this.waiters.size>0&&t.getFiberRef(f.X_).scheduleTask((()=>{const e=this.waiters.values();let t=e.next();for(;!1===t.done&&this.free>0;)t.value(),t=e.next()}),t.getFiberRef(g.QPU)),g.PyW(this.free))));release=e=>this.updateTaken((t=>t-e));releaseAll=this.updateTaken((e=>0));withPermits=e=>t=>g.FcF((n=>g.qIB(n(this.take(e)),(e=>b.ye(n(t),this.release(e))))))}const W=e=>new O(e),I=e=>g.OH5((()=>W(e))),q=e=>B(e,b.C6),T=(0,a.XY)(2,((e,t)=>g.TjK(E(e,t),(e=>e[0])))),E=(0,a.XY)(2,((e,t)=>{const n=r.D4(t);return g.qIB(g._OA(),(t=>g.TjK(te(l.dv()),(r=>[g.PpN(L(e,n,r),t),A(r)]))))})),C=(e,t,n)=>{const i=r.kE(r.D4(t));return(0,a.Fs)(g.WW4(),g.Mim((t=>g._ig(e,t))),g.TjK((e=>l.zN([n+i,e]))))},L=(e,t,n)=>g.FcF((r=>(0,a.Fs)(y.RK((e=>e.currentTimeMillis)),g.qIB((r=>re(n,(n=>{switch(n._tag){case"None":return l.zN(C(e,t,r));case"Some":{const[i]=n.value;return i-r<=0?l.zN(C(e,t,r)):l.dv()}}})))),g.qIB((e=>l.$I(e)?g.GSS("BUG: Effect.cachedInvalidate - please report an issue at https://github.com/Effect-TS/effect/issues"):r(g.gn0(e.value[1]))))))),A=e=>x.hZ(e,l.dv()),D=(0,a.XY)(2,((e,t)=>B(e,(e=>t(b.qm(e)))))),B=(0,a.XY)(2,((e,t)=>g.qIB(S.u4,(n=>(0,a.Fs)(K(e,n),b.ye(g.qIB(n.value,t))))))),P=(0,a.XY)((e=>p.xZ(e[0])),((e,t)=>t?.discard?g.QZV(e,b.Zy):g.TjK(g.CFK(e,b.Zy),b.qm))),M=(0,a.XY)(2,((e,t)=>g.FcF((n=>g.qIB(t.fork(w.il),(t=>(0,a.Fs)(n(e),g.cfM((e=>t.close(e))),b.LX,g.Mim((e=>t.addFinalizer((()=>g.g1G((t=>i.aI(t,e.id())?g.rIH:g.NLW(g.OLv(e))))))))))))))),F=e=>b.NB((t=>M(e,t))),R=e=>N.fj(e),U=e=>g.DYE((()=>g.qIB(e,N.fj))),j=Symbol.for("effect/Effect/memoizeFunction.key");class _{a;eq;[j]=j;constructor(e,t){this.a=e,this.eq=t}[i.HR](e){return!!p.i5(e,j)&&(this.eq?this.eq(this.a,e.a):i.aI(this.a,e.a))}[c.HR](){return this.eq?0:c.PO(this,c.tW(this.a))}}const $=(e,t)=>(0,a.Fs)(g.OH5((()=>d.Ie())),g.qIB(te),g.TjK((n=>r=>(0,a.Fs)(n.modifyEffect((n=>{const i=(0,a.Fs)(n,d.Jt(new _(r,t)));return l.$I(i)?(0,a.Fs)(g.WW4(),g.Mim((t=>(0,a.Fs)(y.Ek(e(r)),g._ig(t),b.Zy))),g.TjK((e=>[e,(0,a.Fs)(n,d.hZ(new _(r,t),e))]))):g.PyW([i.value,n])})),g.qIB(g.gn0),g.qIB((([e,t])=>(0,a.Fs)(y.Bz(e),g.as(t)))))))),Q=(0,a.XY)(2,((e,t)=>(0,a.Fs)(g.NS5(e),b.O4(g.NS5(t)),(e=>g.Bqz(e))))),J=(0,a.XY)(2,((e,t)=>(0,a.Fs)(e,k.mg(t),F))),K=(0,a.XY)(2,((e,t)=>g.q1t(b.me,(e=>e.zip(t)))(e))),H=(0,a.XY)(2,((e,t)=>Y(e,{onTimeout:()=>g.x6Q(t),duration:t}))),Y=(0,a.XY)(2,((e,{duration:t,onTimeout:n})=>g.Bqz(X(e,{onTimeout:()=>g.gOk(n),onSuccess:g.PyW,duration:t})))),V=(0,a.XY)(2,((e,{duration:t,onTimeout:n})=>g.Bqz(X(e,{onTimeout:()=>g.pVV(n),onSuccess:g.PyW,duration:t})))),z=(0,a.XY)(2,((e,t)=>X(e,{duration:t,onSuccess:l.zN,onTimeout:l.dv}))),X=(0,a.XY)(2,((e,{duration:t,onSuccess:n,onTimeout:r})=>g.g1G((i=>b.Fp(e,g.Inz(y.yy(t)),{onSelfWin:(e,t)=>g.qIB(e.await,(r=>"Success"===r._tag?g.qIB(e.inheritAll,(()=>g.as(g._tB(t,i),n(r.value)))):g.qIB(g._tB(t,i),(()=>g.cbD(r.cause))))),onOtherWin:(e,t)=>g.qIB(e.await,(n=>"Success"===n._tag?g.qIB(e.inheritAll,(()=>g.as(g._tB(t,i),r()))):g.qIB(g._tB(t,i),(()=>g.cbD(n.cause))))),otherScope:v.gm}))))),G=Symbol.for("effect/Ref/SynchronizedRef"),Z={_A:e=>e};class ee{ref;withLock;[G]=Z;[x.ll]=x.VO;[h.ii];constructor(e,t){this.ref=e,this.withLock=t,this[h.ii]=h.ii,this.get=x.Jt(this.ref)}get;modify(e){return this.modifyEffect((t=>g.PyW(e(t))))}modifyEffect(e){return this.withLock((0,a.Fs)(g.qIB(x.Jt(this.ref),e),g.qIB((([e,t])=>g.as(x.hZ(this.ref,t),e)))))}pipe(){return(0,u.t)(this,arguments)}}const te=e=>g.OH5((()=>ne(e))),ne=e=>{const t=x.s$(e),n=W(1);return new ee(t,n.withPermits(1))},re=(0,a.XY)(2,((e,t)=>e.modifyEffect((e=>{const n=t(e);switch(n._tag){case"None":return g.PyW([e,e]);case"Some":return g.TjK(n.value,(e=>[e,e]))}})))),ie=(0,a.XY)(2,((e,t)=>ae(e,t,((e,t)=>[e,t])))),oe=(0,a.XY)(2,((e,t)=>ae(e,t,((e,t)=>e)))),se=(0,a.XY)(2,((e,t)=>ae(e,t,((e,t)=>t)))),ae=(0,a.XY)(3,((e,t,n)=>({[N.QV]:N.GP,id:()=>(0,a.Fs)(e.id(),s.Do(t.id())),await:(0,a.Fs)(e.await,g.Bqz,b.cw(g.Bqz(t.await),n,{concurrent:!0}),g.NS5),children:e.children,inheritAll:g.aNH(t.inheritAll,e.inheritAll),poll:g.OYO(e.poll,t.poll,((e,t)=>(0,a.Fs)(e,l.qI((e=>(0,a.Fs)(t,l.Tj((t=>o.OY(e,t,{onSuccess:n,onFailure:m._7}))))))))),interruptAsFork:n=>g.aNH(e.interruptAsFork(n),t.interruptAsFork(n)),pipe(){return(0,u.t)(this,arguments)}})))},617437:(e,t,n)=>{n.d(t,{BQ:()=>u,Gt:()=>d,JP:()=>c,Wz:()=>p,Y3:()=>a,cH:()=>s,pu:()=>h,sY:()=>l});var r=n(374212),i=n(30805),o=n(507503);const s=(0,r.XY)(2,((e,t)=>e.modifyEffect((e=>o.TjK(t(e),(t=>[e,t])))))),a=(0,r.XY)(2,((e,t)=>e.modifyEffect((e=>{const n=t(e);switch(n._tag){case"None":return o.PyW([e,e]);case"Some":return o.TjK(n.value,(t=>[e,t]))}})))),c=(0,r.XY)(2,((e,t)=>e.modify(t))),d=(0,r.XY)(2,((e,t)=>e.modifyEffect(t))),l=(0,r.XY)(3,((e,t,n)=>e.modifyEffect((e=>(0,r.Fs)(n(e),i.WL((()=>o.PyW([t,e])))))))),u=(0,r.XY)(2,((e,t)=>e.modifyEffect((e=>o.TjK(t(e),(e=>[void 0,e])))))),p=(0,r.XY)(2,((e,t)=>e.modifyEffect((e=>o.TjK(t(e),(e=>[e,e])))))),h=(0,r.XY)(2,((e,t)=>e.modifyEffect((e=>{const n=t(e);switch(n._tag){case"None":return o.PyW([void 0,e]);case"Some":return o.TjK(n.value,(e=>[void 0,e]))}}))))}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var o=r[e]={exports:{}};return n[e](o,o.exports,i),o.exports}i.m=n,i.x=()=>{var e=i.O(void 0,[933,733],(()=>i(845119)));return e=i.O(e)},e=[],i.O=(t,n,r,o)=>{if(!n){var s=1/0;for(l=0;l<e.length;l++){for(var[n,r,o]=e[l],a=!0,c=0;c<n.length;c++)(!1&o||s>=o)&&Object.keys(i.O).every((e=>i.O[e](n[c])))?n.splice(c--,1):(a=!1,o<s&&(s=o));if(a){e.splice(l--,1);var d=r();void 0!==d&&(t=d)}}return t}o=o||0;for(var l=e.length;l>0&&e[l-1][2]>o;l--)e[l]=e[l-1];e[l]=[n,r,o]},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,n)=>(i.f[n](e,t),t)),[])),i.u=e=>e+".js",i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),(()=>{i.b=self.location+"";var e={119:1};i.f.i=(t,n)=>{e[t]||importScripts(i.p+i.u(t))};var t=self.webpackChunkstarpyapp=self.webpackChunkstarpyapp||[],n=t.push.bind(t);t.push=t=>{var[r,o,s]=t;for(var a in o)i.o(o,a)&&(i.m[a]=o[a]);for(s&&s(i);r.length;)e[r.pop()]=1;n(t)}})(),t=i.x,i.x=()=>Promise.all([i.e(933),i.e(733)]).then(t);i.x()})();