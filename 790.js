/*! For license information please see 790.js.LICENSE.txt */
(()=>{"use strict";var e,t,n={958146:(e,t,n)=>{n.d(t,{$N:()=>C,$O:()=>D,$j:()=>Xe,Ad:()=>x,BW:()=>N,C8:()=>_e,D6:()=>J,DH:()=>k,Dp:()=>m,EK:()=>Ke,E_:()=>q,Ey:()=>y,Gb:()=>qe,IT:()=>Qe,J5:()=>W,Jo:()=>O,Kt:()=>ee,Ky:()=>Ee,M3:()=>ne,M7:()=>R,MR:()=>S,Mz:()=>Le,NH:()=>Te,OD:()=>me,On:()=>g,Re:()=>j,SB:()=>h,TD:()=>Oe,U4:()=>b,V3:()=>je,Wy:()=>$e,XS:()=>pe,YI:()=>U,YN:()=>f,YP:()=>we,Z8:()=>w,ZG:()=>ve,ZU:()=>xe,Zi:()=>ye,Zn:()=>Ye,_q:()=>se,ai:()=>ie,c$:()=>V,ch:()=>z,dw:()=>He,fq:()=>B,g1:()=>et,gP:()=>Me,gV:()=>Be,gw:()=>E,hk:()=>ze,iJ:()=>F,kV:()=>Ue,nt:()=>Ve,oA:()=>G,p$:()=>tt,rQ:()=>ot,rt:()=>P,u7:()=>v,uS:()=>Y,vs:()=>ce,w_:()=>X,zh:()=>ke});var r=n(975955),i=n(374212),o=n(466894),s=n(620113),a=n(30805),c=n(271314),d=n(43963),l=n(40573),p=n(748755),u=n(250080);const h=Symbol.for("@effect/schema/annotation/Brand"),m=Symbol.for("@effect/schema/annotation/Type"),f=Symbol.for("@effect/schema/annotation/Message"),y=Symbol.for("@effect/schema/annotation/MissingMessage"),g=Symbol.for("@effect/schema/annotation/Identifier"),w=Symbol.for("@effect/schema/annotation/Title"),N=Symbol.for("@effect/schema/annotation/Description"),b=Symbol.for("@effect/schema/annotation/Examples"),v=Symbol.for("@effect/schema/annotation/Default"),x=Symbol.for("@effect/schema/annotation/JSONSchema"),k=Symbol.for("@effect/schema/annotation/Documentation"),S=Symbol.for("@effect/schema/annotation/Concurrency"),O=Symbol.for("@effect/schema/annotation/Batching"),W=Symbol.for("@effect/schema/annotation/ParseIssueTitle"),q=Symbol.for("@effect/schema/annotation/ParseOptions"),I=Symbol.for("@effect/schema/annotation/Surrogate"),T=Symbol.for("@effect/schema/annotation/StableFilter"),E=(0,i.XY)(2,((e,t)=>Object.prototype.hasOwnProperty.call(e.annotations,t)?a.zN(e.annotations[t]):a.dv())),C=E(h),D=E(f),P=E(y),A=E(w),M=E(g),L=E(N),B=E(S),F=E(O),R=E(W),j=E(q),U=E(I),_=E(T),$=Symbol.for("@effect/schema/annotation/JSONIdentifier"),Q=E($);class J{typeParameters;decodeUnknown;encodeUnknown;annotations;_tag="Declaration";constructor(e,t,n,r={}){this.typeParameters=e,this.decodeUnknown=t,this.encodeUnknown=n,this.annotations=r}toString(){return a.WL(pt(this),(()=>"<declaration schema>"))}toJSON(){return{_tag:this._tag,typeParameters:this.typeParameters.map((e=>e.toJSON())),annotations:st(this.annotations)}}}const K=e=>t=>t._tag===e;class Y{literal;annotations;_tag="Literal";constructor(e,t={}){this.literal=e,this.annotations=t}toString(){return a.WL(pt(this),(()=>u.eA(this.literal)))}toJSON(){return{_tag:this._tag,literal:d.sI(this.literal)?String(this.literal):this.literal,annotations:st(this.annotations)}}}const V=K("Literal"),z=new Y(null,{[g]:"null"});class X{symbol;annotations;_tag="UniqueSymbol";constructor(e,t={}){this.symbol=e,this.annotations=t}toString(){return a.WL(pt(this),(()=>u.eA(this.symbol)))}toJSON(){return{_tag:this._tag,symbol:String(this.symbol),annotations:st(this.annotations)}}}class H{annotations;_tag="UndefinedKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const G=new H({[w]:"undefined"});class Z{annotations;_tag="VoidKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const ee=new Z({[w]:"void"});class te{annotations;_tag="NeverKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const ne=new te({[w]:"never"});class re{annotations;_tag="UnknownKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const ie=new re({[w]:"unknown"});class oe{annotations;_tag="AnyKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const se=new oe({[w]:"any"});class ae{annotations;_tag="StringKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const ce=new ae({[w]:"string",[N]:"a string"}),de=K("StringKeyword");class le{annotations;_tag="NumberKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const pe=new le({[w]:"number",[N]:"a number"}),ue=K("NumberKeyword");class he{annotations;_tag="BooleanKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const me=new he({[w]:"boolean",[N]:"a boolean"});class fe{annotations;_tag="BigIntKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const ye=new fe({[w]:"bigint",[N]:"a bigint"});class ge{annotations;_tag="SymbolKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const we=new ge({[w]:"symbol",[N]:"a symbol"}),Ne=K("SymbolKeyword");class be{annotations;_tag="ObjectKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const ve=new be({[g]:"object",[w]:"object",[N]:"an object in the TypeScript meaning, i.e. the `object` type"});class xe{type;annotations;constructor(e,t={}){this.type=e,this.annotations=t}toJSON(){return{type:this.type.toJSON(),annotations:st(this.annotations)}}toString(){return String(this.type)}}class ke extends xe{isOptional;constructor(e,t,n={}){super(e,n),this.isOptional=t}toJSON(){return{type:this.type.toJSON(),isOptional:this.isOptional,annotations:st(this.annotations)}}toString(){return String(this.type)+(this.isOptional?"?":"")}}const Se=e=>e.map((e=>e.type));class Oe{elements;rest;isReadonly;annotations;_tag="TupleType";constructor(e,t,n,r={}){this.elements=e,this.rest=t,this.isReadonly=n,this.annotations=r;let i=!1,o=!1;for(const t of e)if(t.isOptional)i=!0;else if(i){o=!0;break}if(o||i&&t.length>1)throw new Error(p.YW)}toString(){return a.WL(pt(this),(()=>We(this)))}toJSON(){return{_tag:this._tag,elements:this.elements.map((e=>e.toJSON())),rest:this.rest.map((e=>e.toJSON())),isReadonly:this.isReadonly,annotations:st(this.annotations)}}}const We=e=>{const t=e.elements.map(String).join(", ");return r.nc(e.rest,{onEmpty:()=>`readonly [${t}]`,onNonEmpty:(n,r)=>{const i=String(n),o=i.includes(" | ")?`(${i})`:i;if(r.length>0){const n=r.map(String).join(", ");return e.elements.length>0?`readonly [${t}, ...${o}[], ${n}]`:`readonly [...${o}[], ${n}]`}return e.elements.length>0?`readonly [${t}, ...${o}[]]`:`ReadonlyArray<${i}>`}})};class qe extends ke{name;isReadonly;constructor(e,t,n,r,i){super(t,n,i),this.name=e,this.isReadonly=r}toJSON(){return{name:String(this.name),type:this.type.toJSON(),isOptional:this.isOptional,isReadonly:this.isReadonly,annotations:st(this.annotations)}}}const Ie=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return!0;case"Refinement":return Ie(e.from)}return!1};class Te{type;isReadonly;parameter;constructor(e,t,n){if(this.type=t,this.isReadonly=n,!Ie(e))throw new Error(p.D4);this.parameter=e}toJSON(){return{parameter:this.parameter.toJSON(),type:this.type.toJSON(),isReadonly:this.isReadonly}}}class Ee{annotations;_tag="TypeLiteral";propertySignatures;indexSignatures;constructor(e,t,n={}){this.annotations=n;const r={};for(let t=0;t<e.length;t++){const n=e[t].name;if(Object.prototype.hasOwnProperty.call(r,n))throw new Error(p.eT(n));r[n]=null}const i={string:!1,symbol:!1};for(let e=0;e<t.length;e++){const n=dt(t[e].parameter);if(de(n)){if(i.string)throw new Error(p.DB("string"));i.string=!0}else if(Ne(n)){if(i.symbol)throw new Error(p.DB("symbol"));i.symbol=!0}}this.propertySignatures=at(e),this.indexSignatures=ct(t)}toString(){return a.WL(pt(this),(()=>Ce(this)))}toJSON(){return{_tag:this._tag,propertySignatures:this.propertySignatures.map((e=>e.toJSON())),indexSignatures:this.indexSignatures.map((e=>e.toJSON())),annotations:st(this.annotations)}}}const Ce=e=>{const t=e.propertySignatures.map((e=>(e.isReadonly?"readonly ":"")+String(e.name)+(e.isOptional?"?":"")+": "+e.type)).join("; ");if(e.indexSignatures.length>0){const n=e.indexSignatures.map((e=>(e.isReadonly?"readonly ":"")+`[x: ${dt(e.parameter)}]: ${e.type}`)).join("; ");return e.propertySignatures.length>0?`{ ${t}; ${n} }`:`{ ${n} }`}return e.propertySignatures.length>0?`{ ${t} }`:"{}"},De=r.di(c.zQ(s.pH,(e=>{switch(e._tag){case"AnyKeyword":return 0;case"UnknownKeyword":return 1;case"ObjectKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3}return 4}))),Pe={string:"StringKeyword",number:"NumberKeyword",boolean:"BooleanKeyword",bigint:"BigIntKeyword"},Ae=e=>r.qI(e,(e=>Fe(e)?Ae(e.types):[e]));class Me{types;annotations;static make=(e,t)=>{const n=[],r=new Set;for(let t=0;t<e.length;t++){const i=e[t];i===ne||r.has(i)||(r.add(i),n.push(i))}return Me.union(n,t)};static members=(e,t)=>Me.union((e=>e.filter((e=>!(e===ne))))(e),t);static unify=(e,t)=>Me.union((e=>{const t=De(e),n=[],r={},i=[];for(const e of t)switch(e._tag){case"NeverKeyword":break;case"AnyKeyword":return[se];case"UnknownKeyword":return[ie];case"ObjectKeyword":case"UndefinedKeyword":case"VoidKeyword":case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":r[e._tag]||(r[e._tag]=e,n.push(e));break;case"Literal":{const t=typeof e.literal;switch(t){case"string":case"number":case"bigint":case"boolean":r[Pe[t]]||i.includes(e.literal)||(i.push(e.literal),n.push(e));break;case"object":i.includes(e.literal)||(i.push(e.literal),n.push(e))}break}case"UniqueSymbol":r.SymbolKeyword||i.includes(e.symbol)||(i.push(e.symbol),n.push(e));break;case"TupleType":r.ObjectKeyword||n.push(e);break;case"TypeLiteral":0===e.propertySignatures.length&&0===e.indexSignatures.length?r["{}"]||(r["{}"]=e,n.push(e)):r.ObjectKeyword||n.push(e);break;default:n.push(e)}return n})(Ae(e)),t);static union=(e,t)=>Be(e)?new Me(e,t):1===e.length?e[0]:ne;_tag="Union";constructor(e,t={}){this.types=e,this.annotations=t}toString(){return a.WL(pt(this),(()=>this.types.map(String).join(" | ")))}toJSON(){return{_tag:this._tag,types:this.types.map((e=>e.toJSON())),annotations:st(this.annotations)}}}const Le=(e,t)=>e.map(t),Be=e=>e.length>1,Fe=K("Union"),Re=(0,o.V)(Symbol.for("@effect/schema/AST/toJSONMemoMap"),(()=>new WeakMap));class je{f;annotations;_tag="Suspend";constructor(e,t={}){this.f=e,this.annotations=t,this.f=u.Z4(e)}toString(){return pt(this).pipe(a.NW((()=>a.qI(a.IB(this.f)(),(e=>pt(e))))),a.WL((()=>"<suspended schema>")))}toJSON(){const e=this.f();let t=Re.get(e);return t||(Re.set(e,{_tag:this._tag}),t={_tag:this._tag,ast:e.toJSON(),annotations:st(this.annotations)},Re.set(e,t),t)}}class Ue{from;filter;annotations;_tag="Refinement";constructor(e,t,n={}){this.from=e,this.filter=t,this.annotations=n}toString(){return a.WL(pt(this),(()=>`{ ${this.from} | filter }`))}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),annotations:st(this.annotations)}}}const _e=K("Refinement"),$e={};class Qe{from;to;transformation;annotations;_tag="Transformation";constructor(e,t,n,r={}){this.from=e,this.to=t,this.transformation=n,this.annotations=r}toString(){return a.WL(pt(this),(()=>`(${String(this.from)} <-> ${String(this.to)})`))}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),to:this.to.toJSON(),annotations:st(this.annotations)}}}const Je=K("Transformation");class Ke{decode;encode;_tag="FinalTransformation";constructor(e,t){this.decode=e,this.encode=t}}class Ye{from;to;decode;encode;constructor(e,t,n,r){this.from=e,this.to=t,this.decode=n,this.encode=r}}class Ve{propertySignatureTransformations;_tag="TypeLiteralTransformation";constructor(e){this.propertySignatureTransformations=e;const t={},n={};for(const r of e){const e=r.from;if(t[e])throw new Error(p.NJ(e));t[e]=!0;const i=r.to;if(n[i])throw new Error(p.NJ(i));n[i]=!0}}}const ze=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e);return n.annotations.value={...e.annotations,...t},Object.create(Object.getPrototypeOf(e),n)},Xe=e=>{let t=`^${l.i(e.head)}`;for(const n of e.spans)de(n.type)?t+=".*":ue(n.type)&&(t+="[+-]?\\d*\\.?\\d+(?:[Ee][+-]?\\d+)?"),t+=l.i(n.literal);return t+="$",new RegExp(t)},He=e=>{switch(e._tag){case"Declaration":{const t=U(e);if(a.Ru(t))return He(t.value);break}case"TypeLiteral":return e.propertySignatures.slice();case"Suspend":return He(e.f())}return Ze(e).map((t=>Ge(e,t)))},Ge=(e,t)=>{switch(e._tag){case"Declaration":{const n=U(e);if(a.Ru(n))return Ge(n.value,t);break}case"TypeLiteral":{const n=r.i8(e.propertySignatures,(e=>e.name===t));if(a.Ru(n))return n.value;if(d.Kg(t))for(const n of e.indexSignatures){const e=dt(n.parameter);switch(e._tag){case"TemplateLiteral":if(Xe(e).test(t))return new qe(t,n.type,!1,!0);break;case"StringKeyword":return new qe(t,n.type,!1,!0)}}else if(d.Bm(t))for(const n of e.indexSignatures){const e=dt(n.parameter);if(Ne(e))return new qe(t,n.type,!1,!0)}break}case"Union":return new qe(t,Me.make(e.types.map((e=>Ge(e,t).type))),!1,!0);case"Suspend":return Ge(e.f(),t)}return new qe(t,ne,!1,!0)},Ze=e=>{switch(e._tag){case"Declaration":{const t=U(e);if(a.Ru(t))return Ze(t.value);break}case"TypeLiteral":return e.propertySignatures.map((e=>e.name));case"Suspend":return Ze(e.f());case"Union":return e.types.slice(1).reduce(((e,t)=>r.E$(e,Ze(t))),Ze(e.types[0]));case"Transformation":return Ze(e.to)}return[]},et=(e,t)=>{const n=[],r=[],i=e=>{switch(e._tag){case"NeverKeyword":break;case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":case"Refinement":r.push(new Te(e,t,!0));break;case"Literal":if(!d.Kg(e.literal)&&!d.Et(e.literal))throw new Error(p.Bd(e.literal));n.push(new qe(e.literal,t,!1,!0));break;case"Enums":for(const[r,i]of e.enums)n.push(new qe(i,t,!1,!0));break;case"UniqueSymbol":n.push(new qe(e.symbol,t,!1,!0));break;case"Union":e.types.forEach(i);break;default:throw new Error(p.yK(e))}};return i(e),{propertySignatures:n,indexSignatures:r}},tt=e=>{switch(e._tag){case"Declaration":{const t=rt(e.typeParameters,tt);return t===e.typeParameters?e:new J(t,e.decodeUnknown,e.encodeUnknown,e.annotations)}case"TupleType":{const t=rt(e.elements,(e=>{const t=tt(e.type);return t===e.type?e:new ke(t,e.isOptional)})),n=Se(e.rest),r=rt(n,tt);return t===e.elements&&r===n?e:new Oe(t,r.map((e=>new xe(e))),e.isReadonly,e.annotations)}case"TypeLiteral":{const t=rt(e.propertySignatures,(e=>{const t=tt(e.type);return t===e.type?e:new qe(e.name,t,e.isOptional,e.isReadonly)})),n=rt(e.indexSignatures,(e=>{const t=tt(e.type);return t===e.type?e:new Te(e.parameter,t,e.isReadonly)}));return t===e.propertySignatures&&n===e.indexSignatures?e:new Ee(t,n,e.annotations)}case"Union":{const t=rt(e.types,tt);return t===e.types?e:Me.make(t,e.annotations)}case"Suspend":return new je((()=>tt(e.f())),e.annotations);case"Refinement":{const t=tt(e.from);return t===e.from?e:new Ue(t,e.filter,e.annotations)}case"Transformation":return tt(e.to)}return e},nt=e=>a.YW((e=>a.NW(Q(e),(()=>M(e))))(e),{onNone:()=>{},onSome:e=>({[$]:e})});function rt(e,t){let n=!1;const i=r.CN(e.length);for(let r=0;r<e.length;r++){const o=e[r],s=t(o);s!==o&&(n=!0),i[r]=s}return n?i:e}const it=(e,t)=>{switch(e._tag){case"Declaration":{const n=rt(e.typeParameters,(e=>it(e,t)));return n===e.typeParameters?e:new J(n,e.decodeUnknown,e.encodeUnknown,e.annotations)}case"TupleType":{const n=rt(e.elements,(e=>{const n=it(e.type,t);return n===e.type?e:new ke(n,e.isOptional)})),r=Se(e.rest),i=rt(r,(e=>it(e,t)));return n===e.elements&&i===r?e:new Oe(n,i.map((e=>new xe(e))),e.isReadonly,nt(e))}case"TypeLiteral":{const n=rt(e.propertySignatures,(e=>{const n=it(e.type,t);return n===e.type?e:new qe(e.name,n,e.isOptional,e.isReadonly)})),r=rt(e.indexSignatures,(e=>{const n=it(e.type,t);return n===e.type?e:new Te(e.parameter,n,e.isReadonly)}));return n===e.propertySignatures&&r===e.indexSignatures?e:new Ee(n,r,nt(e))}case"Union":{const n=rt(e.types,(e=>it(e,t)));return n===e.types?e:Me.make(n,nt(e))}case"Suspend":return new je((()=>it(e.f(),t)),nt(e));case"Refinement":{const n=it(e.from,t);if(t){if(n===e.from)return e;if(!Je(e.from)){const t=_(e);if(a.Ru(t)&&!0===t.value)return new Ue(n,e.filter)}}return n}case"Transformation":return it(e.from,t)}return e},ot=e=>it(e,!1),st=e=>{const t={};for(const n of Object.getOwnPropertySymbols(e))t[String(n)]=e[n];return t},at=r.di(c.zQ(s.pH,(e=>(e=>{switch(e._tag){case"NeverKeyword":return 0;case"Literal":case"UndefinedKeyword":case"VoidKeyword":case"UniqueSymbol":return 1;case"BooleanKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3;case"ObjectKeyword":return 5;case"UnknownKeyword":case"AnyKeyword":return 6;default:return 4}})(e.type)))),ct=r.di(c.zQ(s.pH,(e=>{switch(dt(e.parameter)._tag){case"StringKeyword":return 2;case"SymbolKeyword":return 3;case"TemplateLiteral":return 1}}))),dt=(s.pH,s.pH,s.pH,e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return e;case"Refinement":return dt(e.from)}}),lt=e=>a.WL(pt(e),(()=>e._tag)),pt=e=>M(e).pipe(a.NW((()=>A(e))),a.NW((()=>L(e))))},156340:(e,t,n)=>{n.d(t,{Kc:()=>$,Py:()=>W,ZU:()=>v,dF:()=>R,eC:()=>w,eq:()=>U,fJ:()=>q,gm:()=>f,is:()=>_,k9:()=>j,lN:()=>F,sV:()=>I,u$:()=>O,wG:()=>B,xm:()=>C});var r=n(975955),i=n(334188),o=n(200093),s=n(237965),a=n(374212),c=n(466894),d=n(755642),l=n(30805),p=n(43963),u=n(958146),h=n(250080),m=n(870512);class f{path;actual;issue;_tag="Pointer";constructor(e,t,n){this.path=e,this.actual=t,this.issue=n}}class y{actual;message;_tag="Unexpected";constructor(e,t){this.actual=e,this.message=t}}class g{ast;message;_tag="Missing";actual=void 0;constructor(e,t){this.ast=e,this.message=t}}class w{ast;actual;issues;output;_tag="Composite";constructor(e,t,n,r){this.ast=e,this.actual=t,this.issues=n,this.output=r}}class N{ast;actual;kind;issue;_tag="Refinement";constructor(e,t,n,r){this.ast=e,this.actual=t,this.kind=n,this.issue=r}}class b{ast;actual;kind;issue;_tag="Transformation";constructor(e,t,n,r){this.ast=e,this.actual=t,this.kind=n,this.issue=r}}class v{ast;actual;message;_tag="Type";constructor(e,t,n){this.ast=e,this.actual=t,this.message=n}}class x{ast;actual;message;_tag="Forbidden";constructor(e,t,n){this.ast=e,this.actual=t,this.message=n}}const k=Symbol.for("@effect/schema/ParseErrorTypeId");class S extends((0,i.rN)("ParseError")){[k]=k;get message(){return this.toString()}toString(){return m.Im(this.issue)}toJSON(){return{_id:"ParseError",message:this.toString()}}[d.FX](){return this.toJSON()}}const O=e=>new S({issue:e}),W=s.pG,q=s.kb,I=(s.Sv,s.sV),T=(0,a.XY)(2,((e,t)=>{const n=e;return"Left"===n._tag?n:"Right"===n._tag?t(n.right):o.flatMap(e,t)})),E=(0,a.XY)(2,((e,t)=>{const n=e;return"Left"===n._tag?n:"Right"===n._tag?s.pG(t(n.right)):o.map(e,t)})),C=(0,a.XY)(2,((e,t)=>{const n=e;return"Left"===n._tag?s.kb(t(n.left)):"Right"===n._tag?n:o.mapError(e,t)})),D=e=>{const t=e;if("Left"===t._tag||"Right"===t._tag)return t},P=(e,t)=>void 0===t||p.Et(t)?e:void 0===e?t:{...e,...t},A=(e,t,n)=>{const r=K(e,t);return(e,t)=>r(e,P(n,t))},M=(e,t,n)=>{const r=A(e,t,n);return(e,t)=>s.Gu(r(e,t),O)},L=(e,t,n)=>{const r=K(e,t);return(e,t)=>r(e,{...P(n,t),isEffectAllowed:!0})},B=(e,t)=>A(e.ast,!0,t),F=(e,t)=>L(e.ast,!0,t),R=(e,t)=>L(e.ast,!1,t),j=(e,t)=>M(e.ast,!0,t),U=(e,t)=>M(u.p$(e.ast),!0,t),_=(e,t)=>{const n=K(u.p$(e.ast),!0);return(e,r)=>s.FG(n(e,{exact:!0,...P(t,r)}))},$=(e,t)=>M(e.ast,!1,t),Q=(0,c.V)(Symbol.for("@effect/schema/Parser/decodeMemoMap"),(()=>new WeakMap)),J=(0,c.V)(Symbol.for("@effect/schema/Parser/encodeMemoMap"),(()=>new WeakMap)),K=(e,t)=>{const n=t?Q:J,r=n.get(e);if(r)return r;const i=z(e,t),o=u.Re(e),s=l.Ru(o)?(e,t)=>i(e,P(t,o.value)):i;return n.set(e,s),s},Y=e=>l.Y6(u.fq(e)),V=e=>l.Y6(u.iJ(e)),z=(e,t)=>{switch(e._tag){case"Refinement":if(t){const t=K(e.from,!0);return(n,r)=>ee(T(C(t(n,r),(t=>new N(e,n,"From",t))),(t=>l.YW(e.filter(t,r??u.Wy,e),{onNone:()=>s.pG(t),onSome:t=>s.kb(new N(e,n,"Predicate",t))}))),e,n,r)}{const t=K(u.p$(e),!0),n=K(Z(e.from),!1);return(r,i)=>ee(T(t(r,i),(e=>n(e,i))),e,r,i)}case"Transformation":{const n=re(e.transformation,t),r=t?K(e.from,!0):K(e.to,!1),i=t?K(e.to,!0):K(e.from,!1);return(o,s)=>ee(T(C(r(o,s),(n=>new b(e,o,t?"Encoded":"Type",n))),(r=>T(C(n(r,s??u.Wy,e),(t=>new b(e,o,"Transformation",t))),(n=>C(i(n,s),(n=>new b(e,o,t?"Type":"Encoded",n))))))),e,o,s)}case"Declaration":{const n=t?e.decodeUnknown(...e.typeParameters):e.encodeUnknown(...e.typeParameters);return(t,r)=>ee(n(t,r??u.Wy,e),e,t,r)}case"Literal":return X(e,(t=>t===e.literal));case"UniqueSymbol":return X(e,(t=>t===e.symbol));case"UndefinedKeyword":case"VoidKeyword":return X(e,p.b0);case"NeverKeyword":return X(e,p.Pd);case"UnknownKeyword":case"AnyKeyword":return s.pG;case"StringKeyword":return X(e,p.Kg);case"NumberKeyword":return X(e,p.Et);case"BooleanKeyword":return X(e,p.Lm);case"BigIntKeyword":return X(e,p.sI);case"SymbolKeyword":return X(e,p.Bm);case"ObjectKeyword":return X(e,p.Gv);case"Enums":return X(e,(t=>e.enums.some((([e,n])=>n===t))));case"TemplateLiteral":{const t=u.$j(e);return X(e,(e=>p.Kg(e)&&t.test(e)))}case"TupleType":{const n=e.elements.map((e=>K(e.type,t))),i=e.rest.map((e=>K(e.type,t)));let a=e.elements.filter((e=>!e.isOptional));e.rest.length>0&&(a=a.concat(e.rest.slice(1)));const c=a.length,d=e.elements.length>0?e.elements.map(((e,t)=>t)).join(" | "):"never",l=Y(e),p=V(e);return(t,u)=>{if(!r.cy(t))return s.kb(new v(e,t));const h="all"===u?.errors,m=[];let N=0;const b=[],x=t.length;for(let n=x;n<=c-1;n++){const r=new f(n,t,new g(a[n-x]));if(!h)return s.kb(new w(e,t,r,b));m.push([N++,r])}if(0===e.rest.length)for(let n=e.elements.length;n<=x-1;n++){const r=new f(n,t,new y(t[n],`is unexpected, expected: ${d}`));if(!h)return s.kb(new w(e,t,r,b));m.push([N++,r])}let k,S=0;for(;S<n.length;S++)if(x<S+1){if(e.elements[S].isOptional)continue}else{const r=(0,n[S])(t[S],u),i=D(r);if(i){if(s.OC(i)){const n=new f(S,t,i.left);if(h){m.push([N++,n]);continue}return s.kb(new w(e,t,n,ne(b)))}b.push([N++,i.right])}else{const n=N++,i=S;k||(k=[]),k.push((({es:a,output:c})=>o.flatMap(o.either(r),(r=>{if(s.OC(r)){const d=new f(i,t,r.left);return h?(a.push([n,d]),o.void):s.kb(new w(e,t,d,ne(c)))}return c.push([n,r.right]),o.void}))))}}if(r.iI(i)){const[n,...r]=i;for(;S<x-r.length;S++){const r=n(t[S],u),i=D(r);if(i){if(s.OC(i)){const n=new f(S,t,i.left);if(h){m.push([N++,n]);continue}return s.kb(new w(e,t,n,ne(b)))}b.push([N++,i.right])}else{const n=N++,i=S;k||(k=[]),k.push((({es:a,output:c})=>o.flatMap(o.either(r),(r=>{if(s.OC(r)){const d=new f(i,t,r.left);return h?(a.push([n,d]),o.void):s.kb(new w(e,t,d,ne(c)))}return c.push([n,r.right]),o.void}))))}}for(let n=0;n<r.length;n++)if(S+=n,!(x<S+1)){const i=r[n](t[S],u),a=D(i);if(a){if(s.OC(a)){const n=new f(S,t,a.left);if(h){m.push([N++,n]);continue}return s.kb(new w(e,t,n,ne(b)))}b.push([N++,a.right])}else{const n=N++,r=S;k||(k=[]),k.push((({es:a,output:c})=>o.flatMap(o.either(i),(i=>{if(s.OC(i)){const d=new f(r,t,i.left);return h?(a.push([n,d]),o.void):s.kb(new w(e,t,d,ne(c)))}return c.push([n,i.right]),o.void}))))}}}const O=({es:n,output:i})=>r.EI(n)?s.kb(new w(e,t,ne(n),ne(i))):s.pG(ne(i));if(k&&k.length>0){const e=k;return o.suspend((()=>{const t={es:r.C(m),output:r.C(b)};return o.flatMap(o.forEach(e,(e=>e(t)),{concurrency:l,batching:p,discard:!0}),(()=>O(t)))}))}return O({output:b,es:m})}}case"TypeLiteral":{if(0===e.propertySignatures.length&&0===e.indexSignatures.length)return X(e,p.$y);const n=[],i={},a=[];for(const r of e.propertySignatures)n.push([K(r.type,t),r]),i[r.name]=null,a.push(r.name);const c=e.indexSignatures.map((e=>[K(e.parameter,t),K(e.type,t),e.parameter])),d=u.gP.make(e.indexSignatures.map((e=>e.parameter)).concat(a.map((e=>p.Bm(e)?new u.w_(e):new u.uS(e))))),l=K(d,t),m=Y(e),N=V(e);return(t,u)=>{if(!p.u4(t))return s.kb(new v(e,t));const b="all"===u?.errors,x=[];let k=0;const S="error"===u?.onExcessProperty,O={};let W,q;if(S||"preserve"===u?.onExcessProperty){W=h.Hs(t);for(const n of W){const r=D(l(n,u));if(s.OC(r)){if(S){const r=new f(n,t,new y(t[n],`is unexpected, expected: ${String(d)}`));if(b){x.push([k++,r]);continue}return s.kb(new w(e,t,r,O))}O[n]=t[n]}}}const I=!0===u?.exact;for(let r=0;r<n.length;r++){const i=n[r][1],a=i.name,c=Object.prototype.hasOwnProperty.call(t,a);if(!c){if(i.isOptional)continue;if(I){const n=new f(a,t,new g(i));if(b){x.push([k++,n]);continue}return s.kb(new w(e,t,n,O))}}const d=(0,n[r][0])(t[a],u),l=D(d);if(l){if(s.OC(l)){const n=new f(a,t,c?l.left:new g(i));if(b){x.push([k++,n]);continue}return s.kb(new w(e,t,n,O))}O[a]=l.right}else{const n=k++,r=a;q||(q=[]),q.push((({es:a,output:l})=>o.flatMap(o.either(d),(d=>{if(s.OC(d)){const p=new f(r,t,c?d.left:new g(i));return b?(a.push([n,p]),o.void):s.kb(new w(e,t,p,l))}return l[r]=d.right,o.void}))))}}for(let n=0;n<c.length;n++){const r=c[n],a=r[0],d=r[1],l=h.SC(t,r[2]);for(const n of l){const r=D(a(n,u));if(r&&s.FG(r)){const r=d(t[n],u),a=D(r);if(a){if(s.OC(a)){const r=new f(n,t,a.left);if(b){x.push([k++,r]);continue}return s.kb(new w(e,t,r,O))}Object.prototype.hasOwnProperty.call(i,n)||(O[n]=a.right)}else{const a=k++,c=n;q||(q=[]),q.push((({es:d,output:l})=>o.flatMap(o.either(r),(r=>{if(s.OC(r)){const n=new f(c,t,r.left);return b?(d.push([a,n]),o.void):s.kb(new w(e,t,n,l))}return Object.prototype.hasOwnProperty.call(i,n)||(l[n]=r.right),o.void}))))}}}}const T=({es:n,output:i})=>{if(r.EI(n))return s.kb(new w(e,t,ne(n),i));if("original"===u?.propertyOrder){const e=W||h.Hs(t);for(const t of a)-1===e.indexOf(t)&&e.push(t);const n={};for(const t of e)Object.prototype.hasOwnProperty.call(i,t)&&(n[t]=i[t]);return s.pG(n)}return s.pG(i)};if(q&&q.length>0){const e=q;return o.suspend((()=>{const t={es:r.C(x),output:Object.assign({},O)};return o.flatMap(o.forEach(e,(e=>e(t)),{concurrency:m,batching:N,discard:!0}),(()=>T(t)))}))}return T({es:x,output:O})}}case"Union":{const n=G(e.types,t),i=h.Hs(n.keys),a=i.length,c=new Map;for(let n=0;n<e.types.length;n++)c.set(e.types[n],K(e.types[n],t));const d=Y(e)??1,l=V(e);return(t,h)=>{const m=[];let y,N=0,b=[];if(a>0)if(p.u4(t))for(let e=0;e<a;e++){const r=i[e],o=n.keys[r].buckets;if(Object.prototype.hasOwnProperty.call(t,r)){const e=String(t[r]);if(Object.prototype.hasOwnProperty.call(o,e))b=b.concat(o[e]);else{const e=u.gP.make(n.keys[r].literals);m.push([N++,new w(new u.Ky([new u.Gb(r,e,!1,!0)],[]),t,new f(r,t,new v(e,t[r])))])}}else{const e=u.gP.make(n.keys[r].literals),i=new u.Gb(r,e,!1,!0);m.push([N++,new w(new u.Ky([i],[]),t,new f(r,t,new g(i)))])}}else m.push([N++,new v(e,t)]);n.otherwise.length>0&&(b=b.concat(n.otherwise));for(let e=0;e<b.length;e++){const n=b[e],r=c.get(n)(t,h),i=y&&0!==y.length?void 0:D(r);if(i){if(s.FG(i))return s.pG(i.right);m.push([N++,i.left])}else{const e=N++;y||(y=[]),y.push((t=>o.suspend((()=>"finalResult"in t?o.void:o.flatMap(o.either(r),(n=>(s.FG(n)?t.finalResult=s.pG(n.right):t.es.push([e,n.left]),o.void)))))))}}const x=n=>r.EI(n)?1===n.length&&"Type"===n[0][1]._tag?s.kb(n[0][1]):s.kb(new w(e,t,ne(n))):s.kb(new v(e,t));if(y&&y.length>0){const e=y;return o.suspend((()=>{const t={es:r.C(m)};return o.flatMap(o.forEach(e,(e=>e(t)),{concurrency:d,batching:l,discard:!0}),(()=>"finalResult"in t?t.finalResult:x(t.es)))}))}return x(m)}}case"Suspend":{const n=h.Z4((()=>K(u.hk(e.f(),e.annotations),t)));return(e,t)=>n()(e,t)}}},X=(e,t)=>n=>t(n)?s.pG(n):s.kb(new v(e,n)),H=(e,t)=>{switch(e._tag){case"Declaration":{const n=u.YI(e);if(l.Ru(n))return H(n.value,t);break}case"TypeLiteral":{const n=[];for(let r=0;r<e.propertySignatures.length;r++){const i=e.propertySignatures[r],o=t?u.rQ(i.type):u.p$(i.type);u.c$(o)&&!i.isOptional&&n.push([i.name,o])}return n}case"Refinement":return H(e.from,t);case"Suspend":return H(e.f(),t);case"Transformation":return H(t?e.from:e.to,t)}return[]},G=(e,t)=>{const n={},r=[];for(let i=0;i<e.length;i++){const o=e[i],s=H(o,t);if(s.length>0)for(let e=0;e<s.length;e++){const[t,r]=s[e],i=String(r.literal);n[t]=n[t]||{buckets:{},literals:[]};const a=n[t].buckets;if(!Object.prototype.hasOwnProperty.call(a,i)){a[i]=[o],n[t].literals.push(r);break}e<s.length-1||(a[i].push(o),n[t].literals.push(r))}else r.push(o)}return{keys:n,otherwise:r}},Z=e=>u.C8(e)?Z(e.from):e,ee=(e,t,n,r)=>{const i=D(e);if(i)return i;if(!0===r?.isEffectAllowed)return e;try{return o.runSync(o.either(e))}catch(e){return s.kb(new x(t,n,"cannot be be resolved synchronously, this is caused by using runSync on an effect that performs async work"))}},te=([e],[t])=>e>t?1:e<t?-1:0;function ne(e){return e.sort(te).map((e=>e[1]))}const re=(e,t)=>{switch(e._tag){case"FinalTransformation":return t?e.decode:e.encode;case"ComposeTransformation":return s.pG;case"TypeLiteralTransformation":return n=>{let r=s.pG(n);for(const n of e.propertySignatureTransformations){const[e,i]=t?[n.from,n.to]:[n.to,n.from],o=t?n.decode:n.encode,s=t=>{const n=o(Object.prototype.hasOwnProperty.call(t,e)?l.zN(t[e]):l.dv());return delete t[e],l.Ru(n)&&(t[i]=n.value),t};r=E(r,s)}return r}}}},622867:(e,t,n)=>{n.d(t,{BpQ:()=>xe,D4M:()=>D,EGw:()=>P,L8n:()=>W,MM$:()=>Ye,O31:()=>te,QfV:()=>K,Ru6:()=>be,T16:()=>Se,TqQ:()=>tt,Whr:()=>Xe,XeB:()=>Ge,_kM:()=>oe,gPz:()=>H,jJo:()=>it,lFO:()=>E,lNp:()=>C,mKk:()=>We,mSG:()=>ae,pbD:()=>me,pdi:()=>ge,rdN:()=>Z,wNn:()=>Y,wkx:()=>de,xeR:()=>B,yjt:()=>rt});var r=n(975955),i=n(2833),o=n(656599),s=n(165446),a=n(972e3),c=n(237965),d=n(643085),l=n(545422),p=n(617194),u=n(487529),h=n(374212),m=n(620113),f=n(30805),y=n(977148),g=n(43963),w=n(711312),N=n(958146),b=n(920902),v=n(586521),x=n(250080),k=n(156340),S=n(356004);const O=Symbol.for("@effect/schema/Schema"),W=e=>class{[O]=q;static Type;static Encoded;static[O]=q;static ast=e;static annotations(e){return W(T(this.ast,e))}static pipe(){return(0,y.t)(this,arguments)}static toString(){return String(e)}},q={_A:e=>e,_I:e=>e,_R:e=>e},I=e=>{if(!e)return{};const t={},n=Object.getOwnPropertySymbols(e);for(const r of n)t[r]=e[r];if(void 0!==e.typeId){const n=e.typeId;"object"==typeof n?(t[N.Dp]=n.id,t[n.id]=n.annotation):t[N.Dp]=n}const r=(n,r)=>{void 0!==e[n]&&(t[r]=e[n])};return r("message",N.YN),r("missingMessage",N.Ey),r("identifier",N.On),r("title",N.Z8),r("description",N.BW),r("examples",N.U4),r("default",N.u7),r("documentation",N.DH),r("jsonSchema",N.Ad),r("arbitrary",w.B1),r("pretty",S.jo),r("equivalence",b.tI),r("concurrency",N.MR),r("batching",N.Jo),r("parseIssueTitle",N.J5),r("parseOptions",N.E_),t},T=(e,t)=>N.hk(e,I(t)),E=(e,t)=>{const n=k.dF(e,t);return(e,t)=>k.xm(n(e,t),k.u$)},C=(e,t)=>{const n=k.lN(e,t);return(e,t)=>k.xm(n(e,t),k.u$)},D=C,P=(e,t)=>{const n=k.wG(e,t);return(e,t)=>c.qE(n(e,t),k.u$)},A=e=>g.i5(e,O)&&g.Gv(e[O]),M=(e,t=(e=>N.gV(e)?N.gP.make(N.Mz(e,(e=>new N.uS(e)))):new N.uS(e[0]))(e))=>class extends(W(t)){static annotations(e){return M(this.literals,T(this.ast,e))}static literals=[...e]};function L(...e){return r.iI(e)?M(e):U}const B=function(){return Array.isArray(arguments[0])?(e=arguments[0],t=arguments[1],n=arguments[2],W(new N.D6(e.map((e=>e.ast)),((...e)=>t.decode(...e.map(W))),((...e)=>t.encode(...e.map(W))),I(n)))):((e,t)=>{const n=()=>(t,n,r)=>e(t)?k.Py(t):k.fJ(new k.ZU(r,t)),r=n;return W(new N.D6([],n,r,I(t)))})(arguments[0],arguments[1]);var e,t,n};class F extends(W(N.oA)){static annotations=super.annotations}class R extends(W(N.Kt)){static annotations=super.annotations}class j extends(W(N.ch)){static annotations=super.annotations}class U extends(W(N.M3)){static annotations=super.annotations}class _ extends(W(N.ai)){static annotations=super.annotations}class $ extends(W(N._q)){static annotations=super.annotations}class Q extends(W(N.Zi)){static annotations=super.annotations}class J extends(W(N.YP)){static annotations=super.annotations}class K extends(W(N.vs)){static annotations=super.annotations}class Y extends(W(N.XS)){static annotations=super.annotations}class V extends(W(N.OD)){static annotations=super.annotations}class z extends(W(N.ZG)){static annotations=super.annotations}const X=(e,t=(e=>N.gP.members(e.map((e=>e.ast))))(e))=>class extends(W(t)){static annotations(e){return X(this.members,T(this.ast,e))}static members=[...e]};function H(...e){return N.gV(e)?X(e):r.iI(e)?e[0]:U}const G=(e,t,n=((e,t)=>new N.TD(e.map((e=>A(e)?new N.zh(e.ast,!1):e.ast)),t.map((e=>A(e)?new N.ZU(e.ast):e.ast)),!0))(e,t))=>class extends(W(n)){static annotations(e){return G(this.elements,this.rest,T(this.ast,e))}static elements=[...e];static rest=[...t]};function Z(...e){return Array.isArray(e[0])?G(e[0],e.slice(1)):G(e,[])}const ee=(e,t)=>class extends(G([],[e],t)){static annotations(e){return ee(this.value,T(this.ast,e))}static value=e},te=e=>ee(e);N.zh,N.zh,N.zh;const ne=Symbol.for("@effect/schema/PropertySignature"),re=e=>g.i5(e,ne),ie=(e,t,n=((e,t)=>{const n=x.Hs(e),i=[];if(n.length>0){const o=[],s=[],a=[];for(let t=0;t<n.length;t++){const r=n[t],c=e[r];if(re(c)){const e=c.ast;switch(e._tag){case"PropertySignatureDeclaration":{const t=e.type,n=e.isOptional,a=e.annotations;o.push(new N.Gb(r,t,n,!0)),s.push(new N.Gb(r,N.p$(t),n,!0,a)),i.push(new N.Gb(r,t,n,!0,a));break}case"PropertySignatureTransformation":{const t=e.from.fromKey??r;o.push(new N.Gb(t,e.from.type,e.from.isOptional,!0,e.from.annotations)),s.push(new N.Gb(r,e.to.type,e.to.isOptional,!0,e.to.annotations)),a.push(new N.Zn(t,r,e.decode,e.encode));break}}}else o.push(new N.Gb(r,c.ast,!1,!0)),s.push(new N.Gb(r,N.p$(c.ast),!1,!0)),i.push(new N.Gb(r,c.ast,!1,!0))}if(r.iI(a)){const e=[],n=[];for(const r of t){const{indexSignatures:t,propertySignatures:i}=N.g1(r.key.ast,r.value.ast);i.forEach((e=>{o.push(e),s.push(new N.Gb(e.name,N.p$(e.type),e.isOptional,e.isReadonly,e.annotations))})),t.forEach((t=>{e.push(t),n.push(new N.NH(t.parameter,N.p$(t.type),t.isReadonly))}))}return new N.IT(new N.Ky(o,e,{[N.Z8]:"Struct (Encoded side)"}),new N.Ky(s,n,{[N.Z8]:"Struct (Type side)"}),new N.nt(a))}}const o=[];for(const e of t){const{indexSignatures:t,propertySignatures:n}=N.g1(e.key.ast,e.value.ast);n.forEach((e=>i.push(e))),t.forEach((e=>o.push(e)))}return new N.Ky(i,o)})(e,t))=>class extends(W(n)){static annotations(e){return ie(this.fields,this.records,T(this.ast,e))}static fields={...e};static records=[...t];static make=(t,n)=>{const r=((e,t)=>{const n=x.Hs(e);for(const r of n){const n=e[r];if(void 0===t[r]&&re(n)){const e=n.ast,i="PropertySignatureDeclaration"===e._tag?e.defaultValue:e.to.defaultValue;void 0!==i&&(t[r]=i())}}return t})(e,{...t});return Mt(n)?r:k.eq(this)(r)}};function oe(e,...t){return ie(e,t)}const se=(e,t,n)=>class extends(ie({},[{key:e,value:t}],n)){static annotations(n){return se(e,t,T(this.ast,n))}static key=e;static value=t},ae=(e,t)=>se(e,t),ce=e=>class extends(W(e)){static annotations(e){return ce(T(this.ast,e))}static make=(e,t)=>Mt(t)?e:k.eq(this)(e)},de=(e,t)=>n=>{const r=f.YW(N.$N(n.ast),{onNone:()=>[e],onSome:t=>[...t,e]}),i=N.hk(n.ast,I({title:String(n.ast)+` & Brand<${x.eA(e)}>`,...t,[N.SB]:r}));return ce(i)},le=e=>W(new N.V3((()=>e().ast))),pe=(e,t,n)=>class extends(W(n)){static annotations(e){return pe(this.from,this.filter,T(this.ast,e))}static from=e;static filter=t;static make=(e,t)=>Mt(t)?e:k.eq(this)(e)},ue=(e,t,n)=>{if(g.Lm(e))return e?f.dv():f.zN(new k.ZU(t,n));if(g.Kg(e))return f.zN(new k.ZU(t,n,e));if(void 0!==e){if("_tag"in e)return f.zN(e);const i=new k.ZU(t,n,e.message);return f.zN(r.iI(e.path)?new k.gm(e.path,n,i):i)}return f.dv()},he=(e,t,n)=>{if(x.vX(e))return ue(e,t,n);if(r.iI(e)){const i=r.x1(e,(e=>ue(e,t,n)));if(r.iI(i))return f.zN(1===i.length?i[0]:new k.eC(t,n,i))}return f.dv()};function me(e,t){return n=>{function r(t,n,r){return he(e(t,n,r),r,t)}const i=new N.kV(n.ast,r,I(t));return pe(n,r,i)}}const fe=(e,t,n)=>class extends(W(n)){static annotations(e){return fe(this.from,this.to,T(this.ast,e))}static from=e;static to=t},ye=(0,h.XY)((e=>A(e[0])&&A(e[1])),((e,t,n)=>fe(e,t,new N.IT(e.ast,t.ast,new N.EK(n.decode,n.encode))))),ge=(0,h.XY)((e=>A(e[0])&&A(e[1])),((e,t,n)=>ye(e,t,{decode:e=>k.Py(n.decode(e)),encode:e=>k.Py(n.encode(e))}))),we=Symbol.for("@effect/schema/TypeId/Trimmed"),Ne=v.Qp,be=(e,t)=>n=>n.pipe(me((t=>t.length<=e),{typeId:Ne,description:`a string at most ${e} character(s) long`,jsonSchema:{maxLength:e},...t})),ve=v.Wz,xe=(e,t)=>n=>n.pipe(me((t=>t.length>=e),{typeId:ve,description:`a string at least ${e} character(s) long`,jsonSchema:{minLength:e},...t})),ke=Symbol.for("@effect/schema/TypeId/Pattern"),Se=(e,t)=>n=>{const r=e.source;return n.pipe(me((t=>(e.lastIndex=0,e.test(t))),{typeId:{id:ke,annotation:{regex:e}},description:`a string matching the pattern ${r}`,jsonSchema:{pattern:r},arbitrary:()=>t=>t.stringMatching(e),...t}))},Oe=Symbol.for("@effect/schema/TypeId/Includes"),We=(e,t)=>n=>n.pipe(me((t=>t.includes(e)),{typeId:{id:Oe,annotation:{includes:e}},description:`a string including ${JSON.stringify(e)}`,jsonSchema:{pattern:`.*${e}.*`},...t})),qe=Symbol.for("@effect/schema/TypeId/Lowercased");class Ie extends(K.pipe((e=>t=>t.pipe(me((e=>e===e.toLowerCase()),{typeId:qe,description:"a lowercase string",...e})))({identifier:"Lowercased",title:"Lowercased"}))){static annotations=super.annotations}const Te=Symbol.for("@effect/schema/TypeId/Uppercased");class Ee extends(K.pipe((e=>t=>t.pipe(me((e=>e===e.toUpperCase()),{typeId:Te,description:"an uppercase string",...e})))({identifier:"Uppercased",title:"Uppercased"}))){static annotations=super.annotations}const Ce=v.Ij;class De extends(K.pipe(((e,t)=>e=>{const n=g.Gv(1)?Math.max(0,Math.floor(1..min)):Math.max(0,Math.floor(1)),r=g.Gv(1)?Math.max(n,Math.floor(1..max)):n;return n!==r?e.pipe(me((e=>e.length>=n&&e.length<=r),{typeId:Ce,description:`a string at least ${n} character(s) and at most ${r} character(s) long`,jsonSchema:{minLength:n,maxLength:r},...t})):e.pipe(me((e=>e.length===n),{typeId:Ce,description:1===n?"a single character":`a string ${n} character(s) long`,jsonSchema:{minLength:n,maxLength:n},...t}))})(0,{identifier:"Char"}))){static annotations=super.annotations}class Pe extends(ge(K,Ie,{decode:e=>e.toLowerCase(),encode:h.D_}).annotations({identifier:"Lowercase"})){static annotations=super.annotations}class Ae extends(ge(K,Ee,{decode:e=>e.toUpperCase(),encode:h.D_}).annotations({identifier:"Uppercase"})){static annotations=super.annotations}class Me extends(K.pipe((e=>t=>t.pipe(me((e=>e===e.trim()),{typeId:we,description:"a string with no leading or trailing whitespace",jsonSchema:{pattern:"^\\S[\\s\\S]*\\S$|^\\S$|^$"},...e})))({identifier:"Trimmed",title:"Trimmed"}))){static annotations=super.annotations}class Le extends(ge(K,Me,{decode:e=>e.trim(),encode:h.D_}).annotations({identifier:"Trim"})){static annotations=super.annotations}N.On,N.Z8,N.BW;class Be extends(K.pipe((e=>xe(1,{description:"a non empty string",identifier:"NonEmpty",title:"NonEmpty"}))())){static annotations=super.annotations}const Fe=Symbol.for("@effect/schema/TypeId/UUID"),Re=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i;class je extends(K.pipe(Se(Re,{typeId:Fe,identifier:"UUID",title:"UUID",description:"a Universally Unique Identifier",arbitrary:()=>e=>e.uuid()}))){static annotations=super.annotations}const Ue=Symbol.for("@effect/schema/TypeId/ULID"),_e=/^[0-7][0-9A-HJKMNP-TV-Z]{25}$/i;class $e extends(K.pipe(Se(_e,{typeId:Ue,identifier:"ULID",title:"ULID",description:"a Universally Unique Lexicographically Sortable Identifier",arbitrary:()=>e=>e.ulid()}))){static annotations=super.annotations}const Qe=Symbol.for("@effect/schema/TypeId/Finite"),Je=e=>t=>t.pipe(me((e=>Number.isFinite(e)),{typeId:Qe,description:"a finite number",...e})),Ke=v.$_,Ye=(e,t)=>n=>n.pipe(me((t=>t>e),{typeId:Ke,description:0===e?"a positive number":`a number greater than ${e}`,jsonSchema:{exclusiveMinimum:e},...t})),Ve=v.ft,ze=v.Xe,Xe=e=>t=>t.pipe(me((e=>Number.isSafeInteger(e)),{typeId:ze,title:"integer",description:"an integer",jsonSchema:{type:"integer"},...e})),He=v.IO,Ge=(e,t)=>n=>n.pipe(me((t=>t<e),{typeId:He,description:0===e?"a negative number":`a number less than ${e}`,jsonSchema:{exclusiveMaximum:e},...t})),Ze=v._b,et=v._F,tt=(e,t,n)=>r=>r.pipe(me((n=>n>=e&&n<=t),{typeId:et,description:`a number between ${e} and ${t}`,jsonSchema:{maximum:t,minimum:e},...n})),nt=Symbol.for("@effect/schema/TypeId/NonNaN"),rt=e=>Ye(0,e);class it extends((e=>ye(e,Y,{strict:!1,decode:(e,t,n)=>k.sV(m.qg(e),(()=>new k.ZU(n,e))),encode:e=>k.Py(String(e))}))(K).annotations({identifier:"NumberFromString"})){static annotations=super.annotations}class ot extends(Y.pipe(Je({identifier:"Finite",title:"Finite"}))){static annotations=super.annotations}class st extends(Y.pipe(Xe({identifier:"Int",title:"Int"}))){static annotations=super.annotations}class at extends(Y.pipe((e=>t=>t.pipe(me((e=>!Number.isNaN(e)),{typeId:nt,description:"a number excluding NaN",...e})))({identifier:"NonNaN",title:"NonNaN"}))){static annotations=super.annotations}class ct extends(Y.pipe(rt({identifier:"Positive",title:"Positive"}))){static annotations=super.annotations}class dt extends(Y.pipe((e=>Ge(0,{identifier:"Negative",title:"Negative"}))())){static annotations=super.annotations}class lt extends(Y.pipe((e=>((e,t)=>e=>e.pipe(me((e=>e<=0),{typeId:Ze,description:"a non-positive number",jsonSchema:{maximum:0},...t})))(0,e))({identifier:"NonPositive",title:"NonPositive"}))){static annotations=super.annotations}class pt extends(Y.pipe((e=>((e,t)=>e=>e.pipe(me((e=>e>=0),{typeId:Ve,description:"a non-negative number",jsonSchema:{minimum:0},...t})))(0,e))({identifier:"NonNegative",title:"NonNegative"}))){static annotations=super.annotations}const ut=Symbol.for("@effect/schema/TypeId/JsonNumber");class ht extends(Y.pipe(me((e=>!Number.isNaN(e)&&Number.isFinite(e)),{typeId:ut,identifier:"JsonNumber",title:"JSON-compatible number",description:"a JSON-compatible number, excluding NaN, +Infinity, and -Infinity",jsonSchema:{type:"number"}}))){static annotations=super.annotations}class mt extends(ge(V,V,{decode:s.AU,encode:s.AU})){static annotations=super.annotations}class ft extends(ge(K,J,{strict:!1,decode:e=>Symbol.for(e),encode:e=>e.description}).annotations({identifier:"symbol"})){static annotations=super.annotations}v.uy,v.wO,v.pU,v.$H,v.tg;class yt extends(ye(K,Q,{decode:(e,t,n)=>k.sV(o.sH(e),(()=>new k.ZU(n,e))),encode:e=>k.Py(String(e))}).annotations({identifier:"bigint"})){static annotations=super.annotations}class gt extends(ye(Y,Q,{decode:(e,t,n)=>k.sV(o.oB(e),(()=>new k.ZU(n,e))),encode:(e,t,n)=>k.sV(o.Ro(e),(()=>new k.ZU(n,e)))}).annotations({identifier:"BigintFromNumber"})){static annotations=super.annotations}class wt extends(B(a.n$,{identifier:"DurationFromSelf",pretty:()=>String,arbitrary:()=>e=>e.oneof(e.constant(a.Tn),e.bigUint().map((e=>a.cF(e))),e.bigUint().map((e=>a.SY(e))),e.maxSafeNat().map((e=>a.ne(e))),e.maxSafeNat().map((e=>a.YA(e))),e.maxSafeNat().map((e=>a.Gx(e))),e.maxSafeNat().map((e=>a.c$(e))),e.maxSafeNat().map((e=>a._3(e))),e.maxSafeNat().map((e=>a.QM(e)))),equivalence:()=>a.rs})){static annotations=super.annotations}class Nt extends(ye(Q,wt,{decode:e=>k.Py(a.cF(e)),encode:(e,t,n)=>f.YW(a.tb(e),{onNone:()=>k.fJ(new k.ZU(n,e)),onSome:e=>k.Py(e)})}).annotations({identifier:"DurationFromNanos"})){static annotations=super.annotations}class bt extends(ge(Y,wt,{decode:e=>a.ne(e),encode:e=>a.kE(e)}).annotations({identifier:"DurationFromMillis"})){static annotations=super.annotations}const vt=Z(pt.pipe(Je({[N.Z8]:"seconds",[N.BW]:"seconds"})),pt.pipe(Je({[N.Z8]:"nanos",[N.BW]:"nanos"})));class xt extends(ge(vt,wt,{decode:([e,t])=>a.cF(BigInt(e)*BigInt(1e9)+BigInt(t)),encode:e=>a.Zr(e)}).annotations({identifier:"Duration"})){static annotations=super.annotations}g.mg;const kt=(d.y4,d.WG,d.$X,d.DX,d.EF,d.mU,v.mO,v.EM,v.Ls,Symbol.for("@effect/schema/TypeId/ValidDate")),St=e=>t=>t.pipe(me((e=>!Number.isNaN(e.getTime())),{typeId:kt,description:"a valid Date",...e}));class Ot extends(B(g.$P,{identifier:"DateFromSelf",description:"a potentially invalid Date instance",pretty:()=>e=>`new Date(${JSON.stringify(e)})`,arbitrary:()=>e=>e.date({noInvalidDate:!1}),equivalence:()=>p.n9})){static annotations=super.annotations}class Wt extends(Ot.pipe(St({identifier:"ValidDateFromSelf",description:"a valid Date instance"}))){static annotations=super.annotations}class qt extends(ge(K,Ot,{decode:e=>new Date(e),encode:e=>e.toISOString()}).annotations({identifier:"DateFromString"})){static annotations=super.annotations}class It extends(qt.pipe(St({identifier:"Date"}))){static annotations=super.annotations}class Tt extends(ge(Y,Ot,{decode:e=>new Date(e),encode:e=>e.getTime()}).annotations({identifier:"DateFromNumber"})){static annotations=super.annotations}const Et=()=>e=>`BigDecimal(${i.GP(i.S8(e))})`,Ct=()=>e=>e.tuple(e.bigInt(),e.integer()).map((([e,t])=>i.L8(e,t)));class Dt extends(B(i.s5,{identifier:"BigDecimalFromSelf",pretty:Et,arbitrary:Ct,equivalence:()=>i.rs})){static annotations=super.annotations}class Pt extends(ye(K,Dt,{decode:(e,t,n)=>i.sH(e).pipe(f.YW({onNone:()=>k.fJ(new k.ZU(n,e)),onSome:e=>k.Py(i.S8(e))})),encode:e=>k.Py(i.GP(i.S8(e)))}).annotations({identifier:"BigDecimal"})){static annotations=super.annotations}class At extends(ye(Y,Dt,{decode:e=>k.Py(i.oB(e)),encode:e=>k.Py(i.Di(e))}).annotations({identifier:"BigDecimalFromNumber"})){static annotations=super.annotations}const Mt=e=>g.Lm(e)?e:e?.disableValidation??!1,Lt=H(oe({_tag:L("None")}).annotations({identifier:"FiberIdNoneEncoded"}),oe({_tag:L("Runtime"),id:st.annotations({title:"id",description:"id"}),startTimeMillis:st.annotations({title:"startTimeMillis",description:"startTimeMillis"})}).annotations({identifier:"FiberIdRuntimeEncoded"}),oe({_tag:L("Composite"),left:le((()=>Lt)),right:le((()=>Lt))}).annotations({identifier:"FiberIdCompositeEncoded"})).annotations({identifier:"FiberIdEncoded"}),Bt=e=>e.letrec((t=>({None:e.record({_tag:e.constant("None")}),Runtime:e.record({_tag:e.constant("Runtime"),id:e.integer(),startTimeMillis:e.integer()}),Composite:e.record({_tag:e.constant("Composite"),left:t("FiberId"),right:t("FiberId")}),FiberId:e.oneof(t("None"),t("Runtime"),t("Composite"))}))).FiberId.map(jt),Ft=e=>{switch(e._tag){case"None":return"FiberId.none";case"Runtime":return`FiberId.runtime(${e.id}, ${e.startTimeMillis})`;case"Composite":return`FiberId.composite(${Ft(e.right)}, ${Ft(e.left)})`}};class Rt extends(B(u.gb,{identifier:"FiberIdFromSelf",pretty:()=>Ft,arbitrary:()=>Bt})){static annotations=super.annotations}const jt=e=>{switch(e._tag){case"None":return u.dv;case"Runtime":return u.fA(e.id,e.startTimeMillis);case"Composite":return u.sN(jt(e.left),jt(e.right))}},Ut=e=>{switch(e._tag){case"None":return{_tag:"None"};case"Runtime":return{_tag:"Runtime",id:e.id,startTimeMillis:e.startTimeMillis};case"Composite":return{_tag:"Composite",left:Ut(e.left),right:Ut(e.right)}}};class _t extends(ge(Lt,Rt,{decode:jt,encode:Ut}).annotations({identifier:"FiberId"})){static annotations=super.annotations}class $t extends(ge(_,V,{decode:g.zz,encode:h.D_}).annotations({identifier:"BooleanFromUnknown"})){static annotations=super.annotations}},821790:(e,t,n)=>{var r=n(689210),i=n(319819),o=n(396244),s=n(156340),a=n(622867),c=n(718034),d=n(858592),l=n(257844),p=n(975955),u=n(703225),h=n(319407),m=n(200093),f=n(374212),y=n(30805),g=n(43963),w=n(796031),N=n(770324),b=n(147494),v=n(684550),x=n(494400);const k=u.Io("Config"),S={reloadUrl:"/",syncUrl:"https://evolu.world",name:"Evolu",maxDrift:3e5,minimumLogLevel:"none"},O=e=>{const t={...S,...e},n=w.Py(k,t),r=x.Uq(t.minimumLogLevel).pipe(x.z7("debug",(()=>N.y)),x.z7("none",(()=>N.NV)),x.z7("trace",(()=>N.Cn)),x.z7("warning",(()=>N.N5)),x.T1),i="none"===t.minimumLogLevel?n:w.Um(n,b.dl(r),b.HC(b.Um,W(t.name)));return v.L(i)},W=e=>b.L8((({logLevel:t,message:n,date:r})=>{const i="Warning"===t._tag?"warn":"Error"===t._tag?"error":"log",o=`${r.getHours().toString().padStart(2,"0")}:${r.getMinutes().toString().padStart(2,"0")}:${r.getSeconds().toString().padStart(2,"0")}:${r.getMilliseconds().toString().padStart(3,"0")}`,s=Array.isArray(n)?n:[n];globalThis.console[i](`${o} [${e}]`,...s)}));var q=n(237965),I=n(620113),T=n(326237),E=n(962100);function C(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`positive integer expected, not ${e}`)}function D(e,...t){if(!((n=e)instanceof Uint8Array||null!=n&&"object"==typeof n&&"Uint8Array"===n.constructor.name))throw new Error("Uint8Array expected");var n;if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function P(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");C(e.outputLen),C(e.blockLen)}function A(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}var M=n(588160);const L=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),B=(e,t)=>e<<32-t|e>>>t;function F(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}(e)),D(e),e}new Uint8Array(new Uint32Array([287454020]).buffer)[0];class R{clone(){return this._cloneInto()}}const j={}.toString;function U(e){const t=t=>e().update(F(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function _(e=32){if(M.E&&"function"==typeof M.E.getRandomValues)return M.E.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}class $ extends R{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,P(e);const n=F(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,i=new Uint8Array(r);i.set(n.length>r?e.create().update(n).digest():n);for(let e=0;e<i.length;e++)i[e]^=54;this.iHash.update(i),this.oHash=e.create();for(let e=0;e<i.length;e++)i[e]^=106;this.oHash.update(i),i.fill(0)}update(e){return A(this),this.iHash.update(e),this}digestInto(e){A(this),D(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:r,destroyed:i,blockLen:o,outputLen:s}=this;return e.finished=r,e.destroyed=i,e.blockLen=o,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Q=(e,t,n)=>new $(e,t).update(n).digest();Q.create=(e,t)=>new $(e,t);const J=(e,t,n)=>e&t^e&n^t&n;class K extends R{constructor(e,t,n,r){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=L(this.buffer)}update(e){A(this);const{view:t,buffer:n,blockLen:r}=this,i=(e=F(e)).length;for(let o=0;o<i;){const s=Math.min(r-this.pos,i-o);if(s!==r)n.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===r&&(this.process(t,0),this.pos=0);else{const t=L(e);for(;r<=i-o;o+=r)this.process(t,o)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){A(this),function(e,t){D(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>r-o&&(this.process(n,0),o=0);for(let e=o;e<r;e++)t[e]=0;!function(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);const i=BigInt(32),o=BigInt(4294967295),s=Number(n>>i&o),a=Number(n&o),c=r?4:0,d=r?0:4;e.setUint32(t+c,s,r),e.setUint32(t+d,a,r)}(n,r-8,BigInt(8*this.length),i),this.process(n,0);const s=L(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,d=this.get();if(c>d.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)s.setUint32(4*e,d[e],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:i,destroyed:o,pos:s}=this;return e.length=r,e.pos=s,e.finished=i,e.destroyed=o,r%t&&e.buffer.set(n),e}}const Y=BigInt(2**32-1),V=BigInt(32);function z(e,t=!1){return t?{h:Number(e&Y),l:Number(e>>V&Y)}:{h:0|Number(e>>V&Y),l:0|Number(e&Y)}}const X=function(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let i=0;i<e.length;i++){const{h:o,l:s}=z(e[i],t);[n[i],r[i]]=[o,s]}return[n,r]},H=(e,t,n)=>e>>>n,G=(e,t,n)=>e<<32-n|t>>>n,Z=(e,t,n)=>e>>>n|t<<32-n,ee=(e,t,n)=>e<<32-n|t>>>n,te=(e,t,n)=>e<<64-n|t>>>n-32,ne=(e,t,n)=>e>>>n-32|t<<64-n,re=function(e,t,n,r){const i=(t>>>0)+(r>>>0);return{h:e+n+(i/2**32|0)|0,l:0|i}},ie=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),oe=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,se=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),ae=(e,t,n,r,i)=>t+n+r+i+(e/2**32|0)|0,ce=(e,t,n,r,i,o)=>t+n+r+i+o+(e/2**32|0)|0,de=(e,t,n,r,i)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(i>>>0),[le,pe]=(()=>X(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((e=>BigInt(e)))))(),ue=new Uint32Array(80),he=new Uint32Array(80);class me extends K{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:r,Ch:i,Cl:o,Dh:s,Dl:a,Eh:c,El:d,Fh:l,Fl:p,Gh:u,Gl:h,Hh:m,Hl:f}=this;return[e,t,n,r,i,o,s,a,c,d,l,p,u,h,m,f]}set(e,t,n,r,i,o,s,a,c,d,l,p,u,h,m,f){this.Ah=0|e,this.Al=0|t,this.Bh=0|n,this.Bl=0|r,this.Ch=0|i,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|d,this.Fh=0|l,this.Fl=0|p,this.Gh=0|u,this.Gl=0|h,this.Hh=0|m,this.Hl=0|f}process(e,t){for(let n=0;n<16;n++,t+=4)ue[n]=e.getUint32(t),he[n]=e.getUint32(t+=4);for(let e=16;e<80;e++){const t=0|ue[e-15],n=0|he[e-15],r=Z(t,n,1)^Z(t,n,8)^H(t,n,7),i=ee(t,n,1)^ee(t,n,8)^G(t,n,7),o=0|ue[e-2],s=0|he[e-2],a=Z(o,s,19)^te(o,s,61)^H(o,s,6),c=ee(o,s,19)^ne(o,s,61)^G(o,s,6),d=se(i,c,he[e-7],he[e-16]),l=ae(d,r,a,ue[e-7],ue[e-16]);ue[e]=0|l,he[e]=0|d}let{Ah:n,Al:r,Bh:i,Bl:o,Ch:s,Cl:a,Dh:c,Dl:d,Eh:l,El:p,Fh:u,Fl:h,Gh:m,Gl:f,Hh:y,Hl:g}=this;for(let e=0;e<80;e++){const t=Z(l,p,14)^Z(l,p,18)^te(l,p,41),w=ee(l,p,14)^ee(l,p,18)^ne(l,p,41),N=l&u^~l&m,b=de(g,w,p&h^~p&f,pe[e],he[e]),v=ce(b,y,t,N,le[e],ue[e]),x=0|b,k=Z(n,r,28)^te(n,r,34)^te(n,r,39),S=ee(n,r,28)^ne(n,r,34)^ne(n,r,39),O=n&i^n&s^i&s,W=r&o^r&a^o&a;y=0|m,g=0|f,m=0|u,f=0|h,u=0|l,h=0|p,({h:l,l:p}=re(0|c,0|d,0|v,0|x)),c=0|s,d=0|a,s=0|i,a=0|o,i=0|n,o=0|r;const q=ie(x,S,W);n=oe(q,v,k,O),r=0|q}({h:n,l:r}=re(0|this.Ah,0|this.Al,0|n,0|r)),({h:i,l:o}=re(0|this.Bh,0|this.Bl,0|i,0|o)),({h:s,l:a}=re(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l:d}=re(0|this.Dh,0|this.Dl,0|c,0|d)),({h:l,l:p}=re(0|this.Eh,0|this.El,0|l,0|p)),({h:u,l:h}=re(0|this.Fh,0|this.Fl,0|u,0|h)),({h:m,l:f}=re(0|this.Gh,0|this.Gl,0|m,0|f)),({h:y,l:g}=re(0|this.Hh,0|this.Hl,0|y,0|g)),this.set(n,r,i,o,s,a,c,d,l,p,u,h,m,f,y,g)}roundClean(){ue.fill(0),he.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const fe=U((()=>new me));const ye=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ge=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),we=new Uint32Array(64);class Ne extends K{constructor(){super(64,32,8,!1),this.A=0|ge[0],this.B=0|ge[1],this.C=0|ge[2],this.D=0|ge[3],this.E=0|ge[4],this.F=0|ge[5],this.G=0|ge[6],this.H=0|ge[7]}get(){const{A:e,B:t,C:n,D:r,E:i,F:o,G:s,H:a}=this;return[e,t,n,r,i,o,s,a]}set(e,t,n,r,i,o,s,a){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(e,t){for(let n=0;n<16;n++,t+=4)we[n]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=we[e-15],n=we[e-2],r=B(t,7)^B(t,18)^t>>>3,i=B(n,17)^B(n,19)^n>>>10;we[e]=i+we[e-7]+r+we[e-16]|0}let{A:n,B:r,C:i,D:o,E:s,F:a,G:c,H:d}=this;for(let e=0;e<64;e++){const t=d+(B(s,6)^B(s,11)^B(s,25))+((l=s)&a^~l&c)+ye[e]+we[e]|0,p=(B(n,2)^B(n,13)^B(n,22))+J(n,r,i)|0;d=c,c=a,a=s,s=o+t|0,o=i,i=r,r=n,n=t+p|0}var l;n=n+this.A|0,r=r+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,d=d+this.H|0,this.set(n,r,i,o,s,a,c,d)}roundClean(){we.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const be=U((()=>new Ne));function ve(e){if(!Number.isSafeInteger(e))throw new Error(`Wrong integer: ${e}`)}function xe(e){return e instanceof Uint8Array||null!=e&&"object"==typeof e&&"Uint8Array"===e.constructor.name}function ke(...e){const t=e=>e,n=(e,t)=>n=>e(t(n));return{encode:e.map((e=>e.encode)).reduceRight(n,t),decode:e.map((e=>e.decode)).reduce(n,t)}}function Se(e){return{encode:t=>{if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw new Error("alphabet.encode input should be an array of numbers");return t.map((t=>{if(ve(t),t<0||t>=e.length)throw new Error(`Digit index outside alphabet: ${t} (alphabet: ${e.length})`);return e[t]}))},decode:t=>{if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("alphabet.decode input should be array of strings");return t.map((t=>{if("string"!=typeof t)throw new Error(`alphabet.decode: not string element=${t}`);const n=e.indexOf(t);if(-1===n)throw new Error(`Unknown letter: "${t}". Allowed: ${e}`);return n}))}}}function Oe(e=""){if("string"!=typeof e)throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("join.encode input should be array of strings");for(let e of t)if("string"!=typeof e)throw new Error(`join.encode: non-string input=${e}`);return t.join(e)},decode:t=>{if("string"!=typeof t)throw new Error("join.decode input should be string");return t.split(e)}}}function We(e,t="="){if(ve(e),"string"!=typeof t)throw new Error("padding chr should be string");return{encode(n){if(!Array.isArray(n)||n.length&&"string"!=typeof n[0])throw new Error("padding.encode input should be array of strings");for(let e of n)if("string"!=typeof e)throw new Error(`padding.encode: non-string input=${e}`);for(;n.length*e%8;)n.push(t);return n},decode(n){if(!Array.isArray(n)||n.length&&"string"!=typeof n[0])throw new Error("padding.encode input should be array of strings");for(let e of n)if("string"!=typeof e)throw new Error(`padding.decode: non-string input=${e}`);let r=n.length;if(r*e%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if(!((r-1)*e%8))throw new Error("Invalid padding: string has too much padding");return n.slice(0,r)}}}function qe(e){if("function"!=typeof e)throw new Error("normalize fn should be function");return{encode:e=>e,decode:t=>e(t)}}function Ie(e,t,n){if(t<2)throw new Error(`convertRadix: wrong from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: wrong to=${n}, base cannot be less than 2`);if(!Array.isArray(e))throw new Error("convertRadix: data should be array");if(!e.length)return[];let r=0;const i=[],o=Array.from(e);for(o.forEach((e=>{if(ve(e),e<0||e>=t)throw new Error(`Wrong integer: ${e}`)}));;){let e=0,s=!0;for(let i=r;i<o.length;i++){const a=o[i],c=t*e+a;if(!Number.isSafeInteger(c)||t*e/t!==e||c-a!=t*e)throw new Error("convertRadix: carry overflow");e=c%n;const d=Math.floor(c/n);if(o[i]=d,!Number.isSafeInteger(d)||d*n+e!==c)throw new Error("convertRadix: carry overflow");s&&(d?s=!1:r=i)}if(i.push(e),s)break}for(let t=0;t<e.length-1&&0===e[t];t++)i.push(0);return i.reverse()}const Te=(e,t)=>t?Te(t,e%t):e,Ee=(e,t)=>e+(t-Te(e,t));function Ce(e,t,n,r){if(!Array.isArray(e))throw new Error("convertRadix2: data should be array");if(t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(Ee(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${Ee(t,n)}`);let i=0,o=0;const s=2**n-1,a=[];for(const r of e){if(ve(r),r>=2**t)throw new Error(`convertRadix2: invalid data word=${r} from=${t}`);if(i=i<<t|r,o+t>32)throw new Error(`convertRadix2: carry overflow pos=${o} from=${t}`);for(o+=t;o>=n;o-=n)a.push((i>>o-n&s)>>>0);i&=2**o-1}if(i=i<<n-o&s,!r&&o>=t)throw new Error("Excess padding");if(!r&&i)throw new Error(`Non-zero padding: ${i}`);return r&&o>0&&a.push(i>>>0),a}function De(e){return ve(e),{encode:t=>{if(!xe(t))throw new Error("radix.encode input should be Uint8Array");return Ie(Array.from(t),256,e)},decode:t=>{if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw new Error("radix.decode input should be array of numbers");return Uint8Array.from(Ie(t,e,256))}}}function Pe(e,t=!1){if(ve(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(Ee(8,e)>32||Ee(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!xe(n))throw new Error("radix2.encode input should be Uint8Array");return Ce(Array.from(n),8,e,!t)},decode:n=>{if(!Array.isArray(n)||n.length&&"number"!=typeof n[0])throw new Error("radix2.decode input should be array of numbers");return Uint8Array.from(Ce(n,e,8,t))}}}const Ae={alphabet:Se,chain:ke,checksum:function(e,t){if(ve(e),"function"!=typeof t)throw new Error("checksum fn should be function");return{encode(n){if(!xe(n))throw new Error("checksum.encode: input should be Uint8Array");const r=t(n).slice(0,e),i=new Uint8Array(n.length+e);return i.set(n),i.set(r,n.length),i},decode(n){if(!xe(n))throw new Error("checksum.decode: input should be Uint8Array");const r=n.slice(0,-e),i=t(r).slice(0,e),o=n.slice(-e);for(let t=0;t<e;t++)if(i[t]!==o[t])throw new Error("Invalid checksum");return r}}},convertRadix:Ie,convertRadix2:Ce,radix:De,radix2:Pe,join:Oe,padding:We};Pe(4),Se("0123456789ABCDEF"),Oe(""),Pe(5),Se("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),We(5),Oe(""),Pe(5),Se("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),Oe(""),Pe(5),Se("0123456789ABCDEFGHIJKLMNOPQRSTUV"),We(5),Oe(""),Pe(5),Se("0123456789ABCDEFGHIJKLMNOPQRSTUV"),Oe(""),Pe(5),Se("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),Oe(""),qe((e=>e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))),Pe(6),Se("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),We(6),Oe(""),Pe(6),Se("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Oe(""),Pe(6),Se("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),We(6),Oe("");Se("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),Oe("");const Me=(Pe(4),Se("0123456789abcdef"),Oe(""),qe((e=>{if("string"!=typeof e||e.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()})),e=>""===e[0]);function Le(e){if("string"!=typeof e)throw new TypeError("Invalid mnemonic type: "+typeof e);return e.normalize("NFKD")}function Be(e,t=128){if(C(t),t%32!=0||t>256)throw new TypeError("Invalid entropy");return function(e,t){!function(e){D(e,16,20,24,28,32)}(e);const n=function(e){if(!Array.isArray(e)||2048!==e.length||"string"!=typeof e[0])throw new Error("Wordlist: expected array of 2048 strings");return e.forEach((e=>{if("string"!=typeof e)throw new Error(`Wordlist: non-string element: ${e}`)})),Ae.chain(Ae.checksum(1,Fe),Ae.radix2(11,!0),Ae.alphabet(e))}(t).encode(e);return n.join(Me(t)?"":" ")}(_(t/8),e)}const Fe=e=>{const t=8-e.length/4;return new Uint8Array([be(e)[0]>>t<<t])};function Re(e,t=""){return function(e,t,n,r){const{c:i,dkLen:o,DK:s,PRF:a,PRFSalt:c}=function(e,t,n,r){P(e);const i=function(e,t){if(void 0!==t&&"[object Object]"!==j.call(t))throw new Error("Options should be object or undefined");return Object.assign({dkLen:32,asyncTick:10},t)}(0,r),{c:o,dkLen:s,asyncTick:a}=i;if(C(o),C(s),C(a),o<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const c=F(t),d=F(n),l=new Uint8Array(s),p=Q.create(e,c),u=p._cloneInto().update(d);return{c:o,dkLen:s,asyncTick:a,DK:l,PRF:p,PRFSalt:u}}(e,t,n,{c:2048,dkLen:64});let d;const l=new Uint8Array(4),p=L(l),u=new Uint8Array(a.outputLen);for(let e=1,t=0;t<o;e++,t+=a.outputLen){const n=s.subarray(t,t+a.outputLen);p.setInt32(0,e,!1),(d=c._cloneInto(d)).update(l).digestInto(u),n.set(u.subarray(0,n.length));for(let e=1;e<i;e++){a._cloneInto(d).update(u).digestInto(u);for(let e=0;e<n.length;e++)n[e]^=u[e]}}return function(e,t,n,r,i){return e.destroy(),t.destroy(),r&&r.destroy(),i.fill(0),n}(a,c,s,d,u)}(fe,function(e){const t=Le(e),n=t.split(" ");if(![12,15,18,21,24].includes(n.length))throw new Error("Invalid mnemonic");return{nfkd:t,words:n}}(e).nfkd,(e=>Le(`mnemonic${e}`))(t))}const je="abandon\nability\nable\nabout\nabove\nabsent\nabsorb\nabstract\nabsurd\nabuse\naccess\naccident\naccount\naccuse\nachieve\nacid\nacoustic\nacquire\nacross\nact\naction\nactor\nactress\nactual\nadapt\nadd\naddict\naddress\nadjust\nadmit\nadult\nadvance\nadvice\naerobic\naffair\nafford\nafraid\nagain\nage\nagent\nagree\nahead\naim\nair\nairport\naisle\nalarm\nalbum\nalcohol\nalert\nalien\nall\nalley\nallow\nalmost\nalone\nalpha\nalready\nalso\nalter\nalways\namateur\namazing\namong\namount\namused\nanalyst\nanchor\nancient\nanger\nangle\nangry\nanimal\nankle\nannounce\nannual\nanother\nanswer\nantenna\nantique\nanxiety\nany\napart\napology\nappear\napple\napprove\napril\narch\narctic\narea\narena\nargue\narm\narmed\narmor\narmy\naround\narrange\narrest\narrive\narrow\nart\nartefact\nartist\nartwork\nask\naspect\nassault\nasset\nassist\nassume\nasthma\nathlete\natom\nattack\nattend\nattitude\nattract\nauction\naudit\naugust\naunt\nauthor\nauto\nautumn\naverage\navocado\navoid\nawake\naware\naway\nawesome\nawful\nawkward\naxis\nbaby\nbachelor\nbacon\nbadge\nbag\nbalance\nbalcony\nball\nbamboo\nbanana\nbanner\nbar\nbarely\nbargain\nbarrel\nbase\nbasic\nbasket\nbattle\nbeach\nbean\nbeauty\nbecause\nbecome\nbeef\nbefore\nbegin\nbehave\nbehind\nbelieve\nbelow\nbelt\nbench\nbenefit\nbest\nbetray\nbetter\nbetween\nbeyond\nbicycle\nbid\nbike\nbind\nbiology\nbird\nbirth\nbitter\nblack\nblade\nblame\nblanket\nblast\nbleak\nbless\nblind\nblood\nblossom\nblouse\nblue\nblur\nblush\nboard\nboat\nbody\nboil\nbomb\nbone\nbonus\nbook\nboost\nborder\nboring\nborrow\nboss\nbottom\nbounce\nbox\nboy\nbracket\nbrain\nbrand\nbrass\nbrave\nbread\nbreeze\nbrick\nbridge\nbrief\nbright\nbring\nbrisk\nbroccoli\nbroken\nbronze\nbroom\nbrother\nbrown\nbrush\nbubble\nbuddy\nbudget\nbuffalo\nbuild\nbulb\nbulk\nbullet\nbundle\nbunker\nburden\nburger\nburst\nbus\nbusiness\nbusy\nbutter\nbuyer\nbuzz\ncabbage\ncabin\ncable\ncactus\ncage\ncake\ncall\ncalm\ncamera\ncamp\ncan\ncanal\ncancel\ncandy\ncannon\ncanoe\ncanvas\ncanyon\ncapable\ncapital\ncaptain\ncar\ncarbon\ncard\ncargo\ncarpet\ncarry\ncart\ncase\ncash\ncasino\ncastle\ncasual\ncat\ncatalog\ncatch\ncategory\ncattle\ncaught\ncause\ncaution\ncave\nceiling\ncelery\ncement\ncensus\ncentury\ncereal\ncertain\nchair\nchalk\nchampion\nchange\nchaos\nchapter\ncharge\nchase\nchat\ncheap\ncheck\ncheese\nchef\ncherry\nchest\nchicken\nchief\nchild\nchimney\nchoice\nchoose\nchronic\nchuckle\nchunk\nchurn\ncigar\ncinnamon\ncircle\ncitizen\ncity\ncivil\nclaim\nclap\nclarify\nclaw\nclay\nclean\nclerk\nclever\nclick\nclient\ncliff\nclimb\nclinic\nclip\nclock\nclog\nclose\ncloth\ncloud\nclown\nclub\nclump\ncluster\nclutch\ncoach\ncoast\ncoconut\ncode\ncoffee\ncoil\ncoin\ncollect\ncolor\ncolumn\ncombine\ncome\ncomfort\ncomic\ncommon\ncompany\nconcert\nconduct\nconfirm\ncongress\nconnect\nconsider\ncontrol\nconvince\ncook\ncool\ncopper\ncopy\ncoral\ncore\ncorn\ncorrect\ncost\ncotton\ncouch\ncountry\ncouple\ncourse\ncousin\ncover\ncoyote\ncrack\ncradle\ncraft\ncram\ncrane\ncrash\ncrater\ncrawl\ncrazy\ncream\ncredit\ncreek\ncrew\ncricket\ncrime\ncrisp\ncritic\ncrop\ncross\ncrouch\ncrowd\ncrucial\ncruel\ncruise\ncrumble\ncrunch\ncrush\ncry\ncrystal\ncube\nculture\ncup\ncupboard\ncurious\ncurrent\ncurtain\ncurve\ncushion\ncustom\ncute\ncycle\ndad\ndamage\ndamp\ndance\ndanger\ndaring\ndash\ndaughter\ndawn\nday\ndeal\ndebate\ndebris\ndecade\ndecember\ndecide\ndecline\ndecorate\ndecrease\ndeer\ndefense\ndefine\ndefy\ndegree\ndelay\ndeliver\ndemand\ndemise\ndenial\ndentist\ndeny\ndepart\ndepend\ndeposit\ndepth\ndeputy\nderive\ndescribe\ndesert\ndesign\ndesk\ndespair\ndestroy\ndetail\ndetect\ndevelop\ndevice\ndevote\ndiagram\ndial\ndiamond\ndiary\ndice\ndiesel\ndiet\ndiffer\ndigital\ndignity\ndilemma\ndinner\ndinosaur\ndirect\ndirt\ndisagree\ndiscover\ndisease\ndish\ndismiss\ndisorder\ndisplay\ndistance\ndivert\ndivide\ndivorce\ndizzy\ndoctor\ndocument\ndog\ndoll\ndolphin\ndomain\ndonate\ndonkey\ndonor\ndoor\ndose\ndouble\ndove\ndraft\ndragon\ndrama\ndrastic\ndraw\ndream\ndress\ndrift\ndrill\ndrink\ndrip\ndrive\ndrop\ndrum\ndry\nduck\ndumb\ndune\nduring\ndust\ndutch\nduty\ndwarf\ndynamic\neager\neagle\nearly\nearn\nearth\neasily\neast\neasy\necho\necology\neconomy\nedge\nedit\neducate\neffort\negg\neight\neither\nelbow\nelder\nelectric\nelegant\nelement\nelephant\nelevator\nelite\nelse\nembark\nembody\nembrace\nemerge\nemotion\nemploy\nempower\nempty\nenable\nenact\nend\nendless\nendorse\nenemy\nenergy\nenforce\nengage\nengine\nenhance\nenjoy\nenlist\nenough\nenrich\nenroll\nensure\nenter\nentire\nentry\nenvelope\nepisode\nequal\nequip\nera\nerase\nerode\nerosion\nerror\nerupt\nescape\nessay\nessence\nestate\neternal\nethics\nevidence\nevil\nevoke\nevolve\nexact\nexample\nexcess\nexchange\nexcite\nexclude\nexcuse\nexecute\nexercise\nexhaust\nexhibit\nexile\nexist\nexit\nexotic\nexpand\nexpect\nexpire\nexplain\nexpose\nexpress\nextend\nextra\neye\neyebrow\nfabric\nface\nfaculty\nfade\nfaint\nfaith\nfall\nfalse\nfame\nfamily\nfamous\nfan\nfancy\nfantasy\nfarm\nfashion\nfat\nfatal\nfather\nfatigue\nfault\nfavorite\nfeature\nfebruary\nfederal\nfee\nfeed\nfeel\nfemale\nfence\nfestival\nfetch\nfever\nfew\nfiber\nfiction\nfield\nfigure\nfile\nfilm\nfilter\nfinal\nfind\nfine\nfinger\nfinish\nfire\nfirm\nfirst\nfiscal\nfish\nfit\nfitness\nfix\nflag\nflame\nflash\nflat\nflavor\nflee\nflight\nflip\nfloat\nflock\nfloor\nflower\nfluid\nflush\nfly\nfoam\nfocus\nfog\nfoil\nfold\nfollow\nfood\nfoot\nforce\nforest\nforget\nfork\nfortune\nforum\nforward\nfossil\nfoster\nfound\nfox\nfragile\nframe\nfrequent\nfresh\nfriend\nfringe\nfrog\nfront\nfrost\nfrown\nfrozen\nfruit\nfuel\nfun\nfunny\nfurnace\nfury\nfuture\ngadget\ngain\ngalaxy\ngallery\ngame\ngap\ngarage\ngarbage\ngarden\ngarlic\ngarment\ngas\ngasp\ngate\ngather\ngauge\ngaze\ngeneral\ngenius\ngenre\ngentle\ngenuine\ngesture\nghost\ngiant\ngift\ngiggle\nginger\ngiraffe\ngirl\ngive\nglad\nglance\nglare\nglass\nglide\nglimpse\nglobe\ngloom\nglory\nglove\nglow\nglue\ngoat\ngoddess\ngold\ngood\ngoose\ngorilla\ngospel\ngossip\ngovern\ngown\ngrab\ngrace\ngrain\ngrant\ngrape\ngrass\ngravity\ngreat\ngreen\ngrid\ngrief\ngrit\ngrocery\ngroup\ngrow\ngrunt\nguard\nguess\nguide\nguilt\nguitar\ngun\ngym\nhabit\nhair\nhalf\nhammer\nhamster\nhand\nhappy\nharbor\nhard\nharsh\nharvest\nhat\nhave\nhawk\nhazard\nhead\nhealth\nheart\nheavy\nhedgehog\nheight\nhello\nhelmet\nhelp\nhen\nhero\nhidden\nhigh\nhill\nhint\nhip\nhire\nhistory\nhobby\nhockey\nhold\nhole\nholiday\nhollow\nhome\nhoney\nhood\nhope\nhorn\nhorror\nhorse\nhospital\nhost\nhotel\nhour\nhover\nhub\nhuge\nhuman\nhumble\nhumor\nhundred\nhungry\nhunt\nhurdle\nhurry\nhurt\nhusband\nhybrid\nice\nicon\nidea\nidentify\nidle\nignore\nill\nillegal\nillness\nimage\nimitate\nimmense\nimmune\nimpact\nimpose\nimprove\nimpulse\ninch\ninclude\nincome\nincrease\nindex\nindicate\nindoor\nindustry\ninfant\ninflict\ninform\ninhale\ninherit\ninitial\ninject\ninjury\ninmate\ninner\ninnocent\ninput\ninquiry\ninsane\ninsect\ninside\ninspire\ninstall\nintact\ninterest\ninto\ninvest\ninvite\ninvolve\niron\nisland\nisolate\nissue\nitem\nivory\njacket\njaguar\njar\njazz\njealous\njeans\njelly\njewel\njob\njoin\njoke\njourney\njoy\njudge\njuice\njump\njungle\njunior\njunk\njust\nkangaroo\nkeen\nkeep\nketchup\nkey\nkick\nkid\nkidney\nkind\nkingdom\nkiss\nkit\nkitchen\nkite\nkitten\nkiwi\nknee\nknife\nknock\nknow\nlab\nlabel\nlabor\nladder\nlady\nlake\nlamp\nlanguage\nlaptop\nlarge\nlater\nlatin\nlaugh\nlaundry\nlava\nlaw\nlawn\nlawsuit\nlayer\nlazy\nleader\nleaf\nlearn\nleave\nlecture\nleft\nleg\nlegal\nlegend\nleisure\nlemon\nlend\nlength\nlens\nleopard\nlesson\nletter\nlevel\nliar\nliberty\nlibrary\nlicense\nlife\nlift\nlight\nlike\nlimb\nlimit\nlink\nlion\nliquid\nlist\nlittle\nlive\nlizard\nload\nloan\nlobster\nlocal\nlock\nlogic\nlonely\nlong\nloop\nlottery\nloud\nlounge\nlove\nloyal\nlucky\nluggage\nlumber\nlunar\nlunch\nluxury\nlyrics\nmachine\nmad\nmagic\nmagnet\nmaid\nmail\nmain\nmajor\nmake\nmammal\nman\nmanage\nmandate\nmango\nmansion\nmanual\nmaple\nmarble\nmarch\nmargin\nmarine\nmarket\nmarriage\nmask\nmass\nmaster\nmatch\nmaterial\nmath\nmatrix\nmatter\nmaximum\nmaze\nmeadow\nmean\nmeasure\nmeat\nmechanic\nmedal\nmedia\nmelody\nmelt\nmember\nmemory\nmention\nmenu\nmercy\nmerge\nmerit\nmerry\nmesh\nmessage\nmetal\nmethod\nmiddle\nmidnight\nmilk\nmillion\nmimic\nmind\nminimum\nminor\nminute\nmiracle\nmirror\nmisery\nmiss\nmistake\nmix\nmixed\nmixture\nmobile\nmodel\nmodify\nmom\nmoment\nmonitor\nmonkey\nmonster\nmonth\nmoon\nmoral\nmore\nmorning\nmosquito\nmother\nmotion\nmotor\nmountain\nmouse\nmove\nmovie\nmuch\nmuffin\nmule\nmultiply\nmuscle\nmuseum\nmushroom\nmusic\nmust\nmutual\nmyself\nmystery\nmyth\nnaive\nname\nnapkin\nnarrow\nnasty\nnation\nnature\nnear\nneck\nneed\nnegative\nneglect\nneither\nnephew\nnerve\nnest\nnet\nnetwork\nneutral\nnever\nnews\nnext\nnice\nnight\nnoble\nnoise\nnominee\nnoodle\nnormal\nnorth\nnose\nnotable\nnote\nnothing\nnotice\nnovel\nnow\nnuclear\nnumber\nnurse\nnut\noak\nobey\nobject\noblige\nobscure\nobserve\nobtain\nobvious\noccur\nocean\noctober\nodor\noff\noffer\noffice\noften\noil\nokay\nold\nolive\nolympic\nomit\nonce\none\nonion\nonline\nonly\nopen\nopera\nopinion\noppose\noption\norange\norbit\norchard\norder\nordinary\norgan\norient\noriginal\norphan\nostrich\nother\noutdoor\nouter\noutput\noutside\noval\noven\nover\nown\nowner\noxygen\noyster\nozone\npact\npaddle\npage\npair\npalace\npalm\npanda\npanel\npanic\npanther\npaper\nparade\nparent\npark\nparrot\nparty\npass\npatch\npath\npatient\npatrol\npattern\npause\npave\npayment\npeace\npeanut\npear\npeasant\npelican\npen\npenalty\npencil\npeople\npepper\nperfect\npermit\nperson\npet\nphone\nphoto\nphrase\nphysical\npiano\npicnic\npicture\npiece\npig\npigeon\npill\npilot\npink\npioneer\npipe\npistol\npitch\npizza\nplace\nplanet\nplastic\nplate\nplay\nplease\npledge\npluck\nplug\nplunge\npoem\npoet\npoint\npolar\npole\npolice\npond\npony\npool\npopular\nportion\nposition\npossible\npost\npotato\npottery\npoverty\npowder\npower\npractice\npraise\npredict\nprefer\nprepare\npresent\npretty\nprevent\nprice\npride\nprimary\nprint\npriority\nprison\nprivate\nprize\nproblem\nprocess\nproduce\nprofit\nprogram\nproject\npromote\nproof\nproperty\nprosper\nprotect\nproud\nprovide\npublic\npudding\npull\npulp\npulse\npumpkin\npunch\npupil\npuppy\npurchase\npurity\npurpose\npurse\npush\nput\npuzzle\npyramid\nquality\nquantum\nquarter\nquestion\nquick\nquit\nquiz\nquote\nrabbit\nraccoon\nrace\nrack\nradar\nradio\nrail\nrain\nraise\nrally\nramp\nranch\nrandom\nrange\nrapid\nrare\nrate\nrather\nraven\nraw\nrazor\nready\nreal\nreason\nrebel\nrebuild\nrecall\nreceive\nrecipe\nrecord\nrecycle\nreduce\nreflect\nreform\nrefuse\nregion\nregret\nregular\nreject\nrelax\nrelease\nrelief\nrely\nremain\nremember\nremind\nremove\nrender\nrenew\nrent\nreopen\nrepair\nrepeat\nreplace\nreport\nrequire\nrescue\nresemble\nresist\nresource\nresponse\nresult\nretire\nretreat\nreturn\nreunion\nreveal\nreview\nreward\nrhythm\nrib\nribbon\nrice\nrich\nride\nridge\nrifle\nright\nrigid\nring\nriot\nripple\nrisk\nritual\nrival\nriver\nroad\nroast\nrobot\nrobust\nrocket\nromance\nroof\nrookie\nroom\nrose\nrotate\nrough\nround\nroute\nroyal\nrubber\nrude\nrug\nrule\nrun\nrunway\nrural\nsad\nsaddle\nsadness\nsafe\nsail\nsalad\nsalmon\nsalon\nsalt\nsalute\nsame\nsample\nsand\nsatisfy\nsatoshi\nsauce\nsausage\nsave\nsay\nscale\nscan\nscare\nscatter\nscene\nscheme\nschool\nscience\nscissors\nscorpion\nscout\nscrap\nscreen\nscript\nscrub\nsea\nsearch\nseason\nseat\nsecond\nsecret\nsection\nsecurity\nseed\nseek\nsegment\nselect\nsell\nseminar\nsenior\nsense\nsentence\nseries\nservice\nsession\nsettle\nsetup\nseven\nshadow\nshaft\nshallow\nshare\nshed\nshell\nsheriff\nshield\nshift\nshine\nship\nshiver\nshock\nshoe\nshoot\nshop\nshort\nshoulder\nshove\nshrimp\nshrug\nshuffle\nshy\nsibling\nsick\nside\nsiege\nsight\nsign\nsilent\nsilk\nsilly\nsilver\nsimilar\nsimple\nsince\nsing\nsiren\nsister\nsituate\nsix\nsize\nskate\nsketch\nski\nskill\nskin\nskirt\nskull\nslab\nslam\nsleep\nslender\nslice\nslide\nslight\nslim\nslogan\nslot\nslow\nslush\nsmall\nsmart\nsmile\nsmoke\nsmooth\nsnack\nsnake\nsnap\nsniff\nsnow\nsoap\nsoccer\nsocial\nsock\nsoda\nsoft\nsolar\nsoldier\nsolid\nsolution\nsolve\nsomeone\nsong\nsoon\nsorry\nsort\nsoul\nsound\nsoup\nsource\nsouth\nspace\nspare\nspatial\nspawn\nspeak\nspecial\nspeed\nspell\nspend\nsphere\nspice\nspider\nspike\nspin\nspirit\nsplit\nspoil\nsponsor\nspoon\nsport\nspot\nspray\nspread\nspring\nspy\nsquare\nsqueeze\nsquirrel\nstable\nstadium\nstaff\nstage\nstairs\nstamp\nstand\nstart\nstate\nstay\nsteak\nsteel\nstem\nstep\nstereo\nstick\nstill\nsting\nstock\nstomach\nstone\nstool\nstory\nstove\nstrategy\nstreet\nstrike\nstrong\nstruggle\nstudent\nstuff\nstumble\nstyle\nsubject\nsubmit\nsubway\nsuccess\nsuch\nsudden\nsuffer\nsugar\nsuggest\nsuit\nsummer\nsun\nsunny\nsunset\nsuper\nsupply\nsupreme\nsure\nsurface\nsurge\nsurprise\nsurround\nsurvey\nsuspect\nsustain\nswallow\nswamp\nswap\nswarm\nswear\nsweet\nswift\nswim\nswing\nswitch\nsword\nsymbol\nsymptom\nsyrup\nsystem\ntable\ntackle\ntag\ntail\ntalent\ntalk\ntank\ntape\ntarget\ntask\ntaste\ntattoo\ntaxi\nteach\nteam\ntell\nten\ntenant\ntennis\ntent\nterm\ntest\ntext\nthank\nthat\ntheme\nthen\ntheory\nthere\nthey\nthing\nthis\nthought\nthree\nthrive\nthrow\nthumb\nthunder\nticket\ntide\ntiger\ntilt\ntimber\ntime\ntiny\ntip\ntired\ntissue\ntitle\ntoast\ntobacco\ntoday\ntoddler\ntoe\ntogether\ntoilet\ntoken\ntomato\ntomorrow\ntone\ntongue\ntonight\ntool\ntooth\ntop\ntopic\ntopple\ntorch\ntornado\ntortoise\ntoss\ntotal\ntourist\ntoward\ntower\ntown\ntoy\ntrack\ntrade\ntraffic\ntragic\ntrain\ntransfer\ntrap\ntrash\ntravel\ntray\ntreat\ntree\ntrend\ntrial\ntribe\ntrick\ntrigger\ntrim\ntrip\ntrophy\ntrouble\ntruck\ntrue\ntruly\ntrumpet\ntrust\ntruth\ntry\ntube\ntuition\ntumble\ntuna\ntunnel\nturkey\nturn\nturtle\ntwelve\ntwenty\ntwice\ntwin\ntwist\ntwo\ntype\ntypical\nugly\numbrella\nunable\nunaware\nuncle\nuncover\nunder\nundo\nunfair\nunfold\nunhappy\nuniform\nunique\nunit\nuniverse\nunknown\nunlock\nuntil\nunusual\nunveil\nupdate\nupgrade\nuphold\nupon\nupper\nupset\nurban\nurge\nusage\nuse\nused\nuseful\nuseless\nusual\nutility\nvacant\nvacuum\nvague\nvalid\nvalley\nvalve\nvan\nvanish\nvapor\nvarious\nvast\nvault\nvehicle\nvelvet\nvendor\nventure\nvenue\nverb\nverify\nversion\nvery\nvessel\nveteran\nviable\nvibrant\nvicious\nvictory\nvideo\nview\nvillage\nvintage\nviolin\nvirtual\nvirus\nvisa\nvisit\nvisual\nvital\nvivid\nvocal\nvoice\nvoid\nvolcano\nvolume\nvote\nvoyage\nwage\nwagon\nwait\nwalk\nwall\nwalnut\nwant\nwarfare\nwarm\nwarrior\nwash\nwasp\nwaste\nwater\nwave\nway\nwealth\nweapon\nwear\nweasel\nweather\nweb\nwedding\nweekend\nweird\nwelcome\nwest\nwet\nwhale\nwhat\nwheat\nwheel\nwhen\nwhere\nwhip\nwhisper\nwide\nwidth\nwife\nwild\nwill\nwin\nwindow\nwine\nwing\nwink\nwinner\nwinter\nwire\nwisdom\nwise\nwish\nwitness\nwolf\nwoman\nwonder\nwood\nwool\nword\nwork\nworld\nworry\nworth\nwrap\nwreck\nwrestle\nwrist\nwrite\nwrong\nyard\nyear\nyellow\nyou\nyoung\nyouth\nzebra\nzero\nzone\nzoo".split("\n");class Ue extends(u.vw("NanoIdGenerator")()){}const _e=a.QfV.pipe(a.T16(/^[\w-]{16}$/),a.wkx("NodeId")),$e=(e,t)=>m.sync((()=>{let n=Q(fe,"Symmetric key seed",e);for(let e=0;e<t.length;e++){const r=(new TextEncoder).encode(t[e]),i=new Uint8Array(r.byteLength+1);i[0]=0,i.set(r,1),n=Q(fe,n.slice(0,32),i)}return n.slice(32,64)}));class Qe extends(u.vw("SecretBox")()){}Qe.Live=w.Py(Qe,Qe.of({seal:(e,t)=>m.sync((()=>{const n=_(24),r=(0,E.EY)(e,n).seal(t);return(0,c.Id)(n,r)})),open:(e,t)=>m.sync((()=>{const n=t.subarray(0,24),r=t.subarray(24);return(0,E.EY)(e,n).open(r)}))}));const Je=860934419999,Ke=a.wNn.pipe(a.MM$(Je),a.XeB(258280326e4),a.wkx("Millis")),Ye=s.k9(Ke)(86093442e4),Ve=a.wNn.pipe(a.TqQ(0,65535),a.wkx("Counter")),ze=s.k9(Ve)(0),Xe=e=>[new Date(e.millis).toISOString(),e.counter.toString(16).toUpperCase().padStart(4,"0"),e.node].join("-"),He=e=>{const t=e.split("-");return{millis:Date.parse(t.slice(0,3).join("-")).valueOf(),counter:parseInt(t[3],16),node:t[4]}},Ge=s.k9(_e)("0000000000000000"),Ze=(e=Ye)=>({millis:e,counter:ze,node:Ge}),et=Ue.pipe(m.flatMap((({nodeId:e})=>e)),m.map((e=>({millis:Ye,counter:ze,node:e}))));class tt extends(u.vw("Time")()){}tt.Live=w.Py(tt,{now:m.suspend((()=>a.D4M(Ke)(Date.now()))).pipe(m.catchTag("ParseError",(()=>m.fail({_tag:"TimestampTimeOutOfRangeError"}))))});const nt=e=>m.gen((function*(){const t=yield*tt,n=yield*k,r=yield*t.now,i=Math.max(r,...e);return i-r>n.maxDrift&&(yield*m.fail({_tag:"TimestampDriftError",now:r,next:i})),i})),rt=e=>(0,f.Fs)(I.GV(e),a.EGw(Ve),q.qE((()=>({_tag:"TimestampCounterOverflowError"})))),it=s.k9(Ve)(0),ot=Object.create(null),st=(e,t)=>(e||0)^t,at=(e,t,n)=>{if(0===t.length)return e;const r=t[0],i=e[r]||{};return{...e,[r]:{...i,...at(i,t.slice(1),n),hash:st(i.hash,n)}}},ct=(e,t)=>{const n=(r=t.millis,Math.floor(r/1e3/60).toString(3).split(""));var r;const i=((e,t=0)=>{let n,r,i,o;const s=3&e.length,a=e.length-s;n=t;const c=3432918353,d=461845907;for(o=0;o<a;)i=255&e.charCodeAt(o)|(255&e.charCodeAt(++o))<<8|(255&e.charCodeAt(++o))<<16|(255&e.charCodeAt(++o))<<24,++o,i=(65535&i)*c+(((i>>>16)*c&65535)<<16)&4294967295,i=i<<15|i>>>17,i=(65535&i)*d+(((i>>>16)*d&65535)<<16)&4294967295,n^=i,n=n<<13|n>>>19,r=5*(65535&n)+((5*(n>>>16)&65535)<<16)&4294967295,n=27492+(65535&r)+((58964+(r>>>16)&65535)<<16);switch(i=0,s){case 3:i^=(255&e.charCodeAt(o+2))<<16;case 2:i^=(255&e.charCodeAt(o+1))<<8;case 1:i^=255&e.charCodeAt(o),i=(65535&i)*c+(((i>>>16)*c&65535)<<16)&4294967295,i=i<<15|i>>>17,i=(65535&i)*d+(((i>>>16)*d&65535)<<16)&4294967295,n^=i}return n^=e.length,n^=n>>>16,n=2246822507*(65535&n)+((2246822507*(n>>>16)&65535)<<16)&4294967295,n^=n>>>13,n=3266489909*(65535&n)+((3266489909*(n>>>16)&65535)<<16)&4294967295,n^=n>>>16,n>>>0})(Xe(t));return at({...e,hash:st(e.hash,i)},n,i)},dt=["0","1","2"],lt=e=>dt.filter((t=>t in e)),pt=e=>JSON.stringify(e),ut=u.Io("Owner"),ht=e=>m.gen((function*(t){null==e&&(e=Be(je,128));const n=(e=>Re(e))(e),r=yield*m.map($e(n,["Evolu","Owner Id"]),(e=>{let t="";for(let n=0;n<21;n++)t+=mt[63&e[n]];return t})),i=yield*$e(n,["Evolu","Encryption Key"]);return{mnemonic:e,id:r,encryptionKey:i}})),mt="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";var ft=n(868075);const yt=u.Io("Sync"),gt={_tag:"SyncStateInitial"};class wt extends(u.vw("SyncFactory")()){}m.gen((function*(){const e=u.Ie().pipe(u.WQ(Qe,yield*Qe)),t=yield*h.L8();return yt.of({init:n=>m.logDebug(["Sync init",{owner:n}]).pipe(m.tap(h.Py(t,e.pipe(u.WQ(ut,n))))),sync:({merkleTree:e,timestamp:n,messages:s})=>m.gen((function*(){yield*m.logDebug(["Sync request",{merkleTree:e,timestamp:n,messages:s}]);const t=yield*Qe,a=yield*ut,c=yield*k;return yield*m.forEach(s||[],(({timestamp:e,...n})=>m.map(t.seal(a.encryptionKey,Nt(n)),(t=>({timestamp:e,content:t}))))).pipe(m.map((t=>ft.Vr.toBinary({messages:t,userId:a.id,nodeId:n.node,merkleTree:pt(e)},xt))),m.flatMap((e=>r.bE(c.syncUrl).pipe(r.mu(e,"application/x-protobuf"),i.vd,o.sv))),m.map((e=>ft.fZ.fromBinary(new Uint8Array(e),kt))),m.flatMap((e=>m.forEach(e.messages,(e=>m.map(t.open(a.encryptionKey,e.content),(t=>[t,e.timestamp])))).pipe(m.map(p.x1((([e,t])=>y.Tj(St(e),(e=>({...e,timestamp:t})))))),m.map((t=>{return{messages:t,merkleTree:(n=e.merkleTree,JSON.parse(n))};var n})),m.tap((e=>m.logDebug(["Sync response",e])))))),m.catchTag("RequestError",(()=>m.fail({_tag:"SyncStateIsNotSynced",error:{_tag:"NetworkError"}}))),m.catchTag("ResponseError",(({response:{status:e}})=>402===e?m.fail({_tag:"SyncStateIsNotSynced",error:{_tag:"PaymentRequiredError"}}):m.fail({_tag:"SyncStateIsNotSynced",error:{_tag:"ServerError",status:e}}))))})).pipe((e=>m.flatMap(h.Tx(t),(t=>m.provide(e,t)))))})}));const Nt=({value:e,...t})=>(0,c.Id)(bt,ft.PV.toBinary({value:vt(e),...t},xt)),bt=new Uint8Array([0,1]),vt=e=>{switch(typeof e){case"string":return{oneofKind:"stringValue",stringValue:e};case"number":return{oneofKind:"numberValue",numberValue:s.Kc(a.jJo)(e)}}return null==e?{oneofKind:void 0}:g.mg(e)?{oneofKind:"bytesValue",bytesValue:e}:{oneofKind:"jsonValue",jsonValue:JSON.stringify(e)}},xt={writerFactory:()=>new d.f({encode:e=>(new TextEncoder).encode(e)})},kt={readerFactory:e=>new l.V(e,{decode:e=>(new TextDecoder).decode(e)})},St=e=>{if(!Ot(e,bt))return y.dv();const{value:t,...n}=ft.PV.fromBinary(e.slice(bt.length),kt);return y.zN({value:Wt(t),...n})},Ot=(e,t)=>{if(t.length>e.length)return!1;for(let n=0;n<t.length;n++)if(e[n]!==t[n])return!1;return!0},Wt=e=>{switch(e.oneofKind){case"numberValue":return s.k9(a.jJo)(e.numberValue);case"stringValue":return e.stringValue;case"bytesValue":return e.bytesValue;case"jsonValue":return JSON.parse(e.jsonValue);case void 0:return null;default:return(0,f.GQ)(e)}};var qt=n(608111),It=n(119153);It.ii,It.MG,qt.QW,qt.oV,qt.un,qt.vA,qt.IU,qt.U9,qt.Ts,qt.Yz,qt.y_,qt.BU,qt.z3,qt.Os,qt.pq;const Tt=qt.Rm;qt.tp,qt.kB,qt.al,qt.uP,qt.R8,qt.I1,qt.CE;var Et=n(836783),Ct=n(332665),Dt=n(338265),Pt=n(360643),At=n(617437);Dt.KX;const Mt=Dt.PJ,Lt=Pt.Jt,Bt=(Pt.C2,Pt.Ru,At.cH),Ft=(Pt.$N,At.Y3,At.JP,At.Gt,Pt.ni,At.sY,Pt.hZ,Pt._c,Pt.yo,At.BQ,Pt.lF,At.Wz,Pt.gH,At.pu,Pt.VH,Dt.oD,Dt.Do,(e,t)=>e.reduce(((e,t)=>{switch(t.op){case"replaceAll":return t.value;case"replaceAt":return p.HC(e,t.index,t.value)}}),t)),Rt=(e,t)=>{if(void 0===e)return[{op:"replaceAll",value:t}];if(e.length!==t.length)return[{op:"replaceAll",value:t}];const n=e.length,r=[];for(let i=0;i<n;i++){const n=e[i],o=t[i];for(const e in n)if(!jt(n[e],o[e])){r.push({op:"replaceAt",value:o,index:i});break}}return n>0&&r.length===n?[{op:"replaceAll",value:t}]:r},jt=(e,t)=>{if(e===t)return!0;if(typeof e!=typeof t)return!1;if("object"==typeof e&&null!==e&&null!==t){const n=g.mg(e),r=g.mg(t);if(n&&r){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}const i=p.cy(e),o=p.cy(t);if(i&&o){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!jt(e[n],t[n]))return!1;return!0}if(!(n||r||i||o)){const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const r of n)if(!jt(e[r],t[r]))return!1;return!0}}return!1},Ut=e=>({_tag:"UnexpectedError",error:e}),_t=e=>e instanceof Error?{message:e.message,name:e.name,stack:e.stack}:e;var $t=n(217076);const Qt=u.Io("Sqlite");class Jt extends(u.vw("SqliteFactory")()){}Jt.Common=w.QZ(Jt,m.map(Jt,(e=>({createSqlite:m.logTrace("SqliteFactory createSqlite").pipe(m.zipRight(e.createSqlite),m.map((e=>({...e,exec:t=>e.exec(t).pipe(m.tap((e=>{Yt(e.rows)})),m.tap((e=>["begin","rollback","commit"].includes(t.sql)?m.logDebug(`SQLiteCommon ${t.sql} transaction`):m.logDebug(["SQLiteCommon exec",t,e])))),transaction:t=>n=>"shared"===t?e.transaction(t)(n):m.flatMap(Qt,(e=>m.acquireUseRelease(e.exec({sql:"begin"}),(()=>n),((t,n)=>$t.N6(n)?e.exec({sql:"rollback"}):e.exec({sql:"commit"}))))).pipe(e.transaction(t))}))))}))));const Kt=e=>null!==e&&"object"==typeof e&&!g.mg(e),Yt=e=>{Vt(e)},Vt=e=>{for(let t=0;t<e.length;++t)e[t]=zt(e[t]);return e},zt=e=>g.Kg(e)?Xt(e):Array.isArray(e)?Vt(e):"object"!=typeof e||null===e||g.mg(e)?e:Gt(e),Xt=e=>{if(Ht(e))try{return zt(JSON.parse(e))}catch(e){}return e},Ht=e=>null!=e.match(/^[[{]/),Gt=e=>{for(const t in e)e[t]=zt(e[t]);return e},Zt=new RegExp(`\\b(${["alter","create","delete","drop","insert","replace","update"].join("|")})\\b`),en=(a.QfV.pipe(a.T16(/^[\w-]{21}$/),a.wkx("Id")),a.QfV.pipe(a.pbD((e=>!isNaN(Date.parse(e)))),a.wkx("SqliteDate"))),tn=a.wNn.pipe(a.Whr(),a.pbD((e=>0===e||1===e)),a.wkx("SqliteBoolean"));function nn(e){return"boolean"==typeof e?!0===e?1:0:"number"==typeof e?1===e:e instanceof Date?e.toISOString():new Date(e)}a._kM({createdAt:en,updatedAt:en,isDeleted:tn}),a._kM;const rn=a.QfV.pipe(a.pbD((e=>{if(!Ht(e))return!0;try{JSON.parse(e)}catch(e){return!0}return!1}),{message:()=>"a string that is not stringified JSON"}),a.wkx("String")),on=(rn.pipe(a.Ru6(1e3),a.wkx("String1000")),rn.pipe(a.BpQ(1),a.Ru6(1e3),a.wkx("NonEmptyString1000")),a.wNn.pipe(a.Whr(),a.yjt(),a.wkx("PositiveInt")),u.Io("FlushSync"));class sn extends(u.vw("AppState")()){}class an extends(u.vw("SyncLock")()){}class cn{constructor(){this._tag="SyncLockAlreadySyncingError"}}const dn={sql:'select "id", "mnemonic", "encryptionKey" from "evolu_owner"'},ln={sql:'create table "evolu_message" ("timestamp" blob primary key, "table" blob, "row" blob, "column" blob, "value" blob)'},pn={sql:'create index "index_evolu_message" on "evolu_message" ("table", "row", "column", "timestamp" desc)'},un={sql:'create table "evolu_owner" ("id" blob, "mnemonic" blob, "encryptionKey" blob, "timestamp" blob, "merkleTree" blob)'},hn={sql:'insert into "evolu_owner" ("id", "mnemonic", "encryptionKey", "timestamp", "merkleTree") values (?, ?, ?, ?, ?)'},mn={sql:'select "timestamp", "merkleTree" from "evolu_owner"'},fn={sql:'select "timestamp" from "evolu_message" where "table" = ? and "row" = ? and "column" = ? order by "timestamp" desc limit ?'},yn={sql:'insert into "evolu_message" ("timestamp", "table", "row", "column", "value") values (?, ?, ?, ?, ?) on conflict do nothing'},gn={sql:'update "evolu_owner" set "merkleTree" = ?, "timestamp" = ?'},wn={sql:'select * from "evolu_message" where "timestamp" >= ? order by "timestamp"'};a._kM({name:a.QfV,sql:a.QfV});class Nn extends(u.vw("DbFactory")()){}const bn=m.gen((function*(){const{createSqlite:e}=yield*Jt,{createSync:t}=yield*wt,n=u.Ie().pipe(u.WQ(Ue,yield*Ue),u.WQ(tt,yield*tt),u.WQ(an,yield*an)),r=yield*h.L8(),i=e=>t=>m.flatMap(h.Tx(r),(n=>m.flatMap(Qt,(n=>n.transaction(e.transaction)(t))).pipe(m.provide(n)))),o=yield*Mt(new Map);return{init:(i,o,s,a,c,d)=>m.gen((function*(){yield*m.logDebug(["Db init",{schema:i}]);const l=yield*e,p=u.WQ(n,Qt,l),f=yield*Sn.pipe(m.tap(On(i)),m.flatMap((e=>e.tables.map((e=>e.name)).includes("evolu_owner")?qn:In(d).pipe(m.tap(Tn(o))))),l.transaction("exclusive"),m.provide(p)),y=yield*t.pipe(m.provide(n));return yield*y.init(f),h.dz(r,m.succeed(p.pipe(u.WQ(ut,f),u.WQ(yt,y),u.WQ(vn,{onError:s,onSyncStateChange:a,onReceive:c})))),f})),loadQueries:e=>m.logDebug(["Db loadQueries",{queries:e}]).pipe(m.zipRight(xn(e,o)),i({transaction:"shared"})),mutate:(e,t)=>m.gen((function*(){yield*m.logDebug(["Db mutate",{mutations:e,queriesToRefresh:t}]);const n=yield*tt,r=yield*Qt,[i,s]=p.jB(e,(e=>e.table.startsWith("_")));for(const e of s)if(Cn(e).some((({column:e,value:t})=>"isDeleted"===e&&1===t)))yield*r.exec({sql:`delete from "${e.table}" where "id" = ?;`,parameters:[e.id]});else{const t=Cn(e);for(const e of t){const r=yield*n.now;yield*Pn(e,t,r)}}return i.length>0&&(yield*m.tap(Tn(i),Fn)),yield*xn(t,o)})).pipe(i({transaction:"exclusive"})),resetOwner:()=>m.logTrace("Db resetOwner").pipe(m.tap(Bn),i({transaction:"last"})),restoreOwner:(e,t)=>m.logTrace("Db restoreOwner").pipe(m.tap(Bn),m.tap(m.flatMap(Sn,On(e))),m.tap(In(t)),i({transaction:"last"})),ensureSchema:e=>Sn.pipe(m.flatMap(On(e)),i({transaction:"exclusive"})),sync:e=>m.logDebug(["Db sync",{queriesToRefresh:e}]).pipe(m.zipRight(Fn()),m.zipRight(xn(e,o)),i({transaction:"shared"})),exportDatabase:()=>m.logTrace("Db exportDatabase").pipe(m.zipRight(Qt),m.flatMap((e=>e.export())),i({transaction:"exclusive"}))}})),vn=u.Io("Callbacks"),xn=(e,t)=>m.gen((function*(){const n=yield*Qt,r=yield*Bt(t,(t=>m.map(m.forEach(e,(e=>{const t=Un(e);return n.exec(t).pipe(m.tap(kn(t)),m.map((({rows:t})=>[e,t])))})),(e=>new Map([...t,...e]))))),i=yield*Lt(t);return e.map((e=>({query:e,patches:Rt(r.get(e),i.get(e)||[])})))})),kn=e=>e.options?.logExplainQueryPlan?Qt.pipe(m.flatMap((t=>t.exec({...e,sql:`EXPLAIN QUERY PLAN ${e.sql}`}))),m.tap(Tt("ExplainQueryPlan",e)),m.tap((({rows:e})=>Tt((e=>e.map((t=>{let n=t.parent,r=0;for(;;){const t=e.find((e=>e.id===n));if(!t)break;n=t.parent,r++}return`${"  ".repeat(r)}${t.detail}`})).join("\n"))(e)))),m.map(f.Yi)):m.void,Sn=m.gen((function*(e){yield*m.logTrace("Db getSchema");const t=yield*Qt;return{tables:yield*m.map(t.exec({sql:"\nselect\n  sqlite_master.name as tableName,\n  table_info.name as columnName\nfrom\n  sqlite_master\n  join pragma_table_info(sqlite_master.name) as table_info\n    ".trim()}),(({rows:e})=>{const t=new Map;return e.forEach((e=>{const{tableName:n,columnName:r}=e;t.has(n)||t.set(n,[]),t.get(n)?.push(r)})),globalThis.Array.from(t,(([e,t])=>({name:e,columns:t})))})),indexes:yield*m.map(t.exec({sql:"\nselect\n  name, sql\nfrom\n  sqlite_master\nwhere\n  type='index' and\n  name not like 'sqlite_%' and\n  name not like 'index_evolu_%'\n".trim()}),(e=>p.Tj(e.rows,(e=>({name:e.name,sql:e.sql.replace("CREATE INDEX","create index")})))))}})),On=e=>t=>m.gen((function*(){yield*m.logTrace("Db ensureSchema");const n=[];if(e.tables.forEach((e=>{const r=t.tables.find((t=>t.name===e.name));r?p.Mo(T.rs)(e.columns,r.columns).forEach((t=>{n.push(`alter table "${e.name}" add column "${t}" blob;`)})):n.push(`\n  create table ${e.name} (\n    "id" text primary key,\n    ${e.columns.filter((e=>"id"!==e)).map((e=>`"${e}" blob`)).join(", ")}\n  );`.trim())})),p.Mo(Wn)(t.indexes,p.kP(Wn)(t.indexes,e.indexes)).forEach((e=>{n.push(`drop index "${e.name}";`)})),p.Mo(Wn)(e.indexes,t.indexes).forEach((e=>{n.push(`${e.sql};`)})),n.length>0){const e=yield*Qt;yield*e.exec({sql:n.join("\n")})}})),Wn=(e,t)=>e.name===t.name&&e.sql===t.sql,qn=m.logTrace("Db readOwner").pipe(m.zipRight(Qt),m.flatMap((e=>e.exec(dn))),m.map((({rows:[e]})=>({id:e.id,mnemonic:e.mnemonic,encryptionKey:e.encryptionKey})))),In=e=>m.logTrace("Db createOwner").pipe(m.zipRight(m.all([ht(e),Qt,et])),m.tap((([e,t,n])=>m.all([t.exec(ln),t.exec(pn),t.exec(un),t.exec({...hn,parameters:[e.id,e.mnemonic,e.encryptionKey,Xe(n),pt(ot)]})]))),m.map((([e])=>e))),Tn=e=>m.gen((function*(t){const{timestamp:n,merkleTree:r}=yield*En,[i,o]=yield*m.mapAccum(e.flatMap(Cn),n,((e,t)=>m.map((e=>m.gen((function*(){const t=yield*nt([e.millis]),n=t===e.millis?yield*rt(e.counter):it;return{...e,millis:t,counter:n}})))(e),(e=>[e,{...t,timestamp:Xe(e)}])))),s=yield*Dn(r,o);return yield*Ln(i,s),o})),En=Qt.pipe(m.flatMap((e=>e.exec(mn))),m.map((({rows:[{timestamp:e,merkleTree:t}]})=>({timestamp:He(e),merkleTree:t})))),Cn=e=>(0,f.Fs)(Object.entries(e.values),p.x1((([t,n])=>void 0===n||e.isInsert&&null==n?y.dv():y.zN([t,n]))),p.Tj((([t,n])=>({table:e.table,row:e.id,column:t,value:"boolean"==typeof n||n instanceof Date?nn(n):n})))),Dn=(e,t)=>m.gen((function*(){const n=yield*Qt;for(const r of t){const i=He(r.timestamp),o=yield*m.map(n.exec({...fn,parameters:[r.table,r.row,r.column,1]}),(({rows:e})=>e.length>0?e[0].timestamp:null));if((null==o||o<r.timestamp)&&(yield*Pn(r,t,i.millis)),null==o||o!==r.timestamp){const{changes:t}=yield*n.exec({...yn,parameters:[r.timestamp,r.table,r.row,r.column,r.value]});1===t&&(e=ct(e,i))}}return e})),Pn=(e,t,n)=>Qt.pipe(m.map((t=>{const r=nn(new Date(n));return t.exec({sql:`\n    insert into\n      "${e.table}" ("id", "${e.column}", "createdAt", "updatedAt")\n    values\n      (?, ?, ?, ?)\n    on conflict do update set\n      "${e.column}" = ?,\n      "updatedAt" = ?\n        `.trim(),parameters:[e.row,e.value,r,r,e.value,r]})})),m.flatMap((e=>m.catchSomeDefect(e,(n=>s.is(An)(n)?y.zN(Mn(t).pipe(m.zipRight(e))):y.dv()))))),An=a._kM({message:a.gPz(a.QfV.pipe(a.mKk("no such table")),a.QfV.pipe(a.mKk("no such column")),a.QfV.pipe(a.mKk("has no column")))}),Mn=e=>m.gen((function*(){const t=new Map;e.forEach((e=>{const n=t.get(e.table);null!=n?n.columns.includes(e.column)||t.set(e.table,{name:e.table,columns:n.columns.concat(e.column)}):t.set(e.table,{name:e.table,columns:[e.column,"createdAt","updatedAt"]})}));const n=p.Ts(t.values());yield*m.flatMap(Sn,On({tables:n,indexes:[]}))})),Ln=(e,t)=>m.flatMap(Qt,(n=>n.exec({...gn,parameters:[pt(t),Xe(e)]}))),Bn=m.gen((function*(){yield*m.logTrace("Db dropAllTables");const e=yield*Qt,t=yield*Sn;yield*m.forEach(t.tables,(t=>e.exec({sql:`drop table "${t.name}"`})))})),Fn=(e=[])=>an.pipe(m.flatMap((e=>e.tryAcquire)),m.matchEffect({onFailure:()=>m.void,onSuccess:()=>Rn(e)}),m.scoped,m.forkDaemon),Rn=(e=[])=>m.gen((function*(t){const n=yield*Qt,r=yield*yt,i=yield*vn,o=yield*tt,s=yield*En.pipe(n.transaction("shared"),m.map((t=>({...t,messages:e}))),m.flatMap(Et.L8));i.onSyncStateChange({_tag:"SyncStateIsSyncing"}),yield*Et.Jt(s).pipe(m.flatMap(r.sync),m.flatMap(jn),m.repeat({schedule:Ct.t5(50),until:y.YW({onNone:()=>m.gen((function*(){return i.onSyncStateChange({_tag:"SyncStateIsSynced",time:yield*o.now}),!0})),onSome:e=>m.gen((function*(){return yield*Et.hZ(s,e),!1}))})}),m.catchAllDefect((e=>m.fail(Ut(_t(e))))),m.catchTag("SyncStateIsNotSynced",(e=>m.succeed(i.onSyncStateChange(e)))),m.catchAll((e=>m.succeed(i.onError(e)))))})),jn=e=>m.flatMap(Qt,(t=>m.gen((function*(n){const{onReceive:r}=yield*vn,i=yield*En,o=yield*m.reduce(e.messages,i.timestamp,((e,t)=>(({local:e,remote:t})=>m.gen((function*(n){e.node===t.node&&(yield*m.fail({_tag:"TimestampDuplicateNodeError",node:e.node}));const r=yield*nt([e.millis,t.millis]),i=yield*r===e.millis&&r===t.millis?rt(Math.max(e.counter,t.counter)):r===e.millis?rt(e.counter):r===t.millis?rt(t.counter):q.pG(it);return{...e,millis:r,counter:i}})))({local:e,remote:He(t.timestamp)}))),s=yield*Dn(i.merkleTree,e.messages);return e.messages.length>0&&(yield*Ln(o,s),r()),yield*((e,t)=>{if(e.hash===t.hash)return y.dv();let n=e,r=t,i=[];for(;;){const e=p.w8(lt(n).concat(lt(r)),T.rs);let t=null;for(let i=0;i<e.length;i++){const o=e[i],s=n[o],a=r[o];if(!s||!a)break;if(s.hash!==a.hash){t=o;break}}if(!t)return y.zN(0===(o=i).length?Ye:1e3*parseInt(o.join("").padEnd(16,"0"),3)*60);i=[...i,t],n=n[t]||ot,r=r[t]||ot}var o;return y.dv()})(e.merkleTree,s).pipe(m.flatMap((e=>t.exec({...wn,parameters:[Xe(Ze(e))]}))),m.map((({rows:e})=>({messages:e,merkleTree:s,timestamp:o}))),m.option)})).pipe(t.transaction("exclusive")))),Un=e=>{const t=JSON.parse(e);return{...t,parameters:t.parameters.map((e=>p.cy(e)?new Uint8Array(e):"object"==typeof e&&null!=e?e.json:e))}},_n=[],$n=()=>_n,Qn=new WeakMap,Jn=e=>{let t=Qn.get(e);return null==t&&(t={rows:e,row:e[0]},Qn.set(e,t)),t};let Kn=e=>crypto.getRandomValues(new Uint8Array(e)),Yn=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),"");const Vn=((e,t)=>{const n=((e,t=21)=>((e,t,n)=>{let r=(2<<Math.log(e.length-1)/Math.LN2)-1,i=-~(1.6*r*t/e.length);return(o=t)=>{let s="";for(;;){let t=n(i),a=i;for(;a--;)if(s+=e[t[a]&r]||"",s.length===o)return s}}})(e,t,Kn))("0123456789abcdef",16);return w.Py(Ue,Ue.of({nanoid:m.sync((()=>t())),nodeId:m.sync((()=>n())),rowId:m.sync((()=>t()))}))})(0,Yn);var zn=n(958146),Xn=n(370817);function Hn(e){return void 0===e||void 0===e}function Gn(e){return"string"==typeof e}function Zn(e){return"number"==typeof e}function er(e){return"boolean"==typeof e}function tr(e){return null===e}function nr(e){return"bigint"==typeof e}function rr(e){return"function"==typeof e}function ir(e){return"object"==typeof e&&null!==e}function or(e){return Object.freeze(e)}function sr(e){return ar(e)?e:[e]}function ar(e){return Array.isArray(e)}function cr(e){return e}const dr=or({is:e=>"AlterTableNode"===e.kind,create:e=>or({kind:"AlterTableNode",table:e}),cloneWithTableProps:(e,t)=>or({...e,...t}),cloneWithColumnAlteration:(e,t)=>or({...e,columnAlterations:e.columnAlterations?[...e.columnAlterations,t]:[t]})}),lr=or({is:e=>"IdentifierNode"===e.kind,create:e=>or({kind:"IdentifierNode",name:e})}),pr=or({is:e=>"CreateIndexNode"===e.kind,create:e=>or({kind:"CreateIndexNode",name:lr.create(e)}),cloneWith:(e,t)=>or({...e,...t}),cloneWithColumns:(e,t)=>or({...e,columns:[...e.columns||[],...t]})}),ur=or({is:e=>"CreateSchemaNode"===e.kind,create:(e,t)=>or({kind:"CreateSchemaNode",schema:lr.create(e),...t}),cloneWith:(e,t)=>or({...e,...t})}),hr=["preserve rows","delete rows","drop"],mr=or({is:e=>"CreateTableNode"===e.kind,create:e=>or({kind:"CreateTableNode",table:e,columns:or([])}),cloneWithColumn:(e,t)=>or({...e,columns:or([...e.columns,t])}),cloneWithConstraint:(e,t)=>or({...e,constraints:e.constraints?or([...e.constraints,t]):or([t])}),cloneWithFrontModifier:(e,t)=>or({...e,frontModifiers:e.frontModifiers?or([...e.frontModifiers,t]):or([t])}),cloneWithEndModifier:(e,t)=>or({...e,endModifiers:e.endModifiers?or([...e.endModifiers,t]):or([t])}),cloneWith:(e,t)=>or({...e,...t})}),fr=or({is:e=>"SchemableIdentifierNode"===e.kind,create:e=>or({kind:"SchemableIdentifierNode",identifier:lr.create(e)}),createWithSchema:(e,t)=>or({kind:"SchemableIdentifierNode",schema:lr.create(e),identifier:lr.create(t)})}),yr=or({is:e=>"DropIndexNode"===e.kind,create:(e,t)=>or({kind:"DropIndexNode",name:fr.create(e),...t}),cloneWith:(e,t)=>or({...e,...t})}),gr=or({is:e=>"DropSchemaNode"===e.kind,create:(e,t)=>or({kind:"DropSchemaNode",schema:lr.create(e),...t}),cloneWith:(e,t)=>or({...e,...t})}),wr=or({is:e=>"DropTableNode"===e.kind,create:(e,t)=>or({kind:"DropTableNode",table:e,...t}),cloneWith:(e,t)=>or({...e,...t})}),Nr=or({is:e=>"AliasNode"===e.kind,create:(e,t)=>or({kind:"AliasNode",node:e,alias:t})}),br=or({is:e=>"TableNode"===e.kind,create:e=>or({kind:"TableNode",table:fr.create(e)}),createWithSchema:(e,t)=>or({kind:"TableNode",table:fr.createWithSchema(e,t)})});function vr(e){return ir(e)&&rr(e.toOperationNode)}const xr=or({is:e=>"SelectModifierNode"===e.kind,create:(e,t)=>or({kind:"SelectModifierNode",modifier:e,of:t}),createWithExpression:e=>or({kind:"SelectModifierNode",rawModifier:e})}),kr=or({is:e=>"AndNode"===e.kind,create:(e,t)=>or({kind:"AndNode",left:e,right:t})}),Sr=or({is:e=>"OrNode"===e.kind,create:(e,t)=>or({kind:"OrNode",left:e,right:t})}),Or=or({is:e=>"OnNode"===e.kind,create:e=>or({kind:"OnNode",on:e}),cloneWithOperation:(e,t,n)=>or({...e,on:"And"===t?kr.create(e.on,n):Sr.create(e.on,n)})}),Wr=or({is:e=>"JoinNode"===e.kind,create:(e,t)=>or({kind:"JoinNode",joinType:e,table:t,on:void 0}),createWithOn:(e,t,n)=>or({kind:"JoinNode",joinType:e,table:t,on:Or.create(n)}),cloneWithOn:(e,t)=>or({...e,on:e.on?Or.cloneWithOperation(e.on,"And",t):Or.create(t)})}),qr=or({is:e=>"BinaryOperationNode"===e.kind,create:(e,t,n)=>or({kind:"BinaryOperationNode",leftOperand:e,operator:t,rightOperand:n})}),Ir=["->","->>"],Tr=[...["=","==","!=","<>",">",">=","<","<=","in","not in","is","is not","like","not like","match","ilike","not ilike","@>","<@","&&","?","?&","!<","!>","<=>","!~","~","~*","!~*","@@","@@@","!!","<->","regexp","is distinct from","is not distinct from","+","-","*","/","%","^","&","|","#","<<",">>","&&","||"],...Ir,"not","-","exists","not exists","between","between symmetric"],Er=or({is:e=>"OperatorNode"===e.kind,create:e=>or({kind:"OperatorNode",operator:e})});function Cr(e){return Gn(e)&&Ir.includes(e)}const Dr=or({is:e=>"ColumnNode"===e.kind,create:e=>or({kind:"ColumnNode",column:lr.create(e)})}),Pr=or({is:e=>"SelectAllNode"===e.kind,create:()=>or({kind:"SelectAllNode"})}),Ar=or({is:e=>"ReferenceNode"===e.kind,create:(e,t)=>or({kind:"ReferenceNode",table:t,column:e}),createSelectAll:e=>or({kind:"ReferenceNode",table:e,column:Pr.create()})});class Mr{#e;get dynamicReference(){return this.#e}get refType(){}constructor(e){this.#e=e}toOperationNode(){return Kr(this.#e)}}function Lr(e){return ir(e)&&vr(e)&&Gn(e.dynamicReference)}const Br=or({is:e=>"OrderByItemNode"===e.kind,create:(e,t)=>or({kind:"OrderByItemNode",orderBy:e,direction:t})}),Fr=or({is:e=>"RawNode"===e.kind,create:(e,t)=>or({kind:"RawNode",sqlFragments:or(e),parameters:or(t)}),createWithSql:e=>Fr.create([e],[]),createWithChild:e=>Fr.create(["",""],[e]),createWithChildren:e=>Fr.create(new Array(e.length+1).fill(""),e)});function Rr(e){return"asc"===e||"desc"===e}function jr(e){if(2===e.length)return[Ur(e[0],e[1])];if(1===e.length){const[t]=e;return Array.isArray(t)?t.map((e=>Ur(e))):[Ur(t)]}throw new Error(`Invalid number of arguments at order by! expected 1-2, received ${e.length}`)}function Ur(e,t){const n=function(e){if(Ss(e))return xs(e);if(Lr(e))return e.toOperationNode();const[t,n]=e.split(" ");if(n){if(!Rr(n))throw new Error(`Invalid order by direction: ${n}`);return Br.create(zr(t),_r(n))}return zr(e)}(e);if(Br.is(n)){if(t)throw new Error("Cannot specify direction twice!");return n}return Br.create(n,_r(t))}function _r(e){if(e)return"asc"===e||"desc"===e?Fr.createWithSql(e):e.toOperationNode()}const $r=or({is:e=>"JSONReferenceNode"===e.kind,create:(e,t)=>or({kind:"JSONReferenceNode",reference:e,traversal:t}),cloneWithTraversal:(e,t)=>or({...e,traversal:t})}),Qr=or({is:e=>"JSONOperatorChainNode"===e.kind,create:e=>or({kind:"JSONOperatorChainNode",operator:e,values:or([])}),cloneWithValue:(e,t)=>or({...e,values:or([...e.values,t])})}),Jr=or({is:e=>"JSONPathNode"===e.kind,create:e=>or({kind:"JSONPathNode",inOperator:e,pathLegs:or([])}),cloneWithLeg:(e,t)=>or({...e,pathLegs:or([...e.pathLegs,t])})});function Kr(e){return Gn(e)?zr(e):e.toOperationNode()}function Yr(e){return ar(e)?e.map((e=>Vr(e))):[Vr(e)]}function Vr(e){return Ss(e)?xs(e):Kr(e)}function zr(e){if(!e.includes("."))return Ar.create(Dr.create(e));const t=e.split(".").map(Gr);if(3===t.length)return function(e){const[t,n,r]=e;return Ar.create(Dr.create(r),br.createWithSchema(t,n))}(t);if(2===t.length)return function(e){const[t,n]=e;return Ar.create(Dr.create(n),br.create(t))}(t);throw new Error(`invalid column reference ${e}`)}function Xr(e){return Dr.create(e)}function Hr(e){if(e.includes(" ")){const[t,n]=e.split(" ").map(Gr);if(!Rr(n))throw new Error(`invalid order direction "${n}" next to "${t}"`);return jr([t,n])[0]}return Xr(e)}function Gr(e){return e.trim()}const Zr=or({is:e=>"PrimitiveValueListNode"===e.kind,create:e=>or({kind:"PrimitiveValueListNode",values:or([...e])})}),ei=or({is:e=>"ValueListNode"===e.kind,create:e=>or({kind:"ValueListNode",values:or(e)})}),ti=or({is:e=>"ValueNode"===e.kind,create:e=>or({kind:"ValueNode",value:e}),createImmediate:e=>or({kind:"ValueNode",value:e,immediate:!0})});function ni(e){return Ss(e)?xs(e):ti.create(e)}function ri(e){return Zn(e)||er(e)||tr(e)}function ii(e){if(!ri(e))throw new Error(`unsafe immediate value ${JSON.stringify(e)}`);return ti.createImmediate(e)}const oi=or({is:e=>"ParensNode"===e.kind,create:e=>or({kind:"ParensNode",node:e})});function si(e){if(3===e.length)return ai(e[0],e[1],e[2]);if(1===e.length)return ni(e[0]);throw new Error(`invalid arguments: ${JSON.stringify(e)}`)}function ai(e,t,n){return function(e){return"is"===e||"is not"===e}(t)&&pi(n)?qr.create(Vr(e),ui(t),ti.createImmediate(n)):qr.create(Vr(e),ui(t),ar(r=n)?function(e){return e.some(Ss)?ei.create(e.map((e=>ni(e)))):Zr.create(e)}(r):ni(r));var r}function ci(e,t,n){return qr.create(Vr(e),ui(t),Vr(n))}function di(e,t){return li(Object.entries(e).filter((([,e])=>!Hn(e))).map((([e,t])=>ai(e,pi(t)?"is":"=",t))),t)}function li(e,t,n=!0){const r="and"===t?kr.create:Sr.create;if(0===e.length)return qr.create(ti.createImmediate(1),Er.create("="),ti.createImmediate("and"===t?1:0));let i=hi(e[0]);for(let t=1;t<e.length;++t)i=r(i,hi(e[t]));return e.length>1&&n?oi.create(i):i}function pi(e){return tr(e)||er(e)}function ui(e){if(Gn(e)&&Tr.includes(e))return Er.create(e);if(vr(e))return e.toOperationNode();throw new Error(`invalid operator ${JSON.stringify(e)}`)}function hi(e){return vr(e)?e.toOperationNode():e}const mi=or({is:e=>"OrderByNode"===e.kind,create:e=>or({kind:"OrderByNode",items:or([...e])}),cloneWithItems:(e,t)=>or({...e,items:or([...e.items,...t])})}),fi=or({is:e=>"PartitionByNode"===e.kind,create:e=>or({kind:"PartitionByNode",items:or(e)}),cloneWithItems:(e,t)=>or({...e,items:or([...e.items,...t])})}),yi=or({is:e=>"OverNode"===e.kind,create:()=>or({kind:"OverNode"}),cloneWithOrderByItems:(e,t)=>or({...e,orderBy:e.orderBy?mi.cloneWithItems(e.orderBy,t):mi.create(t)}),cloneWithPartitionByItems:(e,t)=>or({...e,partitionBy:e.partitionBy?fi.cloneWithItems(e.partitionBy,t):fi.create(t)})});function gi(e,t){Object.defineProperties(e.prototype,{then:{enumerable:!1,value:()=>{throw new Error(t)}}})}class wi{#t;constructor(e){this.#t=or(e)}on(...e){return new wi({...this.#t,joinNode:Wr.cloneWithOn(this.#t.joinNode,si(e))})}onRef(e,t,n){return new wi({...this.#t,joinNode:Wr.cloneWithOn(this.#t.joinNode,ci(e,t,n))})}onTrue(){return new wi({...this.#t,joinNode:Wr.cloneWithOn(this.#t.joinNode,Fr.createWithSql("true"))})}$call(e){return e(this)}toOperationNode(){return this.#t.joinNode}}gi(wi,"don't await JoinBuilder instances. They are never executed directly and are always just a part of a query.");const Ni=or({is:e=>"PartitionByItemNode"===e.kind,create:e=>or({kind:"PartitionByItemNode",partitionBy:e})});function bi(e){return Yr(e).map(Ni.create)}class vi{#t;constructor(e){this.#t=or(e)}orderBy(e,t){return new vi({overNode:yi.cloneWithOrderByItems(this.#t.overNode,jr([e,t]))})}partitionBy(e){return new vi({overNode:yi.cloneWithPartitionByItems(this.#t.overNode,bi(e))})}$call(e){return e(this)}toOperationNode(){return this.#t.overNode}}gi(vi,"don't await OverBuilder instances. They are never executed directly and are always just a part of a query.");const xi=or({is:e=>"SelectionNode"===e.kind,create:e=>or({kind:"SelectionNode",selection:e}),createSelectAll:()=>or({kind:"SelectionNode",selection:Pr.create()}),createSelectAllFromTable:e=>or({kind:"SelectionNode",selection:Ar.createSelectAll(e)})});function ki(e){return rr(e)?ki(e(vs())):ar(e)?e.map((e=>Si(e))):[Si(e)]}function Si(e){return Gn(e)?xi.create(function(e){const t=" as ";if(e.includes(t)){const[n,r]=e.split(t).map(Gr);return Nr.create(zr(n),lr.create(r))}return zr(e)}(e)):Lr(e)?xi.create(e.toOperationNode()):xi.create(ks(e))}function Oi(e){return e?Array.isArray(e)?e.map(Wi):[Wi(e)]:[xi.createSelectAll()]}function Wi(e){if(Gn(e))return xi.createSelectAllFromTable(Is(e));throw new Error(`invalid value selectAll expression: ${JSON.stringify(e)}`)}const qi=or({is:e=>"ValuesNode"===e.kind,create:e=>or({kind:"ValuesNode",values:or(e)})}),Ii=or({is:e=>"DefaultInsertValueNode"===e.kind,create:()=>or({kind:"DefaultInsertValueNode"})});function Ti(e){const t=rr(e)?e(vs()):e;return function(e){const t=function(e){const t=new Map;for(const n of e){const e=Object.keys(n);for(const r of e)t.has(r)||void 0===n[r]||t.set(r,t.size)}return t}(e);return[or([...t.keys()].map(Dr.create)),qi.create(e.map((e=>function(e,t){const n=Object.keys(e),r=Array.from({length:t.size});let i=!1;for(const o of n){const n=t.get(o);if(Hn(n))continue;const s=e[o];(Hn(s)||Ss(s))&&(i=!0),r[n]=s}if(n.length<t.size||i){const e=Ii.create();return ei.create(r.map((t=>Hn(t)?e:ni(t))))}return Zr.create(r)}(e,t))))]}(ar(t)?t:or([t]))}const Ei=or({is:e=>"InsertQueryNode"===e.kind,create:(e,t,n)=>or({kind:"InsertQueryNode",into:e,...t&&{with:t},replace:n}),createWithoutInto:()=>or({kind:"InsertQueryNode"}),cloneWith:(e,t)=>or({...e,...t})}),Ci=or({is:e=>"FromNode"===e.kind,create:e=>or({kind:"FromNode",froms:or(e)}),cloneWithFroms:(e,t)=>or({...e,froms:or([...e.froms,...t])})}),Di=or({is:e=>"GroupByNode"===e.kind,create:e=>or({kind:"GroupByNode",items:or(e)}),cloneWithItems:(e,t)=>or({...e,items:or([...e.items,...t])})}),Pi=or({is:e=>"HavingNode"===e.kind,create:e=>or({kind:"HavingNode",having:e}),cloneWithOperation:(e,t,n)=>or({...e,having:"And"===t?kr.create(e.having,n):Sr.create(e.having,n)})}),Ai=or({is:e=>"SelectQueryNode"===e.kind,create:e=>or({kind:"SelectQueryNode",...e&&{with:e}}),createFrom:(e,t)=>or({kind:"SelectQueryNode",from:Ci.create(e),...t&&{with:t}}),cloneWithSelections:(e,t)=>or({...e,selections:e.selections?or([...e.selections,...t]):or(t)}),cloneWithDistinctOn:(e,t)=>or({...e,distinctOn:e.distinctOn?or([...e.distinctOn,...t]):or(t)}),cloneWithFrontModifier:(e,t)=>or({...e,frontModifiers:e.frontModifiers?or([...e.frontModifiers,t]):or([t])}),cloneWithEndModifier:(e,t)=>or({...e,endModifiers:e.endModifiers?or([...e.endModifiers,t]):or([t])}),cloneWithOrderByItems:(e,t)=>or({...e,orderBy:e.orderBy?mi.cloneWithItems(e.orderBy,t):mi.create(t)}),cloneWithGroupByItems:(e,t)=>or({...e,groupBy:e.groupBy?Di.cloneWithItems(e.groupBy,t):Di.create(t)}),cloneWithLimit:(e,t)=>or({...e,limit:t}),cloneWithOffset:(e,t)=>or({...e,offset:t}),cloneWithFetch:(e,t)=>or({...e,fetch:t}),cloneWithHaving:(e,t)=>or({...e,having:e.having?Pi.cloneWithOperation(e.having,"And",t):Pi.create(t)}),cloneWithSetOperations:(e,t)=>or({...e,setOperations:e.setOperations?or([...e.setOperations,...t]):or([...t])}),cloneWithoutSelections:e=>or({...e,selections:[]}),cloneWithoutLimit:e=>or({...e,limit:void 0}),cloneWithoutOffset:e=>or({...e,offset:void 0}),cloneWithoutOrderBy:e=>or({...e,orderBy:void 0})}),Mi=or({is:e=>"UpdateQueryNode"===e.kind,create:(e,t)=>or({kind:"UpdateQueryNode",table:e,...t&&{with:t}}),createWithoutTable:()=>or({kind:"UpdateQueryNode"}),cloneWithFromItems:(e,t)=>or({...e,from:e.from?Ci.cloneWithFroms(e.from,t):Ci.create(t)}),cloneWithUpdates:(e,t)=>or({...e,updates:e.updates?or([...e.updates,...t]):t}),cloneWithLimit:(e,t)=>or({...e,limit:t})}),Li=or({is:e=>"UsingNode"===e.kind,create:e=>or({kind:"UsingNode",tables:or(e)}),cloneWithTables:(e,t)=>or({...e,tables:or([...e.tables,...t])})}),Bi=or({is:e=>"DeleteQueryNode"===e.kind,create:(e,t)=>or({kind:"DeleteQueryNode",from:Ci.create(e),...t&&{with:t}}),cloneWithOrderByItems:(e,t)=>or({...e,orderBy:e.orderBy?mi.cloneWithItems(e.orderBy,t):mi.create(t)}),cloneWithoutOrderBy:e=>or({...e,orderBy:void 0}),cloneWithLimit:(e,t)=>or({...e,limit:t}),cloneWithoutLimit:e=>or({...e,limit:void 0}),cloneWithUsing:(e,t)=>or({...e,using:void 0!==e.using?Li.cloneWithTables(e.using,t):Li.create(t)})}),Fi=or({is:e=>"WhereNode"===e.kind,create:e=>or({kind:"WhereNode",where:e}),cloneWithOperation:(e,t,n)=>or({...e,where:"And"===t?kr.create(e.where,n):Sr.create(e.where,n)})}),Ri=or({is:e=>"ReturningNode"===e.kind,create:e=>or({kind:"ReturningNode",selections:or(e)}),cloneWithSelections:(e,t)=>or({...e,selections:e.selections?or([...e.selections,...t]):or(t)})}),ji=or({is:e=>"ExplainNode"===e.kind,create:(e,t)=>or({kind:"ExplainNode",format:e,options:t})}),Ui=or({is:e=>"WhenNode"===e.kind,create:e=>or({kind:"WhenNode",condition:e}),cloneWithResult:(e,t)=>or({...e,result:t})}),_i=or({is:e=>"MergeQueryNode"===e.kind,create:(e,t)=>or({kind:"MergeQueryNode",into:e,...t&&{with:t}}),cloneWithUsing:(e,t)=>or({...e,using:t}),cloneWithWhen:(e,t)=>or({...e,whens:e.whens?or([...e.whens,t]):or([t])}),cloneWithThen:(e,t)=>or({...e,whens:e.whens?or([...e.whens.slice(0,-1),Ui.cloneWithResult(e.whens[e.whens.length-1],t)]):void 0})}),$i=or({is:e=>Ai.is(e)||Ei.is(e)||Mi.is(e)||Bi.is(e)||_i.is(e),cloneWithWhere:(e,t)=>or({...e,where:e.where?Fi.cloneWithOperation(e.where,"And",t):Fi.create(t)}),cloneWithJoin:(e,t)=>or({...e,joins:e.joins?or([...e.joins,t]):or([t])}),cloneWithReturning:(e,t)=>or({...e,returning:e.returning?Ri.cloneWithSelections(e.returning,t):Ri.create(t)}),cloneWithoutReturning:e=>or({...e,returning:void 0}),cloneWithoutWhere:e=>or({...e,where:void 0}),cloneWithExplain:(e,t,n)=>or({...e,explain:ji.create(t,n?.toOperationNode())}),cloneWithTop:(e,t)=>or({...e,top:t})}),Qi=or({is:e=>"ColumnUpdateNode"===e.kind,create:(e,t)=>or({kind:"ColumnUpdateNode",column:e,value:t})});function Ji(...e){return 2===e.length?[Qi.create(Vr(e[0]),ni(e[1]))]:Ki(e[0])}function Ki(e){const t=rr(e)?e(vs()):e;return Object.entries(t).filter((([e,t])=>void 0!==t)).map((([e,t])=>Qi.create(Dr.create(e),ni(t))))}const Yi=or({is:e=>"OnDuplicateKeyNode"===e.kind,create:e=>or({kind:"OnDuplicateKeyNode",updates:e})});class Vi{insertId;numInsertedOrUpdatedRows;constructor(e,t){this.insertId=e,this.numInsertedOrUpdatedRows=t}}class zi extends Error{node;constructor(e){super("no result"),this.node=e}}function Xi(e){return Object.prototype.hasOwnProperty.call(e,"prototype")}const Hi=or({is:e=>"OnConflictNode"===e.kind,create:()=>or({kind:"OnConflictNode"}),cloneWith:(e,t)=>or({...e,...t}),cloneWithIndexWhere:(e,t)=>or({...e,indexWhere:e.indexWhere?Fi.cloneWithOperation(e.indexWhere,"And",t):Fi.create(t)}),cloneWithIndexOrWhere:(e,t)=>or({...e,indexWhere:e.indexWhere?Fi.cloneWithOperation(e.indexWhere,"Or",t):Fi.create(t)}),cloneWithUpdateWhere:(e,t)=>or({...e,updateWhere:e.updateWhere?Fi.cloneWithOperation(e.updateWhere,"And",t):Fi.create(t)}),cloneWithUpdateOrWhere:(e,t)=>or({...e,updateWhere:e.updateWhere?Fi.cloneWithOperation(e.updateWhere,"Or",t):Fi.create(t)}),cloneWithoutIndexWhere:e=>or({...e,indexWhere:void 0}),cloneWithoutUpdateWhere:e=>or({...e,updateWhere:void 0})});class Gi{#t;constructor(e){this.#t=or(e)}column(e){const t=Dr.create(e);return new Gi({...this.#t,onConflictNode:Hi.cloneWith(this.#t.onConflictNode,{columns:this.#t.onConflictNode.columns?or([...this.#t.onConflictNode.columns,t]):or([t])})})}columns(e){const t=e.map(Dr.create);return new Gi({...this.#t,onConflictNode:Hi.cloneWith(this.#t.onConflictNode,{columns:this.#t.onConflictNode.columns?or([...this.#t.onConflictNode.columns,...t]):or(t)})})}constraint(e){return new Gi({...this.#t,onConflictNode:Hi.cloneWith(this.#t.onConflictNode,{constraint:lr.create(e)})})}expression(e){return new Gi({...this.#t,onConflictNode:Hi.cloneWith(this.#t.onConflictNode,{indexExpression:e.toOperationNode()})})}where(...e){return new Gi({...this.#t,onConflictNode:Hi.cloneWithIndexWhere(this.#t.onConflictNode,si(e))})}whereRef(e,t,n){return new Gi({...this.#t,onConflictNode:Hi.cloneWithIndexWhere(this.#t.onConflictNode,ci(e,t,n))})}clearWhere(){return new Gi({...this.#t,onConflictNode:Hi.cloneWithoutIndexWhere(this.#t.onConflictNode)})}doNothing(){return new Zi({...this.#t,onConflictNode:Hi.cloneWith(this.#t.onConflictNode,{doNothing:!0})})}doUpdateSet(e){return new eo({...this.#t,onConflictNode:Hi.cloneWith(this.#t.onConflictNode,{updates:Ki(e)})})}$call(e){return e(this)}}gi(Gi,"don't await OnConflictBuilder instances.");class Zi{#t;constructor(e){this.#t=or(e)}toOperationNode(){return this.#t.onConflictNode}}gi(Zi,"don't await OnConflictDoNothingBuilder instances.");class eo{#t;constructor(e){this.#t=or(e)}where(...e){return new eo({...this.#t,onConflictNode:Hi.cloneWithUpdateWhere(this.#t.onConflictNode,si(e))})}whereRef(e,t,n){return new eo({...this.#t,onConflictNode:Hi.cloneWithUpdateWhere(this.#t.onConflictNode,ci(e,t,n))})}clearWhere(){return new eo({...this.#t,onConflictNode:Hi.cloneWithoutUpdateWhere(this.#t.onConflictNode)})}$call(e){return e(this)}toOperationNode(){return this.#t.onConflictNode}}gi(eo,"don't await OnConflictUpdateBuilder instances.");const to=or({is:e=>"TopNode"===e.kind,create:(e,t)=>or({kind:"TopNode",expression:e,modifiers:t})});function no(e,t){if(!Zn(e)&&!nr(e))throw new Error(`Invalid top expression: ${e}`);if(!Hn(t)&&!function(e){return"percent"===e||"with ties"===e||"percent with ties"===e}(t))throw new Error(`Invalid top modifiers: ${t}`);return to.create(e,t)}class ro{#t;constructor(e){this.#t=or(e)}values(e){const[t,n]=Ti(e);return new ro({...this.#t,queryNode:Ei.cloneWith(this.#t.queryNode,{columns:t,values:n})})}columns(e){return new ro({...this.#t,queryNode:Ei.cloneWith(this.#t.queryNode,{columns:or(e.map(Dr.create))})})}expression(e){return new ro({...this.#t,queryNode:Ei.cloneWith(this.#t.queryNode,{values:xs(e)})})}defaultValues(){return new ro({...this.#t,queryNode:Ei.cloneWith(this.#t.queryNode,{defaultValues:!0})})}ignore(){return new ro({...this.#t,queryNode:Ei.cloneWith(this.#t.queryNode,{ignore:!0})})}top(e,t){return new ro({...this.#t,queryNode:$i.cloneWithTop(this.#t.queryNode,no(e,t))})}onConflict(e){return new ro({...this.#t,queryNode:Ei.cloneWith(this.#t.queryNode,{onConflict:e(new Gi({onConflictNode:Hi.create()})).toOperationNode()})})}onDuplicateKeyUpdate(e){return new ro({...this.#t,queryNode:Ei.cloneWith(this.#t.queryNode,{onDuplicateKey:Yi.create(Ki(e))})})}returning(e){return new ro({...this.#t,queryNode:$i.cloneWithReturning(this.#t.queryNode,ki(e))})}returningAll(){return new ro({...this.#t,queryNode:$i.cloneWithReturning(this.#t.queryNode,Oi())})}clearReturning(){return new ro({...this.#t,queryNode:$i.cloneWithoutReturning(this.#t.queryNode)})}$call(e){return e(this)}$if(e,t){return e?t(this):new ro({...this.#t})}$castTo(){return new ro(this.#t)}$narrowType(){return new ro(this.#t)}$assertType(){return new ro(this.#t)}withPlugin(e){return new ro({...this.#t,executor:this.#t.executor.withPlugin(e)})}toOperationNode(){return this.#t.executor.transformQuery(this.#t.queryNode,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){const e=this.compile(),t=e.query,n=await this.#t.executor.executeQuery(e,this.#t.queryId);return this.#t.executor.adapter.supportsReturning&&t.returning?n.rows:[new Vi(n.insertId,n.numAffectedRows??n.numUpdatedOrDeletedRows)]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=zi){const t=await this.executeTakeFirst();if(void 0===t)throw Xi(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async*stream(e=100){const t=this.compile(),n=this.#t.executor.stream(t,e,this.#t.queryId);for await(const e of n)yield*e.rows}async explain(e,t){const n=new ro({...this.#t,queryNode:$i.cloneWithExplain(this.#t.queryNode,e,t)});return await n.execute()}}gi(ro,"don't await InsertQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");class io{numDeletedRows;constructor(e){this.numDeletedRows=e}}const oo=or({is:e=>"LimitNode"===e.kind,create:e=>or({kind:"LimitNode",limit:e})});class so{#t;constructor(e){this.#t=or(e)}where(...e){return new so({...this.#t,queryNode:$i.cloneWithWhere(this.#t.queryNode,si(e))})}whereRef(e,t,n){return new so({...this.#t,queryNode:$i.cloneWithWhere(this.#t.queryNode,ci(e,t,n))})}clearWhere(){return new so({...this.#t,queryNode:$i.cloneWithoutWhere(this.#t.queryNode)})}top(e,t){return new so({...this.#t,queryNode:$i.cloneWithTop(this.#t.queryNode,no(e,t))})}using(e){return new so({...this.#t,queryNode:Bi.cloneWithUsing(this.#t.queryNode,Os(e))})}innerJoin(...e){return new so({...this.#t,queryNode:$i.cloneWithJoin(this.#t.queryNode,Fo("InnerJoin",e))})}leftJoin(...e){return new so({...this.#t,queryNode:$i.cloneWithJoin(this.#t.queryNode,Fo("LeftJoin",e))})}rightJoin(...e){return new so({...this.#t,queryNode:$i.cloneWithJoin(this.#t.queryNode,Fo("RightJoin",e))})}fullJoin(...e){return new so({...this.#t,queryNode:$i.cloneWithJoin(this.#t.queryNode,Fo("FullJoin",e))})}returning(e){return new so({...this.#t,queryNode:$i.cloneWithReturning(this.#t.queryNode,ki(e))})}returningAll(e){return new so({...this.#t,queryNode:$i.cloneWithReturning(this.#t.queryNode,Oi(e))})}clearReturning(){return new so({...this.#t,queryNode:$i.cloneWithoutReturning(this.#t.queryNode)})}clearLimit(){return new so({...this.#t,queryNode:Bi.cloneWithoutLimit(this.#t.queryNode)})}clearOrderBy(){return new so({...this.#t,queryNode:Bi.cloneWithoutOrderBy(this.#t.queryNode)})}orderBy(e,t){return new so({...this.#t,queryNode:Bi.cloneWithOrderByItems(this.#t.queryNode,jr([e,t]))})}limit(e){return new so({...this.#t,queryNode:Bi.cloneWithLimit(this.#t.queryNode,oo.create(ni(e)))})}$call(e){return e(this)}$if(e,t){return e?t(this):new so({...this.#t})}$castTo(){return new so(this.#t)}$narrowType(){return new so(this.#t)}$assertType(){return new so(this.#t)}withPlugin(e){return new so({...this.#t,executor:this.#t.executor.withPlugin(e)})}toOperationNode(){return this.#t.executor.transformQuery(this.#t.queryNode,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){const e=this.compile(),t=e.query,n=await this.#t.executor.executeQuery(e,this.#t.queryId);return this.#t.executor.adapter.supportsReturning&&t.returning?n.rows:[new io(n.numAffectedRows??n.numUpdatedOrDeletedRows??BigInt(0))]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=zi){const t=await this.executeTakeFirst();if(void 0===t)throw Xi(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async*stream(e=100){const t=this.compile(),n=this.#t.executor.stream(t,e,this.#t.queryId);for await(const e of n)yield*e.rows}async explain(e,t){const n=new so({...this.#t,queryNode:$i.cloneWithExplain(this.#t.queryNode,e,t)});return await n.execute()}}gi(so,"don't await DeleteQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");class ao{numUpdatedRows;numChangedRows;constructor(e,t){this.numUpdatedRows=e,this.numChangedRows=t}}class co{#t;constructor(e){this.#t=or(e)}where(...e){return new co({...this.#t,queryNode:$i.cloneWithWhere(this.#t.queryNode,si(e))})}whereRef(e,t,n){return new co({...this.#t,queryNode:$i.cloneWithWhere(this.#t.queryNode,ci(e,t,n))})}clearWhere(){return new co({...this.#t,queryNode:$i.cloneWithoutWhere(this.#t.queryNode)})}top(e,t){return new co({...this.#t,queryNode:$i.cloneWithTop(this.#t.queryNode,no(e,t))})}from(e){return new co({...this.#t,queryNode:Mi.cloneWithFromItems(this.#t.queryNode,Os(e))})}innerJoin(...e){return new co({...this.#t,queryNode:$i.cloneWithJoin(this.#t.queryNode,Fo("InnerJoin",e))})}leftJoin(...e){return new co({...this.#t,queryNode:$i.cloneWithJoin(this.#t.queryNode,Fo("LeftJoin",e))})}rightJoin(...e){return new co({...this.#t,queryNode:$i.cloneWithJoin(this.#t.queryNode,Fo("RightJoin",e))})}fullJoin(...e){return new co({...this.#t,queryNode:$i.cloneWithJoin(this.#t.queryNode,Fo("FullJoin",e))})}limit(e){return new co({...this.#t,queryNode:Mi.cloneWithLimit(this.#t.queryNode,oo.create(ni(e)))})}set(...e){return new co({...this.#t,queryNode:Mi.cloneWithUpdates(this.#t.queryNode,Ji(...e))})}returning(e){return new co({...this.#t,queryNode:$i.cloneWithReturning(this.#t.queryNode,ki(e))})}returningAll(){return new co({...this.#t,queryNode:$i.cloneWithReturning(this.#t.queryNode,Oi())})}clearReturning(){return new co({...this.#t,queryNode:$i.cloneWithoutReturning(this.#t.queryNode)})}$call(e){return e(this)}$if(e,t){return e?t(this):new co({...this.#t})}$castTo(){return new co(this.#t)}$narrowType(){return new co(this.#t)}$assertType(){return new co(this.#t)}withPlugin(e){return new co({...this.#t,executor:this.#t.executor.withPlugin(e)})}toOperationNode(){return this.#t.executor.transformQuery(this.#t.queryNode,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){const e=this.compile(),t=e.query,n=await this.#t.executor.executeQuery(e,this.#t.queryId);return this.#t.executor.adapter.supportsReturning&&t.returning?n.rows:[new ao(n.numAffectedRows??n.numUpdatedOrDeletedRows??BigInt(0),n.numChangedRows)]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=zi){const t=await this.executeTakeFirst();if(void 0===t)throw Xi(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async*stream(e=100){const t=this.compile(),n=this.#t.executor.stream(t,e,this.#t.queryId);for await(const e of n)yield*e.rows}async explain(e,t){const n=new co({...this.#t,queryNode:$i.cloneWithExplain(this.#t.queryNode,e,t)});return await n.execute()}}gi(co,"don't await UpdateQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");const lo=or({is:e=>"CommonTableExpressionNameNode"===e.kind,create:(e,t)=>or({kind:"CommonTableExpressionNameNode",table:br.create(e),columns:t?or(t.map(Dr.create)):void 0})}),po=or({is:e=>"CommonTableExpressionNode"===e.kind,create:(e,t)=>or({kind:"CommonTableExpressionNode",name:e,expression:t}),cloneWith:(e,t)=>or({...e,...t})});class uo{#t;constructor(e){this.#t=or(e)}materialized(){return new uo({...this.#t,node:po.cloneWith(this.#t.node,{materialized:!0})})}notMaterialized(){return new uo({...this.#t,node:po.cloneWith(this.#t.node,{materialized:!1})})}toOperationNode(){return this.#t.node}}function ho(e,t){const n=t(new Bo({executor:Co})).toOperationNode();return rr(e)?e(function(e){return t=>new uo({node:po.create(mo(t),e)})}(n)).toOperationNode():po.create(mo(e),n)}function mo(e){if(e.includes("(")){const t=e.split(/[\(\)]/),n=t[0],r=t[1].split(",").map((e=>e.trim()));return lo.create(n,r)}return lo.create(e)}gi(uo,"don't await CTEBuilder instances. They are never executed directly and are always just a part of a query.");const fo=or({is:e=>"WithNode"===e.kind,create:(e,t)=>or({kind:"WithNode",expressions:or([e]),...t}),cloneWithExpression:(e,t)=>or({...e,expressions:or([...e.expressions,t])})}),yo=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"];function go(){return new wo}class wo{#n;get queryId(){return void 0===this.#n&&(this.#n=function(e){let t="";for(let e=0;e<8;++e)t+=yo[~~(Math.random()*yo.length)];return t}()),this.#n}}class No{nodeStack=[];#r=or({AliasNode:this.transformAlias.bind(this),ColumnNode:this.transformColumn.bind(this),IdentifierNode:this.transformIdentifier.bind(this),SchemableIdentifierNode:this.transformSchemableIdentifier.bind(this),RawNode:this.transformRaw.bind(this),ReferenceNode:this.transformReference.bind(this),SelectQueryNode:this.transformSelectQuery.bind(this),SelectionNode:this.transformSelection.bind(this),TableNode:this.transformTable.bind(this),FromNode:this.transformFrom.bind(this),SelectAllNode:this.transformSelectAll.bind(this),AndNode:this.transformAnd.bind(this),OrNode:this.transformOr.bind(this),ValueNode:this.transformValue.bind(this),ValueListNode:this.transformValueList.bind(this),PrimitiveValueListNode:this.transformPrimitiveValueList.bind(this),ParensNode:this.transformParens.bind(this),JoinNode:this.transformJoin.bind(this),OperatorNode:this.transformOperator.bind(this),WhereNode:this.transformWhere.bind(this),InsertQueryNode:this.transformInsertQuery.bind(this),DeleteQueryNode:this.transformDeleteQuery.bind(this),ReturningNode:this.transformReturning.bind(this),CreateTableNode:this.transformCreateTable.bind(this),AddColumnNode:this.transformAddColumn.bind(this),ColumnDefinitionNode:this.transformColumnDefinition.bind(this),DropTableNode:this.transformDropTable.bind(this),DataTypeNode:this.transformDataType.bind(this),OrderByNode:this.transformOrderBy.bind(this),OrderByItemNode:this.transformOrderByItem.bind(this),GroupByNode:this.transformGroupBy.bind(this),GroupByItemNode:this.transformGroupByItem.bind(this),UpdateQueryNode:this.transformUpdateQuery.bind(this),ColumnUpdateNode:this.transformColumnUpdate.bind(this),LimitNode:this.transformLimit.bind(this),OffsetNode:this.transformOffset.bind(this),OnConflictNode:this.transformOnConflict.bind(this),OnDuplicateKeyNode:this.transformOnDuplicateKey.bind(this),CreateIndexNode:this.transformCreateIndex.bind(this),DropIndexNode:this.transformDropIndex.bind(this),ListNode:this.transformList.bind(this),PrimaryKeyConstraintNode:this.transformPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.transformUniqueConstraint.bind(this),ReferencesNode:this.transformReferences.bind(this),CheckConstraintNode:this.transformCheckConstraint.bind(this),WithNode:this.transformWith.bind(this),CommonTableExpressionNode:this.transformCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.transformCommonTableExpressionName.bind(this),HavingNode:this.transformHaving.bind(this),CreateSchemaNode:this.transformCreateSchema.bind(this),DropSchemaNode:this.transformDropSchema.bind(this),AlterTableNode:this.transformAlterTable.bind(this),DropColumnNode:this.transformDropColumn.bind(this),RenameColumnNode:this.transformRenameColumn.bind(this),AlterColumnNode:this.transformAlterColumn.bind(this),ModifyColumnNode:this.transformModifyColumn.bind(this),AddConstraintNode:this.transformAddConstraint.bind(this),DropConstraintNode:this.transformDropConstraint.bind(this),ForeignKeyConstraintNode:this.transformForeignKeyConstraint.bind(this),CreateViewNode:this.transformCreateView.bind(this),DropViewNode:this.transformDropView.bind(this),GeneratedNode:this.transformGenerated.bind(this),DefaultValueNode:this.transformDefaultValue.bind(this),OnNode:this.transformOn.bind(this),ValuesNode:this.transformValues.bind(this),SelectModifierNode:this.transformSelectModifier.bind(this),CreateTypeNode:this.transformCreateType.bind(this),DropTypeNode:this.transformDropType.bind(this),ExplainNode:this.transformExplain.bind(this),DefaultInsertValueNode:this.transformDefaultInsertValue.bind(this),AggregateFunctionNode:this.transformAggregateFunction.bind(this),OverNode:this.transformOver.bind(this),PartitionByNode:this.transformPartitionBy.bind(this),PartitionByItemNode:this.transformPartitionByItem.bind(this),SetOperationNode:this.transformSetOperation.bind(this),BinaryOperationNode:this.transformBinaryOperation.bind(this),UnaryOperationNode:this.transformUnaryOperation.bind(this),UsingNode:this.transformUsing.bind(this),FunctionNode:this.transformFunction.bind(this),CaseNode:this.transformCase.bind(this),WhenNode:this.transformWhen.bind(this),JSONReferenceNode:this.transformJSONReference.bind(this),JSONPathNode:this.transformJSONPath.bind(this),JSONPathLegNode:this.transformJSONPathLeg.bind(this),JSONOperatorChainNode:this.transformJSONOperatorChain.bind(this),TupleNode:this.transformTuple.bind(this),MergeQueryNode:this.transformMergeQuery.bind(this),MatchedNode:this.transformMatched.bind(this),AddIndexNode:this.transformAddIndex.bind(this),CastNode:this.transformCast.bind(this),FetchNode:this.transformFetch.bind(this),TopNode:this.transformTop.bind(this)});transformNode(e){if(!e)return e;this.nodeStack.push(e);const t=this.transformNodeImpl(e);return this.nodeStack.pop(),or(t)}transformNodeImpl(e){return this.#r[e.kind](e)}transformNodeList(e){return e?or(e.map((e=>this.transformNode(e)))):e}transformSelectQuery(e){return{kind:"SelectQueryNode",from:this.transformNode(e.from),selections:this.transformNodeList(e.selections),distinctOn:this.transformNodeList(e.distinctOn),joins:this.transformNodeList(e.joins),groupBy:this.transformNode(e.groupBy),orderBy:this.transformNode(e.orderBy),where:this.transformNode(e.where),frontModifiers:this.transformNodeList(e.frontModifiers),endModifiers:this.transformNodeList(e.endModifiers),limit:this.transformNode(e.limit),offset:this.transformNode(e.offset),with:this.transformNode(e.with),having:this.transformNode(e.having),explain:this.transformNode(e.explain),setOperations:this.transformNodeList(e.setOperations),fetch:this.transformNode(e.fetch),top:this.transformNode(e.top)}}transformSelection(e){return{kind:"SelectionNode",selection:this.transformNode(e.selection)}}transformColumn(e){return{kind:"ColumnNode",column:this.transformNode(e.column)}}transformAlias(e){return{kind:"AliasNode",node:this.transformNode(e.node),alias:this.transformNode(e.alias)}}transformTable(e){return{kind:"TableNode",table:this.transformNode(e.table)}}transformFrom(e){return{kind:"FromNode",froms:this.transformNodeList(e.froms)}}transformReference(e){return{kind:"ReferenceNode",column:this.transformNode(e.column),table:this.transformNode(e.table)}}transformAnd(e){return{kind:"AndNode",left:this.transformNode(e.left),right:this.transformNode(e.right)}}transformOr(e){return{kind:"OrNode",left:this.transformNode(e.left),right:this.transformNode(e.right)}}transformValueList(e){return{kind:"ValueListNode",values:this.transformNodeList(e.values)}}transformParens(e){return{kind:"ParensNode",node:this.transformNode(e.node)}}transformJoin(e){return{kind:"JoinNode",joinType:e.joinType,table:this.transformNode(e.table),on:this.transformNode(e.on)}}transformRaw(e){return{kind:"RawNode",sqlFragments:or([...e.sqlFragments]),parameters:this.transformNodeList(e.parameters)}}transformWhere(e){return{kind:"WhereNode",where:this.transformNode(e.where)}}transformInsertQuery(e){return{kind:"InsertQueryNode",into:this.transformNode(e.into),columns:this.transformNodeList(e.columns),values:this.transformNode(e.values),returning:this.transformNode(e.returning),onConflict:this.transformNode(e.onConflict),onDuplicateKey:this.transformNode(e.onDuplicateKey),with:this.transformNode(e.with),ignore:e.ignore,replace:e.replace,explain:this.transformNode(e.explain),defaultValues:e.defaultValues,top:this.transformNode(e.top)}}transformValues(e){return{kind:"ValuesNode",values:this.transformNodeList(e.values)}}transformDeleteQuery(e){return{kind:"DeleteQueryNode",from:this.transformNode(e.from),using:this.transformNode(e.using),joins:this.transformNodeList(e.joins),where:this.transformNode(e.where),returning:this.transformNode(e.returning),with:this.transformNode(e.with),orderBy:this.transformNode(e.orderBy),limit:this.transformNode(e.limit),explain:this.transformNode(e.explain),top:this.transformNode(e.top)}}transformReturning(e){return{kind:"ReturningNode",selections:this.transformNodeList(e.selections)}}transformCreateTable(e){return{kind:"CreateTableNode",table:this.transformNode(e.table),columns:this.transformNodeList(e.columns),constraints:this.transformNodeList(e.constraints),temporary:e.temporary,ifNotExists:e.ifNotExists,onCommit:e.onCommit,frontModifiers:this.transformNodeList(e.frontModifiers),endModifiers:this.transformNodeList(e.endModifiers),selectQuery:this.transformNode(e.selectQuery)}}transformColumnDefinition(e){return{kind:"ColumnDefinitionNode",column:this.transformNode(e.column),dataType:this.transformNode(e.dataType),references:this.transformNode(e.references),primaryKey:e.primaryKey,autoIncrement:e.autoIncrement,unique:e.unique,notNull:e.notNull,unsigned:e.unsigned,defaultTo:this.transformNode(e.defaultTo),check:this.transformNode(e.check),generated:this.transformNode(e.generated),frontModifiers:this.transformNodeList(e.frontModifiers),endModifiers:this.transformNodeList(e.endModifiers),nullsNotDistinct:e.nullsNotDistinct,identity:e.identity}}transformAddColumn(e){return{kind:"AddColumnNode",column:this.transformNode(e.column)}}transformDropTable(e){return{kind:"DropTableNode",table:this.transformNode(e.table),ifExists:e.ifExists,cascade:e.cascade}}transformOrderBy(e){return{kind:"OrderByNode",items:this.transformNodeList(e.items)}}transformOrderByItem(e){return{kind:"OrderByItemNode",orderBy:this.transformNode(e.orderBy),direction:this.transformNode(e.direction)}}transformGroupBy(e){return{kind:"GroupByNode",items:this.transformNodeList(e.items)}}transformGroupByItem(e){return{kind:"GroupByItemNode",groupBy:this.transformNode(e.groupBy)}}transformUpdateQuery(e){return{kind:"UpdateQueryNode",table:this.transformNode(e.table),from:this.transformNode(e.from),joins:this.transformNodeList(e.joins),where:this.transformNode(e.where),updates:this.transformNodeList(e.updates),returning:this.transformNode(e.returning),with:this.transformNode(e.with),explain:this.transformNode(e.explain),limit:this.transformNode(e.limit),top:this.transformNode(e.top)}}transformColumnUpdate(e){return{kind:"ColumnUpdateNode",column:this.transformNode(e.column),value:this.transformNode(e.value)}}transformLimit(e){return{kind:"LimitNode",limit:this.transformNode(e.limit)}}transformOffset(e){return{kind:"OffsetNode",offset:this.transformNode(e.offset)}}transformOnConflict(e){return{kind:"OnConflictNode",columns:this.transformNodeList(e.columns),constraint:this.transformNode(e.constraint),indexExpression:this.transformNode(e.indexExpression),indexWhere:this.transformNode(e.indexWhere),updates:this.transformNodeList(e.updates),updateWhere:this.transformNode(e.updateWhere),doNothing:e.doNothing}}transformOnDuplicateKey(e){return{kind:"OnDuplicateKeyNode",updates:this.transformNodeList(e.updates)}}transformCreateIndex(e){return{kind:"CreateIndexNode",name:this.transformNode(e.name),table:this.transformNode(e.table),columns:this.transformNodeList(e.columns),unique:e.unique,using:this.transformNode(e.using),ifNotExists:e.ifNotExists,where:this.transformNode(e.where),nullsNotDistinct:e.nullsNotDistinct}}transformList(e){return{kind:"ListNode",items:this.transformNodeList(e.items)}}transformDropIndex(e){return{kind:"DropIndexNode",name:this.transformNode(e.name),table:this.transformNode(e.table),ifExists:e.ifExists,cascade:e.cascade}}transformPrimaryKeyConstraint(e){return{kind:"PrimaryKeyConstraintNode",columns:this.transformNodeList(e.columns),name:this.transformNode(e.name)}}transformUniqueConstraint(e){return{kind:"UniqueConstraintNode",columns:this.transformNodeList(e.columns),name:this.transformNode(e.name),nullsNotDistinct:e.nullsNotDistinct}}transformForeignKeyConstraint(e){return{kind:"ForeignKeyConstraintNode",columns:this.transformNodeList(e.columns),references:this.transformNode(e.references),name:this.transformNode(e.name),onDelete:e.onDelete,onUpdate:e.onUpdate}}transformSetOperation(e){return{kind:"SetOperationNode",operator:e.operator,expression:this.transformNode(e.expression),all:e.all}}transformReferences(e){return{kind:"ReferencesNode",table:this.transformNode(e.table),columns:this.transformNodeList(e.columns),onDelete:e.onDelete,onUpdate:e.onUpdate}}transformCheckConstraint(e){return{kind:"CheckConstraintNode",expression:this.transformNode(e.expression),name:this.transformNode(e.name)}}transformWith(e){return{kind:"WithNode",expressions:this.transformNodeList(e.expressions),recursive:e.recursive}}transformCommonTableExpression(e){return{kind:"CommonTableExpressionNode",name:this.transformNode(e.name),materialized:e.materialized,expression:this.transformNode(e.expression)}}transformCommonTableExpressionName(e){return{kind:"CommonTableExpressionNameNode",table:this.transformNode(e.table),columns:this.transformNodeList(e.columns)}}transformHaving(e){return{kind:"HavingNode",having:this.transformNode(e.having)}}transformCreateSchema(e){return{kind:"CreateSchemaNode",schema:this.transformNode(e.schema),ifNotExists:e.ifNotExists}}transformDropSchema(e){return{kind:"DropSchemaNode",schema:this.transformNode(e.schema),ifExists:e.ifExists,cascade:e.cascade}}transformAlterTable(e){return{kind:"AlterTableNode",table:this.transformNode(e.table),renameTo:this.transformNode(e.renameTo),setSchema:this.transformNode(e.setSchema),columnAlterations:this.transformNodeList(e.columnAlterations),addConstraint:this.transformNode(e.addConstraint),dropConstraint:this.transformNode(e.dropConstraint),addIndex:this.transformNode(e.addIndex),dropIndex:this.transformNode(e.dropIndex)}}transformDropColumn(e){return{kind:"DropColumnNode",column:this.transformNode(e.column)}}transformRenameColumn(e){return{kind:"RenameColumnNode",column:this.transformNode(e.column),renameTo:this.transformNode(e.renameTo)}}transformAlterColumn(e){return{kind:"AlterColumnNode",column:this.transformNode(e.column),dataType:this.transformNode(e.dataType),dataTypeExpression:this.transformNode(e.dataTypeExpression),setDefault:this.transformNode(e.setDefault),dropDefault:e.dropDefault,setNotNull:e.setNotNull,dropNotNull:e.dropNotNull}}transformModifyColumn(e){return{kind:"ModifyColumnNode",column:this.transformNode(e.column)}}transformAddConstraint(e){return{kind:"AddConstraintNode",constraint:this.transformNode(e.constraint)}}transformDropConstraint(e){return{kind:"DropConstraintNode",constraintName:this.transformNode(e.constraintName),ifExists:e.ifExists,modifier:e.modifier}}transformCreateView(e){return{kind:"CreateViewNode",name:this.transformNode(e.name),temporary:e.temporary,orReplace:e.orReplace,ifNotExists:e.ifNotExists,materialized:e.materialized,columns:this.transformNodeList(e.columns),as:this.transformNode(e.as)}}transformDropView(e){return{kind:"DropViewNode",name:this.transformNode(e.name),ifExists:e.ifExists,materialized:e.materialized,cascade:e.cascade}}transformGenerated(e){return{kind:"GeneratedNode",byDefault:e.byDefault,always:e.always,identity:e.identity,stored:e.stored,expression:this.transformNode(e.expression)}}transformDefaultValue(e){return{kind:"DefaultValueNode",defaultValue:this.transformNode(e.defaultValue)}}transformOn(e){return{kind:"OnNode",on:this.transformNode(e.on)}}transformSelectModifier(e){return{kind:"SelectModifierNode",modifier:e.modifier,rawModifier:this.transformNode(e.rawModifier),of:this.transformNodeList(e.of)}}transformCreateType(e){return{kind:"CreateTypeNode",name:this.transformNode(e.name),enum:this.transformNode(e.enum)}}transformDropType(e){return{kind:"DropTypeNode",name:this.transformNode(e.name),ifExists:e.ifExists}}transformExplain(e){return{kind:"ExplainNode",format:e.format,options:this.transformNode(e.options)}}transformSchemableIdentifier(e){return{kind:"SchemableIdentifierNode",schema:this.transformNode(e.schema),identifier:this.transformNode(e.identifier)}}transformAggregateFunction(e){return{kind:"AggregateFunctionNode",aggregated:this.transformNodeList(e.aggregated),distinct:e.distinct,filter:this.transformNode(e.filter),func:e.func,over:this.transformNode(e.over)}}transformOver(e){return{kind:"OverNode",orderBy:this.transformNode(e.orderBy),partitionBy:this.transformNode(e.partitionBy)}}transformPartitionBy(e){return{kind:"PartitionByNode",items:this.transformNodeList(e.items)}}transformPartitionByItem(e){return{kind:"PartitionByItemNode",partitionBy:this.transformNode(e.partitionBy)}}transformBinaryOperation(e){return{kind:"BinaryOperationNode",leftOperand:this.transformNode(e.leftOperand),operator:this.transformNode(e.operator),rightOperand:this.transformNode(e.rightOperand)}}transformUnaryOperation(e){return{kind:"UnaryOperationNode",operator:this.transformNode(e.operator),operand:this.transformNode(e.operand)}}transformUsing(e){return{kind:"UsingNode",tables:this.transformNodeList(e.tables)}}transformFunction(e){return{kind:"FunctionNode",func:e.func,arguments:this.transformNodeList(e.arguments)}}transformCase(e){return{kind:"CaseNode",value:this.transformNode(e.value),when:this.transformNodeList(e.when),else:this.transformNode(e.else),isStatement:e.isStatement}}transformWhen(e){return{kind:"WhenNode",condition:this.transformNode(e.condition),result:this.transformNode(e.result)}}transformJSONReference(e){return{kind:"JSONReferenceNode",reference:this.transformNode(e.reference),traversal:this.transformNode(e.traversal)}}transformJSONPath(e){return{kind:"JSONPathNode",inOperator:this.transformNode(e.inOperator),pathLegs:this.transformNodeList(e.pathLegs)}}transformJSONPathLeg(e){return{kind:"JSONPathLegNode",type:e.type,value:e.value}}transformJSONOperatorChain(e){return{kind:"JSONOperatorChainNode",operator:this.transformNode(e.operator),values:this.transformNodeList(e.values)}}transformTuple(e){return{kind:"TupleNode",values:this.transformNodeList(e.values)}}transformMergeQuery(e){return{kind:"MergeQueryNode",into:this.transformNode(e.into),using:this.transformNode(e.using),whens:this.transformNodeList(e.whens),with:this.transformNode(e.with),top:this.transformNode(e.top)}}transformMatched(e){return{kind:"MatchedNode",not:e.not,bySource:e.bySource}}transformAddIndex(e){return{kind:"AddIndexNode",name:this.transformNode(e.name),columns:this.transformNodeList(e.columns),unique:e.unique,using:this.transformNode(e.using),ifNotExists:e.ifNotExists}}transformCast(e){return{kind:"CastNode",expression:this.transformNode(e.expression),dataType:this.transformNode(e.dataType)}}transformFetch(e){return{kind:"FetchNode",rowCount:this.transformNode(e.rowCount),modifier:e.modifier}}transformTop(e){return{kind:"TopNode",expression:e.expression,modifiers:e.modifiers}}transformDataType(e){return e}transformSelectAll(e){return e}transformIdentifier(e){return e}transformValue(e){return e}transformPrimitiveValueList(e){return e}transformOperator(e){return e}transformDefaultInsertValue(e){return e}}const bo=or({AlterTableNode:!0,CreateIndexNode:!0,CreateSchemaNode:!0,CreateTableNode:!0,CreateTypeNode:!0,CreateViewNode:!0,DeleteQueryNode:!0,DropIndexNode:!0,DropSchemaNode:!0,DropTableNode:!0,DropTypeNode:!0,DropViewNode:!0,InsertQueryNode:!0,RawNode:!0,SelectQueryNode:!0,UpdateQueryNode:!0,MergeQueryNode:!0});class vo extends No{#i;#o=new Set;#s=new Set;constructor(e){super(),this.#i=e}transformNodeImpl(e){if(!this.#a(e))return super.transformNodeImpl(e);const t=this.#c(e);for(const e of t)this.#s.add(e);const n=this.#d(e);for(const e of n)this.#o.add(e);const r=super.transformNodeImpl(e);for(const e of n)this.#o.delete(e);for(const e of t)this.#s.delete(e);return r}transformSchemableIdentifier(e){const t=super.transformSchemableIdentifier(e);return t.schema||!this.#o.has(e.identifier.name)?t:{...t,schema:lr.create(this.#i)}}transformReferences(e){const t=super.transformReferences(e);return t.table.table.schema?t:{...t,table:br.createWithSchema(this.#i,t.table.table.identifier.name)}}#a(e){return e.kind in bo}#d(e){const t=new Set;if("name"in e&&e.name&&fr.is(e.name)&&this.#l(e.name,t),"from"in e&&e.from)for(const n of e.from.froms)this.#p(n,t);if("into"in e&&e.into&&this.#p(e.into,t),"table"in e&&e.table&&this.#p(e.table,t),"joins"in e&&e.joins)for(const n of e.joins)this.#p(n.table,t);return"using"in e&&e.using&&this.#p(e.using,t),t}#c(e){const t=new Set;return"with"in e&&e.with&&this.#u(e.with,t),t}#p(e,t){const n=br.is(e)?e:Nr.is(e)&&br.is(e.node)?e.node:null;n&&this.#l(n.table,t)}#l(e,t){const n=e.identifier.name;this.#o.has(n)||this.#s.has(n)||t.add(n)}#u(e,t){for(const n of e.expressions){const e=n.name.table.table.identifier.name;this.#s.has(e)||t.add(e)}}}class xo{#h;constructor(e){this.#h=new vo(e)}transformQuery(e){return this.#h.transformNode(e.node)}async transformResult(e){return e.result}}const ko=or({is:e=>"MatchedNode"===e.kind,create:(e,t=!1)=>or({kind:"MatchedNode",not:e,bySource:t})});function So(e,t,n){return Ui.create(li([ko.create(!e.isMatched,e.bySource),...t&&t.length>0?[3===t.length&&n?ci(t[0],t[1],t[2]):si(t)]:[]],"and",!1))}function Oo(e){return Gn(e)?Fr.create([e],[]):vr(e)?e.toOperationNode():e}class Wo{#m;#f;#y;constructor(){this.#m=new Promise(((e,t)=>{this.#y=t,this.#f=e}))}get promise(){return this.#m}resolve=e=>{this.#f&&this.#f(e)};reject=e=>{this.#y&&this.#y(e)}}const qo=new Set,Io=or([]);class To{#g;constructor(e=Io){this.#g=e}get plugins(){return this.#g}transformQuery(e,t){for(const n of this.#g){const r=n.transformQuery({node:e,queryId:t});if(r.kind!==e.kind)throw new Error(["KyselyPlugin.transformQuery must return a node","of the same kind that was given to it.",`The plugin was given a ${e.kind}`,`but it returned a ${r.kind}`].join(" "));e=r}return e}async executeQuery(e,t){return await this.provideConnection((async n=>{const r=await n.executeQuery(e),i=await this.#w(r,t);return function(e,t){const{numAffectedRows:n}=e;var r;void 0===n&&void 0===e.numUpdatedOrDeletedRows||void 0!==n&&void 0!==t.numAffectedRows||(r="kysely:warning: outdated driver/plugin detected! QueryResult.numUpdatedOrDeletedRows is deprecated and will be removed in a future release.",qo.has(r)||(qo.add(r),console.log(r)))}(r,i),i}))}async*stream(e,t,n){const r=new Wo,i=new Wo;this.provideConnection((async e=>(r.resolve(e),await i.promise))).catch((e=>r.reject(e)));const o=await r.promise;try{for await(const r of o.streamQuery(e,t))yield await this.#w(r,n)}finally{i.resolve()}}async#w(e,t){for(const n of this.#g)e=await n.transformResult({result:e,queryId:t});return e}}class Eo extends To{get adapter(){throw new Error("this query cannot be compiled to SQL")}compileQuery(){throw new Error("this query cannot be compiled to SQL")}provideConnection(){throw new Error("this query cannot be executed")}withConnectionProvider(){throw new Error("this query cannot have a connection provider")}withPlugin(e){return new Eo([...this.plugins,e])}withPlugins(e){return new Eo([...this.plugins,...e])}withPluginAtFront(e){return new Eo([e,...this.plugins])}withoutPlugins(){return new Eo([])}}const Co=new Eo;class Do{numChangedRows;constructor(e){this.numChangedRows=e}}class Po{#t;constructor(e){this.#t=or(e)}top(e,t){return new Po({...this.#t,queryNode:$i.cloneWithTop(this.#t.queryNode,no(e,t))})}using(...e){return new Ao({...this.#t,queryNode:_i.cloneWithUsing(this.#t.queryNode,Fo("Using",e))})}}gi(Po,"don't await MergeQueryBuilder instances directly. To execute the query you need to call `execute` when available.");class Ao{#t;constructor(e){this.#t=or(e)}top(e,t){return new Ao({...this.#t,queryNode:$i.cloneWithTop(this.#t.queryNode,no(e,t))})}whenMatched(){return this.#N([])}whenMatchedAnd(...e){return this.#N(e)}whenMatchedAndRef(e,t,n){return this.#N([e,t,n],!0)}#N(e,t){return new Mo({...this.#t,queryNode:_i.cloneWithWhen(this.#t.queryNode,So({isMatched:!0},e,t))})}whenNotMatched(){return this.#b([])}whenNotMatchedAnd(...e){return this.#b(e)}whenNotMatchedAndRef(e,t,n){return this.#b([e,t,n],!0)}whenNotMatchedBySource(){return this.#b([],!1,!0)}whenNotMatchedBySourceAnd(...e){return this.#b(e,!1,!0)}whenNotMatchedBySourceAndRef(e,t,n){return this.#b([e,t,n],!0,!0)}#b(e,t=!1,n=!1){const r={...this.#t,queryNode:_i.cloneWithWhen(this.#t.queryNode,So({isMatched:!1,bySource:n},e,t))};return new(n?Mo:Lo)(r)}$call(e){return e(this)}$if(e,t){return e?t(this):new Ao({...this.#t})}toOperationNode(){return this.#t.executor.transformQuery(this.#t.queryNode,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.#t.queryNode,this.#t.queryId)}async execute(){const e=this.compile(),t=await this.#t.executor.executeQuery(e,this.#t.queryId);return[new Do(t.numAffectedRows)]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=zi){const t=await this.executeTakeFirst();if(void 0===t)throw Xi(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}}gi(Ao,"don't await WheneableMergeQueryBuilder instances directly. To execute the query you need to call `execute`.");class Mo{#t;constructor(e){this.#t=or(e)}thenDelete(){return new Ao({...this.#t,queryNode:_i.cloneWithThen(this.#t.queryNode,Oo("delete"))})}thenDoNothing(){return new Ao({...this.#t,queryNode:_i.cloneWithThen(this.#t.queryNode,Oo("do nothing"))})}thenUpdate(e){return new Ao({...this.#t,queryNode:_i.cloneWithThen(this.#t.queryNode,Oo(e(new co({queryId:this.#t.queryId,executor:Co,queryNode:Mi.createWithoutTable()}))))})}thenUpdateSet(...e){return this.thenUpdate((t=>t.set(...e)))}}gi(Mo,"don't await MatchedThenableMergeQueryBuilder instances directly. To execute the query you need to call `execute` when available.");class Lo{#t;constructor(e){this.#t=or(e)}thenDoNothing(){return new Ao({...this.#t,queryNode:_i.cloneWithThen(this.#t.queryNode,Oo("do nothing"))})}thenInsertValues(e){const[t,n]=Ti(e);return new Ao({...this.#t,queryNode:_i.cloneWithThen(this.#t.queryNode,Oo(Ei.cloneWith(Ei.createWithoutInto(),{columns:t,values:n})))})}}gi(Lo,"don't await NotMatchedThenableMergeQueryBuilder instances directly. To execute the query you need to call `execute` when available.");class Bo{#t;constructor(e){this.#t=or(e)}selectFrom(e){return Ho({queryId:go(),executor:this.#t.executor,queryNode:Ai.createFrom(Os(e),this.#t.withNode)})}selectNoFrom(e){return Ho({queryId:go(),executor:this.#t.executor,queryNode:Ai.cloneWithSelections(Ai.create(this.#t.withNode),ki(e))})}insertInto(e){return new ro({queryId:go(),executor:this.#t.executor,queryNode:Ei.create(Is(e),this.#t.withNode)})}replaceInto(e){return new ro({queryId:go(),executor:this.#t.executor,queryNode:Ei.create(Is(e),this.#t.withNode,!0)})}deleteFrom(e){return new so({queryId:go(),executor:this.#t.executor,queryNode:Bi.create(Os(e),this.#t.withNode)})}updateTable(e){return new co({queryId:go(),executor:this.#t.executor,queryNode:Mi.create(Ws(e),this.#t.withNode)})}mergeInto(e){return new Po({queryId:go(),executor:this.#t.executor,queryNode:_i.create(qs(e),this.#t.withNode)})}with(e,t){const n=ho(e,t);return new Bo({...this.#t,withNode:this.#t.withNode?fo.cloneWithExpression(this.#t.withNode,n):fo.create(n)})}withRecursive(e,t){const n=ho(e,t);return new Bo({...this.#t,withNode:this.#t.withNode?fo.cloneWithExpression(this.#t.withNode,n):fo.create(n,{recursive:!0})})}withPlugin(e){return new Bo({...this.#t,executor:this.#t.executor.withPlugin(e)})}withoutPlugins(){return new Bo({...this.#t,executor:this.#t.executor.withoutPlugins()})}withSchema(e){return new Bo({...this.#t,executor:this.#t.executor.withPluginAtFront(new xo(e))})}}function Fo(e,t){if(3===t.length)return function(e,t,n,r){return Wr.createWithOn(e,Ws(t),ci(n,"=",r))}(e,t[0],t[1],t[2]);if(2===t.length)return function(e,t,n){return n(function(e,t){return new wi({joinNode:Wr.create(e,Ws(t))})}(e,t)).toOperationNode()}(e,t[0],t[1]);throw new Error("not implemented")}const Ro=or({is:e=>"OffsetNode"===e.kind,create:e=>or({kind:"OffsetNode",offset:e})}),jo=or({is:e=>"GroupByItemNode"===e.kind,create:e=>or({kind:"GroupByItemNode",groupBy:e})});function Uo(e){return Yr(e=rr(e)?e(vs()):e).map(jo.create)}const _o=or({is:e=>"SetOperationNode"===e.kind,create:(e,t,n)=>or({kind:"SetOperationNode",operator:e,expression:t,all:n})});function $o(e,t,n){return rr(t)&&(t=t(bs())),ar(t)||(t=[t]),t.map((t=>_o.create(e,xs(t),n)))}class Qo{#v;constructor(e){this.#v=e}get expressionType(){}as(e){return new Jo(this,e)}or(...e){return new Ko(Sr.create(this.#v,si(e)))}and(...e){return new Yo(kr.create(this.#v,si(e)))}$castTo(){return new Qo(this.#v)}$notNull(){return new Qo(this.#v)}toOperationNode(){return this.#v}}class Jo{#x;#k;constructor(e,t){this.#x=e,this.#k=t}get expression(){return this.#x}get alias(){return this.#k}toOperationNode(){return Nr.create(this.#x.toOperationNode(),vr(this.#k)?this.#k.toOperationNode():lr.create(this.#k))}}class Ko{#v;constructor(e){this.#v=e}get expressionType(){}as(e){return new Jo(this,e)}or(...e){return new Ko(Sr.create(this.#v,si(e)))}$castTo(){return new Ko(this.#v)}toOperationNode(){return oi.create(this.#v)}}class Yo{#v;constructor(e){this.#v=e}get expressionType(){}as(e){return new Jo(this,e)}and(...e){return new Yo(kr.create(this.#v,si(e)))}$castTo(){return new Yo(this.#v)}toOperationNode(){return oi.create(this.#v)}}const Vo=(e,t)=>({kind:"FetchNode",rowCount:ti.create(e),modifier:t});function zo(e,t){if(!Zn(e)&&!nr(e))throw new Error(`Invalid fetch row count: ${e}`);if("only"!==(n=t)&&"with ties"!==n)throw new Error(`Invalid fetch modifier: ${t}`);var n;return Vo(e,t)}class Xo{#t;constructor(e){this.#t=or(e)}get expressionType(){}get isSelectQueryBuilder(){return!0}where(...e){return new Xo({...this.#t,queryNode:$i.cloneWithWhere(this.#t.queryNode,si(e))})}whereRef(e,t,n){return new Xo({...this.#t,queryNode:$i.cloneWithWhere(this.#t.queryNode,ci(e,t,n))})}having(...e){return new Xo({...this.#t,queryNode:Ai.cloneWithHaving(this.#t.queryNode,si(e))})}havingRef(e,t,n){return new Xo({...this.#t,queryNode:Ai.cloneWithHaving(this.#t.queryNode,ci(e,t,n))})}select(e){return new Xo({...this.#t,queryNode:Ai.cloneWithSelections(this.#t.queryNode,ki(e))})}distinctOn(e){return new Xo({...this.#t,queryNode:Ai.cloneWithDistinctOn(this.#t.queryNode,Yr(e))})}modifyFront(e){return new Xo({...this.#t,queryNode:Ai.cloneWithFrontModifier(this.#t.queryNode,xr.createWithExpression(e.toOperationNode()))})}modifyEnd(e){return new Xo({...this.#t,queryNode:Ai.cloneWithEndModifier(this.#t.queryNode,xr.createWithExpression(e.toOperationNode()))})}distinct(){return new Xo({...this.#t,queryNode:Ai.cloneWithFrontModifier(this.#t.queryNode,xr.create("Distinct"))})}forUpdate(e){return new Xo({...this.#t,queryNode:Ai.cloneWithEndModifier(this.#t.queryNode,xr.create("ForUpdate",e?sr(e).map(Is):void 0))})}forShare(e){return new Xo({...this.#t,queryNode:Ai.cloneWithEndModifier(this.#t.queryNode,xr.create("ForShare",e?sr(e).map(Is):void 0))})}forKeyShare(e){return new Xo({...this.#t,queryNode:Ai.cloneWithEndModifier(this.#t.queryNode,xr.create("ForKeyShare",e?sr(e).map(Is):void 0))})}forNoKeyUpdate(e){return new Xo({...this.#t,queryNode:Ai.cloneWithEndModifier(this.#t.queryNode,xr.create("ForNoKeyUpdate",e?sr(e).map(Is):void 0))})}skipLocked(){return new Xo({...this.#t,queryNode:Ai.cloneWithEndModifier(this.#t.queryNode,xr.create("SkipLocked"))})}noWait(){return new Xo({...this.#t,queryNode:Ai.cloneWithEndModifier(this.#t.queryNode,xr.create("NoWait"))})}selectAll(e){return new Xo({...this.#t,queryNode:Ai.cloneWithSelections(this.#t.queryNode,Oi(e))})}innerJoin(...e){return new Xo({...this.#t,queryNode:$i.cloneWithJoin(this.#t.queryNode,Fo("InnerJoin",e))})}leftJoin(...e){return new Xo({...this.#t,queryNode:$i.cloneWithJoin(this.#t.queryNode,Fo("LeftJoin",e))})}rightJoin(...e){return new Xo({...this.#t,queryNode:$i.cloneWithJoin(this.#t.queryNode,Fo("RightJoin",e))})}fullJoin(...e){return new Xo({...this.#t,queryNode:$i.cloneWithJoin(this.#t.queryNode,Fo("FullJoin",e))})}innerJoinLateral(...e){return new Xo({...this.#t,queryNode:$i.cloneWithJoin(this.#t.queryNode,Fo("LateralInnerJoin",e))})}leftJoinLateral(...e){return new Xo({...this.#t,queryNode:$i.cloneWithJoin(this.#t.queryNode,Fo("LateralLeftJoin",e))})}orderBy(...e){return new Xo({...this.#t,queryNode:Ai.cloneWithOrderByItems(this.#t.queryNode,jr(e))})}groupBy(e){return new Xo({...this.#t,queryNode:Ai.cloneWithGroupByItems(this.#t.queryNode,Uo(e))})}limit(e){return new Xo({...this.#t,queryNode:Ai.cloneWithLimit(this.#t.queryNode,oo.create(ni(e)))})}offset(e){return new Xo({...this.#t,queryNode:Ai.cloneWithOffset(this.#t.queryNode,Ro.create(ni(e)))})}fetch(e,t="only"){return new Xo({...this.#t,queryNode:Ai.cloneWithFetch(this.#t.queryNode,zo(e,t))})}top(e,t){return new Xo({...this.#t,queryNode:$i.cloneWithTop(this.#t.queryNode,no(e,t))})}union(e){return new Xo({...this.#t,queryNode:Ai.cloneWithSetOperations(this.#t.queryNode,$o("union",e,!1))})}unionAll(e){return new Xo({...this.#t,queryNode:Ai.cloneWithSetOperations(this.#t.queryNode,$o("union",e,!0))})}intersect(e){return new Xo({...this.#t,queryNode:Ai.cloneWithSetOperations(this.#t.queryNode,$o("intersect",e,!1))})}intersectAll(e){return new Xo({...this.#t,queryNode:Ai.cloneWithSetOperations(this.#t.queryNode,$o("intersect",e,!0))})}except(e){return new Xo({...this.#t,queryNode:Ai.cloneWithSetOperations(this.#t.queryNode,$o("except",e,!1))})}exceptAll(e){return new Xo({...this.#t,queryNode:Ai.cloneWithSetOperations(this.#t.queryNode,$o("except",e,!0))})}as(e){return new Go(this,e)}clearSelect(){return new Xo({...this.#t,queryNode:Ai.cloneWithoutSelections(this.#t.queryNode)})}clearWhere(){return new Xo({...this.#t,queryNode:$i.cloneWithoutWhere(this.#t.queryNode)})}clearLimit(){return new Xo({...this.#t,queryNode:Ai.cloneWithoutLimit(this.#t.queryNode)})}clearOffset(){return new Xo({...this.#t,queryNode:Ai.cloneWithoutOffset(this.#t.queryNode)})}clearOrderBy(){return new Xo({...this.#t,queryNode:Ai.cloneWithoutOrderBy(this.#t.queryNode)})}$call(e){return e(this)}$if(e,t){return e?t(this):new Xo({...this.#t})}$castTo(){return new Xo(this.#t)}$narrowType(){return new Xo(this.#t)}$assertType(){return new Xo(this.#t)}$asTuple(){return new Qo(this.toOperationNode())}withPlugin(e){return new Xo({...this.#t,executor:this.#t.executor.withPlugin(e)})}toOperationNode(){return this.#t.executor.transformQuery(this.#t.queryNode,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){const e=this.compile();return(await this.#t.executor.executeQuery(e,this.#t.queryId)).rows}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=zi){const t=await this.executeTakeFirst();if(void 0===t)throw Xi(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async*stream(e=100){const t=this.compile(),n=this.#t.executor.stream(t,e,this.#t.queryId);for await(const e of n)yield*e.rows}async explain(e,t){const n=new Xo({...this.#t,queryNode:$i.cloneWithExplain(this.#t.queryNode,e,t)});return await n.execute()}}function Ho(e){return new Xo(e)}gi(Xo,"don't await SelectQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");class Go{#S;#k;constructor(e,t){this.#S=e,this.#k=t}get expression(){return this.#S}get alias(){return this.#k}get isAliasedSelectQueryBuilder(){return!0}toOperationNode(){return Nr.create(this.#S.toOperationNode(),lr.create(this.#k))}}gi(Go,"don't await AliasedSelectQueryBuilder instances directly. AliasedSelectQueryBuilder should never be executed directly since it's always a part of another query.");const Zo=or({is:e=>"AggregateFunctionNode"===e.kind,create:(e,t=[])=>or({kind:"AggregateFunctionNode",func:e,aggregated:t}),cloneWithDistinct:e=>or({...e,distinct:!0}),cloneWithFilter:(e,t)=>or({...e,filter:e.filter?Fi.cloneWithOperation(e.filter,"And",t):Fi.create(t)}),cloneWithOrFilter:(e,t)=>or({...e,filter:e.filter?Fi.cloneWithOperation(e.filter,"Or",t):Fi.create(t)}),cloneWithOver:(e,t)=>or({...e,over:t})}),es=or({is:e=>"FunctionNode"===e.kind,create:(e,t)=>or({kind:"FunctionNode",func:e,arguments:t})});class ts{#t;constructor(e){this.#t=or(e)}get expressionType(){}as(e){return new ns(this,e)}distinct(){return new ts({...this.#t,aggregateFunctionNode:Zo.cloneWithDistinct(this.#t.aggregateFunctionNode)})}filterWhere(...e){return new ts({...this.#t,aggregateFunctionNode:Zo.cloneWithFilter(this.#t.aggregateFunctionNode,si(e))})}filterWhereRef(e,t,n){return new ts({...this.#t,aggregateFunctionNode:Zo.cloneWithFilter(this.#t.aggregateFunctionNode,ci(e,t,n))})}over(e){const t=new vi({overNode:yi.create()});return new ts({...this.#t,aggregateFunctionNode:Zo.cloneWithOver(this.#t.aggregateFunctionNode,(e?e(t):t).toOperationNode())})}$call(e){return e(this)}$castTo(){return new ts(this.#t)}$notNull(){return new ts(this.#t)}toOperationNode(){return this.#t.aggregateFunctionNode}}gi(ts,"don't await AggregateFunctionBuilder instances. They are never executed directly and are always just a part of a query.");class ns{#O;#k;constructor(e,t){this.#O=e,this.#k=t}get expression(){return this.#O}get alias(){return this.#k}toOperationNode(){return Nr.create(this.#O.toOperationNode(),lr.create(this.#k))}}function rs(){const e=(e,t)=>new Qo(es.create(e,Yr(t??[]))),t=(e,t)=>new ts({aggregateFunctionNode:Zo.create(e,t?Yr(t):void 0)});return Object.assign(e,{agg:t,avg:e=>t("avg",[e]),coalesce:(...t)=>e("coalesce",t),count:e=>t("count",[e]),countAll:e=>new ts({aggregateFunctionNode:Zo.create("count",Oi(e))}),max:e=>t("max",[e]),min:e=>t("min",[e]),sum:e=>t("sum",[e]),any:t=>e("any",[t]),jsonAgg:e=>new ts({aggregateFunctionNode:Zo.create("json_agg",[Gn(e)?Is(e):e.toOperationNode()])}),toJson:e=>new Qo(es.create("to_json",[Gn(e)?Is(e):e.toOperationNode()]))})}const is=or({is:e=>"UnaryOperationNode"===e.kind,create:(e,t)=>or({kind:"UnaryOperationNode",operator:e,operand:t})});const os=or({is:e=>"CaseNode"===e.kind,create:e=>or({kind:"CaseNode",value:e}),cloneWithWhen:(e,t)=>or({...e,when:or(e.when?[...e.when,t]:[t])}),cloneWithThen:(e,t)=>or({...e,when:e.when?or([...e.when.slice(0,-1),Ui.cloneWithResult(e.when[e.when.length-1],t)]):void 0}),cloneWith:(e,t)=>or({...e,...t})});class ss{#t;constructor(e){this.#t=or(e)}when(...e){return new as({...this.#t,node:os.cloneWithWhen(this.#t.node,Ui.create(si(e)))})}}class as{#t;constructor(e){this.#t=or(e)}then(e){return new cs({...this.#t,node:os.cloneWithThen(this.#t.node,ri(e)?ii(e):ni(e))})}}class cs{#t;constructor(e){this.#t=or(e)}when(...e){return new as({...this.#t,node:os.cloneWithWhen(this.#t.node,Ui.create(si(e)))})}else(e){return new ds({...this.#t,node:os.cloneWith(this.#t.node,{else:ri(e)?ii(e):ni(e)})})}end(){return new Qo(os.cloneWith(this.#t.node,{isStatement:!1}))}endCase(){return new Qo(os.cloneWith(this.#t.node,{isStatement:!0}))}}class ds{#t;constructor(e){this.#t=or(e)}end(){return new Qo(os.cloneWith(this.#t.node,{isStatement:!1}))}endCase(){return new Qo(os.cloneWith(this.#t.node,{isStatement:!0}))}}const ls=or({is:e=>"JSONPathLegNode"===e.kind,create:(e,t)=>or({kind:"JSONPathLegNode",type:e,value:t})});class ps{#v;constructor(e){this.#v=e}at(e){return this.#W("ArrayLocation",e)}key(e){return this.#W("Member",e)}#W(e,t){return $r.is(this.#v)?new us($r.cloneWithTraversal(this.#v,Jr.is(this.#v.traversal)?Jr.cloneWithLeg(this.#v.traversal,ls.create(e,t)):Qr.cloneWithValue(this.#v.traversal,ti.createImmediate(t)))):new us(Jr.cloneWithLeg(this.#v,ls.create(e,t)))}}class us extends ps{#v;constructor(e){super(e),this.#v=e}get expressionType(){}as(e){return new hs(this,e)}$castTo(){return new ps(this.#v)}$notNull(){return new ps(this.#v)}toOperationNode(){return this.#v}}class hs{#q;#k;constructor(e,t){this.#q=e,this.#k=t}get expression(){return this.#q}get alias(){return this.#k}toOperationNode(){return Nr.create(this.#q.toOperationNode(),vr(this.#k)?this.#k.toOperationNode():lr.create(this.#k))}}const ms=or({is:e=>"TupleNode"===e.kind,create:e=>or({kind:"TupleNode",values:or(e)})}),fs=["varchar","char","text","integer","int2","int4","int8","smallint","bigint","boolean","real","double precision","float4","float8","decimal","numeric","binary","bytea","date","datetime","time","timetz","timestamp","timestamptz","serial","bigserial","uuid","json","jsonb","blob"],ys=[/^varchar\(\d+\)$/,/^char\(\d+\)$/,/^decimal\(\d+, \d+\)$/,/^numeric\(\d+, \d+\)$/,/^binary\(\d+\)$/,/^datetime\(\d+\)$/,/^time\(\d+\)$/,/^timez\(\d+\)$/,/^timestamp\(\d+\)$/,/^timestamptz\(\d+\)$/],gs=or({is:e=>"DataTypeNode"===e.kind,create:e=>or({kind:"DataTypeNode",dataType:e})});function ws(e){if(vr(e))return e.toOperationNode();if(function(e){return!!fs.includes(e)||!!ys.some((t=>t.test(e)))}(e))return gs.create(e);throw new Error(`invalid column data type ${JSON.stringify(e)}`)}const Ns=or({is:e=>"CastNode"===e.kind,create:(e,t)=>or({kind:"CastNode",expression:e,dataType:t})});function bs(e=Co){function t(e,t){return new Qo((n=e,r=t,is.create(Er.create(n),Vr(r))));var n,r}const n=Object.assign((function(e,t,n){return new Qo(ai(e,t,n))}),{fn:void 0,eb:void 0,selectFrom:t=>Ho({queryId:go(),executor:e,queryNode:Ai.createFrom(Os(t))}),case:e=>new ss({node:os.create(Hn(e)?void 0:Vr(e))}),ref:(e,t)=>Hn(t)?new Qo(zr(e)):new ps(function(e,t){const n=zr(e);if(Cr(t))return $r.create(n,Qr.create(Er.create(t)));const r=t.slice(0,-1);if(Cr(r))return $r.create(n,Jr.create(Er.create(r)));throw new Error(`Invalid JSON operator: ${t}`)}(e,t)),jsonPath:()=>new ps(Jr.create()),table:e=>new Qo(Is(e)),val:e=>new Qo(ni(e)),refTuple:(...e)=>new Qo(ms.create(e.map(Vr))),tuple:(...e)=>new Qo(ms.create(e.map(ni))),lit:e=>new Qo(ii(e)),unary:t,not:e=>t("not",e),exists:e=>t("exists",e),neg:e=>t("-",e),between:(e,t,n)=>new Qo(qr.create(Vr(e),Er.create("between"),kr.create(ni(t),ni(n)))),betweenSymmetric:(e,t,n)=>new Qo(qr.create(Vr(e),Er.create("between symmetric"),kr.create(ni(t),ni(n)))),and:e=>ar(e)?new Qo(li(e,"and")):new Qo(di(e,"and")),or:e=>ar(e)?new Qo(li(e,"or")):new Qo(di(e,"or")),parens(...e){const t=si(e);return oi.is(t)?new Qo(t):new Qo(oi.create(t))},cast:(e,t)=>new Qo(Ns.create(Vr(e),ws(t))),withSchema:t=>bs(e.withPluginAtFront(new xo(t)))});return n.fn=rs(),n.eb=n,n}function vs(e){return bs()}function xs(e){if(vr(e))return e.toOperationNode();if(rr(e))return e(vs()).toOperationNode();throw new Error(`invalid expression: ${JSON.stringify(e)}`)}function ks(e){if(vr(e))return e.toOperationNode();if(rr(e))return e(vs()).toOperationNode();throw new Error(`invalid aliased expression: ${JSON.stringify(e)}`)}function Ss(e){return function(e){return ir(e)&&"expressionType"in e&&vr(e)}(e)||function(e){return ir(e)&&"expression"in e&&Gn(e.alias)&&vr(e)}(e)||rr(e)}function Os(e){return ar(e)?e.map((e=>Ws(e))):[Ws(e)]}function Ws(e){return Gn(e)?qs(e):ks(e)}function qs(e){const t=" as ";if(e.includes(t)){const[n,r]=e.split(t).map(Ts);return Nr.create(Is(n),lr.create(r))}return Is(e)}function Is(e){if(e.includes(".")){const[t,n]=e.split(".").map(Ts);return br.createWithSchema(t,n)}return br.create(e)}function Ts(e){return e.trim()}const Es=or({is:e=>"AddColumnNode"===e.kind,create:e=>or({kind:"AddColumnNode",column:e})}),Cs=or({is:e=>"ColumnDefinitionNode"===e.kind,create:(e,t)=>or({kind:"ColumnDefinitionNode",column:Dr.create(e),dataType:t}),cloneWithFrontModifier:(e,t)=>or({...e,frontModifiers:e.frontModifiers?or([...e.frontModifiers,t]):[t]}),cloneWithEndModifier:(e,t)=>or({...e,endModifiers:e.endModifiers?or([...e.endModifiers,t]):[t]}),cloneWith:(e,t)=>or({...e,...t})}),Ds=or({is:e=>"DropColumnNode"===e.kind,create:e=>or({kind:"DropColumnNode",column:Dr.create(e)})}),Ps=or({is:e=>"RenameColumnNode"===e.kind,create:(e,t)=>or({kind:"RenameColumnNode",column:Dr.create(e),renameTo:Dr.create(t)})}),As=or({is:e=>"CheckConstraintNode"===e.kind,create:(e,t)=>or({kind:"CheckConstraintNode",expression:e,name:t?lr.create(t):void 0})}),Ms=["no action","restrict","cascade","set null","set default"],Ls=or({is:e=>"ReferencesNode"===e.kind,create:(e,t)=>or({kind:"ReferencesNode",table:e,columns:or([...t])}),cloneWithOnDelete:(e,t)=>or({...e,onDelete:t}),cloneWithOnUpdate:(e,t)=>or({...e,onUpdate:t})});function Bs(e){return vr(e)?e.toOperationNode():ti.createImmediate(e)}const Fs=or({is:e=>"GeneratedNode"===e.kind,create:e=>or({kind:"GeneratedNode",...e}),createWithExpression:e=>or({kind:"GeneratedNode",always:!0,expression:e}),cloneWith:(e,t)=>or({...e,...t})}),Rs=or({is:e=>"DefaultValueNode"===e.kind,create:e=>or({kind:"DefaultValueNode",defaultValue:e})});function js(e){if(Ms.includes(e))return e;throw new Error(`invalid OnModifyForeignAction ${e}`)}class Us{#v;constructor(e){this.#v=e}autoIncrement(){return new Us(Cs.cloneWith(this.#v,{autoIncrement:!0}))}identity(){return new Us(Cs.cloneWith(this.#v,{identity:!0}))}primaryKey(){return new Us(Cs.cloneWith(this.#v,{primaryKey:!0}))}references(e){const t=zr(e);if(!t.table||Pr.is(t.column))throw new Error(`invalid call references('${e}'). The reference must have format table.column or schema.table.column`);return new Us(Cs.cloneWith(this.#v,{references:Ls.create(t.table,[t.column])}))}onDelete(e){if(!this.#v.references)throw new Error("on delete constraint can only be added for foreign keys");return new Us(Cs.cloneWith(this.#v,{references:Ls.cloneWithOnDelete(this.#v.references,js(e))}))}onUpdate(e){if(!this.#v.references)throw new Error("on update constraint can only be added for foreign keys");return new Us(Cs.cloneWith(this.#v,{references:Ls.cloneWithOnUpdate(this.#v.references,js(e))}))}unique(){return new Us(Cs.cloneWith(this.#v,{unique:!0}))}notNull(){return new Us(Cs.cloneWith(this.#v,{notNull:!0}))}unsigned(){return new Us(Cs.cloneWith(this.#v,{unsigned:!0}))}defaultTo(e){return new Us(Cs.cloneWith(this.#v,{defaultTo:Rs.create(Bs(e))}))}check(e){return new Us(Cs.cloneWith(this.#v,{check:As.create(e.toOperationNode())}))}generatedAlwaysAs(e){return new Us(Cs.cloneWith(this.#v,{generated:Fs.createWithExpression(e.toOperationNode())}))}generatedAlwaysAsIdentity(){return new Us(Cs.cloneWith(this.#v,{generated:Fs.create({identity:!0,always:!0})}))}generatedByDefaultAsIdentity(){return new Us(Cs.cloneWith(this.#v,{generated:Fs.create({identity:!0,byDefault:!0})}))}stored(){if(!this.#v.generated)throw new Error("stored() can only be called after generatedAlwaysAs");return new Us(Cs.cloneWith(this.#v,{generated:Fs.cloneWith(this.#v.generated,{stored:!0})}))}modifyFront(e){return new Us(Cs.cloneWithFrontModifier(this.#v,e.toOperationNode()))}nullsNotDistinct(){return new Us(Cs.cloneWith(this.#v,{nullsNotDistinct:!0}))}modifyEnd(e){return new Us(Cs.cloneWithEndModifier(this.#v,e.toOperationNode()))}$call(e){return e(this)}toOperationNode(){return this.#v}}gi(Us,"don't await ColumnDefinitionBuilder instances directly.");const _s=or({is:e=>"ModifyColumnNode"===e.kind,create:e=>or({kind:"ModifyColumnNode",column:e})}),$s=or({is:e=>"ForeignKeyConstraintNode"===e.kind,create:(e,t,n,r)=>or({kind:"ForeignKeyConstraintNode",columns:e,references:Ls.create(t,n),name:r?lr.create(r):void 0}),cloneWith:(e,t)=>or({...e,...t})});class Qs{#v;constructor(e){this.#v=e}onDelete(e){return new Qs($s.cloneWith(this.#v,{onDelete:js(e)}))}onUpdate(e){return new Qs($s.cloneWith(this.#v,{onUpdate:js(e)}))}$call(e){return e(this)}toOperationNode(){return this.#v}}gi(Qs,"don't await ForeignKeyConstraintBuilder instances directly.");const Js=or({is:e=>"AddConstraintNode"===e.kind,create:e=>or({kind:"AddConstraintNode",constraint:e})}),Ks=or({is:e=>"UniqueConstraintNode"===e.kind,create:(e,t,n)=>or({kind:"UniqueConstraintNode",columns:or(e.map(Dr.create)),name:t?lr.create(t):void 0,nullsNotDistinct:n}),cloneWith:(e,t)=>or({...e,...t})}),Ys=or({is:e=>"DropConstraintNode"===e.kind,create:e=>or({kind:"DropConstraintNode",constraintName:lr.create(e)}),cloneWith:(e,t)=>or({...e,...t})}),Vs=or({is:e=>"AlterColumnNode"===e.kind,create:(e,t,n)=>or({kind:"AlterColumnNode",column:Dr.create(e),[t]:n})});class zs{#I;constructor(e){this.#I=e}setDataType(e){return new Xs(Vs.create(this.#I,"dataType",ws(e)))}setDefault(e){return new Xs(Vs.create(this.#I,"setDefault",Bs(e)))}dropDefault(){return new Xs(Vs.create(this.#I,"dropDefault",!0))}setNotNull(){return new Xs(Vs.create(this.#I,"setNotNull",!0))}dropNotNull(){return new Xs(Vs.create(this.#I,"dropNotNull",!0))}$call(e){return e(this)}}class Xs{#T;constructor(e){this.#T=e}toOperationNode(){return this.#T}}class Hs{#t;constructor(e){this.#t=or(e)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}gi(Hs,"don't await AlterTableExecutor instances directly. To execute the query you need to call `execute`");class Gs{#t;constructor(e){this.#t=or(e)}onDelete(e){return new Gs({...this.#t,constraintBuilder:this.#t.constraintBuilder.onDelete(e)})}onUpdate(e){return new Gs({...this.#t,constraintBuilder:this.#t.constraintBuilder.onUpdate(e)})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(dr.cloneWithTableProps(this.#t.node,{addConstraint:Js.create(this.#t.constraintBuilder.toOperationNode())}),this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}gi(Gs,"don't await AlterTableAddForeignKeyConstraintBuilder instances directly. To execute the query you need to call `execute`");class Zs{#t;constructor(e){this.#t=or(e)}ifExists(){return new Zs({...this.#t,node:dr.cloneWithTableProps(this.#t.node,{dropConstraint:Ys.cloneWith(this.#t.node.dropConstraint,{ifExists:!0})})})}cascade(){return new Zs({...this.#t,node:dr.cloneWithTableProps(this.#t.node,{dropConstraint:Ys.cloneWith(this.#t.node.dropConstraint,{modifier:"cascade"})})})}restrict(){return new Zs({...this.#t,node:dr.cloneWithTableProps(this.#t.node,{dropConstraint:Ys.cloneWith(this.#t.node.dropConstraint,{modifier:"restrict"})})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}gi(Zs,"don't await AlterTableDropConstraintBuilder instances directly. To execute the query you need to call `execute`");const ea=or({is:e=>"PrimaryKeyConstraintNode"===e.kind,create:(e,t)=>or({kind:"PrimaryKeyConstraintNode",columns:or(e.map(Dr.create)),name:t?lr.create(t):void 0})}),ta=or({is:e=>"AddIndexNode"===e.kind,create:e=>or({kind:"AddIndexNode",name:lr.create(e)}),cloneWith:(e,t)=>or({...e,...t}),cloneWithColumns:(e,t)=>or({...e,columns:[...e.columns||[],...t]})});class na{#t;constructor(e){this.#t=or(e)}unique(){return new na({...this.#t,node:dr.cloneWithTableProps(this.#t.node,{addIndex:ta.cloneWith(this.#t.node.addIndex,{unique:!0})})})}column(e){return new na({...this.#t,node:dr.cloneWithTableProps(this.#t.node,{addIndex:ta.cloneWithColumns(this.#t.node.addIndex,[Hr(e)])})})}columns(e){return new na({...this.#t,node:dr.cloneWithTableProps(this.#t.node,{addIndex:ta.cloneWithColumns(this.#t.node.addIndex,e.map(Hr))})})}expression(e){return new na({...this.#t,node:dr.cloneWithTableProps(this.#t.node,{addIndex:ta.cloneWithColumns(this.#t.node.addIndex,[e.toOperationNode()])})})}using(e){return new na({...this.#t,node:dr.cloneWithTableProps(this.#t.node,{addIndex:ta.cloneWith(this.#t.node.addIndex,{using:Fr.createWithSql(e)})})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}gi(na,"don't await AlterTableAddIndexBuilder instances directly. To execute the query you need to call `execute`");class ra{#v;constructor(e){this.#v=e}toOperationNode(){return this.#v}nullsNotDistinct(){return new ra(Ks.cloneWith(this.#v,{nullsNotDistinct:!0}))}}gi(ra,"don't await UniqueConstraintNodeBuilder instances directly.");class ia{#t;constructor(e){this.#t=or(e)}renameTo(e){return new Hs({...this.#t,node:dr.cloneWithTableProps(this.#t.node,{renameTo:Is(e)})})}setSchema(e){return new Hs({...this.#t,node:dr.cloneWithTableProps(this.#t.node,{setSchema:lr.create(e)})})}alterColumn(e,t){const n=t(new zs(e));return new oa({...this.#t,node:dr.cloneWithColumnAlteration(this.#t.node,n.toOperationNode())})}dropColumn(e){return new oa({...this.#t,node:dr.cloneWithColumnAlteration(this.#t.node,Ds.create(e))})}renameColumn(e,t){return new oa({...this.#t,node:dr.cloneWithColumnAlteration(this.#t.node,Ps.create(e,t))})}addColumn(e,t,n=cr){const r=n(new Us(Cs.create(e,ws(t))));return new oa({...this.#t,node:dr.cloneWithColumnAlteration(this.#t.node,Es.create(r.toOperationNode()))})}modifyColumn(e,t,n=cr){const r=n(new Us(Cs.create(e,ws(t))));return new oa({...this.#t,node:dr.cloneWithColumnAlteration(this.#t.node,_s.create(r.toOperationNode()))})}addUniqueConstraint(e,t,n=cr){const r=n(new ra(Ks.create(t,e)));return new Hs({...this.#t,node:dr.cloneWithTableProps(this.#t.node,{addConstraint:Js.create(r.toOperationNode())})})}addCheckConstraint(e,t){return new Hs({...this.#t,node:dr.cloneWithTableProps(this.#t.node,{addConstraint:Js.create(As.create(t.toOperationNode(),e))})})}addForeignKeyConstraint(e,t,n,r){return new Gs({...this.#t,constraintBuilder:new Qs($s.create(t.map(Dr.create),Is(n),r.map(Dr.create),e))})}addPrimaryKeyConstraint(e,t){return new Hs({...this.#t,node:dr.cloneWithTableProps(this.#t.node,{addConstraint:Js.create(ea.create(t,e))})})}dropConstraint(e){return new Zs({...this.#t,node:dr.cloneWithTableProps(this.#t.node,{dropConstraint:Ys.create(e)})})}addIndex(e){return new na({...this.#t,node:dr.cloneWithTableProps(this.#t.node,{addIndex:ta.create(e)})})}dropIndex(e){return new Hs({...this.#t,node:dr.cloneWithTableProps(this.#t.node,{dropIndex:yr.create(e)})})}$call(e){return e(this)}}class oa{#t;constructor(e){this.#t=or(e)}alterColumn(e,t){const n=t(new zs(e));return new oa({...this.#t,node:dr.cloneWithColumnAlteration(this.#t.node,n.toOperationNode())})}dropColumn(e){return new oa({...this.#t,node:dr.cloneWithColumnAlteration(this.#t.node,Ds.create(e))})}renameColumn(e,t){return new oa({...this.#t,node:dr.cloneWithColumnAlteration(this.#t.node,Ps.create(e,t))})}addColumn(e,t,n=cr){const r=n(new Us(Cs.create(e,ws(t))));return new oa({...this.#t,node:dr.cloneWithColumnAlteration(this.#t.node,Es.create(r.toOperationNode()))})}modifyColumn(e,t,n=cr){const r=n(new Us(Cs.create(e,ws(t))));return new oa({...this.#t,node:dr.cloneWithColumnAlteration(this.#t.node,_s.create(r.toOperationNode()))})}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}gi(ia,"don't await AlterTableBuilder instances"),gi(zs,"don't await AlterColumnBuilder instances"),gi(oa,"don't await AlterTableColumnAlteringBuilder instances directly. To execute the query you need to call `execute`");class sa extends No{transformValue(e){return{...super.transformValue(e),immediate:!0}}}class aa{#t;constructor(e){this.#t=or(e)}ifNotExists(){return new aa({...this.#t,node:pr.cloneWith(this.#t.node,{ifNotExists:!0})})}unique(){return new aa({...this.#t,node:pr.cloneWith(this.#t.node,{unique:!0})})}nullsNotDistinct(){return new aa({...this.#t,node:pr.cloneWith(this.#t.node,{nullsNotDistinct:!0})})}on(e){return new aa({...this.#t,node:pr.cloneWith(this.#t.node,{table:Is(e)})})}column(e){return new aa({...this.#t,node:pr.cloneWithColumns(this.#t.node,[Hr(e)])})}columns(e){return new aa({...this.#t,node:pr.cloneWithColumns(this.#t.node,e.map(Hr))})}expression(e){return new aa({...this.#t,node:pr.cloneWithColumns(this.#t.node,[e.toOperationNode()])})}using(e){return new aa({...this.#t,node:pr.cloneWith(this.#t.node,{using:Fr.createWithSql(e)})})}where(...e){const t=new sa;return new aa({...this.#t,node:$i.cloneWithWhere(this.#t.node,t.transformNode(si(e)))})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}gi(aa,"don't await CreateIndexBuilder instances directly. To execute the query you need to call `execute`");class ca{#t;constructor(e){this.#t=or(e)}ifNotExists(){return new ca({...this.#t,node:ur.cloneWith(this.#t.node,{ifNotExists:!0})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}function da(e){if(hr.includes(e))return e;throw new Error(`invalid OnCommitAction ${e}`)}gi(ca,"don't await CreateSchemaBuilder instances directly. To execute the query you need to call `execute`");class la{#t;constructor(e){this.#t=or(e)}temporary(){return new la({...this.#t,node:mr.cloneWith(this.#t.node,{temporary:!0})})}onCommit(e){return new la({...this.#t,node:mr.cloneWith(this.#t.node,{onCommit:da(e)})})}ifNotExists(){return new la({...this.#t,node:mr.cloneWith(this.#t.node,{ifNotExists:!0})})}addColumn(e,t,n=cr){const r=n(new Us(Cs.create(e,ws(t))));return new la({...this.#t,node:mr.cloneWithColumn(this.#t.node,r.toOperationNode())})}addPrimaryKeyConstraint(e,t){return new la({...this.#t,node:mr.cloneWithConstraint(this.#t.node,ea.create(t,e))})}addUniqueConstraint(e,t,n=cr){const r=n(new ra(Ks.create(t,e)));return new la({...this.#t,node:mr.cloneWithConstraint(this.#t.node,r.toOperationNode())})}addCheckConstraint(e,t){return new la({...this.#t,node:mr.cloneWithConstraint(this.#t.node,As.create(t.toOperationNode(),e))})}addForeignKeyConstraint(e,t,n,r,i=cr){const o=i(new Qs($s.create(t.map(Dr.create),Is(n),r.map(Dr.create),e)));return new la({...this.#t,node:mr.cloneWithConstraint(this.#t.node,o.toOperationNode())})}modifyFront(e){return new la({...this.#t,node:mr.cloneWithFrontModifier(this.#t.node,e.toOperationNode())})}modifyEnd(e){return new la({...this.#t,node:mr.cloneWithEndModifier(this.#t.node,e.toOperationNode())})}as(e){return new la({...this.#t,node:mr.cloneWith(this.#t.node,{selectQuery:xs(e)})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}gi(la,"don't await CreateTableBuilder instances directly. To execute the query you need to call `execute`");class pa{#t;constructor(e){this.#t=or(e)}on(e){return new pa({...this.#t,node:yr.cloneWith(this.#t.node,{table:Is(e)})})}ifExists(){return new pa({...this.#t,node:yr.cloneWith(this.#t.node,{ifExists:!0})})}cascade(){return new pa({...this.#t,node:yr.cloneWith(this.#t.node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}gi(pa,"don't await DropIndexBuilder instances directly. To execute the query you need to call `execute`");class ua{#t;constructor(e){this.#t=or(e)}ifExists(){return new ua({...this.#t,node:gr.cloneWith(this.#t.node,{ifExists:!0})})}cascade(){return new ua({...this.#t,node:gr.cloneWith(this.#t.node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}gi(ua,"don't await DropSchemaBuilder instances directly. To execute the query you need to call `execute`");class ha{#t;constructor(e){this.#t=or(e)}ifExists(){return new ha({...this.#t,node:wr.cloneWith(this.#t.node,{ifExists:!0})})}cascade(){return new ha({...this.#t,node:wr.cloneWith(this.#t.node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}gi(ha,"don't await DropTableBuilder instances directly. To execute the query you need to call `execute`");const ma=or({is:e=>"CreateViewNode"===e.kind,create:e=>or({kind:"CreateViewNode",name:fr.create(e)}),cloneWith:(e,t)=>or({...e,...t})});class fa{#h=new sa;transformQuery(e){return this.#h.transformNode(e.node)}transformResult(e){return Promise.resolve(e.result)}}class ya{#t;constructor(e){this.#t=or(e)}temporary(){return new ya({...this.#t,node:ma.cloneWith(this.#t.node,{temporary:!0})})}materialized(){return new ya({...this.#t,node:ma.cloneWith(this.#t.node,{materialized:!0})})}ifNotExists(){return new ya({...this.#t,node:ma.cloneWith(this.#t.node,{ifNotExists:!0})})}orReplace(){return new ya({...this.#t,node:ma.cloneWith(this.#t.node,{orReplace:!0})})}columns(e){return new ya({...this.#t,node:ma.cloneWith(this.#t.node,{columns:e.map(Xr)})})}as(e){const t=e.withPlugin(new fa).toOperationNode();return new ya({...this.#t,node:ma.cloneWith(this.#t.node,{as:t})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}gi(ya,"don't await CreateViewBuilder instances directly. To execute the query you need to call `execute`");const ga=or({is:e=>"DropViewNode"===e.kind,create:e=>or({kind:"DropViewNode",name:fr.create(e)}),cloneWith:(e,t)=>or({...e,...t})});class wa{#t;constructor(e){this.#t=or(e)}materialized(){return new wa({...this.#t,node:ga.cloneWith(this.#t.node,{materialized:!0})})}ifExists(){return new wa({...this.#t,node:ga.cloneWith(this.#t.node,{ifExists:!0})})}cascade(){return new wa({...this.#t,node:ga.cloneWith(this.#t.node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}gi(wa,"don't await DropViewBuilder instances directly. To execute the query you need to call `execute`");const Na=or({is:e=>"CreateTypeNode"===e.kind,create:e=>or({kind:"CreateTypeNode",name:e}),cloneWithEnum:(e,t)=>or({...e,enum:ei.create(t.map((e=>ti.createImmediate(e))))})});class ba{#t;constructor(e){this.#t=or(e)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}asEnum(e){return new ba({...this.#t,node:Na.cloneWithEnum(this.#t.node,e)})}$call(e){return e(this)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}gi(ba,"don't await CreateTypeBuilder instances directly. To execute the query you need to call `execute`");const va=or({is:e=>"DropTypeNode"===e.kind,create:e=>or({kind:"DropTypeNode",name:e}),cloneWith:(e,t)=>or({...e,...t})});class xa{#t;constructor(e){this.#t=or(e)}ifExists(){return new xa({...this.#t,node:va.cloneWith(this.#t.node,{ifExists:!0})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}function ka(e){if(e.includes(".")){const t=e.split(".").map(Sa);if(2===t.length)return fr.createWithSchema(t[0],t[1]);throw new Error(`invalid schemable identifier ${e}`)}return fr.create(e)}function Sa(e){return e.trim()}gi(xa,"don't await DropTypeBuilder instances directly. To execute the query you need to call `execute`");class Oa{#E;constructor(e){this.#E=e}createTable(e){return new la({queryId:go(),executor:this.#E,node:mr.create(Is(e))})}dropTable(e){return new ha({queryId:go(),executor:this.#E,node:wr.create(Is(e))})}createIndex(e){return new aa({queryId:go(),executor:this.#E,node:pr.create(e)})}dropIndex(e){return new pa({queryId:go(),executor:this.#E,node:yr.create(e)})}createSchema(e){return new ca({queryId:go(),executor:this.#E,node:ur.create(e)})}dropSchema(e){return new ua({queryId:go(),executor:this.#E,node:gr.create(e)})}alterTable(e){return new ia({queryId:go(),executor:this.#E,node:dr.create(Is(e))})}createView(e){return new ya({queryId:go(),executor:this.#E,node:ma.create(e)})}dropView(e){return new wa({queryId:go(),executor:this.#E,node:ga.create(e)})}createType(e){return new ba({queryId:go(),executor:this.#E,node:Na.create(ka(e))})}dropType(e){return new xa({queryId:go(),executor:this.#E,node:va.create(ka(e))})}withPlugin(e){return new Oa(this.#E.withPlugin(e))}withoutPlugins(){return new Oa(this.#E.withoutPlugins())}withSchema(e){return new Oa(this.#E.withPluginAtFront(new xo(e)))}}class Wa{ref(e){return new Mr(e)}}class qa{#C;constructor(e){this.#C=e}async provideConnection(e){const t=await this.#C.acquireConnection();try{return await e(t)}finally{await this.#C.releaseConnection(t)}}}class Ia extends To{#D;#P;#A;constructor(e,t,n,r=[]){super(r),this.#D=e,this.#P=t,this.#A=n}get adapter(){return this.#P}compileQuery(e){return this.#D.compileQuery(e)}provideConnection(e){return this.#A.provideConnection(e)}withPlugins(e){return new Ia(this.#D,this.#P,this.#A,[...this.plugins,...e])}withPlugin(e){return new Ia(this.#D,this.#P,this.#A,[...this.plugins,e])}withPluginAtFront(e){return new Ia(this.#D,this.#P,this.#A,[e,...this.plugins])}withConnectionProvider(e){return new Ia(this.#D,this.#P,e,[...this.plugins])}withoutPlugins(){return new Ia(this.#D,this.#P,this.#A,[])}}function Ta(){return"undefined"!=typeof performance&&rr(performance.now)?performance.now():Date.now()}class Ea{#C;#M;#L;#B;#F;#R=new WeakSet;constructor(e,t){this.#B=!1,this.#C=e,this.#M=t}async init(){if(this.#F)throw new Error("driver has already been destroyed");this.#L||(this.#L=this.#C.init().then((()=>{this.#B=!0})).catch((e=>(this.#L=void 0,Promise.reject(e))))),await this.#L}async acquireConnection(){if(this.#F)throw new Error("driver has already been destroyed");this.#B||await this.init();const e=await this.#C.acquireConnection();return this.#R.has(e)||(this.#j()&&this.#U(e),this.#R.add(e)),e}async releaseConnection(e){await this.#C.releaseConnection(e)}beginTransaction(e,t){return this.#C.beginTransaction(e,t)}commitTransaction(e){return this.#C.commitTransaction(e)}rollbackTransaction(e){return this.#C.rollbackTransaction(e)}async destroy(){this.#L&&(await this.#L,this.#F||(this.#F=this.#C.destroy().catch((e=>(this.#F=void 0,Promise.reject(e))))),await this.#F)}#j(){return this.#M.isLevelEnabled("query")||this.#M.isLevelEnabled("error")}#U(e){const t=e.executeQuery;e.executeQuery=async n=>{let r;const i=Ta();try{return await t.call(e,n)}catch(e){throw r=e,await this.#_(e,n,i),e}finally{r||await this.#$(n,i)}}}async#_(e,t,n){await this.#M.error((()=>({level:"error",error:e,query:t,queryDurationMillis:this.#Q(n)})))}async#$(e,t){await this.#M.query((()=>({level:"query",query:e,queryDurationMillis:this.#Q(t)})))}#Q(e){return Ta()-e}}const Ca=()=>{};class Da{#J;#K;constructor(e){this.#J=e}async provideConnection(e){for(;this.#K;)await this.#K.catch(Ca);return this.#K=this.#Y(e).finally((()=>{this.#K=void 0})),this.#K}async#Y(e){return await e(this.#J)}}const Pa=["read uncommitted","read committed","repeatable read","serializable","snapshot"];or(["query","error"]);class Aa{#V;#z;constructor(e){rr(e)?(this.#z=e,this.#V=or({query:!0,error:!0})):(this.#z=Ma,this.#V=or({query:e.includes("query"),error:e.includes("error")}))}isLevelEnabled(e){return this.#V[e]}async query(e){this.#V.query&&await this.#z(e())}async error(e){this.#V.error&&await this.#z(e())}}function Ma(e){"query"===e.level?(console.log(`kysely:query: ${e.query.sql}`),console.log(`kysely:query: duration: ${e.queryDurationMillis.toFixed(1)}ms`)):"error"===e.level&&(e.error instanceof Error?console.error(`kysely:error: ${e.error.stack??e.error.message}`):console.error(`kysely:error: ${JSON.stringify({error:e.error,query:e.query.sql,queryDurationMillis:e.queryDurationMillis})}`))}class La extends Bo{#t;constructor(e){let t,n;if(ir(r=e)&&ir(r.config)&&ir(r.driver)&&ir(r.executor)&&ir(r.dialect))t={executor:e.executor},n={...e};else{const r=e.dialect,i=r.createDriver(),o=r.createQueryCompiler(),s=r.createAdapter(),a=new Aa(e.log??[]),c=new Ea(i,a),d=new qa(c),l=new Ia(o,s,d,e.plugins??[]);t={executor:l},n={config:e,executor:l,dialect:r,driver:c}}var r;super(t),this.#t=or(n)}get schema(){return new Oa(this.#t.executor)}get dynamic(){return new Wa}get introspection(){return this.#t.dialect.createIntrospector(this.withoutPlugins())}case(e){return new ss({node:os.create(Hn(e)?void 0:xs(e))})}get fn(){return rs()}transaction(){return new Ra({...this.#t})}connection(){return new Fa({...this.#t})}withPlugin(e){return new La({...this.#t,executor:this.#t.executor.withPlugin(e)})}withoutPlugins(){return new La({...this.#t,executor:this.#t.executor.withoutPlugins()})}withSchema(e){return new La({...this.#t,executor:this.#t.executor.withPluginAtFront(new xo(e))})}withTables(){return new La({...this.#t})}async destroy(){await this.#t.driver.destroy()}get isTransaction(){return!1}getExecutor(){return this.#t.executor}executeQuery(e,t=go()){const n=ir(r=e)&&rr(r.compile)?e.compile():e;var r;return this.getExecutor().executeQuery(n,t)}}class Ba extends La{#t;constructor(e){super(e),this.#t=e}get isTransaction(){return!0}transaction(){throw new Error("calling the transaction method for a Transaction is not supported")}connection(){throw new Error("calling the connection method for a Transaction is not supported")}async destroy(){throw new Error("calling the destroy method for a Transaction is not supported")}withPlugin(e){return new Ba({...this.#t,executor:this.#t.executor.withPlugin(e)})}withoutPlugins(){return new Ba({...this.#t,executor:this.#t.executor.withoutPlugins()})}withSchema(e){return new Ba({...this.#t,executor:this.#t.executor.withPluginAtFront(new xo(e))})}withTables(){return new Ba({...this.#t})}}class Fa{#t;constructor(e){this.#t=or(e)}async execute(e){return this.#t.executor.provideConnection((async t=>{const n=this.#t.executor.withConnectionProvider(new Da(t)),r=new La({...this.#t,executor:n});return await e(r)}))}}gi(Fa,"don't await ConnectionBuilder instances directly. To execute the query you need to call the `execute` method");class Ra{#t;constructor(e){this.#t=or(e)}setIsolationLevel(e){return new Ra({...this.#t,isolationLevel:e})}async execute(e){const{isolationLevel:t,...n}=this.#t,r={isolationLevel:t};return function(e){if(e.isolationLevel&&!Pa.includes(e.isolationLevel))throw new Error(`invalid transaction isolation level ${e.isolationLevel}`)}(r),this.#t.executor.provideConnection((async t=>{const i=this.#t.executor.withConnectionProvider(new Da(t)),o=new Ba({...n,executor:i});try{await this.#t.driver.beginTransaction(t,r);const n=await e(o);return await this.#t.driver.commitTransaction(t),n}catch(e){throw await this.#t.driver.rollbackTransaction(t),e}}))}}gi(Ra,"don't await TransactionBuilder instances directly. To execute the transaction you need to call the `execute` method");class ja{get supportsCreateIfNotExists(){return!0}get supportsTransactionalDdl(){return!1}get supportsReturning(){return!1}}class Ua extends ja{get supportsTransactionalDdl(){return!1}get supportsReturning(){return!0}async acquireMigrationLock(e,t){}async releaseMigrationLock(e,t){}}class _a{async init(){}async acquireConnection(){return new $a}async beginTransaction(){}async commitTransaction(){}async rollbackTransaction(){}async releaseConnection(){}async destroy(){}}class $a{async executeQuery(){return{rows:[]}}async*streamQuery(){}}class Qa{nodeStack=[];get parentNode(){return this.nodeStack[this.nodeStack.length-2]}#X=or({AliasNode:this.visitAlias.bind(this),ColumnNode:this.visitColumn.bind(this),IdentifierNode:this.visitIdentifier.bind(this),SchemableIdentifierNode:this.visitSchemableIdentifier.bind(this),RawNode:this.visitRaw.bind(this),ReferenceNode:this.visitReference.bind(this),SelectQueryNode:this.visitSelectQuery.bind(this),SelectionNode:this.visitSelection.bind(this),TableNode:this.visitTable.bind(this),FromNode:this.visitFrom.bind(this),SelectAllNode:this.visitSelectAll.bind(this),AndNode:this.visitAnd.bind(this),OrNode:this.visitOr.bind(this),ValueNode:this.visitValue.bind(this),ValueListNode:this.visitValueList.bind(this),PrimitiveValueListNode:this.visitPrimitiveValueList.bind(this),ParensNode:this.visitParens.bind(this),JoinNode:this.visitJoin.bind(this),OperatorNode:this.visitOperator.bind(this),WhereNode:this.visitWhere.bind(this),InsertQueryNode:this.visitInsertQuery.bind(this),DeleteQueryNode:this.visitDeleteQuery.bind(this),ReturningNode:this.visitReturning.bind(this),CreateTableNode:this.visitCreateTable.bind(this),AddColumnNode:this.visitAddColumn.bind(this),ColumnDefinitionNode:this.visitColumnDefinition.bind(this),DropTableNode:this.visitDropTable.bind(this),DataTypeNode:this.visitDataType.bind(this),OrderByNode:this.visitOrderBy.bind(this),OrderByItemNode:this.visitOrderByItem.bind(this),GroupByNode:this.visitGroupBy.bind(this),GroupByItemNode:this.visitGroupByItem.bind(this),UpdateQueryNode:this.visitUpdateQuery.bind(this),ColumnUpdateNode:this.visitColumnUpdate.bind(this),LimitNode:this.visitLimit.bind(this),OffsetNode:this.visitOffset.bind(this),OnConflictNode:this.visitOnConflict.bind(this),OnDuplicateKeyNode:this.visitOnDuplicateKey.bind(this),CreateIndexNode:this.visitCreateIndex.bind(this),DropIndexNode:this.visitDropIndex.bind(this),ListNode:this.visitList.bind(this),PrimaryKeyConstraintNode:this.visitPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.visitUniqueConstraint.bind(this),ReferencesNode:this.visitReferences.bind(this),CheckConstraintNode:this.visitCheckConstraint.bind(this),WithNode:this.visitWith.bind(this),CommonTableExpressionNode:this.visitCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.visitCommonTableExpressionName.bind(this),HavingNode:this.visitHaving.bind(this),CreateSchemaNode:this.visitCreateSchema.bind(this),DropSchemaNode:this.visitDropSchema.bind(this),AlterTableNode:this.visitAlterTable.bind(this),DropColumnNode:this.visitDropColumn.bind(this),RenameColumnNode:this.visitRenameColumn.bind(this),AlterColumnNode:this.visitAlterColumn.bind(this),ModifyColumnNode:this.visitModifyColumn.bind(this),AddConstraintNode:this.visitAddConstraint.bind(this),DropConstraintNode:this.visitDropConstraint.bind(this),ForeignKeyConstraintNode:this.visitForeignKeyConstraint.bind(this),CreateViewNode:this.visitCreateView.bind(this),DropViewNode:this.visitDropView.bind(this),GeneratedNode:this.visitGenerated.bind(this),DefaultValueNode:this.visitDefaultValue.bind(this),OnNode:this.visitOn.bind(this),ValuesNode:this.visitValues.bind(this),SelectModifierNode:this.visitSelectModifier.bind(this),CreateTypeNode:this.visitCreateType.bind(this),DropTypeNode:this.visitDropType.bind(this),ExplainNode:this.visitExplain.bind(this),DefaultInsertValueNode:this.visitDefaultInsertValue.bind(this),AggregateFunctionNode:this.visitAggregateFunction.bind(this),OverNode:this.visitOver.bind(this),PartitionByNode:this.visitPartitionBy.bind(this),PartitionByItemNode:this.visitPartitionByItem.bind(this),SetOperationNode:this.visitSetOperation.bind(this),BinaryOperationNode:this.visitBinaryOperation.bind(this),UnaryOperationNode:this.visitUnaryOperation.bind(this),UsingNode:this.visitUsing.bind(this),FunctionNode:this.visitFunction.bind(this),CaseNode:this.visitCase.bind(this),WhenNode:this.visitWhen.bind(this),JSONReferenceNode:this.visitJSONReference.bind(this),JSONPathNode:this.visitJSONPath.bind(this),JSONPathLegNode:this.visitJSONPathLeg.bind(this),JSONOperatorChainNode:this.visitJSONOperatorChain.bind(this),TupleNode:this.visitTuple.bind(this),MergeQueryNode:this.visitMergeQuery.bind(this),MatchedNode:this.visitMatched.bind(this),AddIndexNode:this.visitAddIndex.bind(this),CastNode:this.visitCast.bind(this),FetchNode:this.visitFetch.bind(this),TopNode:this.visitTop.bind(this)});visitNode=e=>{this.nodeStack.push(e),this.#X[e.kind](e),this.nodeStack.pop()}}class Ja extends Qa{#H="";#G=[];get numParameters(){return this.#G.length}compileQuery(e){return this.#H="",this.#G=[],this.visitNode(e),or({query:e,sql:this.getSql(),parameters:[...this.#G]})}getSql(){return this.#H}visitSelectQuery(e){const t=!(void 0===this.parentNode||oi.is(this.parentNode)||Ei.is(this.parentNode)||mr.is(this.parentNode)||ma.is(this.parentNode)||_o.is(this.parentNode));void 0===this.parentNode&&e.explain&&(this.visitNode(e.explain),this.append(" ")),t&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append("select"),e.distinctOn&&(this.append(" "),this.compileDistinctOn(e.distinctOn)),e.frontModifiers?.length&&(this.append(" "),this.compileList(e.frontModifiers," ")),e.top&&(this.append(" "),this.visitNode(e.top)),e.selections&&(this.append(" "),this.compileList(e.selections)),e.from&&(this.append(" "),this.visitNode(e.from)),e.joins&&(this.append(" "),this.compileList(e.joins," ")),e.where&&(this.append(" "),this.visitNode(e.where)),e.groupBy&&(this.append(" "),this.visitNode(e.groupBy)),e.having&&(this.append(" "),this.visitNode(e.having)),e.setOperations&&(this.append(" "),this.compileList(e.setOperations," ")),e.orderBy&&(this.append(" "),this.visitNode(e.orderBy)),e.limit&&(this.append(" "),this.visitNode(e.limit)),e.offset&&(this.append(" "),this.visitNode(e.offset)),e.fetch&&(this.append(" "),this.visitNode(e.fetch)),e.endModifiers?.length&&(this.append(" "),this.compileList(this.sortSelectModifiers([...e.endModifiers])," ")),t&&this.append(")")}visitFrom(e){this.append("from "),this.compileList(e.froms)}visitSelection(e){this.visitNode(e.selection)}visitColumn(e){this.visitNode(e.column)}compileDistinctOn(e){this.append("distinct on ("),this.compileList(e),this.append(")")}compileList(e,t=", "){const n=e.length-1;for(let r=0;r<=n;r++)this.visitNode(e[r]),r<n&&this.append(t)}visitWhere(e){this.append("where "),this.visitNode(e.where)}visitHaving(e){this.append("having "),this.visitNode(e.having)}visitInsertQuery(e){const t=this.nodeStack.find($i.is),n=t!==e;!n&&e.explain&&(this.visitNode(e.explain),this.append(" ")),n&&!_i.is(t)&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append(e.replace?"replace":"insert"),e.ignore&&this.append(" ignore"),e.top&&(this.append(" "),this.visitNode(e.top)),e.into&&(this.append(" into "),this.visitNode(e.into)),e.columns&&(this.append(" ("),this.compileList(e.columns),this.append(")")),e.values&&(this.append(" "),this.visitNode(e.values)),e.defaultValues&&(this.append(" "),this.append("default values")),e.onConflict&&(this.append(" "),this.visitNode(e.onConflict)),e.onDuplicateKey&&(this.append(" "),this.visitNode(e.onDuplicateKey)),e.returning&&(this.append(" "),this.visitNode(e.returning)),n&&!_i.is(t)&&this.append(")")}visitValues(e){this.append("values "),this.compileList(e.values)}visitDeleteQuery(e){const t=this.nodeStack.find($i.is)!==e;!t&&e.explain&&(this.visitNode(e.explain),this.append(" ")),t&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append("delete "),e.top&&(this.visitNode(e.top),this.append(" ")),this.visitNode(e.from),e.using&&(this.append(" "),this.visitNode(e.using)),e.joins&&(this.append(" "),this.compileList(e.joins," ")),e.where&&(this.append(" "),this.visitNode(e.where)),e.orderBy&&(this.append(" "),this.visitNode(e.orderBy)),e.limit&&(this.append(" "),this.visitNode(e.limit)),e.returning&&(this.append(" "),this.visitNode(e.returning)),t&&this.append(")")}visitReturning(e){this.append("returning "),this.compileList(e.selections)}visitAlias(e){this.visitNode(e.node),this.append(" as "),this.visitNode(e.alias)}visitReference(e){e.table&&(this.visitNode(e.table),this.append(".")),this.visitNode(e.column)}visitSelectAll(e){this.append("*")}visitIdentifier(e){this.append(this.getLeftIdentifierWrapper()),this.compileUnwrappedIdentifier(e),this.append(this.getRightIdentifierWrapper())}compileUnwrappedIdentifier(e){if(!Gn(e.name))throw new Error("a non-string identifier was passed to compileUnwrappedIdentifier.");this.append(this.sanitizeIdentifier(e.name))}visitAnd(e){this.visitNode(e.left),this.append(" and "),this.visitNode(e.right)}visitOr(e){this.visitNode(e.left),this.append(" or "),this.visitNode(e.right)}visitValue(e){e.immediate?this.appendImmediateValue(e.value):this.appendValue(e.value)}visitValueList(e){this.append("("),this.compileList(e.values),this.append(")")}visitTuple(e){this.append("("),this.compileList(e.values),this.append(")")}visitPrimitiveValueList(e){this.append("(");const{values:t}=e;for(let e=0;e<t.length;++e)this.appendValue(t[e]),e!==t.length-1&&this.append(", ");this.append(")")}visitParens(e){this.append("("),this.visitNode(e.node),this.append(")")}visitJoin(e){this.append(Va[e.joinType]),this.append(" "),this.visitNode(e.table),e.on&&(this.append(" "),this.visitNode(e.on))}visitOn(e){this.append("on "),this.visitNode(e.on)}visitRaw(e){const{sqlFragments:t,parameters:n}=e;for(let e=0;e<t.length;++e)this.append(t[e]),n.length>e&&this.visitNode(n[e])}visitOperator(e){this.append(e.operator)}visitTable(e){this.visitNode(e.table)}visitSchemableIdentifier(e){e.schema&&(this.visitNode(e.schema),this.append(".")),this.visitNode(e.identifier)}visitCreateTable(e){this.append("create "),e.frontModifiers&&e.frontModifiers.length>0&&(this.compileList(e.frontModifiers," "),this.append(" ")),e.temporary&&this.append("temporary "),this.append("table "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.table),e.selectQuery?(this.append(" as "),this.visitNode(e.selectQuery)):(this.append(" ("),this.compileList([...e.columns,...e.constraints??[]]),this.append(")"),e.onCommit&&(this.append(" on commit "),this.append(e.onCommit)),e.endModifiers&&e.endModifiers.length>0&&(this.append(" "),this.compileList(e.endModifiers," ")))}visitColumnDefinition(e){this.visitNode(e.column),this.append(" "),this.visitNode(e.dataType),e.unsigned&&this.append(" unsigned"),e.frontModifiers&&e.frontModifiers.length>0&&(this.append(" "),this.compileList(e.frontModifiers," ")),e.generated&&(this.append(" "),this.visitNode(e.generated)),e.identity&&this.append(" identity"),e.defaultTo&&(this.append(" "),this.visitNode(e.defaultTo)),e.notNull&&this.append(" not null"),e.unique&&this.append(" unique"),e.nullsNotDistinct&&this.append(" nulls not distinct"),e.primaryKey&&this.append(" primary key"),e.autoIncrement&&(this.append(" "),this.append(this.getAutoIncrement())),e.references&&(this.append(" "),this.visitNode(e.references)),e.check&&(this.append(" "),this.visitNode(e.check)),e.endModifiers&&e.endModifiers.length>0&&(this.append(" "),this.compileList(e.endModifiers," "))}getAutoIncrement(){return"auto_increment"}visitReferences(e){this.append("references "),this.visitNode(e.table),this.append(" ("),this.compileList(e.columns),this.append(")"),e.onDelete&&(this.append(" on delete "),this.append(e.onDelete)),e.onUpdate&&(this.append(" on update "),this.append(e.onUpdate))}visitDropTable(e){this.append("drop table "),e.ifExists&&this.append("if exists "),this.visitNode(e.table),e.cascade&&this.append(" cascade")}visitDataType(e){this.append(e.dataType)}visitOrderBy(e){this.append("order by "),this.compileList(e.items)}visitOrderByItem(e){this.visitNode(e.orderBy),e.direction&&(this.append(" "),this.visitNode(e.direction))}visitGroupBy(e){this.append("group by "),this.compileList(e.items)}visitGroupByItem(e){this.visitNode(e.groupBy)}visitUpdateQuery(e){const t=this.nodeStack.find($i.is),n=t!==e;!n&&e.explain&&(this.visitNode(e.explain),this.append(" ")),n&&!_i.is(t)&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append("update "),e.top&&(this.visitNode(e.top),this.append(" ")),e.table&&(this.visitNode(e.table),this.append(" ")),this.append("set "),e.updates&&this.compileList(e.updates),e.from&&(this.append(" "),this.visitNode(e.from)),e.joins&&(this.append(" "),this.compileList(e.joins," ")),e.where&&(this.append(" "),this.visitNode(e.where)),e.limit&&(this.append(" "),this.visitNode(e.limit)),e.returning&&(this.append(" "),this.visitNode(e.returning)),n&&!_i.is(t)&&this.append(")")}visitColumnUpdate(e){this.visitNode(e.column),this.append(" = "),this.visitNode(e.value)}visitLimit(e){this.append("limit "),this.visitNode(e.limit)}visitOffset(e){this.append("offset "),this.visitNode(e.offset)}visitOnConflict(e){this.append("on conflict"),e.columns?(this.append(" ("),this.compileList(e.columns),this.append(")")):e.constraint?(this.append(" on constraint "),this.visitNode(e.constraint)):e.indexExpression&&(this.append(" ("),this.visitNode(e.indexExpression),this.append(")")),e.indexWhere&&(this.append(" "),this.visitNode(e.indexWhere)),!0===e.doNothing?this.append(" do nothing"):e.updates&&(this.append(" do update set "),this.compileList(e.updates),e.updateWhere&&(this.append(" "),this.visitNode(e.updateWhere)))}visitOnDuplicateKey(e){this.append("on duplicate key update "),this.compileList(e.updates)}visitCreateIndex(e){this.append("create "),e.unique&&this.append("unique "),this.append("index "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.name),e.table&&(this.append(" on "),this.visitNode(e.table)),e.using&&(this.append(" using "),this.visitNode(e.using)),e.columns&&(this.append(" ("),this.compileList(e.columns),this.append(")")),e.nullsNotDistinct&&this.append(" nulls not distinct"),e.where&&(this.append(" "),this.visitNode(e.where))}visitDropIndex(e){this.append("drop index "),e.ifExists&&this.append("if exists "),this.visitNode(e.name),e.table&&(this.append(" on "),this.visitNode(e.table)),e.cascade&&this.append(" cascade")}visitCreateSchema(e){this.append("create schema "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.schema)}visitDropSchema(e){this.append("drop schema "),e.ifExists&&this.append("if exists "),this.visitNode(e.schema),e.cascade&&this.append(" cascade")}visitPrimaryKeyConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("primary key ("),this.compileList(e.columns),this.append(")")}visitUniqueConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("unique"),e.nullsNotDistinct&&this.append(" nulls not distinct"),this.append(" ("),this.compileList(e.columns),this.append(")")}visitCheckConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("check ("),this.visitNode(e.expression),this.append(")")}visitForeignKeyConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("foreign key ("),this.compileList(e.columns),this.append(") "),this.visitNode(e.references),e.onDelete&&(this.append(" on delete "),this.append(e.onDelete)),e.onUpdate&&(this.append(" on update "),this.append(e.onUpdate))}visitList(e){this.compileList(e.items)}visitWith(e){this.append("with "),e.recursive&&this.append("recursive "),this.compileList(e.expressions)}visitCommonTableExpression(e){this.visitNode(e.name),this.append(" as "),er(e.materialized)&&(e.materialized||this.append("not "),this.append("materialized ")),this.visitNode(e.expression)}visitCommonTableExpressionName(e){this.visitNode(e.table),e.columns&&(this.append("("),this.compileList(e.columns),this.append(")"))}visitAlterTable(e){this.append("alter table "),this.visitNode(e.table),this.append(" "),e.renameTo&&(this.append("rename to "),this.visitNode(e.renameTo)),e.setSchema&&(this.append("set schema "),this.visitNode(e.setSchema)),e.addConstraint&&this.visitNode(e.addConstraint),e.dropConstraint&&this.visitNode(e.dropConstraint),e.columnAlterations&&this.compileColumnAlterations(e.columnAlterations),e.addIndex&&this.visitNode(e.addIndex),e.dropIndex&&this.visitNode(e.dropIndex)}visitAddColumn(e){this.append("add column "),this.visitNode(e.column)}visitRenameColumn(e){this.append("rename column "),this.visitNode(e.column),this.append(" to "),this.visitNode(e.renameTo)}visitDropColumn(e){this.append("drop column "),this.visitNode(e.column)}visitAlterColumn(e){this.append("alter column "),this.visitNode(e.column),this.append(" "),e.dataType&&(this.announcesNewColumnDataType()&&this.append("type "),this.visitNode(e.dataType),e.dataTypeExpression&&(this.append("using "),this.visitNode(e.dataTypeExpression))),e.setDefault&&(this.append("set default "),this.visitNode(e.setDefault)),e.dropDefault&&this.append("drop default"),e.setNotNull&&this.append("set not null"),e.dropNotNull&&this.append("drop not null")}visitModifyColumn(e){this.append("modify column "),this.visitNode(e.column)}visitAddConstraint(e){this.append("add "),this.visitNode(e.constraint)}visitDropConstraint(e){this.append("drop constraint "),e.ifExists&&this.append("if exists "),this.visitNode(e.constraintName),"cascade"===e.modifier?this.append(" cascade"):"restrict"===e.modifier&&this.append(" restrict")}visitSetOperation(e){this.append(e.operator),this.append(" "),e.all&&this.append("all "),this.visitNode(e.expression)}visitCreateView(e){this.append("create "),e.orReplace&&this.append("or replace "),e.materialized&&this.append("materialized "),e.temporary&&this.append("temporary "),this.append("view "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.name),this.append(" "),e.columns&&(this.append("("),this.compileList(e.columns),this.append(") ")),e.as&&(this.append("as "),this.visitNode(e.as))}visitDropView(e){this.append("drop "),e.materialized&&this.append("materialized "),this.append("view "),e.ifExists&&this.append("if exists "),this.visitNode(e.name),e.cascade&&this.append(" cascade")}visitGenerated(e){this.append("generated "),e.always&&this.append("always "),e.byDefault&&this.append("by default "),this.append("as "),e.identity&&this.append("identity"),e.expression&&(this.append("("),this.visitNode(e.expression),this.append(")")),e.stored&&this.append(" stored")}visitDefaultValue(e){this.append("default "),this.visitNode(e.defaultValue)}visitSelectModifier(e){e.rawModifier?this.visitNode(e.rawModifier):this.append(Ka[e.modifier]),e.of&&(this.append(" of "),this.compileList(e.of,", "))}visitCreateType(e){this.append("create type "),this.visitNode(e.name),e.enum&&(this.append(" as enum "),this.visitNode(e.enum))}visitDropType(e){this.append("drop type "),e.ifExists&&this.append("if exists "),this.visitNode(e.name)}visitExplain(e){this.append("explain"),(e.options||e.format)&&(this.append(" "),this.append(this.getLeftExplainOptionsWrapper()),e.options&&(this.visitNode(e.options),e.format&&this.append(this.getExplainOptionsDelimiter())),e.format&&(this.append("format"),this.append(this.getExplainOptionAssignment()),this.append(e.format)),this.append(this.getRightExplainOptionsWrapper()))}visitDefaultInsertValue(e){this.append("default")}visitAggregateFunction(e){this.append(e.func),this.append("("),e.distinct&&this.append("distinct "),this.compileList(e.aggregated),this.append(")"),e.filter&&(this.append(" filter("),this.visitNode(e.filter),this.append(")")),e.over&&(this.append(" "),this.visitNode(e.over))}visitOver(e){this.append("over("),e.partitionBy&&(this.visitNode(e.partitionBy),e.orderBy&&this.append(" ")),e.orderBy&&this.visitNode(e.orderBy),this.append(")")}visitPartitionBy(e){this.append("partition by "),this.compileList(e.items)}visitPartitionByItem(e){this.visitNode(e.partitionBy)}visitBinaryOperation(e){this.visitNode(e.leftOperand),this.append(" "),this.visitNode(e.operator),this.append(" "),this.visitNode(e.rightOperand)}visitUnaryOperation(e){this.visitNode(e.operator),this.isMinusOperator(e.operator)||this.append(" "),this.visitNode(e.operand)}isMinusOperator(e){return Er.is(e)&&"-"===e.operator}visitUsing(e){this.append("using "),this.compileList(e.tables)}visitFunction(e){this.append(e.func),this.append("("),this.compileList(e.arguments),this.append(")")}visitCase(e){this.append("case"),e.value&&(this.append(" "),this.visitNode(e.value)),e.when&&(this.append(" "),this.compileList(e.when," ")),e.else&&(this.append(" else "),this.visitNode(e.else)),this.append(" end"),e.isStatement&&this.append(" case")}visitWhen(e){this.append("when "),this.visitNode(e.condition),e.result&&(this.append(" then "),this.visitNode(e.result))}visitJSONReference(e){this.visitNode(e.reference),this.visitNode(e.traversal)}visitJSONPath(e){e.inOperator&&this.visitNode(e.inOperator),this.append("'$");for(const t of e.pathLegs)this.visitNode(t);this.append("'")}visitJSONPathLeg(e){const t="ArrayLocation"===e.type;this.append(t?"[":"."),this.append(String(e.value)),t&&this.append("]")}visitJSONOperatorChain(e){for(let t=0,n=e.values.length;t<n;t++)t===n-1?this.visitNode(e.operator):this.append("->"),this.visitNode(e.values[t])}visitMergeQuery(e){e.with&&(this.visitNode(e.with),this.append(" ")),this.append("merge "),e.top&&(this.visitNode(e.top),this.append(" ")),this.append("into "),this.visitNode(e.into),e.using&&(this.append(" "),this.visitNode(e.using)),e.whens&&(this.append(" "),this.compileList(e.whens))}visitMatched(e){e.not&&this.append("not "),this.append("matched"),e.bySource&&this.append(" by source")}visitAddIndex(e){this.append("add "),e.unique&&this.append("unique "),this.append("index "),this.visitNode(e.name),e.columns&&(this.append(" ("),this.compileList(e.columns),this.append(")")),e.using&&(this.append(" using "),this.visitNode(e.using))}visitCast(e){this.append("cast("),this.visitNode(e.expression),this.append(" as "),this.visitNode(e.dataType),this.append(")")}visitFetch(e){this.append("fetch next "),this.visitNode(e.rowCount),this.append(` rows ${e.modifier}`)}visitTop(e){this.append(`top(${e.expression})`),e.modifiers&&this.append(` ${e.modifiers}`)}append(e){this.#H+=e}appendValue(e){this.addParameter(e),this.append(this.getCurrentParameterPlaceholder())}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getCurrentParameterPlaceholder(){return"$"+this.numParameters}getLeftExplainOptionsWrapper(){return"("}getExplainOptionAssignment(){return" "}getExplainOptionsDelimiter(){return", "}getRightExplainOptionsWrapper(){return")"}sanitizeIdentifier(e){const t=this.getLeftIdentifierWrapper(),n=this.getRightIdentifierWrapper();let r="";for(const i of e)r+=i,i===t?r+=t:i===n&&(r+=n);return r}addParameter(e){this.#G.push(e)}appendImmediateValue(e){if(Gn(e))this.append(`'${e}'`);else if(Zn(e)||er(e))this.append(e.toString());else if(tr(e))this.append("null");else if(e instanceof Date)this.appendImmediateValue(e.toISOString());else{if(!nr(e))throw new Error(`invalid immediate value ${e}`);this.appendImmediateValue(e.toString())}}sortSelectModifiers(e){return e.sort(((e,t)=>e.modifier&&t.modifier?Ya[e.modifier]-Ya[t.modifier]:1)),or(e)}compileColumnAlterations(e){this.compileList(e)}announcesNewColumnDataType(){return!0}}const Ka=or({ForKeyShare:"for key share",ForNoKeyUpdate:"for no key update",ForUpdate:"for update",ForShare:"for share",NoWait:"nowait",SkipLocked:"skip locked",Distinct:"distinct"}),Ya=or({ForKeyShare:1,ForNoKeyUpdate:1,ForUpdate:1,ForShare:1,NoWait:2,SkipLocked:2,Distinct:0}),Va=or({InnerJoin:"inner join",LeftJoin:"left join",RightJoin:"right join",FullJoin:"full join",LateralInnerJoin:"inner join lateral",LateralLeftJoin:"left join lateral",Using:"using"}),za=/"/g;class Xa extends Ja{getCurrentParameterPlaceholder(){return"?"}getLeftExplainOptionsWrapper(){return""}getRightExplainOptionsWrapper(){return""}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getAutoIncrement(){return"autoincrement"}sanitizeIdentifier(e){return e.replace(za,'""')}visitDefaultInsertValue(e){this.append("null")}}let Ha,Ga,Za,ec,tc=!1;const nc=(e,t)=>{"string"!=typeof t.data&&!0!==tc&&(clearTimeout(Ha),Ha=void 0,Ha=setTimeout((()=>{tc=!0,e({refreshQueries:!0})(),clearTimeout(Ha),clearTimeout(Ga),Ga=setTimeout((()=>{tc=!1}),500)}),500))},rc=(e,t,n)=>t.externalWebsocketConnection?(t.externalWebsocketConnection.send(JSON.stringify({message:"subscribe",channelId:n.id})),t.externalWebsocketConnection.addEventListener("message",(t=>nc(e,t))),t.externalWebsocketConnection):t.enableWebsocketConnection?(ec=new WebSocket(t.syncUrl?.replace("http","ws")),ec.addEventListener("message",(t=>nc(e,t))),ec.onerror=e=>{console.error("WebSocket error:",e)},ec.onclose=()=>{Za=setTimeout((()=>rc(e,t,n)),3e3)},ec.onopen=()=>{ec.send(JSON.stringify({message:"subscribe",channelId:n.id})),clearTimeout(Za)},ec):void 0,ic=e=>m.sync((()=>{const t=new Set;let n=e;return{subscribe:e=>(t.add(e),()=>{t.delete(e)}),getState:()=>n,setState:e=>m.sync((()=>{e!==n&&(n=e,t.forEach((e=>e())))}))}}));class oc extends(u.vw("EvoluFactory")()){}oc.Common=w.QZ(oc,m.gen((function*(){const e=yield*m.map(m.serviceOption(on),y.WL((()=>e=>e()))),t=u.Ie().pipe(u.WQ(Nn,yield*Nn),u.WQ(Ue,yield*Ue),u.WQ(on,e),u.WQ(sn,yield*sn)),n=new Map;return oc.of({createEvolu:(e,{indexes:r,initialData:i,mnemonic:o,...s}={})=>{const a=O(s),c=s?.name||S.name,d={tables:sc(e),indexes:r||[]};let l=n.get(c);return null==l?(l=cc(d,a,i,o).pipe(m.provide(t),a.runSync),n.set(c,l)):l.ensureSchema(d),l}})})));const sc=e=>(0,f.Fs)(ac(e),Xn.Wo,p.Tj((([e,t])=>({name:e,columns:Object.keys(ac(t))})))),ac=e=>{const t={},n=zn.dw(e.ast);for(let e=0;e<n.length;e++){const r=n[e];t[r.name]=(0,a.L8n)(r.type)}return t},cc=(e,t,n,r)=>m.gen((function*(){yield*m.logTrace("EvoluFactory createEvolu");const i=yield*k,o=yield*Nn,s=yield*sn,a=yield*Ue,c=yield*on,d=yield*o.createDb,l=yield*ic(null),u=yield*ic(null),h=yield*ic(new Map),y=yield*ic(gt),w=new Map,N=new Map,b=e=>e.pipe(m.catchAllDefect((e=>m.fail(Ut(e)))),m.tapError(m.logError),m.tapError(l.setState)),v=(0,f.L3)(b,t.runFork),x=(0,f.L3)(b,t.runSync),S=(0,f.L3)(b,t.runPromise),O=yield*m.provideService(dc(n),Ue,a),W=({refreshQueries:e})=>()=>{m.flatMap(d.sync(e?[...N.keys()]:[]),C()).pipe(v)};d.init(e,O,(e=>{m.fail(e).pipe(v)}),(e=>{m.logDebug(["Evolu handleSyncStateChange",{state:e}]).pipe(m.zipRight(y.setState(e)),v)}),(()=>{m.gen((function*(){yield*m.logTrace("Evolu handleDbReceive"),A();const e=[...N.keys()];e.length>0&&(yield*m.flatMap(d.loadQueries(e),C()))})).pipe(v)}),r).pipe(m.tap(W({refreshQueries:!1})),m.flatMap(u.setState),m.catchTag("NotSupportedPlatformError",(()=>m.void)),v);let q=!1;const T=new Promise((e=>{u.subscribe((()=>{const t=u.getState();q||"string"!=typeof t?.id||(q=!0,e(rc(W,i,t)))}))})),E=yield*s.init({onRequestSync:W({refreshQueries:!0}),reloadUrl:i.reloadUrl}),C=e=>t=>m.logDebug(["Evolu handlePatches",{patches:t}]).pipe(m.zipRight(D(t)),m.tap((e=>m.forEach(t,(({query:t})=>P(t,e.get(t)||$n()))))),m.tap((t=>{e?.flushSync?c((()=>{h.setState(t).pipe(x)})):h.setState(t).pipe(x)}))),D=e=>m.sync((()=>{const t=h.getState();if(0===e.length)return t;const n=p.Tj(e,(({query:e,patches:n})=>[e,Ft(n,t.get(e)||$n())]));return new Map([...t,...n])})),P=(e,t)=>m.sync((()=>{const n=w.get(e);if(!n)return;const r=Jn(t);"fulfilled"!==n.promise.status?n.resolve(r):n.promise=Promise.resolve(r),Object.assign(n.promise,{status:"fulfilled",value:r}),n.releaseOnResolve&&w.delete(e)})),A=()=>{[...w.entries()].filter((([e])=>!N.has(e))).forEach((([e,t])=>{"fulfilled"===t.promise.status?w.delete(e):t.releaseOnResolve=!0}))},M=(()=>{let e=[];return(t,{id:n,...r},i)=>{m.logDebug(["Evolu mutate",{table:t,id:n,values:r}]).pipe(x);const o=null==n;return o&&(n=a.rowId.pipe(x)),e=[...e,[{table:t,id:n,values:r,isInsert:o},i]],1===e.length&&queueMicrotask((()=>{const[t,n]=p.$1(e);e=[];const r=n.filter(g.EA);A(),d.mutate(t,[...N.keys()]).pipe(m.flatMap(C({flushSync:r.length>0})),m.tap((()=>{r.forEach((e=>e()))})),v)})),{id:n}}})(),L={socket:T,subscribeError:l.subscribe,getError:l.getState,createQuery:(e,t)=>(0,f.Fs)(e(lc).compile(),(e=>{if(n=e.sql,Zt.test(n))throw new Error("SQL mutation (INSERT, UPDATE, DELETE, etc.) isn't allowed in the Evolu `createQuery` function. Kysely suggests it because there is no read-only Kysely yet, and removing such an API is not possible. For mutations, use Evolu mutation API.");var n;const r=e.parameters;return{sql:e.sql,parameters:r,...t&&{options:t}}}),(e=>(({sql:e,parameters:t=[],options:n})=>{const r={sql:e,parameters:t.map((e=>g.mg(e)?p.Ts(e):Kt(e)?{json:e}:e)),...n&&{options:n}};return JSON.stringify(r)})(e))),loadQuery:(()=>{let e=[];return t=>{m.logDebug(["Evolu loadQuery",{query:Un(t)}]).pipe(x);let n=w.get(t);if(!n){let r=f.Yi;const i=new Promise((e=>{r=e}));n={resolve:r,promise:i,releaseOnResolve:!1},w.set(t,n),e=[...e,t],1===e.length&&queueMicrotask((()=>{d.loadQueries(p.Qq(e)).pipe(m.flatMap(C()),v),e=[]}))}return n.promise}})(),loadQueries:e=>e.map(L.loadQuery),subscribeQuery:e=>t=>{N.set(e,I.GV(N.get(e)??0));const n=h.subscribe(t);return()=>{const t=N.get(e);null!=t&&t>1?N.set(e,I.Kt(t)):N.delete(e),n()}},getQuery:e=>Jn(h.getState().get(e)||$n()),subscribeOwner:u.subscribe,getOwner:u.getState,subscribeSyncState:y.subscribe,getSyncState:y.getState,create:M,update:M,createOrUpdate:M,resetOwner:e=>m.gen((function*(){yield*d.resetOwner(),!1!==e?.reload&&(yield*E.reset)})).pipe(S),restoreOwner:(t,n)=>m.gen((function*(){yield*d.restoreOwner(e,t),!1!==n?.reload&&(yield*E.reset)})).pipe(S),reloadApp:()=>{E.reset.pipe(v)},ensureSchema:e=>{d.ensureSchema(e).pipe(v)},exportDatabase:()=>d.exportDatabase().pipe(S)};return L})),dc=(e=f.Yi)=>m.map(Ue,(t=>{const n=[],r=(e,{id:r,...i})=>(null==r&&(r=t.rowId.pipe(m.runSync)),n.push({isInsert:!0,id:r,table:e,values:i}),{id:r});return e({create:r,createOrUpdate:r}),n})),lc=new La({dialect:{createAdapter:()=>new Ua,createDriver:()=>new _a,createIntrospector(){throw"Not implemeneted"},createQueryCompiler:()=>new Xa}}),pc=(lc.schema.createIndex.bind(lc.schema),e=>m.map(k,(t=>`evolu:${t.name}:${e}`))),uc=(w.Py(sn,{init:({reloadUrl:e,onRequestSync:t})=>m.sync((()=>{if("undefined"==typeof document)return{reset:m.void};const n="evolu:reloadAllTabs",r=()=>{location.replace(e)};let i;window.addEventListener("storage",(e=>{e.key===n&&r()}));const o=()=>{null==i&&(t(),i=window.setTimeout((()=>{i=null}),50))};return window.addEventListener("online",o),document.addEventListener("visibilitychange",(()=>{"hidden"!==document.visibilityState&&o()})),window.addEventListener("focus",o),{reset:m.sync((()=>{localStorage.setItem(n,Date.now().toString()),r()}))}}))}),w.Py(an,{tryAcquire:m.gen((function*(){yield*m.logTrace("SyncLock tryAcquire");const e=yield*pc("SyncLock"),t=m.async((t=>{navigator.locks.request(e,{ifAvailable:!0},(e=>{if(null!=e)return new Promise((e=>{m.logTrace("SyncLock acquired").pipe(m.zipRight(m.succeed({release:m.logTrace("SyncLock released").pipe(m.tap(m.sync(e)))})),t)}));m.logTrace("SyncLock not acquired").pipe(m.zipRight(m.fail(new cn)),t)}))}));return yield*m.acquireRelease(t,(({release:e})=>e))}))}));var hc=n(171733);globalThis.sqlite3Worker1Promiser=function e(t=e.defaultConfig){if(1===arguments.length&&"function"==typeof arguments[0]){const n=t;(t=Object.assign(Object.create(null),e.defaultConfig)).onready=n}else t=Object.assign(Object.create(null),e.defaultConfig,t);const n=Object.create(null),r=function(){},i=t.onerror||r,o=t.debug||r,s=t.generateMessageId?void 0:Object.create(null),a=t.generateMessageId||function(e){return e.type+"#"+(s[e.type]=(s[e.type]||0)+1)},c=(...e)=>{throw new Error(e.join(" "))};let d,l;return t.worker||(t.worker=e.defaultConfig.worker),"function"==typeof t.worker&&(t.worker=t.worker()),t.worker.onmessage=function(e){e=e.data,o("worker1.onmessage",e);let r=n[e.messageId];if(!r)return e&&"sqlite3-api"===e.type&&"worker1-ready"===e.result?void(t.onready&&t.onready(l)):(r=n[e.type],r&&r.onrow?void r.onrow(e):void(t.onunhandled?t.onunhandled(arguments[0]):i("sqlite3Worker1Promiser() unhandled worker message:",e)));switch(delete n[e.messageId],e.type){case"error":return void r.reject(e);case"open":d||(d=e.dbId);break;case"close":e.dbId===d&&(d=void 0)}try{r.resolve(e)}catch(e){r.reject(e)}},l=function(){let e;1===arguments.length?e=arguments[0]:2===arguments.length?(e=Object.create(null),e.type=arguments[0],e.args=arguments[1],e.dbId=e.args.dbId):c("Invalid arguments for sqlite3Worker1Promiser()-created factory."),e.dbId||"open"===e.type||(e.dbId=d),e.messageId=a(e),e.departureTime=performance.now();const r=Object.create(null);let i;r.message=e,"exec"===e.type&&e.args&&("function"==typeof e.args.callback?(i=e.messageId+":row",r.onrow=e.args.callback,e.args.callback=i,n[i]=r):"string"==typeof e.args.callback&&c("exec callback may not be a string when using the Promise interface."));let s=new Promise((function(i,s){r.resolve=i,r.reject=s,n[e.messageId]=r,o("Posting",e.type,"message to Worker dbId="+(d||"default")+":",e),t.worker.postMessage(e)}));return i&&(s=s.finally((()=>delete n[i]))),s}},globalThis.sqlite3Worker1Promiser.defaultConfig={worker:function(){return new Worker(new URL(n.p+n.u(65),n.b),{type:void 0})},onerror:(...e)=>console.error("worker1 promiser error",...e)},sqlite3Worker1Promiser.v2=function(e){let t;"function"==typeof e?(t=e,e={}):"function"==typeof e?.onready&&(t=e.onready,delete e.onready);const n=Object.create(null);e=Object.assign(e||Object.create(null),{onready:async function(e){try{t&&await t(e),n.resolve(e)}catch(e){n.reject(e)}}});const r=new Promise((function(e,t){n.resolve=e,n.reject=t}));try{this.original(e)}catch(e){n.reject(e)}return r}.bind({original:sqlite3Worker1Promiser}),sqlite3Worker1Promiser.v2,self.sqlite3Worker1Promiser;const mc=hc.A;globalThis.sqlite3ApiConfig={warn:f.Yi};const fc=w.QZ(Jt,m.gen((function*(){const e=yield*Ue,t=mc();return Jt.of({createSqlite:m.gen((function*(){const n=yield*m.flatMap(pc("SqliteBroadcastChannel"),yc);n.onMessage=e=>{switch(e._tag){case"Exec":r=[...r,e];break;case"ExecError":case"ExecSuccess":r=p.pb(r,(t=>t.id!==e.id)),i(e);break;default:(0,f.GQ)(e)}};let r=[];const i=e=>{const t=o.get(e.id);t&&(t(e),o.delete(e.id))},o=new Map,s=yield*k,a=O(s);m.logTrace("SqliteWeb connection lock request").pipe(m.zipRight(pc("SqliteConnection")),m.flatMap((e=>m.async((n=>{navigator.locks.request(e,(()=>new Promise((()=>{n(m.promise((()=>t)))}))))})))),m.tap(m.logTrace("SqliteWeb connection lock granted")),m.flatMap((e=>m.promise((()=>e.installOpfsSAHPoolVfs({name:s.name}))).pipe(m.map((t=>({sqlite:new t.OpfsSAHPoolDb("/evolu1.db"),sqlite3:e})))))),m.tap((({sqlite:e,sqlite3:t})=>{const o=(r,i)=>m.try({try:()=>{return r.sql===gc.sql?[{file:t.capi.sqlite3_js_db_export(e)}]:e.exec(r.sql,{returnValue:"resultRows",rowMode:"object",bind:(n=r.parameters||[],n.map((e=>Kt(e)?JSON.stringify(e):e)))});var n},catch:_t}).pipe((e=>t=>e.options?.logQueryExecutionTime?m.Do.pipe(m.let("start",(()=>performance.now())),m.bind("result",(()=>t)),m.let("elapsed",(({start:e})=>performance.now()-e)),m.tap((({elapsed:t})=>Tt(`QueryExecutionTime: ${t}ms`,e))),m.map((({result:e})=>e))):t)(r),m.match({onSuccess:t=>{n.postMessage({_tag:"ExecSuccess",id:i,result:{rows:t,changes:e.changes()}})},onFailure:e=>{n.postMessage({_tag:"ExecError",id:i,error:e})}}),a.runSync);n.onMessage=e=>{switch(e._tag){case"Exec":o(e.query,e.id);break;case"ExecSuccess":case"ExecError":i(e);break;default:(0,f.GQ)(e)}},r.forEach((e=>{o(e.query,e.id)})),r=[]}))).pipe(m.provideService(k,s),a.runPromise);const c=yield*pc("SqliteTransaction");return Qt.of({exec:t=>m.flatMap(e.nanoid,(e=>m.async((r=>{o.set(e,(e=>{switch(e._tag){case"ExecSuccess":r(m.succeed(e.result));break;case"ExecError":r(m.die(e.error))}})),n.postMessage({_tag:"Exec",id:e,query:t})})))),transaction:e=>t=>m.acquireUseRelease(m.async((t=>{navigator.locks.request(c,{mode:"last"===e?"exclusive":e},(()=>new Promise((e=>{t(m.succeed(e))}))))})),(()=>t),(t=>m.sync((()=>{"last"!==e&&t()})))),export:()=>m.flatMap(e.nanoid,(e=>m.async((t=>{o.set(e,(e=>{switch(e._tag){case"ExecSuccess":t(m.succeed(e.result.rows[0].file));break;case"ExecError":t(m.die(e.error))}})),n.postMessage({_tag:"Exec",id:e,query:gc})}))))})}))})}))),yc=e=>m.sync((()=>{const t=new BroadcastChannel(e),n={postMessage:e=>{t.postMessage(e),n.onMessage(e)},onMessage:f.Yi};return t.onmessage=e=>{n.onMessage(e.data)},n})),gc={sql:"export database"},wc=w.Py(wt,{createSync:m.sync((()=>(e=>{const t=new Map;e.onmessage=({data:e})=>{const n=t.get(e.id);n&&(n(e.response),t.delete(e.id))};return new Proxy(e,{get:(e,n)=>(...r)=>m.flatMap(k,(i=>m.async((o=>{const s=[],a=r.map((e=>{if("function"!=typeof e)return e;const t=new MessageChannel;return t.port1.onmessage=({data:t})=>{e(...t)},s.push(t.port2),t.port2})),c=Yn();t.set(c,(e=>{o(m[e._tag](e.value))}));const d={id:c,name:n,args:a,config:i};e.postMessage(d,s)}))))})})(new Worker(new URL(n.p+n.u(52),n.b),{type:void 0}))))});bn.pipe(m.provide(w.Um(Jt.Common.pipe(w.Gt(fc),w.Gt(Vn)),Vn,tt.Live,wc,uc)),m.runSync,(e=>{let t=null;onmessage=({data:{id:n,name:r,args:i,config:o}})=>{null==t&&(t=O(o));const s=i.map((e=>e instanceof MessagePort?(...t)=>{e.postMessage(t)}:e));t.runFork(e[r](...s).pipe(m.map((e=>({id:n,response:{_tag:"succeed",value:e}}))),m.catchAll((e=>m.succeed({id:n,response:{_tag:"fail",value:e}}))),m.catchAllDefect((e=>m.succeed({id:n,response:{_tag:"die",value:_t(e)}}))),m.tap((e=>postMessage(e)))))}}))},975955:(e,t,n)=>{n.d(t,{$1:()=>J,$v:()=>W,BC:()=>N,BE:()=>U,Bq:()=>ae,C:()=>H,CN:()=>h,D8:()=>y,E$:()=>te,EI:()=>x,HC:()=>F,HV:()=>T,Hs:()=>w,Ie:()=>re,KC:()=>Z,Kl:()=>M,Ln:()=>D,Mo:()=>ne,OM:()=>be,OY:()=>Q,Ou:()=>K,Qq:()=>we,Rm:()=>E,Rx:()=>C,TS:()=>he,Tj:()=>oe,Ts:()=>f,Uk:()=>B,XK:()=>me,Y6:()=>m,Yz:()=>le,bt:()=>ye,cy:()=>v,d5:()=>q,di:()=>_,fj:()=>Ne,g9:()=>A,gI:()=>z,gR:()=>V,gv:()=>P,i8:()=>L,iI:()=>k,jB:()=>ue,kP:()=>ee,mA:()=>de,nc:()=>g,of:()=>ie,pb:()=>pe,qI:()=>se,t8:()=>fe,u2:()=>b,v4:()=>I,w8:()=>ge,x1:()=>ce,yU:()=>$});var r=n(545422),i=n(617194),o=n(374212),s=n(249687),a=n(319678),c=n(30805),d=n(271314),l=n(43963),p=n(370817),u=n(241892);const h=e=>new Array(e),m=(e,t)=>{const n=Math.max(1,Math.floor(e)),r=new Array(n);for(let e=0;e<n;e++)r[e]=t(e);return r},f=e=>Array.isArray(e)?e:Array.from(e),y=e=>Array.isArray(e)?e:[e],g=(p.Wo,c.$r,(0,o.XY)(2,((e,{onEmpty:t,onNonEmpty:n})=>k(e)?n(I(e),C(e)):t()))),w=(0,o.XY)(2,((e,t)=>[t,...e])),N=(0,o.XY)(2,((e,t)=>[...e,t])),b=(0,o.XY)(2,((e,t)=>f(e).concat(f(t)))),v=Array.isArray,x=s.E,k=s.E,S=(e,t)=>e<0||e>=t.length,O=(0,o.XY)(2,((e,t)=>{const n=Math.floor(t);return S(n,e)?c.dv():c.zN(e[n])})),W=(0,o.XY)(2,((e,t)=>{const n=Math.floor(t);if(S(n,e))throw new Error(`Index ${n} out of bounds`);return e[n]})),q=O(0),I=W(0),T=e=>k(e)?c.zN(E(e)):c.dv(),E=e=>e[e.length-1],C=e=>e.slice(1),D=(0,o.XY)(2,((e,t)=>z(e,((e,t)=>{let n=0;for(const r of e){if(!t(r,n))break;n++}return n})(e,t)))),P=(0,o.XY)(2,((e,t)=>{const n=f(e);return n.slice((r=t,i=n,Math.floor(Math.min(Math.max(0,r),i.length))),n.length);var r,i})),A=(0,o.XY)(2,((e,t)=>{let n=0;for(const r of e){if(t(r,n))return c.zN(n);n++}return c.dv()})),M=(0,o.XY)(2,((e,t)=>{const n=f(e);for(let e=n.length-1;e>=0;e--)if(t(n[e],e))return c.zN(e);return c.dv()})),L=a.i8,B=(0,o.XY)(2,((e,t)=>{const n=f(e);for(let e=n.length-1;e>=0;e--){const r=n[e],i=t(r,e);if((0,l.Lm)(i)){if(i)return c.zN(r)}else if(c.Ru(i))return i}return c.dv()})),F=(0,o.XY)(3,((e,t,n)=>R(e,t,(()=>n)))),R=(0,o.XY)(3,((e,t,n)=>c.WL(j(e,t,n),(()=>Array.from(e))))),j=(0,o.XY)(3,((e,t,n)=>{const r=Array.from(e);if(S(t,r))return c.dv();const i=n(r[t]);return r[t]=i,c.zN(r)})),U=e=>Array.from(e).reverse(),_=(0,o.XY)(2,((e,t)=>{const n=Array.from(e);return n.sort(t),n})),$=(0,o.XY)(2,((e,t)=>Q(e,t,u.L8))),Q=(0,o.XY)(3,((e,t,n)=>{const r=f(e),i=f(t);if(k(r)&&k(i)){const e=[n(I(r),I(i))],t=Math.min(r.length,i.length);for(let o=1;o<t;o++)e[o]=n(r[o],i[o]);return e}return[]})),J=e=>{const t=f(e);if(k(t)){const e=[t[0][0]],n=[t[0][1]];for(let r=1;r<t.length;r++)e[r]=t[r][0],n[r]=t[r][1];return[e,n]}return[[],[]]},K=e=>(0,o.XY)(2,((t,n)=>{for(const r of t)if(e(n,r))return!0;return!1})),Y=r.XY(),V=K(Y),z=(0,o.XY)(2,((e,t)=>{const n=Array.from(e),r=Math.floor(t);return k(n)?r>=1?X(n,r):[[],n]:[n,[]]})),X=(0,o.XY)(2,((e,t)=>{const n=Math.max(1,Math.floor(t));return n>=e.length?[H(e),[]]:[w(e.slice(1,n),I(e)),e.slice(n)]})),H=e=>e.slice(),G=(0,o.XY)(3,((e,t,n)=>{const r=f(e),i=f(t);return k(r)?k(i)?ge(n)(b(r,i)):r:i})),Z=(0,o.XY)(2,((e,t)=>G(e,t,Y))),ee=e=>{const t=K(e);return(0,o.XY)(2,((e,n)=>f(e).filter((e=>t(n,e)))))},te=ee(Y),ne=e=>{const t=K(e);return(0,o.XY)(2,((e,n)=>f(e).filter((e=>!t(n,e)))))},re=()=>[],ie=e=>[e],oe=(0,o.XY)(2,((e,t)=>e.map(t))),se=(0,o.XY)(2,((e,t)=>{if((e=>0===e.length)(e))return[];const n=[];for(let r=0;r<e.length;r++){const i=t(e[r],r);for(let e=0;e<i.length;e++)n.push(i[e])}return n})),ae=se(o.D_),ce=(0,o.XY)(2,((e,t)=>{const n=f(e),r=[];for(let e=0;e<n.length;e++){const i=t(n[e],e);c.Ru(i)&&r.push(i.value)}return r})),de=(0,o.XY)(2,((e,t)=>{let n=0;const r=[];for(const i of e){const e=t(i,n);if(!c.Ru(e))break;r.push(e.value),n++}return r})),le=ce(o.D_),pe=(0,o.XY)(2,((e,t)=>{const n=f(e),r=[];for(let e=0;e<n.length;e++)t(n[e],e)&&r.push(n[e]);return r})),ue=(0,o.XY)(2,((e,t)=>{const n=[],r=[],i=f(e);for(let e=0;e<i.length;e++)t(i[e],e)?r.push(i[e]):n.push(i[e]);return[n,r]})),he=(0,o.XY)(3,((e,t,n)=>f(e).reduce(((e,t,r)=>n(e,t,r)),t))),me=(0,o.XY)(3,((e,t,n)=>f(e).reduceRight(((e,t,r)=>n(e,t,r)),t))),fe=(e,t)=>{const n=[];let r,i=e;for(;c.Ru(r=t(i));){const[e,t]=r.value;n.push(e),i=t}return n},ye=(d.YO,i.YO),ge=(0,o.XY)(2,((e,t)=>{const n=f(e);if(k(n)){const e=[I(n)],r=C(n);for(const n of r)e.every((e=>!t(n,e)))&&e.push(n);return e}return[]})),we=e=>ge(e,r.XY()),Ne=(0,o.XY)(2,((e,t)=>f(e).join(t))),be=(0,o.XY)(3,((e,t,n)=>{let r=0,i=t;const o=[];for(const t of e){const e=n(i,t,r);i=e[0],o.push(e[1]),r++}return[i,o]}))},200093:(e,t,n)=>{n.r(t),n.d(t,{Do:()=>En,EffectTypeId:()=>g,Tag:()=>io,acquireRelease:()=>lt,acquireReleaseInterruptible:()=>pt,acquireUseRelease:()=>ut,addFinalizer:()=>ht,all:()=>S,allSuccesses:()=>W,allWith:()=>O,allowInterrupt:()=>je,andThen:()=>Xn,annotateCurrentSpan:()=>$i,annotateLogs:()=>$r,annotateLogsScoped:()=>Qr,annotateSpans:()=>_i,ap:()=>qi,as:()=>He,asSome:()=>Ge,asSomeError:()=>Ze,asVoid:()=>et,async:()=>z,asyncEffect:()=>X,awaitAllChildren:()=>Ot,bind:()=>Cn,bindTo:()=>Dn,blocked:()=>Ii,cacheRequestResult:()=>Di,cached:()=>v,cachedFunction:()=>x,cachedInvalidateWithTTL:()=>b,cachedWithTTL:()=>N,catch:()=>ge,catchAll:()=>we,catchAllCause:()=>Ne,catchAllDefect:()=>be,catchIf:()=>ve,catchSome:()=>xe,catchSomeCause:()=>ke,catchSomeDefect:()=>Se,catchTag:()=>Oe,catchTags:()=>We,cause:()=>qe,checkInterruptible:()=>Ue,clock:()=>Vt,clockWith:()=>zt,configProviderWith:()=>un,console:()=>Gt,consoleWith:()=>Zt,context:()=>fn,contextWith:()=>yn,contextWithEffect:()=>gn,currentParentSpan:()=>Ji,currentSpan:()=>Qi,custom:()=>H,daemonChildren:()=>Wt,delay:()=>nn,descriptor:()=>qt,descriptorWith:()=>It,die:()=>re,dieMessage:()=>ie,dieSync:()=>oe,diffFiberRefs:()=>Tt,disconnect:()=>_e,dropUntil:()=>q,dropWhile:()=>I,either:()=>An,ensuring:()=>mt,ensuringChild:()=>Et,ensuringChildren:()=>Ct,eventually:()=>Ie,every:()=>T,exists:()=>E,exit:()=>Mn,fail:()=>Z,failCause:()=>te,failCauseSync:()=>ne,failSync:()=>ee,fiberId:()=>Dt,fiberIdWith:()=>Pt,filter:()=>C,filterMap:()=>D,filterOrDie:()=>Rn,filterOrDieMessage:()=>jn,filterOrElse:()=>Un,filterOrFail:()=>_n,finalizersMask:()=>wt,findFirst:()=>P,firstSuccessOf:()=>A,flatMap:()=>zn,flatten:()=>Hn,flip:()=>tt,flipWith:()=>nt,forEach:()=>M,forever:()=>dr,fork:()=>At,forkAll:()=>Lt,forkDaemon:()=>Mt,forkIn:()=>Bt,forkScoped:()=>Ft,forkWithErrorHandler:()=>Rt,fromFiber:()=>jt,fromFiberEffect:()=>Ut,fromNullable:()=>no,functionWithSpan:()=>Zi,gen:()=>se,getFiberRefs:()=>Nr,getRuntimeFlags:()=>ri,head:()=>L,if:()=>Fn,ignore:()=>Te,ignoreLogged:()=>Ee,inheritFiberRefs:()=>br,interrupt:()=>$e,interruptWith:()=>Qe,interruptible:()=>Je,interruptibleMask:()=>Ke,intoDeferred:()=>Ln,isEffect:()=>w,isFailure:()=>Ir,isSuccess:()=>Tr,iterate:()=>lr,labelMetrics:()=>ci,labelMetricsScoped:()=>li,let:()=>Pn,liftPredicate:()=>Xe,linkSpans:()=>Vi,locally:()=>vr,locallyScoped:()=>kr,locallyScopedWith:()=>Sr,locallyWith:()=>xr,log:()=>Ar,logAnnotations:()=>Jr,logDebug:()=>Br,logError:()=>jr,logFatal:()=>Ur,logInfo:()=>Fr,logTrace:()=>Lr,logWarning:()=>Rr,logWithLevel:()=>Mr,loop:()=>pr,makeSemaphore:()=>mi,makeSpan:()=>zi,makeSpanScoped:()=>Xi,map:()=>rt,mapAccum:()=>it,mapBoth:()=>ot,mapError:()=>st,mapErrorCause:()=>at,mapInputContext:()=>wn,match:()=>Er,matchCause:()=>Cr,matchCauseEffect:()=>Dr,matchEffect:()=>Pr,merge:()=>ct,mergeAll:()=>B,metricLabels:()=>pi,negate:()=>dt,never:()=>ae,none:()=>ce,onError:()=>ft,onExit:()=>yt,onInterrupt:()=>Ye,once:()=>k,option:()=>Bn,optionFromOptional:()=>ro,orDie:()=>Yr,orDieWith:()=>Vr,orElse:()=>zr,orElseFail:()=>Xr,orElseSucceed:()=>Hr,parallelErrors:()=>Ce,parallelFinalizers:()=>gt,partition:()=>F,patchFiberRefs:()=>Or,patchRuntimeFlags:()=>ii,promise:()=>de,provide:()=>Nn,provideService:()=>bn,provideServiceEffect:()=>vn,race:()=>Zn,raceAll:()=>Gn,raceFirst:()=>er,raceWith:()=>tr,random:()=>Gr,randomWith:()=>Zr,reduce:()=>R,reduceEffect:()=>j,reduceRight:()=>U,reduceWhile:()=>_,repeat:()=>ur,repeatN:()=>hr,repeatOrElse:()=>mr,replicate:()=>$,replicateEffect:()=>Q,request:()=>Ci,retry:()=>Pe,retryOrElse:()=>Ae,runCallback:()=>yi,runFork:()=>fi,runPromise:()=>gi,runPromiseExit:()=>wi,runRequestBlock:()=>Ti,runSync:()=>Ni,runSyncExit:()=>bi,runtime:()=>ni,sandbox:()=>De,schedule:()=>fr,scheduleForked:()=>yr,scheduleFrom:()=>gr,scope:()=>bt,scopeWith:()=>vt,scoped:()=>xt,sequentialFinalizers:()=>Nt,serviceConstants:()=>On,serviceFunction:()=>xn,serviceFunctionEffect:()=>kn,serviceFunctions:()=>Sn,serviceMembers:()=>Wn,serviceOption:()=>qn,serviceOptional:()=>In,setFiberRefs:()=>Wr,sleep:()=>rn,spanAnnotations:()=>Ki,spanLinks:()=>Yi,step:()=>Ei,succeed:()=>le,succeedNone:()=>pe,succeedSome:()=>ue,summarized:()=>nr,supervised:()=>_t,suspend:()=>he,sync:()=>me,tagMetrics:()=>ai,tagMetricsScoped:()=>di,takeUntil:()=>J,takeWhile:()=>K,tap:()=>rr,tapBoth:()=>ir,tapDefect:()=>or,tapError:()=>sr,tapErrorCause:()=>cr,tapErrorTag:()=>ar,timed:()=>on,timedWith:()=>sn,timeout:()=>an,timeoutFail:()=>dn,timeoutFailCause:()=>ln,timeoutOption:()=>cn,timeoutTo:()=>pn,tracer:()=>Li,tracerWith:()=>Bi,transplant:()=>$t,try:()=>Me,tryMap:()=>Le,tryMapPromise:()=>Be,tryPromise:()=>Fe,uninterruptible:()=>Ve,uninterruptibleMask:()=>ze,unless:()=>$n,unlessEffect:()=>Qn,unsafeMakeSemaphore:()=>hi,unsandbox:()=>Re,updateFiberRefs:()=>qr,updateService:()=>Tn,useSpan:()=>Hi,using:()=>kt,validate:()=>vi,validateAll:()=>Y,validateFirst:()=>V,validateWith:()=>xi,void:()=>fe,when:()=>Jn,whenEffect:()=>Kn,whenFiberRef:()=>Yn,whenRef:()=>Vn,whileLoop:()=>wr,withClock:()=>Ht,withClockScoped:()=>Xt,withConcurrency:()=>Qt,withConfigProvider:()=>hn,withConfigProviderScoped:()=>mn,withConsole:()=>tn,withConsoleScoped:()=>en,withEarlyRelease:()=>St,withFiberRuntime:()=>G,withLogSpan:()=>_r,withMaxOpsBeforeYield:()=>Yt,withMetric:()=>ui,withParentSpan:()=>to,withRandom:()=>ei,withRandomScoped:()=>ti,withRequestBatching:()=>Pi,withRequestCache:()=>Mi,withRequestCaching:()=>Ai,withRuntimeFlagsPatch:()=>oi,withRuntimeFlagsPatchScoped:()=>si,withScheduler:()=>Jt,withSchedulingPriority:()=>Kt,withSpan:()=>Gi,withSpanScoped:()=>eo,withTracer:()=>Fi,withTracerEnabled:()=>ji,withTracerScoped:()=>Ri,withTracerTiming:()=>Ui,withUnhandledErrorLogLevel:()=>Kr,yieldNow:()=>ye,zip:()=>ki,zipLeft:()=>Si,zipRight:()=>Oi,zipWith:()=>Wi});var r=n(374212),i=n(608111),o=n(937957),s=n(648029),a=n(507503),c=n(266315),d=n(338265),l=n(426964),p=n(367442),u=n(960510),h=n(83902),m=n(387162),f=n(985455),y=n(345059);const g=a.$n1,w=a.yw5,N=d.PO,b=d.CJ,v=s.Bj,x=d.L_,k=s.Oo,S=l.Q7,O=l._y,W=l.XU,q=s.Cm,I=s.Hd,T=s.Si,E=l.t2,C=l.pb,D=s.x1,P=s.i8,A=s.Dd,M=l.jJ,L=s.d5,B=l.B1,F=l.jB,R=s.TS,j=l.GH,U=s.XK,_=s.KE,$=l.aA,Q=l.Xr,J=s.QK,K=s.v6,Y=l.wM,V=l.nO,z=a.bIC,X=h.a1,H=a.IeY,G=a.$we,Z=a.fJG,ee=a.gOk,te=a.ATB,ne=a.pVV,re=a.F_Q,ie=a.GSS,oe=a.Kbz,se=s.Jk,ae=a.ZmZ,ce=s.dv,de=s.iv,le=a.PyW,pe=s.lw,ue=s.nG,he=a.DYE,me=a.OH5,fe=a.rIH,ye=a.m9E,ge=s.nb,we=a.h9N,Ne=a.uPo,be=s.IK,ve=a.XWm,xe=a._Oy,ke=s.RJ,Se=s.Nu,Oe=s.Ku,We=s.lo,qe=s.c1,Ie=s.u4,Te=s.Xe,Ee=s.XP,Ce=s.Zk,De=s._S,Pe=m.nn,Ae=m.H_,Me=s.bS,Le=s.gZ,Be=s.xA,Fe=s.$m,Re=s.Pb,je=s.vV,Ue=a._5X,_e=l.Zf,$e=a.GaK,Qe=a.IPo,Je=a.Inz,Ke=a.eMl,Ye=a.nAr,Ve=a.rfi,ze=a.FcF,Xe=s.VW,He=a.as,Ge=s.Xx,Ze=s.t2,et=a.NLW,tt=a.UUz,nt=s.AA,rt=a.TjK,it=s.OM,ot=a.UcN,st=a.xm_,at=s.aW,ct=s.h1,dt=s.ze,lt=l.Q5,pt=l.p5,ut=a.jGc,ht=l.U9,mt=l.ye,ft=a.S5A,yt=a.cfM,gt=l.dJ,wt=l.ct,Nt=l.PO,bt=l.z8,vt=l.NB,xt=l.sZ,kt=l.v,St=l.lg,Ot=d.PC,Wt=l.e7,qt=s.yu,It=s.U$,Tt=s.Ek,Et=d.GR,Ct=d.jE,Dt=a.ABT,Pt=a.g1G,At=l.Zy,Mt=l.LX,Lt=d.Oy,Bt=d.ar,Ft=d.x6,Rt=l.Bh,jt=d.$T,Ut=d.qK,_t=d.Tg,$t=a.sK9,Qt=a.KyM,Jt=y.kW,Kt=a.FRe,Yt=a.jDN,Vt=s.pm,zt=s.RK,Xt=l.rh,Ht=c.V6,Gt=i.k2,Zt=i.un,en=i.Q_,tn=i.QW,nn=s.cb,rn=s.yy,on=s.ay,sn=s.yW,an=d.wR,cn=d.D5,dn=d.AN,ln=d.ny,pn=d.nH,un=c.aP,hn=c.gm,mn=l.Ek,fn=a._OA,yn=s.sx,gn=a.d_m,wn=a.kyh,Nn=p.up,bn=s.Pf,vn=s.c7,xn=s.A3,kn=s.p4,Sn=s.KO,On=s.XN,Wn=s.ZF,qn=s.N,In=s.gB,Tn=s.bU,En=s.Do,Cn=s.oI,Dn=s.Jr,Pn=s.zM,An=a.gPK,Mn=a.NS5,Ln=a._ig,Bn=s.uK,Fn=a.tDT,Rn=s.kr,jn=s.Nf,Un=s.Pm,_n=s.W$,$n=s.NJ,Qn=s.ix,Jn=s.z7,Kn=a.iK2,Yn=s.iz,Vn=s.mf,zn=a.qIB,Xn=a.hgn,Hn=a.Bqz,Gn=l.Vd,Zn=l.O4,er=d.KT,tr=l.wV,nr=s.Uy,rr=a.Mim,ir=s.Bi,or=s.nA,sr=s.sF,ar=s.TN,cr=s.Ly,dr=s.i4,lr=s.nl,pr=s.HW,ur=m.Mj,hr=s.wn,mr=m.g2,fr=m.mg,yr=d.Rq,gr=m.Av,wr=a.iMI,Nr=s.rQ,br=s.EN,vr=a.woH,xr=a.q1t,kr=l.Eq,Sr=l._1,Or=s.Bz,Wr=s.Z,qr=s.En,Ir=s.N6,Tr=s.oJ,Er=s.YW,Cr=a.D$$,Dr=a.khu,Pr=a.tvg,Ar=s.Rm,Mr=(e,...t)=>s.lI(e)(...t),Lr=s.om,Br=s.MD,Fr=s.fH,Rr=s.FF,jr=s.Og,Ur=s.Zc,_r=s.f1,$r=s.sw,Qr=l.gs,Jr=s.rr,Kr=a.EYO,Yr=a.QgK,Vr=a.kS9,zr=a.NWQ,Xr=s.xS,Hr=s.DM,Gr=s.yT,Zr=c.Gx,ei=c.Ii,ti=l.AA,ni=h.fA,ri=a.m$m,ii=a.$QS,oi=a.cay,si=l.qH,ai=s.G6,ci=s.Mw,di=l.Yt,li=l.oi,pi=a.SLb,ui=s.Xz,hi=d.RI,mi=d.VH,fi=h.C9,yi=h.HZ,gi=h.w$,wi=h.MN,Ni=h.wg,bi=h.ej,vi=l.tf,xi=l.xJ,ki=l.SJ,Si=l.Ne,Oi=l.OC,Wi=l.cw,qi=(0,r.XY)(2,((e,t)=>Wi(e,t,((e,t)=>e(t))))),Ii=a.Z5i,Ti=a.UFt,Ei=a.PMw,Ci=(0,r.XY)((e=>f.ks(e[0])),u.kc),Di=u.QA,Pi=a.mHP,Ai=u.f0,Mi=u.Uj,Li=s.kJ,Bi=c.wT,Fi=c._o,Ri=l.i4,ji=a.nDN,Ui=a.MaT,_i=s.Mu,$i=s.ww,Qi=s._3,Ji=s.Wj,Ki=s.Fu,Yi=s.Wb,Vi=s.A_,zi=s.Z9,Xi=l.Rd,Hi=s.gv,Gi=s.fR,Zi=s.RO,eo=l.zr,to=s.hq,no=s.k$,ro=s.SM,io=e=>()=>{const t=Error.stackTraceLimit;Error.stackTraceLimit=2;const n=new Error;function r(){}Error.stackTraceLimit=t,Object.setPrototypeOf(r,o.XI),r.key=e,Object.defineProperty(r,"stack",{get:()=>n.stack});const i=new Map;return new Proxy(r,{get(e,t,n){if("use"===t)return e=>a.hgn(r,e);if(t in r)return r[t];if(i.has(t))return i.get(t);const o=(...e)=>a.hgn(r,(n=>"function"==typeof n[t]?(i.set(t,((...e)=>a.hgn(r,(n=>n[t](...e))))),n[t](...e)):(i.set(t,a.hgn(r,(e=>e[t]))),n[t]))),s=a.hgn(r,(e=>e[t]));return Object.assign(o,s),Object.setPrototypeOf(o,Object.getPrototypeOf(s)),i.set(t,o),o}})}},374212:(e,t,n)=>{n.d(t,{D_:()=>o,Fs:()=>u,GQ:()=>p,L3:()=>h,MN:()=>d,Tn:()=>r,XY:()=>i,Yi:()=>l,dY:()=>s,f4:()=>c,ue:()=>a});const r=e=>"function"==typeof e,i=function(e,t){if("function"==typeof e)return function(){return e(arguments)?t.apply(this,arguments):e=>t(e,...arguments)};switch(e){case 0:case 1:throw new RangeError(`Invalid arity ${e}`);case 2:return function(e,n){return arguments.length>=2?t(e,n):function(n){return t(n,e)}};case 3:return function(e,n,r){return arguments.length>=3?t(e,n,r):function(r){return t(r,e,n)}};case 4:return function(e,n,r,i){return arguments.length>=4?t(e,n,r,i):function(i){return t(i,e,n,r)}};case 5:return function(e,n,r,i,o){return arguments.length>=5?t(e,n,r,i,o):function(o){return t(o,e,n,r,i)}};default:return function(){if(arguments.length>=e)return t.apply(this,arguments);const n=arguments;return function(e){return t(e,...n)}}}},o=e=>e,s=e=>()=>e,a=s(!0),c=s(!1),d=s(void 0),l=d,p=e=>{throw new Error("Called `absurd` function which should be uncallable")};function u(e,t,n,r,i,o,s,a,c){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return n(t(e));case 4:return r(n(t(e)));case 5:return i(r(n(t(e))));case 6:return o(i(r(n(t(e)))));case 7:return s(o(i(r(n(t(e))))));case 8:return a(s(o(i(r(n(t(e)))))));case 9:return c(a(s(o(i(r(n(t(e))))))));default:{let e=arguments[0];for(let t=1;t<arguments.length;t++)e=arguments[t](e);return e}}}function h(e,t,n,r,i,o,s,a,c){switch(arguments.length){case 1:return e;case 2:return function(){return t(e.apply(this,arguments))};case 3:return function(){return n(t(e.apply(this,arguments)))};case 4:return function(){return r(n(t(e.apply(this,arguments))))};case 5:return function(){return i(r(n(t(e.apply(this,arguments)))))};case 6:return function(){return o(i(r(n(t(e.apply(this,arguments))))))};case 7:return function(){return s(o(i(r(n(t(e.apply(this,arguments)))))))};case 8:return function(){return a(s(o(i(r(n(t(e.apply(this,arguments))))))))};case 9:return function(){return c(a(s(o(i(r(n(t(e.apply(this,arguments)))))))))}}}},796031:(e,t,n)=>{n.d(t,{Gt:()=>p,Py:()=>l,QZ:()=>a,Um:()=>d,_O:()=>s,h1:()=>c,jq:()=>o});var r=n(367442),i=n(871035);r.Lc,r.mH,r.IW,r.pL,r.sw,r.Mu;const o=r.jq,s=(r.LT,r.h9,r.uP,r._O),a=(r.F_,r.Kb,r.vf,r.uS),c=(r.AC,r.Nf,r.Ie,r.XE,r.fJ,r.gO,r.AT,r.pV,r.qI,r.Bq,r.pn,r.Xx,r.ql,r.Tj,r.xm,r.YW,r.D$,r.Bj,r.h1),d=r.Um,l=(r.Qg,r.NW,r.le,r.Cv,r.sk,r.wo,r.q1,r.Eq,r._1,r.L5,r.z8,r.P1,r.dm,r.qA,r.eu,r.Py),p=(r.Or,r.DY,r.OH,r.Jc,r.Mi,r.sF,r.Ly,r.Qf,r.Yp,r.Gt);r.S5,r.OY,r.vM,r.A2,i.e2,i.$5,i.cL,i.mv,r.fR,r.hq,r.vh,r.H7},620113:(e,t,n)=>{n.d(t,{GV:()=>s,Kt:()=>a,U5:()=>d,pH:()=>c,qg:()=>l});var r=n(617194),i=n(584129),o=n(271314);n(43963).Et;const s=e=>e+1,a=e=>e-1,c=(r.ai,o.ai),d=e=>{const t=Math.ceil(Math.log(e)/Math.log(2));return Math.max(Math.pow(2,t),2)},l=e=>{if("NaN"===e)return i.zN(NaN);if("Infinity"===e)return i.zN(1/0);if("-Infinity"===e)return i.zN(-1/0);if(""===e.trim())return i.dv;const t=Number(e);return Number.isNaN(t)?i.dv:i.zN(t)}},43963:(e,t,n)=>{n.d(t,{$J:()=>w,$P:()=>x,$X:()=>O,$y:()=>b,Bm:()=>d,EA:()=>u,Et:()=>s,Gv:()=>y,Kg:()=>o,Lm:()=>a,Pd:()=>m,Tn:()=>l,b0:()=>p,i5:()=>g,kZ:()=>h,mg:()=>v,sI:()=>c,u4:()=>S,wD:()=>N,xZ:()=>k,zz:()=>i});var r=n(374212);const i=e=>!!e,o=e=>"string"==typeof e,s=e=>"number"==typeof e,a=e=>"boolean"==typeof e,c=e=>"bigint"==typeof e,d=e=>"symbol"==typeof e,l=r.Tn,p=e=>void 0===e,u=e=>void 0!==e,h=e=>null===e,m=e=>!1,f=e=>"object"==typeof e&&null!==e,y=e=>f(e)||l(e),g=(0,r.XY)(2,((e,t)=>y(e)&&t in e)),w=(0,r.XY)(2,((e,t)=>g(e,"_tag")&&e._tag===t)),N=e=>null==e,b=e=>null!=e,v=e=>e instanceof Uint8Array,x=e=>e instanceof Date,k=e=>g(e,Symbol.iterator),S=e=>f(e)&&!Array.isArray(e),O=e=>g(e,"then")&&l(e.then)},332665:(e,t,n)=>{n.d(t,{Bd:()=>i,i4:()=>o,ji:()=>a,t5:()=>s});var r=n(387162);r.NU,r.rk,r.g7,r.VN,r.Y4,r.hg,r.y8,r.as,r.NL,r.FX,r.z6,r.ab,r.vt,r.IE,r.Fh,r.Mc,r.wu,r.tB,r.Zz,r.zQ,r.ky,r.K7,r.U9,r.BW,r.SD,r.mK,r.Nw,r.ol,r.iq,r.xA,r.Uc,r.$E;const i=r.Bd,o=(r.p0,r.gP,r.k$,r.vk,r.ye,r.EV,r.$_,r.Zu,r.i4),s=(r._E,r.Ht,r.Xx,r.cf,r.D_,r.y$,r.SV,r.et,r.q3,r.sn,r.Tj,r.WK,r.cM,r.y1,r.Nb,r.u1,r.Oo,r.le,r.Pp,r.Pf,r.oG,r.$y,r.Vf,r.O5,r.FP,r.fE,r.t5),a=(r.TS,r.GH,r.i4,r.Xu,r.yj,r.uw,r.eF,r.Qn,r.ji);r.ds,r.Py,r.OH,r.EM,r.NZ,r.t8,r.KC,r.q2,r.RY,r.GE,r.m$,r.HI,r.jB,r.O9,r.vm,r.v,r.ph,r.Ix,r.pi,r.aN,r.OY},608111:(e,t,n)=>{n.d(t,{BU:()=>v,CE:()=>D,I1:()=>C,IU:()=>y,Os:()=>k,QW:()=>u,Q_:()=>h,R8:()=>E,Rm:()=>O,Ts:()=>w,U9:()=>g,Yz:()=>N,al:()=>I,k2:()=>l,kB:()=>q,oV:()=>m,pq:()=>S,tp:()=>W,uP:()=>T,un:()=>p,vA:()=>f,y_:()=>b,z3:()=>x});var r=n(703225),i=n(374212),o=n(507503),s=n(266315),a=n(119153),c=n(426964),d=n(367442);const l=o.TjK(o.U8_(s.qJ),r.Jt(a.MG)),p=e=>o.uPR(s.qJ,(t=>e(r.Jt(t,a.MG)))),u=(0,i.XY)(2,((e,t)=>o.q1t(e,s.qJ,r.WQ(a.MG,t)))),h=e=>c._1(s.qJ,r.WQ(a.MG,e)),m=e=>d.dm(c._1(s.qJ,r.WQ(a.MG,e))),f=(e,...t)=>p((n=>n.assert(e,...t))),y=p((e=>e.clear)),g=e=>p((t=>t.count(e))),w=e=>p((t=>t.countReset(e))),N=(...e)=>p((t=>t.debug(...e))),b=(e,t)=>p((n=>n.dir(e,t))),v=(...e)=>p((t=>t.dirxml(...e))),x=(...e)=>p((t=>t.error(...e))),k=e=>p((t=>c.Q5(t.group(e),(()=>t.groupEnd)))),S=(...e)=>p((t=>t.info(...e))),O=(...e)=>p((t=>t.log(...e))),W=(e,t)=>p((n=>n.table(e,t))),q=e=>p((t=>c.Q5(t.time(e),(()=>t.timeEnd(e))))),I=(e,...t)=>p((n=>n.timeLog(e,...t))),T=(...e)=>p((t=>t.trace(...e))),E=(...e)=>p((t=>t.warn(...e))),C=(0,i.XY)((e=>o.yw5(e[0])),((e,t)=>p((n=>o.jGc(n.group(t),(()=>e),(()=>n.groupEnd)))))),D=(0,i.XY)((e=>o.yw5(e[0])),((e,t)=>p((n=>o.jGc(n.time(t),(()=>e),(()=>n.timeEnd(t)))))))},937957:(e,t,n)=>{n.d(t,{$v:()=>O,Ie:()=>x,Jt:()=>W,KA:()=>m,L8:()=>k,Sr:()=>p,Up:()=>T,WQ:()=>S,XI:()=>h,aE:()=>N,cJ:()=>E,dz:()=>b,h1:()=>I,ii:()=>y,og:()=>w,om:()=>q,vw:()=>f});var r=n(545422),i=n(374212),o=n(32388),s=n(755642),a=n(977148),c=n(43963),d=n(428461),l=n(584129);const p=Symbol.for("effect/Context/Tag"),u=Symbol.for("effect/STM"),h={...d.MS,_tag:"Tag",_op:"Tag",[u]:d.Hs,[p]:{_Service:e=>e,_Identifier:e=>e},toString(){return(0,s.GP)(this.toJSON())},toJSON(){return{_id:"Tag",key:this.key,stack:this.stack}},[s.FX](){return this.toJSON()},of:e=>e,context(e){return k(this,e)}},m=e=>{const t=Error.stackTraceLimit;Error.stackTraceLimit=2;const n=new Error;Error.stackTraceLimit=t;const r=Object.create(h);return Object.defineProperty(r,"stack",{get:()=>n.stack}),r.key=e,r},f=e=>()=>{const t=Error.stackTraceLimit;Error.stackTraceLimit=2;const n=new Error;function r(){}return Error.stackTraceLimit=t,Object.setPrototypeOf(r,h),r.key=e,Object.defineProperty(r,"stack",{get:()=>n.stack}),r},y=Symbol.for("effect/Context"),g={[y]:{_Services:e=>e},[r.HR](e){if(N(e)&&this.unsafeMap.size===e.unsafeMap.size){for(const t of this.unsafeMap.keys())if(!e.unsafeMap.has(t)||!r.aI(this.unsafeMap.get(t),e.unsafeMap.get(t)))return!1;return!0}return!1},[o.HR](){return o.PO(this,o.ai(this.unsafeMap.size))},pipe(){return(0,a.t)(this,arguments)},toString(){return(0,s.GP)(this.toJSON())},toJSON(){return{_id:"Context",services:Array.from(this.unsafeMap).map(s.U2)}},[s.FX](){return this.toJSON()}},w=e=>{const t=Object.create(g);return t.unsafeMap=e,t},N=e=>(0,c.i5)(e,y),b=e=>(0,c.i5)(e,p),v=w(new Map),x=()=>v,k=(e,t)=>w(new Map([[e.key,t]])),S=(0,i.XY)(3,((e,t,n)=>{const r=new Map(e.unsafeMap);return r.set(t.key,n),w(r)})),O=(0,i.XY)(2,((e,t)=>{if(!e.unsafeMap.has(t.key))throw(e=>{const t=new Error("Service not found"+(e.key?`: ${String(e.key)}`:""));if(e.stack){const n=e.stack.split("\n");if(n.length>2){const e=n[2].match(/at (.*)/);e&&(t.message=t.message+` (defined at ${e[1]})`)}}if(t.stack){const e=t.stack.split("\n");e.splice(1,3),t.stack=e.join("\n")}return t})(t);return e.unsafeMap.get(t.key)})),W=O,q=(0,i.XY)(2,((e,t)=>e.unsafeMap.has(t.key)?l.zN(e.unsafeMap.get(t.key)):l.dv)),I=(0,i.XY)(2,((e,t)=>{const n=new Map(e.unsafeMap);for(const[e,r]of t.unsafeMap)n.set(e,r);return w(n)})),T=(...e)=>t=>{const n=new Set(e.map((e=>e.key))),r=new Map;for(const[e,i]of t.unsafeMap.entries())n.has(e)&&r.set(e,i);return w(r)},E=(...e)=>t=>{const n=new Map(t.unsafeMap);for(const t of e)n.delete(t.key);return w(n)}},648029:(e,t,n)=>{n.d(t,{$m:()=>kt,A3:()=>Lt,AA:()=>le,A_:()=>Kt,Bi:()=>ft,Bj:()=>Re,Bz:()=>Ve,Cm:()=>H,DM:()=>Ke,Dd:()=>de,Do:()=>Y,EN:()=>be,Ek:()=>K,En:()=>Tt,FF:()=>Te,Fu:()=>Xt,G6:()=>pt,HW:()=>Ae,Hd:()=>G,IK:()=>A,Jk:()=>fe,Jr:()=>z,KE:()=>tt,KO:()=>Bt,Ku:()=>B,Ly:()=>Nt,MD:()=>qe,Mu:()=>$t,Mw:()=>ut,N:()=>jt,N6:()=>ve,NJ:()=>Wt,Nf:()=>re,Nu:()=>L,OM:()=>Be,Og:()=>Ee,Oo:()=>$e,Pb:()=>It,Pf:()=>Xe,Pm:()=>ie,QK:()=>ht,RJ:()=>M,RK:()=>j,RO:()=>nn,Rm:()=>Oe,SM:()=>on,Si:()=>ue,TN:()=>wt,TS:()=>Ze,U$:()=>$,Uy:()=>lt,VW:()=>oe,W$:()=>se,Wb:()=>Ht,Wj:()=>Qt,XK:()=>et,XN:()=>Ft,XP:()=>Ne,Xe:()=>we,Xx:()=>E,Xz:()=>At,YW:()=>pe,Z:()=>st,Z9:()=>zt,ZF:()=>Rt,Zc:()=>Ce,Zk:()=>Ye,_3:()=>Jt,_S:()=>ot,aW:()=>Fe,ay:()=>bt,bS:()=>D,bU:()=>Et,c1:()=>R,c7:()=>He,cb:()=>_,d5:()=>ge,dv:()=>_e,ex:()=>Gt,f1:()=>De,fH:()=>Ie,fR:()=>tn,gB:()=>Ut,gZ:()=>St,gv:()=>Zt,h1:()=>je,hq:()=>en,i4:()=>me,i8:()=>ae,iv:()=>ze,ix:()=>qt,iz:()=>Dt,k$:()=>rn,kJ:()=>xt,kr:()=>ne,lI:()=>Se,lo:()=>F,lw:()=>ct,mf:()=>Pt,nA:()=>yt,nG:()=>dt,nb:()=>P,nl:()=>ke,oI:()=>V,oJ:()=>xe,om:()=>We,p4:()=>Mt,pm:()=>U,rQ:()=>ye,rr:()=>Pe,sF:()=>gt,sw:()=>T,sx:()=>Z,t2:()=>C,u4:()=>ee,uK:()=>Qe,v6:()=>mt,vV:()=>Q,wn:()=>rt,ww:()=>_t,x1:()=>te,xA:()=>Ot,xI:()=>Vt,xS:()=>Je,yT:()=>Ge,yW:()=>vt,yu:()=>J,yy:()=>at,z7:()=>Ct,zM:()=>X,ze:()=>Ue});var r=n(7663),i=n(975955),o=n(754603),s=n(460336),a=n(703225),c=n(972e3),d=n(700182),l=n(374212),p=n(594152),u=n(793414),h=n(934796),m=n(770324),f=n(722219),y=n(30805),g=n(43963),w=n(836783),N=n(211845),b=n(950379),v=n(134564),x=n(507503),k=n(266315),S=n(778263),O=n(386831),W=n(780329),q=n(431211),I=n(338753);const T=(0,l.XY)((e=>x.yw5(e[0])),(function(){const e=arguments;return x.q1t(e[0],x.Umi,"string"==typeof e[1]?p.hZ(e[1],e[2]):t=>Object.entries(e[1]).reduce(((e,[t,n])=>p.hZ(e,t,n)),t))})),E=e=>x.TjK(e,y.zN),C=e=>x.xm_(e,y.zN),D=e=>{let t,n;return"function"==typeof e?t=e:(t=e.try,n=e.catch),x.OH5((()=>{try{return t()}catch(e){throw x.eO_(b.fJ(n?n(e):new x.Uis(e)))}}))},P=(0,l.XY)(3,((e,t,n)=>x.h9N(e,(e=>g.i5(e,t)&&e[t]===n.failure?n.onFailure(e):x.fJG(e))))),A=(0,l.XY)(2,((e,t)=>x.uPo(e,(e=>{const n=b.I6(e,(e=>b.VY(e)?y.zN(e):y.dv()));switch(n._tag){case"None":return x.ATB(e);case"Some":return t(n.value.defect)}})))),M=(0,l.XY)(2,((e,t)=>x.khu(e,{onFailure:e=>{const n=t(e);switch(n._tag){case"None":return x.ATB(e);case"Some":return n.value}},onSuccess:x.PyW}))),L=(0,l.XY)(2,((e,t)=>x.uPo(e,(e=>{const n=b.I6(e,(e=>b.VY(e)?y.zN(e):y.dv()));switch(n._tag){case"None":return x.ATB(e);case"Some":{const r=t(n.value.defect);return"Some"===r._tag?r.value:x.ATB(e)}}})))),B=(0,l.XY)(3,((e,t,n)=>x.XWm(e,g.$J(t),n))),F=(0,l.XY)(2,((e,t)=>{let n;return x.XWm(e,(e=>(n??=Object.keys(t),g.i5(e,"_tag")&&g.Kg(e._tag)&&n.includes(e._tag))),(e=>t[e._tag](e)))})),R=e=>x.D$$(e,{onFailure:l.D_,onSuccess:()=>b.Ie}),j=s.RK,U=j(x.PyW),_=(0,l.XY)(2,((e,t)=>x.aNH(s.yy(t),e))),$=e=>x.$we(((t,n)=>e({id:t.id(),status:n,interruptors:b.ml(t.getFiberRef(x.LGt))}))),Q=$((e=>u.Ej(e.interruptors)>0?x.GaK:x.rIH)),J=$(x.PyW),K=e=>lt(e,ye,O.Ui),Y=x.PyW({}),V=S.oI(x.TjK,x.qIB),z=S.Jr(x.TjK),X=S.zM(x.TjK),H=(0,l.XY)(2,((e,t)=>x.DYE((()=>{const n=e[Symbol.iterator](),r=[];let i,o=x.PyW(!1),s=0;for(;(i=n.next())&&!i.done;){const e=i.value,n=s++;o=x.qIB(o,(i=>i?(r.push(e),x.PyW(!0)):t(e,n)))}return x.TjK(o,(()=>r))})))),G=(0,l.XY)(2,((e,t)=>x.DYE((()=>{const n=e[Symbol.iterator](),r=[];let i,o=x.PyW(!0),s=0;for(;(i=n.next())&&!i.done;){const e=i.value,n=s++;o=x.qIB(o,(i=>x.TjK(i?t(e,n):x.PyW(!1),(t=>(t||r.push(e),t)))))}return x.TjK(o,(()=>r))})))),Z=e=>x.TjK(x._OA(),e),ee=e=>x.NWQ(e,(()=>x.qIB(x.m9E(),(()=>ee(e))))),te=(0,l.XY)(2,((e,t)=>x.TjK(x.CFK(e,l.D_),i.x1(t)))),ne=(0,l.XY)(3,((e,t,n)=>ie(e,t,(e=>x.Kbz((()=>n(e))))))),re=(0,l.XY)(3,((e,t,n)=>ie(e,t,(()=>x.GSS(n))))),ie=(0,l.XY)(3,((e,t,n)=>x.qIB(e,(e=>t(e)?x.PyW(e):n(e))))),oe=(0,l.XY)(3,((e,t,n)=>x.DYE((()=>t(e)?x.PyW(e):x.fJG(n(e)))))),se=(0,l.XY)((e=>x.yw5(e[0])),((e,t,n)=>ie(e,t,(e=>void 0===n?x.fJG(new x.kJg):x.gOk((()=>n(e))))))),ae=(0,l.XY)(2,((e,t)=>x.DYE((()=>{const n=e[Symbol.iterator](),r=n.next();return r.done?x.PyW(y.dv()):ce(n,0,t,r.value)})))),ce=(e,t,n,r)=>x.qIB(n(r,t),(i=>{if(i)return x.PyW(y.zN(r));const o=e.next();return o.done?x.PyW(y.dv()):ce(e,t+1,n,o.value)})),de=e=>x.DYE((()=>{const t=o.Ts(e);return o.J_(t)?(0,l.Fs)(o.Rx(t),i.TS(o.v4(t),((e,t)=>x.NWQ(e,(()=>t))))):x.Kbz((()=>new x.nAV("Received an empty collection of effects")))})),le=(0,l.XY)(2,((e,t)=>x.UUz(t(x.UUz(e))))),pe=(0,l.XY)(2,((e,t)=>x.tvg(e,{onFailure:e=>x.PyW(t.onFailure(e)),onSuccess:e=>x.PyW(t.onSuccess(e))}))),ue=(0,l.XY)(2,((e,t)=>x.DYE((()=>he(e[Symbol.iterator](),0,t))))),he=(e,t,n)=>{const r=e.next();return r.done?x.PyW(!0):x.qIB(n(r.value,t),(r=>r?he(e,t+1,n):x.PyW(r)))},me=e=>{const t=x.qIB(x.qIB(e,(()=>x.m9E())),(()=>t));return t},fe=function(){let e;return e=1===arguments.length?arguments[0]:arguments[1].bind(arguments[0]),x.DYE((()=>{const t=e(l.Fs),n=(0,r.sn)((()=>t.next())),i=e=>e.done?x.PyW(e.value):x.qIB((0,r.ku)(e.value),(e=>i((0,r.sn)((()=>t.next(e))))));return i(n)}))},ye=x.$we((e=>x.PyW(e.getFiberRefs()))),ge=e=>x.qIB(e,(e=>{const t=e[Symbol.iterator]().next();return t.done?x.fJG(new x.kJg):x.PyW(t.value)})),we=e=>pe(e,{onFailure:l.Yi,onSuccess:l.Yi}),Ne=e=>x.khu(e,{onFailure:e=>qe(e,"An error was silently ignored because it is not anticipated to be useful"),onSuccess:()=>x.rIH}),be=e=>Tt(((t,n)=>d.rl(n,t,e))),ve=e=>pe(e,{onFailure:l.ue,onSuccess:l.f4}),xe=e=>pe(e,{onFailure:l.f4,onSuccess:l.ue}),ke=(e,t)=>x.DYE((()=>t.while(e)?x.qIB(t.body(e),(e=>ke(e,t))):x.PyW(e))),Se=e=>(...t)=>{const n=y.k$(e);let r;for(let e=0,n=t.length;e<n;e++){const n=t[e];b.Aj(n)&&(r=void 0!==r?b.il(r,n):n,t=[...t.slice(0,e),...t.slice(e+1)],e--)}return void 0===r&&(r=b.Ie),x.$we((e=>(e.log(t,r,n),x.rIH)))},Oe=Se(),We=Se(m.Cn),qe=Se(m.y),Ie=Se(m.R2),Te=Se(m.N5),Ee=Se(m.$D),Ce=Se(m.Lj),De=(0,l.XY)(2,((e,t)=>x.qIB(s.Ru,(n=>x.q1t(e,x.krO,h.Hs(f.L(t,n))))))),Pe=x.U8_(x.Umi),Ae=(e,t)=>t.discard?Le(e,t.while,t.step,t.body):x.TjK(Me(e,t.while,t.step,t.body),i.Ts),Me=(e,t,n,r)=>x.DYE((()=>t(e)?x.qIB(r(e),(i=>x.TjK(Me(n(e),t,n,r),h.Hs(i)))):x.OH5((()=>h.Ie())))),Le=(e,t,n,r)=>x.DYE((()=>t(e)?x.qIB(r(e),(()=>Le(n(e),t,n,r))):x.rIH)),Be=(0,l.XY)(3,((e,t,n)=>x.DYE((()=>{const r=e[Symbol.iterator](),i=[];let o,s=x.PyW(t),a=0;for(;!(o=r.next()).done;){const e=a++,t=o.value;s=x.qIB(s,(r=>x.TjK(n(r,t,e),(([e,t])=>(i.push(t),e)))))}return x.TjK(s,(e=>[e,i]))})))),Fe=(0,l.XY)(2,((e,t)=>x.khu(e,{onFailure:e=>x.pVV((()=>t(e))),onSuccess:x.PyW}))),Re=e=>(0,l.Fs)(x.WW4(),x.qIB((t=>(0,l.Fs)((e=>lt(e,x.yU6(ye,x.m$m),(([e,t],[n,r])=>[O.Ui(e,n),q.Ui(t,r)])))(e),x._ig(t),$e,x.TjK((e=>x.aNH(e,(0,l.Fs)(x.gn0(t),x.qIB((([e,t])=>x.as(x.yU6(Ve(e[0]),x.$QS(e[1])),t))))))))))),je=e=>x.tvg(e,{onFailure:e=>x.PyW(e),onSuccess:x.PyW}),Ue=e=>x.TjK(e,(e=>!e)),_e=e=>x.qIB(e,(e=>{switch(e._tag){case"None":return x.rIH;case"Some":return x.fJG(new x.kJg)}})),$e=e=>x.TjK(w.L8(!0),(t=>x.NLW(x.iK2(e,w.C2(t,!1))))),Qe=e=>x.tvg(e,{onFailure:()=>x.PyW(y.dv()),onSuccess:e=>x.PyW(y.zN(e))}),Je=(0,l.XY)(2,((e,t)=>x.NWQ(e,(()=>x.gOk(t))))),Ke=(0,l.XY)(2,((e,t)=>x.NWQ(e,(()=>x.OH5(t))))),Ye=e=>x.khu(e,{onFailure:e=>{const t=i.Ts(b.e9(e));return 0===t.length?x.ATB(e):x.fJG(t)},onSuccess:x.PyW}),Ve=e=>Tt(((t,n)=>(0,l.Fs)(e,O.F6(t,n)))),ze=e=>e.length>=1?x.bIC(((t,n)=>{e(n).then((e=>t(x.xtk(e))),(e=>t(x.V2G(e))))})):x.bIC((t=>{e().then((e=>t(x.xtk(e))),(e=>t(x.V2G(e))))})),Xe=(0,l.XY)(3,((e,t,n)=>x.d_m((r=>x.PpN(e,a.WQ(r,t,n)))))),He=(0,l.XY)(3,((e,t,n)=>x.d_m((r=>x.qIB(n,(n=>x.PpN(e,(0,l.Fs)(r,a.WQ(t,n))))))))),Ge=k.Gx(x.PyW),Ze=(0,l.XY)(3,((e,t,n)=>i.Ts(e).reduce(((e,t,r)=>x.qIB(e,(e=>n(e,t,r)))),x.PyW(t)))),et=(0,l.XY)(3,((e,t,n)=>i.Ts(e).reduceRight(((e,t,r)=>x.qIB(e,(e=>n(t,e,r)))),x.PyW(t)))),tt=(0,l.XY)(3,((e,t,n)=>x.qIB(x.OH5((()=>e[Symbol.iterator]())),(e=>nt(e,0,t,n.while,n.body))))),nt=(e,t,n,r,i)=>{const o=e.next();return!o.done&&r(n)?x.qIB(i(n,o.value,t),(n=>nt(e,t+1,n,r,i))):x.PyW(n)},rt=(0,l.XY)(2,((e,t)=>x.DYE((()=>it(e,t))))),it=(e,t)=>x.qIB(e,(n=>t<=0?x.PyW(n):x.aNH(x.m9E(),it(e,t-1)))),ot=e=>x.khu(e,{onFailure:x.fJG,onSuccess:x.PyW}),st=e=>x.DYE((()=>d.Au(e))),at=s.yy,ct=x.PyW(y.dv()),dt=e=>x.PyW(y.zN(e)),lt=(0,l.XY)(3,((e,t,n)=>x.qIB(t,(r=>x.qIB(e,(e=>x.TjK(t,(t=>[n(r,t),e])))))))),pt=(0,l.XY)((e=>x.yw5(e[0])),(function(){return ut(arguments[0],"string"==typeof arguments[1]?[W.L8(arguments[1],arguments[2])]:Object.entries(arguments[1]).map((([e,t])=>W.L8(e,t))))})),ut=(0,l.XY)(2,((e,t)=>x.q1t(e,x.b1P,(e=>i.KC(e,t))))),ht=(0,l.XY)(2,((e,t)=>x.DYE((()=>{const n=e[Symbol.iterator](),r=[];let i,o=x.PyW(!1),s=0;for(;(i=n.next())&&!i.done;){const e=i.value,n=s++;o=x.qIB(o,(i=>i?x.PyW(!0):(r.push(e),t(e,n))))}return x.TjK(o,(()=>r))})))),mt=(0,l.XY)(2,((e,t)=>x.DYE((()=>{const n=e[Symbol.iterator](),r=[];let i,o=x.PyW(!0),s=0;for(;(i=n.next())&&!i.done;){const e=i.value,n=s++;o=x.qIB(o,(i=>(0,l.Fs)(i?t(e,n):x.PyW(!1),x.TjK((t=>(t&&r.push(e),t))))))}return x.TjK(o,(()=>r))})))),ft=(0,l.XY)(2,((e,{onFailure:t,onSuccess:n})=>x.khu(e,{onFailure:e=>{const n=b.vE(e);switch(n._tag){case"Left":return x.aNH(t(n.left),x.ATB(e));case"Right":return x.ATB(e)}},onSuccess:e=>x.as(n(e),e)}))),yt=(0,l.XY)(2,((e,t)=>x.uPo(e,(e=>y.YW(b.AW(e),{onNone:()=>x.ATB(e),onSome:n=>x.aNH(t(n),x.ATB(e))}))))),gt=(0,l.XY)(2,((e,t)=>x.khu(e,{onFailure:e=>{const n=b.vE(e);switch(n._tag){case"Left":return x.aNH(t(n.left),x.ATB(e));case"Right":return x.ATB(e)}},onSuccess:x.PyW}))),wt=(0,l.XY)(3,((e,t,n)=>gt(e,(e=>g.$J(e,t)?n(e):x.rIH)))),Nt=(0,l.XY)(2,((e,t)=>x.khu(e,{onFailure:e=>x.aNH(t(e),x.ATB(e)),onSuccess:x.PyW}))),bt=e=>vt(e,s.s0),vt=(0,l.XY)(2,((e,t)=>lt(e,t,((e,t)=>c.cF(t-e))))),xt=(0,N.wT)(x.PyW),kt=e=>{let t,n;return"function"==typeof e?t=e:(t=e.try,n=e.catch),t.length>=1?x.bIC(((e,r)=>{try{t(r).then((t=>e(x.xtk(t))),(t=>e(x.fJG(n?n(t):new x.Uis(t)))))}catch(t){e(x.fJG(n?n(t):new x.Uis(t)))}})):x.bIC((e=>{try{t().then((t=>e(x.xtk(t))),(t=>e(x.fJG(n?n(t):new x.Uis(t)))))}catch(t){e(x.fJG(n?n(t):new x.Uis(t)))}}))},St=(0,l.XY)(2,((e,t)=>x.qIB(e,(e=>D({try:()=>t.try(e),catch:t.catch}))))),Ot=(0,l.XY)(2,((e,t)=>x.qIB(e,(e=>kt({try:t.try.length>=1?n=>t.try(e,n):()=>t.try(e),catch:t.catch}))))),Wt=(0,l.XY)(2,((e,t)=>x.DYE((()=>t()?ct:E(e))))),qt=(0,l.XY)(2,((e,t)=>x.qIB(t,(t=>t?ct:E(e))))),It=e=>Fe(e,b.Bq),Tt=e=>x.$we((t=>(t.setFiberRefs(e(t.id(),t.getFiberRefs())),x.rIH))),Et=(0,l.XY)(3,((e,t,n)=>x.kyh(e,(e=>a.WQ(e,t,n(a.$v(e,t))))))),Ct=(0,l.XY)(2,((e,t)=>x.DYE((()=>t()?x.TjK(e,y.zN):x.PyW(y.dv()))))),Dt=(0,l.XY)(3,((e,t,n)=>x.qIB(x.U8_(t),(t=>n(t)?x.TjK(e,(e=>[t,y.zN(e)])):x.PyW([t,y.dv()]))))),Pt=(0,l.XY)(3,((e,t,n)=>x.qIB(w.Jt(t),(t=>n(t)?x.TjK(e,(e=>[t,y.zN(e)])):x.PyW([t,y.dv()]))))),At=(0,l.XY)(2,((e,t)=>t(e))),Mt=(e,t)=>(...n)=>x.qIB(e,(e=>t(e)(...n))),Lt=(e,t)=>(...n)=>x.TjK(e,(e=>t(e)(...n))),Bt=e=>new Proxy({},{get:(t,n,r)=>(...t)=>x.qIB(e,(e=>e[n](...t)))}),Ft=e=>new Proxy({},{get:(t,n,r)=>x.qIB(e,(e=>x.yw5(e[n])?e[n]:x.PyW(e[n])))}),Rt=e=>({functions:Bt(e),constants:Ft(e)}),jt=e=>x.TjK(x._OA(),a.om(e)),Ut=e=>x.qIB(x._OA(),a.om(e)),_t=function(){const e=arguments;return we(x.qIB(Jt,(t=>x.OH5((()=>{if("string"==typeof e[0])t.attribute(e[0],e[1]);else for(const n in e[0])t.attribute(n,e[0][n])})))))},$t=(0,l.XY)((e=>x.yw5(e[0])),(function(){const e=arguments;return x.q1t(e[0],x.BzD,"string"==typeof e[1]?p.hZ(e[1],e[2]):t=>Object.entries(e[1]).reduce(((e,[t,n])=>p.hZ(e,t,n)),t))})),Qt=Ut(I.Te),Jt=x.qIB(x._OA(),(e=>{const t=e.unsafeMap.get(I.Te.key);return void 0!==t&&"Span"===t._tag?x.PyW(t):x.fJG(new x.kJg)})),Kt=(0,l.XY)((e=>x.yw5(e[0])),((e,t,n)=>x.q1t(e,x.s$T,o.BC({_tag:"SpanLink",span:t,attributes:n??{}})))),Yt=BigInt(0),Vt=(e,t,n)=>{if(!1===e.getFiberRef(x.MP9))return x.bVS(t);const r=e.getFiberRef(x.Fi1),c=e.getFiberRef(k.qJ),l=a.Jt(c,I.Ez),u=a.Jt(c,s.zD),h=e.getFiberRef(x.QYw),m=e.getFiberRefs(),f=d.Jt(m,x.BzD),g=d.Jt(m,x.s$T),w=n.parent?y.zN(n.parent):n.root?y.dv():a.om(r,I.Te),N="Some"===g._tag?void 0!==n.links?[...o.h3(g.value),...n.links??[]]:o.h3(g.value):n.links??i.Ie(),v=l.span(t,w,n.context??a.Ie(),N,h?u.unsafeCurrentTimeNanos():Yt,n.kind??"internal");return"function"==typeof n.captureStackTrace&&b.rF.set(v,n.captureStackTrace),"Some"===f._tag&&p.jJ(f.value,((e,t)=>v.attribute(t,e))),void 0!==n.attributes&&Object.entries(n.attributes).forEach((([e,t])=>v.attribute(e,t))),v},zt=(e,t)=>(t=I.ZA(t),x.$we((n=>x.PyW(Vt(n,e,t))))),Xt=x.U8_(x.BzD),Ht=x.U8_(x.s$T),Gt=(e,t,n,r)=>x.OH5((()=>{"Ended"!==e.status._tag&&(x.VE1(t)&&b.rF.has(e)&&e.attribute("code.stacktrace",b.rF.get(e)()),e.end(r?n.unsafeCurrentTimeNanos():Yt,t))})),Zt=(e,...t)=>{const n=I.ZA(1===t.length?void 0:t[0]),r=t[t.length-1];return x.$we((t=>{const i=Vt(t,e,n),o=t.getFiberRef(x.QYw),s=a.Jt(t.getFiberRef(k.qJ),v.hV);return x.cfM(r(i),(e=>Gt(i,e,s,o)))}))},en=(0,l.XY)(2,((e,t)=>Xe(e,I.Te,t))),tn=function(){const e="string"!=typeof arguments[0],t=e?arguments[1]:arguments[0],n=I.ZA(e?arguments[2]:arguments[1]);if(e){const e=arguments[0];return Zt(t,n,(t=>en(e,t)))}return e=>Zt(t,n,(t=>en(e,t)))},nn=e=>function(){let t=e.captureStackTrace??!1;if(!1!==e.captureStackTrace){const e=Error.stackTraceLimit;Error.stackTraceLimit=2;const n=new Error;Error.stackTraceLimit=e;let r=!1;t=()=>{if(!1!==r)return r;if(n.stack){const e=n.stack.trim().split("\n");return r=e.slice(2).join("\n").trim(),r}}}return x.DYE((()=>{const n="function"==typeof e.options?e.options.apply(null,arguments):e.options;return tn(x.DYE((()=>(0,r.sn)((()=>e.body.apply(this,arguments))))),n.name,{...n,captureStackTrace:t})}))},rn=e=>null==e?x.fJG(new x.kJg):x.PyW(e),on=e=>x.h9N(x.TjK(e,y.zN),(e=>x.QRo(e)?ct:x.fJG(e)))},119153:(e,t,n)=>{n.d(t,{MG:()=>s,ii:()=>o,nS:()=>a});var r=n(703225),i=n(507503);const o=Symbol.for("effect/Console"),s=r.Io("effect/Console"),a={[o]:o,assert:(e,...t)=>i.OH5((()=>{console.assert(e,...t)})),clear:i.OH5((()=>{console.clear()})),count:e=>i.OH5((()=>{console.count(e)})),countReset:e=>i.OH5((()=>{console.countReset(e)})),debug:(...e)=>i.OH5((()=>{console.debug(...e)})),dir:(e,t)=>i.OH5((()=>{console.dir(e,t)})),dirxml:(...e)=>i.OH5((()=>{console.dirxml(...e)})),error:(...e)=>i.OH5((()=>{console.error(...e)})),group:e=>e?.collapsed?i.OH5((()=>console.groupCollapsed(e?.label))):i.OH5((()=>console.group(e?.label))),groupEnd:i.OH5((()=>{console.groupEnd()})),info:(...e)=>i.OH5((()=>{console.info(...e)})),log:(...e)=>i.OH5((()=>{console.log(...e)})),table:(e,t)=>i.OH5((()=>{console.table(e,t)})),time:e=>i.OH5((()=>console.time(e))),timeEnd:e=>i.OH5((()=>console.timeEnd(e))),timeLog:(e,...t)=>i.OH5((()=>{console.timeLog(e,...t)})),trace:(...e)=>i.OH5((()=>{console.trace(...e)})),warn:(...e)=>i.OH5((()=>{console.warn(...e)})),unsafe:console}},338265:(e,t,n)=>{n.d(t,{$T:()=>R,AN:()=>V,CJ:()=>E,D5:()=>X,Do:()=>ne,GR:()=>A,KT:()=>Q,KX:()=>G,L_:()=>$,Oy:()=>L,PC:()=>I,PJ:()=>te,PO:()=>T,RI:()=>W,Rq:()=>J,S1:()=>ie,SH:()=>ae,Tg:()=>K,VH:()=>q,XJ:()=>oe,ar:()=>B,gh:()=>se,jE:()=>M,nH:()=>H,ny:()=>z,oD:()=>re,qK:()=>j,wR:()=>Y,x6:()=>F});var r=n(972e3),i=n(545422),o=n(217076),s=n(487529),a=n(374212),c=n(32388),d=n(704928),l=n(30805),p=n(977148),u=n(43963),h=n(203956),m=n(345059),f=n(950379),y=n(648029),g=n(507503),w=n(999233),N=n(760852),b=n(426964),v=n(901006),x=n(360643),k=n(387162),S=n(997014);class O{permits;waiters=new Set;taken=0;constructor(e){this.permits=e}get free(){return this.permits-this.taken}take=e=>g.bIC((t=>{if(this.free<e){const n=()=>{this.free<e||(this.waiters.delete(n),this.taken+=e,t(g.PyW(e)))};return this.waiters.add(n),g.OH5((()=>{this.waiters.delete(n)}))}return this.taken+=e,t(g.PyW(e))}));updateTaken=e=>g.$we((t=>(this.taken=e(this.taken),this.waiters.size>0&&t.getFiberRef(m.X_).scheduleTask((()=>{const e=this.waiters.values();let t=e.next();for(;!1===t.done&&this.free>0;)t.value(),t=e.next()}),t.getFiberRef(g.QPU)),g.PyW(this.free))));release=e=>this.updateTaken((t=>t-e));releaseAll=this.updateTaken((e=>0));withPermits=e=>t=>g.FcF((n=>g.qIB(n(this.take(e)),(e=>b.ye(n(t),this.release(e))))))}const W=e=>new O(e),q=e=>g.OH5((()=>W(e))),I=e=>M(e,b.C6),T=(0,a.XY)(2,((e,t)=>g.TjK(E(e,t),(e=>e[0])))),E=(0,a.XY)(2,((e,t)=>{const n=r.D4(t);return g.qIB(g._OA(),(t=>g.TjK(te(l.dv()),(r=>[g.PpN(D(e,n,r),t),P(r)]))))})),C=(e,t,n)=>{const i=r.kE(r.D4(t));return(0,a.Fs)(g.WW4(),g.Mim((t=>g._ig(e,t))),g.TjK((e=>l.zN([n+i,e]))))},D=(e,t,n)=>g.FcF((r=>(0,a.Fs)(y.RK((e=>e.currentTimeMillis)),g.qIB((r=>re(n,(n=>{switch(n._tag){case"None":return l.zN(C(e,t,r));case"Some":{const[i]=n.value;return i-r<=0?l.zN(C(e,t,r)):l.dv()}}})))),g.qIB((e=>l.$I(e)?g.GSS("BUG: Effect.cachedInvalidate - please report an issue at https://github.com/Effect-TS/effect/issues"):r(g.gn0(e.value[1]))))))),P=e=>x.hZ(e,l.dv()),A=(0,a.XY)(2,((e,t)=>M(e,(e=>t(b.qm(e)))))),M=(0,a.XY)(2,((e,t)=>g.qIB(S.u4,(n=>(0,a.Fs)(K(e,n),b.ye(g.qIB(n.value,t))))))),L=(0,a.XY)((e=>u.xZ(e[0])),((e,t)=>t?.discard?g.QZV(e,b.Zy):g.TjK(g.CFK(e,b.Zy),b.qm))),B=(0,a.XY)(2,((e,t)=>g.FcF((n=>g.qIB(t.fork(w.il),(t=>(0,a.Fs)(n(e),g.cfM((e=>t.close(e))),b.LX,g.Mim((e=>t.addFinalizer((()=>g.g1G((t=>i.aI(t,e.id())?g.rIH:g.NLW(g.OLv(e))))))))))))))),F=e=>b.NB((t=>B(e,t))),R=e=>N.fj(e),j=e=>g.DYE((()=>g.qIB(e,N.fj))),U=Symbol.for("effect/Effect/memoizeFunction.key");class _{a;eq;[U]=U;constructor(e,t){this.a=e,this.eq=t}[i.HR](e){return!!u.i5(e,U)&&(this.eq?this.eq(this.a,e.a):i.aI(this.a,e.a))}[c.HR](){return this.eq?0:c.PO(this,c.tW(this.a))}}const $=(e,t)=>(0,a.Fs)(g.OH5((()=>d.Ie())),g.qIB(te),g.TjK((n=>r=>(0,a.Fs)(n.modifyEffect((n=>{const i=(0,a.Fs)(n,d.Jt(new _(r,t)));return l.$I(i)?(0,a.Fs)(g.WW4(),g.Mim((t=>(0,a.Fs)(y.Ek(e(r)),g._ig(t),b.Zy))),g.TjK((e=>[e,(0,a.Fs)(n,d.hZ(new _(r,t),e))]))):g.PyW([i.value,n])})),g.qIB(g.gn0),g.qIB((([e,t])=>(0,a.Fs)(y.Bz(e),g.as(t)))))))),Q=(0,a.XY)(2,((e,t)=>(0,a.Fs)(g.NS5(e),b.O4(g.NS5(t)),(e=>g.Bqz(e))))),J=(0,a.XY)(2,((e,t)=>(0,a.Fs)(e,k.mg(t),F))),K=(0,a.XY)(2,((e,t)=>g.q1t(b.me,(e=>e.zip(t)))(e))),Y=(0,a.XY)(2,((e,t)=>V(e,{onTimeout:()=>g.x6Q(t),duration:t}))),V=(0,a.XY)(2,((e,{duration:t,onTimeout:n})=>g.Bqz(H(e,{onTimeout:()=>g.gOk(n),onSuccess:g.PyW,duration:t})))),z=(0,a.XY)(2,((e,{duration:t,onTimeout:n})=>g.Bqz(H(e,{onTimeout:()=>g.pVV(n),onSuccess:g.PyW,duration:t})))),X=(0,a.XY)(2,((e,t)=>H(e,{duration:t,onSuccess:l.zN,onTimeout:l.dv}))),H=(0,a.XY)(2,((e,{duration:t,onSuccess:n,onTimeout:r})=>g.g1G((i=>b.Fp(e,g.Inz(y.yy(t)),{onSelfWin:(e,t)=>g.qIB(e.await,(r=>"Success"===r._tag?g.qIB(e.inheritAll,(()=>g.as(g._tB(t,i),n(r.value)))):g.qIB(g._tB(t,i),(()=>g.cbD(r.cause))))),onOtherWin:(e,t)=>g.qIB(e.await,(n=>"Success"===n._tag?g.qIB(e.inheritAll,(()=>g.as(g._tB(t,i),r()))):g.qIB(g._tB(t,i),(()=>g.cbD(n.cause))))),otherScope:v.gm}))))),G=Symbol.for("effect/Ref/SynchronizedRef"),Z={_A:e=>e};class ee{ref;withLock;[G]=Z;[x.ll]=x.VO;[h.ii];constructor(e,t){this.ref=e,this.withLock=t,this[h.ii]=h.ii,this.get=x.Jt(this.ref)}get;modify(e){return this.modifyEffect((t=>g.PyW(e(t))))}modifyEffect(e){return this.withLock((0,a.Fs)(g.qIB(x.Jt(this.ref),e),g.qIB((([e,t])=>g.as(x.hZ(this.ref,t),e)))))}pipe(){return(0,p.t)(this,arguments)}}const te=e=>g.OH5((()=>ne(e))),ne=e=>{const t=x.s$(e),n=W(1);return new ee(t,n.withPermits(1))},re=(0,a.XY)(2,((e,t)=>e.modifyEffect((e=>{const n=t(e);switch(n._tag){case"None":return g.PyW([e,e]);case"Some":return g.TjK(n.value,(e=>[e,e]))}})))),ie=(0,a.XY)(2,((e,t)=>ae(e,t,((e,t)=>[e,t])))),oe=(0,a.XY)(2,((e,t)=>ae(e,t,((e,t)=>e)))),se=(0,a.XY)(2,((e,t)=>ae(e,t,((e,t)=>t)))),ae=(0,a.XY)(3,((e,t,n)=>({[N.QV]:N.GP,id:()=>(0,a.Fs)(e.id(),s.Do(t.id())),await:(0,a.Fs)(e.await,g.Bqz,b.cw(g.Bqz(t.await),n,{concurrent:!0}),g.NS5),children:e.children,inheritAll:g.aNH(t.inheritAll,e.inheritAll),poll:g.OYO(e.poll,t.poll,((e,t)=>(0,a.Fs)(e,l.qI((e=>(0,a.Fs)(t,l.Tj((t=>o.OY(e,t,{onSuccess:n,onFailure:f._7}))))))))),interruptAsFork:n=>g.aNH(e.interruptAsFork(n),t.interruptAsFork(n)),pipe(){return(0,p.t)(this,arguments)}})))},617437:(e,t,n)=>{n.d(t,{BQ:()=>p,Gt:()=>d,JP:()=>c,Wz:()=>u,Y3:()=>a,cH:()=>s,pu:()=>h,sY:()=>l});var r=n(374212),i=n(30805),o=n(507503);const s=(0,r.XY)(2,((e,t)=>e.modifyEffect((e=>o.TjK(t(e),(t=>[e,t])))))),a=(0,r.XY)(2,((e,t)=>e.modifyEffect((e=>{const n=t(e);switch(n._tag){case"None":return o.PyW([e,e]);case"Some":return o.TjK(n.value,(t=>[e,t]))}})))),c=(0,r.XY)(2,((e,t)=>e.modify(t))),d=(0,r.XY)(2,((e,t)=>e.modifyEffect(t))),l=(0,r.XY)(3,((e,t,n)=>e.modifyEffect((e=>(0,r.Fs)(n(e),i.WL((()=>o.PyW([t,e])))))))),p=(0,r.XY)(2,((e,t)=>e.modifyEffect((e=>o.TjK(t(e),(e=>[void 0,e])))))),u=(0,r.XY)(2,((e,t)=>e.modifyEffect((e=>o.TjK(t(e),(e=>[e,e])))))),h=(0,r.XY)(2,((e,t)=>e.modifyEffect((e=>{const n=t(e);switch(n._tag){case"None":return o.PyW([void 0,e]);case"Some":return o.TjK(n.value,(e=>[void 0,e]))}}))))}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var o=r[e]={exports:{}};return n[e](o,o.exports,i),o.exports}i.m=n,i.x=()=>{var e=i.O(void 0,[516,733],(()=>i(821790)));return i.O(e)},e=[],i.O=(t,n,r,o)=>{if(!n){var s=1/0;for(l=0;l<e.length;l++){for(var[n,r,o]=e[l],a=!0,c=0;c<n.length;c++)(!1&o||s>=o)&&Object.keys(i.O).every((e=>i.O[e](n[c])))?n.splice(c--,1):(a=!1,o<s&&(s=o));if(a){e.splice(l--,1);var d=r();void 0!==d&&(t=d)}}return t}o=o||0;for(var l=e.length;l>0&&e[l-1][2]>o;l--)e[l]=e[l-1];e[l]=[n,r,o]},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,n)=>(i.f[n](e,t),t)),[])),i.u=e=>e+".js",i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),(()=>{i.b=self.location+"";var e={790:1};i.f.i=(t,n)=>{e[t]||importScripts(i.p+i.u(t))};var t=self.webpackChunkstarpyapp=self.webpackChunkstarpyapp||[],n=t.push.bind(t);t.push=t=>{var[r,o,s]=t;for(var a in o)i.o(o,a)&&(i.m[a]=o[a]);for(s&&s(i);r.length;)e[r.pop()]=1;n(t)}})(),t=i.x,i.x=()=>Promise.all([i.e(516),i.e(733)]).then(t),i.x()})();