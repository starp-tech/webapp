/*! For license information please see 925.js.LICENSE.txt */
(()=>{"use strict";var e,t,n={28789:(e,t,n)=>{n.d(t,{$N:()=>C,$O:()=>A,$j:()=>He,Ad:()=>x,BW:()=>N,C8:()=>_e,D6:()=>J,DH:()=>k,Dp:()=>f,EK:()=>Ke,E_:()=>I,Ey:()=>y,Gb:()=>Ie,IT:()=>Qe,J5:()=>W,Jo:()=>O,Kt:()=>ee,Ky:()=>Ee,M3:()=>ne,M7:()=>R,MR:()=>S,Mz:()=>Be,NH:()=>Te,OD:()=>fe,On:()=>g,Re:()=>U,SB:()=>h,TD:()=>Oe,U4:()=>b,V3:()=>Ue,Wy:()=>$e,XS:()=>ue,YI:()=>j,YN:()=>m,YP:()=>we,Z8:()=>w,ZG:()=>ve,ZU:()=>xe,Zi:()=>ye,Zn:()=>Ye,_q:()=>se,ai:()=>ie,c$:()=>V,ch:()=>z,dw:()=>Xe,fq:()=>M,g1:()=>et,gP:()=>Le,gV:()=>Me,gw:()=>E,hk:()=>ze,iJ:()=>F,kV:()=>je,nt:()=>Ve,oA:()=>G,p$:()=>tt,rQ:()=>ot,rt:()=>D,u7:()=>v,uS:()=>Y,vs:()=>ce,w_:()=>H,zh:()=>ke});var r=n(58600),i=n(61369),o=n(6517),s=n(4676),a=n(77948),c=n(59877),d=n(56572),l=n(95156),u=n(41112),p=n(15407);const h=Symbol.for("@effect/schema/annotation/Brand"),f=Symbol.for("@effect/schema/annotation/Type"),m=Symbol.for("@effect/schema/annotation/Message"),y=Symbol.for("@effect/schema/annotation/MissingMessage"),g=Symbol.for("@effect/schema/annotation/Identifier"),w=Symbol.for("@effect/schema/annotation/Title"),N=Symbol.for("@effect/schema/annotation/Description"),b=Symbol.for("@effect/schema/annotation/Examples"),v=Symbol.for("@effect/schema/annotation/Default"),x=Symbol.for("@effect/schema/annotation/JSONSchema"),k=Symbol.for("@effect/schema/annotation/Documentation"),S=Symbol.for("@effect/schema/annotation/Concurrency"),O=Symbol.for("@effect/schema/annotation/Batching"),W=Symbol.for("@effect/schema/annotation/ParseIssueTitle"),I=Symbol.for("@effect/schema/annotation/ParseOptions"),q=Symbol.for("@effect/schema/annotation/Surrogate"),T=Symbol.for("@effect/schema/annotation/StableFilter"),E=(0,i.XY)(2,((e,t)=>Object.prototype.hasOwnProperty.call(e.annotations,t)?a.zN(e.annotations[t]):a.dv())),C=E(h),A=E(m),D=E(y),P=E(w),L=E(g),B=E(N),M=E(S),F=E(O),R=E(W),U=E(I),j=E(q),_=E(T),$=Symbol.for("@effect/schema/annotation/JSONIdentifier"),Q=E($);class J{typeParameters;decodeUnknown;encodeUnknown;annotations;_tag="Declaration";constructor(e,t,n,r={}){this.typeParameters=e,this.decodeUnknown=t,this.encodeUnknown=n,this.annotations=r}toString(){return a.WL(ut(this),(()=>"<declaration schema>"))}toJSON(){return{_tag:this._tag,typeParameters:this.typeParameters.map((e=>e.toJSON())),annotations:st(this.annotations)}}}const K=e=>t=>t._tag===e;class Y{literal;annotations;_tag="Literal";constructor(e,t={}){this.literal=e,this.annotations=t}toString(){return a.WL(ut(this),(()=>p.eA(this.literal)))}toJSON(){return{_tag:this._tag,literal:d.sI(this.literal)?String(this.literal):this.literal,annotations:st(this.annotations)}}}const V=K("Literal"),z=new Y(null,{[g]:"null"});class H{symbol;annotations;_tag="UniqueSymbol";constructor(e,t={}){this.symbol=e,this.annotations=t}toString(){return a.WL(ut(this),(()=>p.eA(this.symbol)))}toJSON(){return{_tag:this._tag,symbol:String(this.symbol),annotations:st(this.annotations)}}}class X{annotations;_tag="UndefinedKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const G=new X({[w]:"undefined"});class Z{annotations;_tag="VoidKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const ee=new Z({[w]:"void"});class te{annotations;_tag="NeverKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const ne=new te({[w]:"never"});class re{annotations;_tag="UnknownKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const ie=new re({[w]:"unknown"});class oe{annotations;_tag="AnyKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const se=new oe({[w]:"any"});class ae{annotations;_tag="StringKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const ce=new ae({[w]:"string",[N]:"a string"}),de=K("StringKeyword");class le{annotations;_tag="NumberKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const ue=new le({[w]:"number",[N]:"a number"}),pe=K("NumberKeyword");class he{annotations;_tag="BooleanKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const fe=new he({[w]:"boolean",[N]:"a boolean"});class me{annotations;_tag="BigIntKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const ye=new me({[w]:"bigint",[N]:"a bigint"});class ge{annotations;_tag="SymbolKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const we=new ge({[w]:"symbol",[N]:"a symbol"}),Ne=K("SymbolKeyword");class be{annotations;_tag="ObjectKeyword";constructor(e={}){this.annotations=e}toString(){return lt(this)}toJSON(){return{_tag:this._tag,annotations:st(this.annotations)}}}const ve=new be({[g]:"object",[w]:"object",[N]:"an object in the TypeScript meaning, i.e. the `object` type"});class xe{type;annotations;constructor(e,t={}){this.type=e,this.annotations=t}toJSON(){return{type:this.type.toJSON(),annotations:st(this.annotations)}}toString(){return String(this.type)}}class ke extends xe{isOptional;constructor(e,t,n={}){super(e,n),this.isOptional=t}toJSON(){return{type:this.type.toJSON(),isOptional:this.isOptional,annotations:st(this.annotations)}}toString(){return String(this.type)+(this.isOptional?"?":"")}}const Se=e=>e.map((e=>e.type));class Oe{elements;rest;isReadonly;annotations;_tag="TupleType";constructor(e,t,n,r={}){this.elements=e,this.rest=t,this.isReadonly=n,this.annotations=r;let i=!1,o=!1;for(const t of e)if(t.isOptional)i=!0;else if(i){o=!0;break}if(o||i&&t.length>1)throw new Error(u.YW)}toString(){return a.WL(ut(this),(()=>We(this)))}toJSON(){return{_tag:this._tag,elements:this.elements.map((e=>e.toJSON())),rest:this.rest.map((e=>e.toJSON())),isReadonly:this.isReadonly,annotations:st(this.annotations)}}}const We=e=>{const t=e.elements.map(String).join(", ");return r.nc(e.rest,{onEmpty:()=>`readonly [${t}]`,onNonEmpty:(n,r)=>{const i=String(n),o=i.includes(" | ")?`(${i})`:i;if(r.length>0){const n=r.map(String).join(", ");return e.elements.length>0?`readonly [${t}, ...${o}[], ${n}]`:`readonly [...${o}[], ${n}]`}return e.elements.length>0?`readonly [${t}, ...${o}[]]`:`ReadonlyArray<${i}>`}})};class Ie extends ke{name;isReadonly;constructor(e,t,n,r,i){super(t,n,i),this.name=e,this.isReadonly=r}toJSON(){return{name:String(this.name),type:this.type.toJSON(),isOptional:this.isOptional,isReadonly:this.isReadonly,annotations:st(this.annotations)}}}const qe=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return!0;case"Refinement":return qe(e.from)}return!1};class Te{type;isReadonly;parameter;constructor(e,t,n){if(this.type=t,this.isReadonly=n,!qe(e))throw new Error(u.D4);this.parameter=e}toJSON(){return{parameter:this.parameter.toJSON(),type:this.type.toJSON(),isReadonly:this.isReadonly}}}class Ee{annotations;_tag="TypeLiteral";propertySignatures;indexSignatures;constructor(e,t,n={}){this.annotations=n;const r={};for(let t=0;t<e.length;t++){const n=e[t].name;if(Object.prototype.hasOwnProperty.call(r,n))throw new Error(u.eT(n));r[n]=null}const i={string:!1,symbol:!1};for(let e=0;e<t.length;e++){const n=dt(t[e].parameter);if(de(n)){if(i.string)throw new Error(u.DB("string"));i.string=!0}else if(Ne(n)){if(i.symbol)throw new Error(u.DB("symbol"));i.symbol=!0}}this.propertySignatures=at(e),this.indexSignatures=ct(t)}toString(){return a.WL(ut(this),(()=>Ce(this)))}toJSON(){return{_tag:this._tag,propertySignatures:this.propertySignatures.map((e=>e.toJSON())),indexSignatures:this.indexSignatures.map((e=>e.toJSON())),annotations:st(this.annotations)}}}const Ce=e=>{const t=e.propertySignatures.map((e=>(e.isReadonly?"readonly ":"")+String(e.name)+(e.isOptional?"?":"")+": "+e.type)).join("; ");if(e.indexSignatures.length>0){const n=e.indexSignatures.map((e=>(e.isReadonly?"readonly ":"")+`[x: ${dt(e.parameter)}]: ${e.type}`)).join("; ");return e.propertySignatures.length>0?`{ ${t}; ${n} }`:`{ ${n} }`}return e.propertySignatures.length>0?`{ ${t} }`:"{}"},Ae=r.di(c.zQ(s.pH,(e=>{switch(e._tag){case"AnyKeyword":return 0;case"UnknownKeyword":return 1;case"ObjectKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3}return 4}))),De={string:"StringKeyword",number:"NumberKeyword",boolean:"BooleanKeyword",bigint:"BigIntKeyword"},Pe=e=>r.qI(e,(e=>Fe(e)?Pe(e.types):[e]));class Le{types;annotations;static make=(e,t)=>{const n=[],r=new Set;for(let t=0;t<e.length;t++){const i=e[t];i===ne||r.has(i)||(r.add(i),n.push(i))}return Le.union(n,t)};static members=(e,t)=>Le.union((e=>e.filter((e=>!(e===ne))))(e),t);static unify=(e,t)=>Le.union((e=>{const t=Ae(e),n=[],r={},i=[];for(const e of t)switch(e._tag){case"NeverKeyword":break;case"AnyKeyword":return[se];case"UnknownKeyword":return[ie];case"ObjectKeyword":case"UndefinedKeyword":case"VoidKeyword":case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":r[e._tag]||(r[e._tag]=e,n.push(e));break;case"Literal":{const t=typeof e.literal;switch(t){case"string":case"number":case"bigint":case"boolean":r[De[t]]||i.includes(e.literal)||(i.push(e.literal),n.push(e));break;case"object":i.includes(e.literal)||(i.push(e.literal),n.push(e))}break}case"UniqueSymbol":r.SymbolKeyword||i.includes(e.symbol)||(i.push(e.symbol),n.push(e));break;case"TupleType":r.ObjectKeyword||n.push(e);break;case"TypeLiteral":0===e.propertySignatures.length&&0===e.indexSignatures.length?r["{}"]||(r["{}"]=e,n.push(e)):r.ObjectKeyword||n.push(e);break;default:n.push(e)}return n})(Pe(e)),t);static union=(e,t)=>Me(e)?new Le(e,t):1===e.length?e[0]:ne;_tag="Union";constructor(e,t={}){this.types=e,this.annotations=t}toString(){return a.WL(ut(this),(()=>this.types.map(String).join(" | ")))}toJSON(){return{_tag:this._tag,types:this.types.map((e=>e.toJSON())),annotations:st(this.annotations)}}}const Be=(e,t)=>e.map(t),Me=e=>e.length>1,Fe=K("Union"),Re=(0,o.V)(Symbol.for("@effect/schema/AST/toJSONMemoMap"),(()=>new WeakMap));class Ue{f;annotations;_tag="Suspend";constructor(e,t={}){this.f=e,this.annotations=t,this.f=p.Z4(e)}toString(){return ut(this).pipe(a.NW((()=>a.qI(a.IB(this.f)(),(e=>ut(e))))),a.WL((()=>"<suspended schema>")))}toJSON(){const e=this.f();let t=Re.get(e);return t||(Re.set(e,{_tag:this._tag}),t={_tag:this._tag,ast:e.toJSON(),annotations:st(this.annotations)},Re.set(e,t),t)}}class je{from;filter;annotations;_tag="Refinement";constructor(e,t,n={}){this.from=e,this.filter=t,this.annotations=n}toString(){return a.WL(ut(this),(()=>`{ ${this.from} | filter }`))}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),annotations:st(this.annotations)}}}const _e=K("Refinement"),$e={};class Qe{from;to;transformation;annotations;_tag="Transformation";constructor(e,t,n,r={}){this.from=e,this.to=t,this.transformation=n,this.annotations=r}toString(){return a.WL(ut(this),(()=>`(${String(this.from)} <-> ${String(this.to)})`))}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),to:this.to.toJSON(),annotations:st(this.annotations)}}}const Je=K("Transformation");class Ke{decode;encode;_tag="FinalTransformation";constructor(e,t){this.decode=e,this.encode=t}}class Ye{from;to;decode;encode;constructor(e,t,n,r){this.from=e,this.to=t,this.decode=n,this.encode=r}}class Ve{propertySignatureTransformations;_tag="TypeLiteralTransformation";constructor(e){this.propertySignatureTransformations=e;const t={},n={};for(const r of e){const e=r.from;if(t[e])throw new Error(u.NJ(e));t[e]=!0;const i=r.to;if(n[i])throw new Error(u.NJ(i));n[i]=!0}}}const ze=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e);return n.annotations.value={...e.annotations,...t},Object.create(Object.getPrototypeOf(e),n)},He=e=>{let t=`^${l.i(e.head)}`;for(const n of e.spans)de(n.type)?t+=".*":pe(n.type)&&(t+="[+-]?\\d*\\.?\\d+(?:[Ee][+-]?\\d+)?"),t+=l.i(n.literal);return t+="$",new RegExp(t)},Xe=e=>{switch(e._tag){case"Declaration":{const t=j(e);if(a.Ru(t))return Xe(t.value);break}case"TypeLiteral":return e.propertySignatures.slice();case"Suspend":return Xe(e.f())}return Ze(e).map((t=>Ge(e,t)))},Ge=(e,t)=>{switch(e._tag){case"Declaration":{const n=j(e);if(a.Ru(n))return Ge(n.value,t);break}case"TypeLiteral":{const n=r.i8(e.propertySignatures,(e=>e.name===t));if(a.Ru(n))return n.value;if(d.Kg(t))for(const n of e.indexSignatures){const e=dt(n.parameter);switch(e._tag){case"TemplateLiteral":if(He(e).test(t))return new Ie(t,n.type,!1,!0);break;case"StringKeyword":return new Ie(t,n.type,!1,!0)}}else if(d.Bm(t))for(const n of e.indexSignatures){const e=dt(n.parameter);if(Ne(e))return new Ie(t,n.type,!1,!0)}break}case"Union":return new Ie(t,Le.make(e.types.map((e=>Ge(e,t).type))),!1,!0);case"Suspend":return Ge(e.f(),t)}return new Ie(t,ne,!1,!0)},Ze=e=>{switch(e._tag){case"Declaration":{const t=j(e);if(a.Ru(t))return Ze(t.value);break}case"TypeLiteral":return e.propertySignatures.map((e=>e.name));case"Suspend":return Ze(e.f());case"Union":return e.types.slice(1).reduce(((e,t)=>r.E$(e,Ze(t))),Ze(e.types[0]));case"Transformation":return Ze(e.to)}return[]},et=(e,t)=>{const n=[],r=[],i=e=>{switch(e._tag){case"NeverKeyword":break;case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":case"Refinement":r.push(new Te(e,t,!0));break;case"Literal":if(!d.Kg(e.literal)&&!d.Et(e.literal))throw new Error(u.Bd(e.literal));n.push(new Ie(e.literal,t,!1,!0));break;case"Enums":for(const[r,i]of e.enums)n.push(new Ie(i,t,!1,!0));break;case"UniqueSymbol":n.push(new Ie(e.symbol,t,!1,!0));break;case"Union":e.types.forEach(i);break;default:throw new Error(u.yK(e))}};return i(e),{propertySignatures:n,indexSignatures:r}},tt=e=>{switch(e._tag){case"Declaration":{const t=rt(e.typeParameters,tt);return t===e.typeParameters?e:new J(t,e.decodeUnknown,e.encodeUnknown,e.annotations)}case"TupleType":{const t=rt(e.elements,(e=>{const t=tt(e.type);return t===e.type?e:new ke(t,e.isOptional)})),n=Se(e.rest),r=rt(n,tt);return t===e.elements&&r===n?e:new Oe(t,r.map((e=>new xe(e))),e.isReadonly,e.annotations)}case"TypeLiteral":{const t=rt(e.propertySignatures,(e=>{const t=tt(e.type);return t===e.type?e:new Ie(e.name,t,e.isOptional,e.isReadonly)})),n=rt(e.indexSignatures,(e=>{const t=tt(e.type);return t===e.type?e:new Te(e.parameter,t,e.isReadonly)}));return t===e.propertySignatures&&n===e.indexSignatures?e:new Ee(t,n,e.annotations)}case"Union":{const t=rt(e.types,tt);return t===e.types?e:Le.make(t,e.annotations)}case"Suspend":return new Ue((()=>tt(e.f())),e.annotations);case"Refinement":{const t=tt(e.from);return t===e.from?e:new je(t,e.filter,e.annotations)}case"Transformation":return tt(e.to)}return e},nt=e=>a.YW((e=>a.NW(Q(e),(()=>L(e))))(e),{onNone:()=>{},onSome:e=>({[$]:e})});function rt(e,t){let n=!1;const i=r.CN(e.length);for(let r=0;r<e.length;r++){const o=e[r],s=t(o);s!==o&&(n=!0),i[r]=s}return n?i:e}const it=(e,t)=>{switch(e._tag){case"Declaration":{const n=rt(e.typeParameters,(e=>it(e,t)));return n===e.typeParameters?e:new J(n,e.decodeUnknown,e.encodeUnknown,e.annotations)}case"TupleType":{const n=rt(e.elements,(e=>{const n=it(e.type,t);return n===e.type?e:new ke(n,e.isOptional)})),r=Se(e.rest),i=rt(r,(e=>it(e,t)));return n===e.elements&&i===r?e:new Oe(n,i.map((e=>new xe(e))),e.isReadonly,nt(e))}case"TypeLiteral":{const n=rt(e.propertySignatures,(e=>{const n=it(e.type,t);return n===e.type?e:new Ie(e.name,n,e.isOptional,e.isReadonly)})),r=rt(e.indexSignatures,(e=>{const n=it(e.type,t);return n===e.type?e:new Te(e.parameter,n,e.isReadonly)}));return n===e.propertySignatures&&r===e.indexSignatures?e:new Ee(n,r,nt(e))}case"Union":{const n=rt(e.types,(e=>it(e,t)));return n===e.types?e:Le.make(n,nt(e))}case"Suspend":return new Ue((()=>it(e.f(),t)),nt(e));case"Refinement":{const n=it(e.from,t);if(t){if(n===e.from)return e;if(!Je(e.from)){const t=_(e);if(a.Ru(t)&&!0===t.value)return new je(n,e.filter)}}return n}case"Transformation":return it(e.from,t)}return e},ot=e=>it(e,!1),st=e=>{const t={};for(const n of Object.getOwnPropertySymbols(e))t[String(n)]=e[n];return t},at=r.di(c.zQ(s.pH,(e=>(e=>{switch(e._tag){case"NeverKeyword":return 0;case"Literal":case"UndefinedKeyword":case"VoidKeyword":case"UniqueSymbol":return 1;case"BooleanKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3;case"ObjectKeyword":return 5;case"UnknownKeyword":case"AnyKeyword":return 6;default:return 4}})(e.type)))),ct=r.di(c.zQ(s.pH,(e=>{switch(dt(e.parameter)._tag){case"StringKeyword":return 2;case"SymbolKeyword":return 3;case"TemplateLiteral":return 1}}))),dt=(s.pH,s.pH,s.pH,e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return e;case"Refinement":return dt(e.from)}}),lt=e=>a.WL(ut(e),(()=>e._tag)),ut=e=>L(e).pipe(a.NW((()=>P(e))),a.NW((()=>B(e))))},60023:(e,t,n)=>{n.d(t,{Kc:()=>$,Py:()=>W,ZU:()=>v,dF:()=>R,eC:()=>w,eq:()=>j,fJ:()=>I,gm:()=>m,is:()=>_,k9:()=>U,lN:()=>F,sV:()=>q,u$:()=>O,wG:()=>M,xm:()=>C});var r=n(58600),i=n(95181),o=n(55519),s=n(57964),a=n(61369),c=n(6517),d=n(83845),l=n(77948),u=n(56572),p=n(28789),h=n(15407),f=n(81107);class m{path;actual;issue;_tag="Pointer";constructor(e,t,n){this.path=e,this.actual=t,this.issue=n}}class y{actual;message;_tag="Unexpected";constructor(e,t){this.actual=e,this.message=t}}class g{ast;message;_tag="Missing";actual=void 0;constructor(e,t){this.ast=e,this.message=t}}class w{ast;actual;issues;output;_tag="Composite";constructor(e,t,n,r){this.ast=e,this.actual=t,this.issues=n,this.output=r}}class N{ast;actual;kind;issue;_tag="Refinement";constructor(e,t,n,r){this.ast=e,this.actual=t,this.kind=n,this.issue=r}}class b{ast;actual;kind;issue;_tag="Transformation";constructor(e,t,n,r){this.ast=e,this.actual=t,this.kind=n,this.issue=r}}class v{ast;actual;message;_tag="Type";constructor(e,t,n){this.ast=e,this.actual=t,this.message=n}}class x{ast;actual;message;_tag="Forbidden";constructor(e,t,n){this.ast=e,this.actual=t,this.message=n}}const k=Symbol.for("@effect/schema/ParseErrorTypeId");class S extends((0,i.rN)("ParseError")){[k]=k;get message(){return this.toString()}toString(){return f.Im(this.issue)}toJSON(){return{_id:"ParseError",message:this.toString()}}[d.FX](){return this.toJSON()}}const O=e=>new S({issue:e}),W=s.pG,I=s.kb,q=(s.Sv,s.sV),T=(0,a.XY)(2,((e,t)=>{const n=e;return"Left"===n._tag?n:"Right"===n._tag?t(n.right):o.flatMap(e,t)})),E=(0,a.XY)(2,((e,t)=>{const n=e;return"Left"===n._tag?n:"Right"===n._tag?s.pG(t(n.right)):o.map(e,t)})),C=(0,a.XY)(2,((e,t)=>{const n=e;return"Left"===n._tag?s.kb(t(n.left)):"Right"===n._tag?n:o.mapError(e,t)})),A=e=>{const t=e;if("Left"===t._tag||"Right"===t._tag)return t},D=(e,t)=>void 0===t||u.Et(t)?e:void 0===e?t:{...e,...t},P=(e,t,n)=>{const r=K(e,t);return(e,t)=>r(e,D(n,t))},L=(e,t,n)=>{const r=P(e,t,n);return(e,t)=>s.Gu(r(e,t),O)},B=(e,t,n)=>{const r=K(e,t);return(e,t)=>r(e,{...D(n,t),isEffectAllowed:!0})},M=(e,t)=>P(e.ast,!0,t),F=(e,t)=>B(e.ast,!0,t),R=(e,t)=>B(e.ast,!1,t),U=(e,t)=>L(e.ast,!0,t),j=(e,t)=>L(p.p$(e.ast),!0,t),_=(e,t)=>{const n=K(p.p$(e.ast),!0);return(e,r)=>s.FG(n(e,{exact:!0,...D(t,r)}))},$=(e,t)=>L(e.ast,!1,t),Q=(0,c.V)(Symbol.for("@effect/schema/Parser/decodeMemoMap"),(()=>new WeakMap)),J=(0,c.V)(Symbol.for("@effect/schema/Parser/encodeMemoMap"),(()=>new WeakMap)),K=(e,t)=>{const n=t?Q:J,r=n.get(e);if(r)return r;const i=z(e,t),o=p.Re(e),s=l.Ru(o)?(e,t)=>i(e,D(t,o.value)):i;return n.set(e,s),s},Y=e=>l.Y6(p.fq(e)),V=e=>l.Y6(p.iJ(e)),z=(e,t)=>{switch(e._tag){case"Refinement":if(t){const t=K(e.from,!0);return(n,r)=>ee(T(C(t(n,r),(t=>new N(e,n,"From",t))),(t=>l.YW(e.filter(t,r??p.Wy,e),{onNone:()=>s.pG(t),onSome:t=>s.kb(new N(e,n,"Predicate",t))}))),e,n,r)}{const t=K(p.p$(e),!0),n=K(Z(e.from),!1);return(r,i)=>ee(T(t(r,i),(e=>n(e,i))),e,r,i)}case"Transformation":{const n=re(e.transformation,t),r=t?K(e.from,!0):K(e.to,!1),i=t?K(e.to,!0):K(e.from,!1);return(o,s)=>ee(T(C(r(o,s),(n=>new b(e,o,t?"Encoded":"Type",n))),(r=>T(C(n(r,s??p.Wy,e),(t=>new b(e,o,"Transformation",t))),(n=>C(i(n,s),(n=>new b(e,o,t?"Type":"Encoded",n))))))),e,o,s)}case"Declaration":{const n=t?e.decodeUnknown(...e.typeParameters):e.encodeUnknown(...e.typeParameters);return(t,r)=>ee(n(t,r??p.Wy,e),e,t,r)}case"Literal":return H(e,(t=>t===e.literal));case"UniqueSymbol":return H(e,(t=>t===e.symbol));case"UndefinedKeyword":case"VoidKeyword":return H(e,u.b0);case"NeverKeyword":return H(e,u.Pd);case"UnknownKeyword":case"AnyKeyword":return s.pG;case"StringKeyword":return H(e,u.Kg);case"NumberKeyword":return H(e,u.Et);case"BooleanKeyword":return H(e,u.Lm);case"BigIntKeyword":return H(e,u.sI);case"SymbolKeyword":return H(e,u.Bm);case"ObjectKeyword":return H(e,u.Gv);case"Enums":return H(e,(t=>e.enums.some((([e,n])=>n===t))));case"TemplateLiteral":{const t=p.$j(e);return H(e,(e=>u.Kg(e)&&t.test(e)))}case"TupleType":{const n=e.elements.map((e=>K(e.type,t))),i=e.rest.map((e=>K(e.type,t)));let a=e.elements.filter((e=>!e.isOptional));e.rest.length>0&&(a=a.concat(e.rest.slice(1)));const c=a.length,d=e.elements.length>0?e.elements.map(((e,t)=>t)).join(" | "):"never",l=Y(e),u=V(e);return(t,p)=>{if(!r.cy(t))return s.kb(new v(e,t));const h="all"===p?.errors,f=[];let N=0;const b=[],x=t.length;for(let n=x;n<=c-1;n++){const r=new m(n,t,new g(a[n-x]));if(!h)return s.kb(new w(e,t,r,b));f.push([N++,r])}if(0===e.rest.length)for(let n=e.elements.length;n<=x-1;n++){const r=new m(n,t,new y(t[n],`is unexpected, expected: ${d}`));if(!h)return s.kb(new w(e,t,r,b));f.push([N++,r])}let k,S=0;for(;S<n.length;S++)if(x<S+1){if(e.elements[S].isOptional)continue}else{const r=(0,n[S])(t[S],p),i=A(r);if(i){if(s.OC(i)){const n=new m(S,t,i.left);if(h){f.push([N++,n]);continue}return s.kb(new w(e,t,n,ne(b)))}b.push([N++,i.right])}else{const n=N++,i=S;k||(k=[]),k.push((({es:a,output:c})=>o.flatMap(o.either(r),(r=>{if(s.OC(r)){const d=new m(i,t,r.left);return h?(a.push([n,d]),o.void):s.kb(new w(e,t,d,ne(c)))}return c.push([n,r.right]),o.void}))))}}if(r.iI(i)){const[n,...r]=i;for(;S<x-r.length;S++){const r=n(t[S],p),i=A(r);if(i){if(s.OC(i)){const n=new m(S,t,i.left);if(h){f.push([N++,n]);continue}return s.kb(new w(e,t,n,ne(b)))}b.push([N++,i.right])}else{const n=N++,i=S;k||(k=[]),k.push((({es:a,output:c})=>o.flatMap(o.either(r),(r=>{if(s.OC(r)){const d=new m(i,t,r.left);return h?(a.push([n,d]),o.void):s.kb(new w(e,t,d,ne(c)))}return c.push([n,r.right]),o.void}))))}}for(let n=0;n<r.length;n++)if(S+=n,!(x<S+1)){const i=r[n](t[S],p),a=A(i);if(a){if(s.OC(a)){const n=new m(S,t,a.left);if(h){f.push([N++,n]);continue}return s.kb(new w(e,t,n,ne(b)))}b.push([N++,a.right])}else{const n=N++,r=S;k||(k=[]),k.push((({es:a,output:c})=>o.flatMap(o.either(i),(i=>{if(s.OC(i)){const d=new m(r,t,i.left);return h?(a.push([n,d]),o.void):s.kb(new w(e,t,d,ne(c)))}return c.push([n,i.right]),o.void}))))}}}const O=({es:n,output:i})=>r.EI(n)?s.kb(new w(e,t,ne(n),ne(i))):s.pG(ne(i));if(k&&k.length>0){const e=k;return o.suspend((()=>{const t={es:r.C(f),output:r.C(b)};return o.flatMap(o.forEach(e,(e=>e(t)),{concurrency:l,batching:u,discard:!0}),(()=>O(t)))}))}return O({output:b,es:f})}}case"TypeLiteral":{if(0===e.propertySignatures.length&&0===e.indexSignatures.length)return H(e,u.$y);const n=[],i={},a=[];for(const r of e.propertySignatures)n.push([K(r.type,t),r]),i[r.name]=null,a.push(r.name);const c=e.indexSignatures.map((e=>[K(e.parameter,t),K(e.type,t),e.parameter])),d=p.gP.make(e.indexSignatures.map((e=>e.parameter)).concat(a.map((e=>u.Bm(e)?new p.w_(e):new p.uS(e))))),l=K(d,t),f=Y(e),N=V(e);return(t,p)=>{if(!u.u4(t))return s.kb(new v(e,t));const b="all"===p?.errors,x=[];let k=0;const S="error"===p?.onExcessProperty,O={};let W,I;if(S||"preserve"===p?.onExcessProperty){W=h.Hs(t);for(const n of W){const r=A(l(n,p));if(s.OC(r)){if(S){const r=new m(n,t,new y(t[n],`is unexpected, expected: ${String(d)}`));if(b){x.push([k++,r]);continue}return s.kb(new w(e,t,r,O))}O[n]=t[n]}}}const q=!0===p?.exact;for(let r=0;r<n.length;r++){const i=n[r][1],a=i.name,c=Object.prototype.hasOwnProperty.call(t,a);if(!c){if(i.isOptional)continue;if(q){const n=new m(a,t,new g(i));if(b){x.push([k++,n]);continue}return s.kb(new w(e,t,n,O))}}const d=(0,n[r][0])(t[a],p),l=A(d);if(l){if(s.OC(l)){const n=new m(a,t,c?l.left:new g(i));if(b){x.push([k++,n]);continue}return s.kb(new w(e,t,n,O))}O[a]=l.right}else{const n=k++,r=a;I||(I=[]),I.push((({es:a,output:l})=>o.flatMap(o.either(d),(d=>{if(s.OC(d)){const u=new m(r,t,c?d.left:new g(i));return b?(a.push([n,u]),o.void):s.kb(new w(e,t,u,l))}return l[r]=d.right,o.void}))))}}for(let n=0;n<c.length;n++){const r=c[n],a=r[0],d=r[1],l=h.SC(t,r[2]);for(const n of l){const r=A(a(n,p));if(r&&s.FG(r)){const r=d(t[n],p),a=A(r);if(a){if(s.OC(a)){const r=new m(n,t,a.left);if(b){x.push([k++,r]);continue}return s.kb(new w(e,t,r,O))}Object.prototype.hasOwnProperty.call(i,n)||(O[n]=a.right)}else{const a=k++,c=n;I||(I=[]),I.push((({es:d,output:l})=>o.flatMap(o.either(r),(r=>{if(s.OC(r)){const n=new m(c,t,r.left);return b?(d.push([a,n]),o.void):s.kb(new w(e,t,n,l))}return Object.prototype.hasOwnProperty.call(i,n)||(l[n]=r.right),o.void}))))}}}}const T=({es:n,output:i})=>{if(r.EI(n))return s.kb(new w(e,t,ne(n),i));if("original"===p?.propertyOrder){const e=W||h.Hs(t);for(const t of a)-1===e.indexOf(t)&&e.push(t);const n={};for(const t of e)Object.prototype.hasOwnProperty.call(i,t)&&(n[t]=i[t]);return s.pG(n)}return s.pG(i)};if(I&&I.length>0){const e=I;return o.suspend((()=>{const t={es:r.C(x),output:Object.assign({},O)};return o.flatMap(o.forEach(e,(e=>e(t)),{concurrency:f,batching:N,discard:!0}),(()=>T(t)))}))}return T({es:x,output:O})}}case"Union":{const n=G(e.types,t),i=h.Hs(n.keys),a=i.length,c=new Map;for(let n=0;n<e.types.length;n++)c.set(e.types[n],K(e.types[n],t));const d=Y(e)??1,l=V(e);return(t,h)=>{const f=[];let y,N=0,b=[];if(a>0)if(u.u4(t))for(let e=0;e<a;e++){const r=i[e],o=n.keys[r].buckets;if(Object.prototype.hasOwnProperty.call(t,r)){const e=String(t[r]);if(Object.prototype.hasOwnProperty.call(o,e))b=b.concat(o[e]);else{const e=p.gP.make(n.keys[r].literals);f.push([N++,new w(new p.Ky([new p.Gb(r,e,!1,!0)],[]),t,new m(r,t,new v(e,t[r])))])}}else{const e=p.gP.make(n.keys[r].literals),i=new p.Gb(r,e,!1,!0);f.push([N++,new w(new p.Ky([i],[]),t,new m(r,t,new g(i)))])}}else f.push([N++,new v(e,t)]);n.otherwise.length>0&&(b=b.concat(n.otherwise));for(let e=0;e<b.length;e++){const n=b[e],r=c.get(n)(t,h),i=y&&0!==y.length?void 0:A(r);if(i){if(s.FG(i))return s.pG(i.right);f.push([N++,i.left])}else{const e=N++;y||(y=[]),y.push((t=>o.suspend((()=>"finalResult"in t?o.void:o.flatMap(o.either(r),(n=>(s.FG(n)?t.finalResult=s.pG(n.right):t.es.push([e,n.left]),o.void)))))))}}const x=n=>r.EI(n)?1===n.length&&"Type"===n[0][1]._tag?s.kb(n[0][1]):s.kb(new w(e,t,ne(n))):s.kb(new v(e,t));if(y&&y.length>0){const e=y;return o.suspend((()=>{const t={es:r.C(f)};return o.flatMap(o.forEach(e,(e=>e(t)),{concurrency:d,batching:l,discard:!0}),(()=>"finalResult"in t?t.finalResult:x(t.es)))}))}return x(f)}}case"Suspend":{const n=h.Z4((()=>K(p.hk(e.f(),e.annotations),t)));return(e,t)=>n()(e,t)}}},H=(e,t)=>n=>t(n)?s.pG(n):s.kb(new v(e,n)),X=(e,t)=>{switch(e._tag){case"Declaration":{const n=p.YI(e);if(l.Ru(n))return X(n.value,t);break}case"TypeLiteral":{const n=[];for(let r=0;r<e.propertySignatures.length;r++){const i=e.propertySignatures[r],o=t?p.rQ(i.type):p.p$(i.type);p.c$(o)&&!i.isOptional&&n.push([i.name,o])}return n}case"Refinement":return X(e.from,t);case"Suspend":return X(e.f(),t);case"Transformation":return X(t?e.from:e.to,t)}return[]},G=(e,t)=>{const n={},r=[];for(let i=0;i<e.length;i++){const o=e[i],s=X(o,t);if(s.length>0)for(let e=0;e<s.length;e++){const[t,r]=s[e],i=String(r.literal);n[t]=n[t]||{buckets:{},literals:[]};const a=n[t].buckets;if(!Object.prototype.hasOwnProperty.call(a,i)){a[i]=[o],n[t].literals.push(r);break}e<s.length-1||(a[i].push(o),n[t].literals.push(r))}else r.push(o)}return{keys:n,otherwise:r}},Z=e=>p.C8(e)?Z(e.from):e,ee=(e,t,n,r)=>{const i=A(e);if(i)return i;if(!0===r?.isEffectAllowed)return e;try{return o.runSync(o.either(e))}catch(e){return s.kb(new x(t,n,"cannot be be resolved synchronously, this is caused by using runSync on an effect that performs async work"))}},te=([e],[t])=>e>t?1:e<t?-1:0;function ne(e){return e.sort(te).map((e=>e[1]))}const re=(e,t)=>{switch(e._tag){case"FinalTransformation":return t?e.decode:e.encode;case"ComposeTransformation":return s.pG;case"TypeLiteralTransformation":return n=>{let r=s.pG(n);for(const n of e.propertySignatureTransformations){const[e,i]=t?[n.from,n.to]:[n.to,n.from],o=t?n.decode:n.encode,s=t=>{const n=o(Object.prototype.hasOwnProperty.call(t,e)?l.zN(t[e]):l.dv());return delete t[e],l.Ru(n)&&(t[i]=n.value),t};r=E(r,s)}return r}}}},89210:(e,t,n)=>{n.d(t,{BpQ:()=>xe,D4M:()=>A,EGw:()=>D,L8n:()=>W,MM$:()=>Ye,O31:()=>te,QfV:()=>K,Ru6:()=>be,T16:()=>Se,TqQ:()=>tt,Whr:()=>He,XeB:()=>Ge,_kM:()=>oe,gPz:()=>X,jJo:()=>it,lFO:()=>E,lNp:()=>C,mKk:()=>We,mSG:()=>ae,pbD:()=>fe,pdi:()=>ge,rdN:()=>Z,wNn:()=>Y,wkx:()=>de,xeR:()=>M,yjt:()=>rt});var r=n(58600),i=n(75176),o=n(37694),s=n(83733),a=n(84073),c=n(57964),d=n(7664),l=n(43977),u=n(35309),p=n(95602),h=n(61369),f=n(4676),m=n(77948),y=n(53533),g=n(56572),w=n(41499),N=n(28789),b=n(34721),v=n(29140),x=n(15407),k=n(60023),S=n(39357);const O=Symbol.for("@effect/schema/Schema"),W=e=>class{[O]=I;static Type;static Encoded;static[O]=I;static ast=e;static annotations(e){return W(T(this.ast,e))}static pipe(){return(0,y.t)(this,arguments)}static toString(){return String(e)}},I={_A:e=>e,_I:e=>e,_R:e=>e},q=e=>{if(!e)return{};const t={},n=Object.getOwnPropertySymbols(e);for(const r of n)t[r]=e[r];if(void 0!==e.typeId){const n=e.typeId;"object"==typeof n?(t[N.Dp]=n.id,t[n.id]=n.annotation):t[N.Dp]=n}const r=(n,r)=>{void 0!==e[n]&&(t[r]=e[n])};return r("message",N.YN),r("missingMessage",N.Ey),r("identifier",N.On),r("title",N.Z8),r("description",N.BW),r("examples",N.U4),r("default",N.u7),r("documentation",N.DH),r("jsonSchema",N.Ad),r("arbitrary",w.B1),r("pretty",S.jo),r("equivalence",b.tI),r("concurrency",N.MR),r("batching",N.Jo),r("parseIssueTitle",N.J5),r("parseOptions",N.E_),t},T=(e,t)=>N.hk(e,q(t)),E=(e,t)=>{const n=k.dF(e,t);return(e,t)=>k.xm(n(e,t),k.u$)},C=(e,t)=>{const n=k.lN(e,t);return(e,t)=>k.xm(n(e,t),k.u$)},A=C,D=(e,t)=>{const n=k.wG(e,t);return(e,t)=>c.qE(n(e,t),k.u$)},P=e=>g.i5(e,O)&&g.Gv(e[O]),L=(e,t=(e=>N.gV(e)?N.gP.make(N.Mz(e,(e=>new N.uS(e)))):new N.uS(e[0]))(e))=>class extends(W(t)){static annotations(e){return L(this.literals,T(this.ast,e))}static literals=[...e]};function B(...e){return r.iI(e)?L(e):j}const M=function(){return Array.isArray(arguments[0])?(e=arguments[0],t=arguments[1],n=arguments[2],W(new N.D6(e.map((e=>e.ast)),((...e)=>t.decode(...e.map(W))),((...e)=>t.encode(...e.map(W))),q(n)))):((e,t)=>{const n=()=>(t,n,r)=>e(t)?k.Py(t):k.fJ(new k.ZU(r,t)),r=n;return W(new N.D6([],n,r,q(t)))})(arguments[0],arguments[1]);var e,t,n};class F extends(W(N.oA)){static annotations=super.annotations}class R extends(W(N.Kt)){static annotations=super.annotations}class U extends(W(N.ch)){static annotations=super.annotations}class j extends(W(N.M3)){static annotations=super.annotations}class _ extends(W(N.ai)){static annotations=super.annotations}class $ extends(W(N._q)){static annotations=super.annotations}class Q extends(W(N.Zi)){static annotations=super.annotations}class J extends(W(N.YP)){static annotations=super.annotations}class K extends(W(N.vs)){static annotations=super.annotations}class Y extends(W(N.XS)){static annotations=super.annotations}class V extends(W(N.OD)){static annotations=super.annotations}class z extends(W(N.ZG)){static annotations=super.annotations}const H=(e,t=(e=>N.gP.members(e.map((e=>e.ast))))(e))=>class extends(W(t)){static annotations(e){return H(this.members,T(this.ast,e))}static members=[...e]};function X(...e){return N.gV(e)?H(e):r.iI(e)?e[0]:j}const G=(e,t,n=((e,t)=>new N.TD(e.map((e=>P(e)?new N.zh(e.ast,!1):e.ast)),t.map((e=>P(e)?new N.ZU(e.ast):e.ast)),!0))(e,t))=>class extends(W(n)){static annotations(e){return G(this.elements,this.rest,T(this.ast,e))}static elements=[...e];static rest=[...t]};function Z(...e){return Array.isArray(e[0])?G(e[0],e.slice(1)):G(e,[])}const ee=(e,t)=>class extends(G([],[e],t)){static annotations(e){return ee(this.value,T(this.ast,e))}static value=e},te=e=>ee(e);N.zh,N.zh,N.zh;const ne=Symbol.for("@effect/schema/PropertySignature"),re=e=>g.i5(e,ne),ie=(e,t,n=((e,t)=>{const n=x.Hs(e),i=[];if(n.length>0){const o=[],s=[],a=[];for(let t=0;t<n.length;t++){const r=n[t],c=e[r];if(re(c)){const e=c.ast;switch(e._tag){case"PropertySignatureDeclaration":{const t=e.type,n=e.isOptional,a=e.annotations;o.push(new N.Gb(r,t,n,!0)),s.push(new N.Gb(r,N.p$(t),n,!0,a)),i.push(new N.Gb(r,t,n,!0,a));break}case"PropertySignatureTransformation":{const t=e.from.fromKey??r;o.push(new N.Gb(t,e.from.type,e.from.isOptional,!0,e.from.annotations)),s.push(new N.Gb(r,e.to.type,e.to.isOptional,!0,e.to.annotations)),a.push(new N.Zn(t,r,e.decode,e.encode));break}}}else o.push(new N.Gb(r,c.ast,!1,!0)),s.push(new N.Gb(r,N.p$(c.ast),!1,!0)),i.push(new N.Gb(r,c.ast,!1,!0))}if(r.iI(a)){const e=[],n=[];for(const r of t){const{indexSignatures:t,propertySignatures:i}=N.g1(r.key.ast,r.value.ast);i.forEach((e=>{o.push(e),s.push(new N.Gb(e.name,N.p$(e.type),e.isOptional,e.isReadonly,e.annotations))})),t.forEach((t=>{e.push(t),n.push(new N.NH(t.parameter,N.p$(t.type),t.isReadonly))}))}return new N.IT(new N.Ky(o,e,{[N.Z8]:"Struct (Encoded side)"}),new N.Ky(s,n,{[N.Z8]:"Struct (Type side)"}),new N.nt(a))}}const o=[];for(const e of t){const{indexSignatures:t,propertySignatures:n}=N.g1(e.key.ast,e.value.ast);n.forEach((e=>i.push(e))),t.forEach((e=>o.push(e)))}return new N.Ky(i,o)})(e,t))=>class extends(W(n)){static annotations(e){return ie(this.fields,this.records,T(this.ast,e))}static fields={...e};static records=[...t];static make=(t,n)=>{const r=((e,t)=>{const n=x.Hs(e);for(const r of n){const n=e[r];if(void 0===t[r]&&re(n)){const e=n.ast,i="PropertySignatureDeclaration"===e._tag?e.defaultValue:e.to.defaultValue;void 0!==i&&(t[r]=i())}}return t})(e,{...t});return Lt(n)?r:k.eq(this)(r)}};function oe(e,...t){return ie(e,t)}const se=(e,t,n)=>class extends(ie({},[{key:e,value:t}],n)){static annotations(n){return se(e,t,T(this.ast,n))}static key=e;static value=t},ae=(e,t)=>se(e,t),ce=e=>class extends(W(e)){static annotations(e){return ce(T(this.ast,e))}static make=(e,t)=>Lt(t)?e:k.eq(this)(e)},de=(e,t)=>n=>{const r=m.YW(N.$N(n.ast),{onNone:()=>[e],onSome:t=>[...t,e]}),i=N.hk(n.ast,q({title:String(n.ast)+` & Brand<${x.eA(e)}>`,...t,[N.SB]:r}));return ce(i)},le=e=>W(new N.V3((()=>e().ast))),ue=(e,t,n)=>class extends(W(n)){static annotations(e){return ue(this.from,this.filter,T(this.ast,e))}static from=e;static filter=t;static make=(e,t)=>Lt(t)?e:k.eq(this)(e)},pe=(e,t,n)=>{if(g.Lm(e))return e?m.dv():m.zN(new k.ZU(t,n));if(g.Kg(e))return m.zN(new k.ZU(t,n,e));if(void 0!==e){if("_tag"in e)return m.zN(e);const i=new k.ZU(t,n,e.message);return m.zN(r.iI(e.path)?new k.gm(e.path,n,i):i)}return m.dv()},he=(e,t,n)=>{if(x.vX(e))return pe(e,t,n);if(r.iI(e)){const i=r.x1(e,(e=>pe(e,t,n)));if(r.iI(i))return m.zN(1===i.length?i[0]:new k.eC(t,n,i))}return m.dv()};function fe(e,t){return n=>{function r(t,n,r){return he(e(t,n,r),r,t)}const i=new N.kV(n.ast,r,q(t));return ue(n,r,i)}}const me=(e,t,n)=>class extends(W(n)){static annotations(e){return me(this.from,this.to,T(this.ast,e))}static from=e;static to=t},ye=(0,h.XY)((e=>P(e[0])&&P(e[1])),((e,t,n)=>me(e,t,new N.IT(e.ast,t.ast,new N.EK(n.decode,n.encode))))),ge=(0,h.XY)((e=>P(e[0])&&P(e[1])),((e,t,n)=>ye(e,t,{decode:e=>k.Py(n.decode(e)),encode:e=>k.Py(n.encode(e))}))),we=Symbol.for("@effect/schema/TypeId/Trimmed"),Ne=v.Qp,be=(e,t)=>n=>n.pipe(fe((t=>t.length<=e),{typeId:Ne,description:`a string at most ${e} character(s) long`,jsonSchema:{maxLength:e},...t})),ve=v.Wz,xe=(e,t)=>n=>n.pipe(fe((t=>t.length>=e),{typeId:ve,description:`a string at least ${e} character(s) long`,jsonSchema:{minLength:e},...t})),ke=Symbol.for("@effect/schema/TypeId/Pattern"),Se=(e,t)=>n=>{const r=e.source;return n.pipe(fe((t=>(e.lastIndex=0,e.test(t))),{typeId:{id:ke,annotation:{regex:e}},description:`a string matching the pattern ${r}`,jsonSchema:{pattern:r},arbitrary:()=>t=>t.stringMatching(e),...t}))},Oe=Symbol.for("@effect/schema/TypeId/Includes"),We=(e,t)=>n=>n.pipe(fe((t=>t.includes(e)),{typeId:{id:Oe,annotation:{includes:e}},description:`a string including ${JSON.stringify(e)}`,jsonSchema:{pattern:`.*${e}.*`},...t})),Ie=Symbol.for("@effect/schema/TypeId/Lowercased");class qe extends(K.pipe((e=>t=>t.pipe(fe((e=>e===e.toLowerCase()),{typeId:Ie,description:"a lowercase string",...e})))({identifier:"Lowercased",title:"Lowercased"}))){static annotations=super.annotations}const Te=Symbol.for("@effect/schema/TypeId/Uppercased");class Ee extends(K.pipe((e=>t=>t.pipe(fe((e=>e===e.toUpperCase()),{typeId:Te,description:"an uppercase string",...e})))({identifier:"Uppercased",title:"Uppercased"}))){static annotations=super.annotations}const Ce=v.Ij;class Ae extends(K.pipe(((e,t)=>e=>{const n=g.Gv(1)?Math.max(0,Math.floor(1..min)):Math.max(0,Math.floor(1)),r=g.Gv(1)?Math.max(n,Math.floor(1..max)):n;return n!==r?e.pipe(fe((e=>e.length>=n&&e.length<=r),{typeId:Ce,description:`a string at least ${n} character(s) and at most ${r} character(s) long`,jsonSchema:{minLength:n,maxLength:r},...t})):e.pipe(fe((e=>e.length===n),{typeId:Ce,description:1===n?"a single character":`a string ${n} character(s) long`,jsonSchema:{minLength:n,maxLength:n},...t}))})(0,{identifier:"Char"}))){static annotations=super.annotations}class De extends(ge(K,qe,{decode:e=>e.toLowerCase(),encode:h.D_}).annotations({identifier:"Lowercase"})){static annotations=super.annotations}class Pe extends(ge(K,Ee,{decode:e=>e.toUpperCase(),encode:h.D_}).annotations({identifier:"Uppercase"})){static annotations=super.annotations}class Le extends(K.pipe((e=>t=>t.pipe(fe((e=>e===e.trim()),{typeId:we,description:"a string with no leading or trailing whitespace",jsonSchema:{pattern:"^\\S[\\s\\S]*\\S$|^\\S$|^$"},...e})))({identifier:"Trimmed",title:"Trimmed"}))){static annotations=super.annotations}class Be extends(ge(K,Le,{decode:e=>e.trim(),encode:h.D_}).annotations({identifier:"Trim"})){static annotations=super.annotations}N.On,N.Z8,N.BW;class Me extends(K.pipe((e=>xe(1,{description:"a non empty string",identifier:"NonEmpty",title:"NonEmpty"}))())){static annotations=super.annotations}const Fe=Symbol.for("@effect/schema/TypeId/UUID"),Re=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i;class Ue extends(K.pipe(Se(Re,{typeId:Fe,identifier:"UUID",title:"UUID",description:"a Universally Unique Identifier",arbitrary:()=>e=>e.uuid()}))){static annotations=super.annotations}const je=Symbol.for("@effect/schema/TypeId/ULID"),_e=/^[0-7][0-9A-HJKMNP-TV-Z]{25}$/i;class $e extends(K.pipe(Se(_e,{typeId:je,identifier:"ULID",title:"ULID",description:"a Universally Unique Lexicographically Sortable Identifier",arbitrary:()=>e=>e.ulid()}))){static annotations=super.annotations}const Qe=Symbol.for("@effect/schema/TypeId/Finite"),Je=e=>t=>t.pipe(fe((e=>Number.isFinite(e)),{typeId:Qe,description:"a finite number",...e})),Ke=v.$_,Ye=(e,t)=>n=>n.pipe(fe((t=>t>e),{typeId:Ke,description:0===e?"a positive number":`a number greater than ${e}`,jsonSchema:{exclusiveMinimum:e},...t})),Ve=v.ft,ze=v.Xe,He=e=>t=>t.pipe(fe((e=>Number.isSafeInteger(e)),{typeId:ze,title:"integer",description:"an integer",jsonSchema:{type:"integer"},...e})),Xe=v.IO,Ge=(e,t)=>n=>n.pipe(fe((t=>t<e),{typeId:Xe,description:0===e?"a negative number":`a number less than ${e}`,jsonSchema:{exclusiveMaximum:e},...t})),Ze=v._b,et=v._F,tt=(e,t,n)=>r=>r.pipe(fe((n=>n>=e&&n<=t),{typeId:et,description:`a number between ${e} and ${t}`,jsonSchema:{maximum:t,minimum:e},...n})),nt=Symbol.for("@effect/schema/TypeId/NonNaN"),rt=e=>Ye(0,e);class it extends((e=>ye(e,Y,{strict:!1,decode:(e,t,n)=>k.sV(f.qg(e),(()=>new k.ZU(n,e))),encode:e=>k.Py(String(e))}))(K).annotations({identifier:"NumberFromString"})){static annotations=super.annotations}class ot extends(Y.pipe(Je({identifier:"Finite",title:"Finite"}))){static annotations=super.annotations}class st extends(Y.pipe(He({identifier:"Int",title:"Int"}))){static annotations=super.annotations}class at extends(Y.pipe((e=>t=>t.pipe(fe((e=>!Number.isNaN(e)),{typeId:nt,description:"a number excluding NaN",...e})))({identifier:"NonNaN",title:"NonNaN"}))){static annotations=super.annotations}class ct extends(Y.pipe(rt({identifier:"Positive",title:"Positive"}))){static annotations=super.annotations}class dt extends(Y.pipe((e=>Ge(0,{identifier:"Negative",title:"Negative"}))())){static annotations=super.annotations}class lt extends(Y.pipe((e=>((e,t)=>e=>e.pipe(fe((e=>e<=0),{typeId:Ze,description:"a non-positive number",jsonSchema:{maximum:0},...t})))(0,e))({identifier:"NonPositive",title:"NonPositive"}))){static annotations=super.annotations}class ut extends(Y.pipe((e=>((e,t)=>e=>e.pipe(fe((e=>e>=0),{typeId:Ve,description:"a non-negative number",jsonSchema:{minimum:0},...t})))(0,e))({identifier:"NonNegative",title:"NonNegative"}))){static annotations=super.annotations}const pt=Symbol.for("@effect/schema/TypeId/JsonNumber");class ht extends(Y.pipe(fe((e=>!Number.isNaN(e)&&Number.isFinite(e)),{typeId:pt,identifier:"JsonNumber",title:"JSON-compatible number",description:"a JSON-compatible number, excluding NaN, +Infinity, and -Infinity",jsonSchema:{type:"number"}}))){static annotations=super.annotations}class ft extends(ge(V,V,{decode:s.AU,encode:s.AU})){static annotations=super.annotations}class mt extends(ge(K,J,{strict:!1,decode:e=>Symbol.for(e),encode:e=>e.description}).annotations({identifier:"symbol"})){static annotations=super.annotations}v.uy,v.wO,v.pU,v.$H,v.tg;class yt extends(ye(K,Q,{decode:(e,t,n)=>k.sV(o.sH(e),(()=>new k.ZU(n,e))),encode:e=>k.Py(String(e))}).annotations({identifier:"bigint"})){static annotations=super.annotations}class gt extends(ye(Y,Q,{decode:(e,t,n)=>k.sV(o.oB(e),(()=>new k.ZU(n,e))),encode:(e,t,n)=>k.sV(o.Ro(e),(()=>new k.ZU(n,e)))}).annotations({identifier:"BigintFromNumber"})){static annotations=super.annotations}class wt extends(M(a.n$,{identifier:"DurationFromSelf",pretty:()=>String,arbitrary:()=>e=>e.oneof(e.constant(a.Tn),e.bigUint().map((e=>a.cF(e))),e.bigUint().map((e=>a.SY(e))),e.maxSafeNat().map((e=>a.ne(e))),e.maxSafeNat().map((e=>a.YA(e))),e.maxSafeNat().map((e=>a.Gx(e))),e.maxSafeNat().map((e=>a.c$(e))),e.maxSafeNat().map((e=>a._3(e))),e.maxSafeNat().map((e=>a.QM(e)))),equivalence:()=>a.rs})){static annotations=super.annotations}class Nt extends(ye(Q,wt,{decode:e=>k.Py(a.cF(e)),encode:(e,t,n)=>m.YW(a.tb(e),{onNone:()=>k.fJ(new k.ZU(n,e)),onSome:e=>k.Py(e)})}).annotations({identifier:"DurationFromNanos"})){static annotations=super.annotations}class bt extends(ge(Y,wt,{decode:e=>a.ne(e),encode:e=>a.kE(e)}).annotations({identifier:"DurationFromMillis"})){static annotations=super.annotations}const vt=Z(ut.pipe(Je({[N.Z8]:"seconds",[N.BW]:"seconds"})),ut.pipe(Je({[N.Z8]:"nanos",[N.BW]:"nanos"})));class xt extends(ge(vt,wt,{decode:([e,t])=>a.cF(BigInt(e)*BigInt(1e9)+BigInt(t)),encode:e=>a.Zr(e)}).annotations({identifier:"Duration"})){static annotations=super.annotations}g.mg;const kt=(d.y4,d.WG,d.$X,d.DX,d.EF,d.mU,v.mO,v.EM,v.Ls,Symbol.for("@effect/schema/TypeId/ValidDate")),St=e=>t=>t.pipe(fe((e=>!Number.isNaN(e.getTime())),{typeId:kt,description:"a valid Date",...e}));class Ot extends(M(g.$P,{identifier:"DateFromSelf",description:"a potentially invalid Date instance",pretty:()=>e=>`new Date(${JSON.stringify(e)})`,arbitrary:()=>e=>e.date({noInvalidDate:!1}),equivalence:()=>u.n9})){static annotations=super.annotations}class Wt extends(Ot.pipe(St({identifier:"ValidDateFromSelf",description:"a valid Date instance"}))){static annotations=super.annotations}class It extends(ge(K,Ot,{decode:e=>new Date(e),encode:e=>e.toISOString()}).annotations({identifier:"DateFromString"})){static annotations=super.annotations}class qt extends(It.pipe(St({identifier:"Date"}))){static annotations=super.annotations}class Tt extends(ge(Y,Ot,{decode:e=>new Date(e),encode:e=>e.getTime()}).annotations({identifier:"DateFromNumber"})){static annotations=super.annotations}const Et=()=>e=>`BigDecimal(${i.GP(i.S8(e))})`,Ct=()=>e=>e.tuple(e.bigInt(),e.integer()).map((([e,t])=>i.L8(e,t)));class At extends(M(i.s5,{identifier:"BigDecimalFromSelf",pretty:Et,arbitrary:Ct,equivalence:()=>i.rs})){static annotations=super.annotations}class Dt extends(ye(K,At,{decode:(e,t,n)=>i.sH(e).pipe(m.YW({onNone:()=>k.fJ(new k.ZU(n,e)),onSome:e=>k.Py(i.S8(e))})),encode:e=>k.Py(i.GP(i.S8(e)))}).annotations({identifier:"BigDecimal"})){static annotations=super.annotations}class Pt extends(ye(Y,At,{decode:e=>k.Py(i.oB(e)),encode:e=>k.Py(i.Di(e))}).annotations({identifier:"BigDecimalFromNumber"})){static annotations=super.annotations}const Lt=e=>g.Lm(e)?e:e?.disableValidation??!1,Bt=X(oe({_tag:B("None")}).annotations({identifier:"FiberIdNoneEncoded"}),oe({_tag:B("Runtime"),id:st.annotations({title:"id",description:"id"}),startTimeMillis:st.annotations({title:"startTimeMillis",description:"startTimeMillis"})}).annotations({identifier:"FiberIdRuntimeEncoded"}),oe({_tag:B("Composite"),left:le((()=>Bt)),right:le((()=>Bt))}).annotations({identifier:"FiberIdCompositeEncoded"})).annotations({identifier:"FiberIdEncoded"}),Mt=e=>e.letrec((t=>({None:e.record({_tag:e.constant("None")}),Runtime:e.record({_tag:e.constant("Runtime"),id:e.integer(),startTimeMillis:e.integer()}),Composite:e.record({_tag:e.constant("Composite"),left:t("FiberId"),right:t("FiberId")}),FiberId:e.oneof(t("None"),t("Runtime"),t("Composite"))}))).FiberId.map(Ut),Ft=e=>{switch(e._tag){case"None":return"FiberId.none";case"Runtime":return`FiberId.runtime(${e.id}, ${e.startTimeMillis})`;case"Composite":return`FiberId.composite(${Ft(e.right)}, ${Ft(e.left)})`}};class Rt extends(M(p.gb,{identifier:"FiberIdFromSelf",pretty:()=>Ft,arbitrary:()=>Mt})){static annotations=super.annotations}const Ut=e=>{switch(e._tag){case"None":return p.dv;case"Runtime":return p.fA(e.id,e.startTimeMillis);case"Composite":return p.sN(Ut(e.left),Ut(e.right))}},jt=e=>{switch(e._tag){case"None":return{_tag:"None"};case"Runtime":return{_tag:"Runtime",id:e.id,startTimeMillis:e.startTimeMillis};case"Composite":return{_tag:"Composite",left:jt(e.left),right:jt(e.right)}}};class _t extends(ge(Bt,Rt,{decode:Ut,encode:jt}).annotations({identifier:"FiberId"})){static annotations=super.annotations}class $t extends(ge(_,V,{decode:g.zz,encode:h.D_}).annotations({identifier:"BooleanFromUnknown"})){static annotations=super.annotations}},35925:(e,t,n)=>{var r=n(10749),i=n(18880),o=n(233),s=n(60023),a=n(89210),c=n(92075),d=n(34589),l=n(80945),u=n(58600),p=n(89702),h=n(62738),f=n(55519),m=n(61369),y=n(77948),g=n(56572),w=n(86780),N=n(34321),b=n(10523),v=n(98966),x=n(62304);const k=p.Io("Config"),S={reloadUrl:"/",syncUrl:"https://evolu.world",name:"Evolu",maxDrift:3e5,minimumLogLevel:"none"},O=e=>{const t={...S,...e},n=w.Py(k,t),r=x.Uq(t.minimumLogLevel).pipe(x.z7("debug",(()=>N.y)),x.z7("none",(()=>N.NV)),x.z7("trace",(()=>N.Cn)),x.z7("warning",(()=>N.N5)),x.T1),i="none"===t.minimumLogLevel?n:w.Um(n,b.dl(r),b.HC(b.Um,W(t.name)));return v.L(i)},W=e=>b.L8((({logLevel:t,message:n,date:r})=>{const i="Warning"===t._tag?"warn":"Error"===t._tag?"error":"log",o=`${r.getHours().toString().padStart(2,"0")}:${r.getMinutes().toString().padStart(2,"0")}:${r.getSeconds().toString().padStart(2,"0")}:${r.getMilliseconds().toString().padStart(3,"0")}`,s=Array.isArray(n)?n:[n];globalThis.console[i](`${o} [${e}]`,...s)}));var I=n(57964),q=n(4676),T=n(43216),E=n(95107);function C(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`positive integer expected, not ${e}`)}function A(e,...t){if(!((n=e)instanceof Uint8Array||null!=n&&"object"==typeof n&&"Uint8Array"===n.constructor.name))throw new Error("Uint8Array expected");var n;if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function D(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}var P=n(95906);const L=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);function B(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}(e)),A(e),e}new Uint8Array(new Uint32Array([287454020]).buffer)[0];class M{clone(){return this._cloneInto()}}function F(e){const t=t=>e().update(B(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}class R extends M{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,function(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");C(e.outputLen),C(e.blockLen)}(e);const n=B(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,i=new Uint8Array(r);i.set(n.length>r?e.create().update(n).digest():n);for(let e=0;e<i.length;e++)i[e]^=54;this.iHash.update(i),this.oHash=e.create();for(let e=0;e<i.length;e++)i[e]^=106;this.oHash.update(i),i.fill(0)}update(e){return D(this),this.iHash.update(e),this}digestInto(e){D(this),A(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:r,destroyed:i,blockLen:o,outputLen:s}=this;return e.finished=r,e.destroyed=i,e.blockLen=o,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const U=(e,t,n)=>new R(e,t).update(n).digest();U.create=(e,t)=>new R(e,t);class j extends M{constructor(e,t,n,r){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=L(this.buffer)}update(e){D(this);const{view:t,buffer:n,blockLen:r}=this,i=(e=B(e)).length;for(let o=0;o<i;){const s=Math.min(r-this.pos,i-o);if(s!==r)n.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===r&&(this.process(t,0),this.pos=0);else{const t=L(e);for(;r<=i-o;o+=r)this.process(t,o)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){D(this),function(e,t){A(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>r-o&&(this.process(n,0),o=0);for(let e=o;e<r;e++)t[e]=0;!function(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);const i=BigInt(32),o=BigInt(4294967295),s=Number(n>>i&o),a=Number(n&o),c=r?4:0,d=r?0:4;e.setUint32(t+c,s,r),e.setUint32(t+d,a,r)}(n,r-8,BigInt(8*this.length),i),this.process(n,0);const s=L(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,d=this.get();if(c>d.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)s.setUint32(4*e,d[e],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:i,destroyed:o,pos:s}=this;return e.length=r,e.pos=s,e.finished=i,e.destroyed=o,r%t&&e.buffer.set(n),e}}const _=BigInt(2**32-1),$=BigInt(32);function Q(e,t=!1){return t?{h:Number(e&_),l:Number(e>>$&_)}:{h:0|Number(e>>$&_),l:0|Number(e&_)}}const J=function(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let i=0;i<e.length;i++){const{h:o,l:s}=Q(e[i],t);[n[i],r[i]]=[o,s]}return[n,r]},K=(e,t,n)=>e>>>n,Y=(e,t,n)=>e<<32-n|t>>>n,V=(e,t,n)=>e>>>n|t<<32-n,z=(e,t,n)=>e<<32-n|t>>>n,H=(e,t,n)=>e<<64-n|t>>>n-32,X=(e,t,n)=>e>>>n-32|t<<64-n,G=function(e,t,n,r){const i=(t>>>0)+(r>>>0);return{h:e+n+(i/2**32|0)|0,l:0|i}},Z=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),ee=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,te=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),ne=(e,t,n,r,i)=>t+n+r+i+(e/2**32|0)|0,re=(e,t,n,r,i,o)=>t+n+r+i+o+(e/2**32|0)|0,ie=(e,t,n,r,i)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(i>>>0),[oe,se]=(()=>J(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((e=>BigInt(e)))))(),ae=new Uint32Array(80),ce=new Uint32Array(80);class de extends j{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:r,Ch:i,Cl:o,Dh:s,Dl:a,Eh:c,El:d,Fh:l,Fl:u,Gh:p,Gl:h,Hh:f,Hl:m}=this;return[e,t,n,r,i,o,s,a,c,d,l,u,p,h,f,m]}set(e,t,n,r,i,o,s,a,c,d,l,u,p,h,f,m){this.Ah=0|e,this.Al=0|t,this.Bh=0|n,this.Bl=0|r,this.Ch=0|i,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|d,this.Fh=0|l,this.Fl=0|u,this.Gh=0|p,this.Gl=0|h,this.Hh=0|f,this.Hl=0|m}process(e,t){for(let n=0;n<16;n++,t+=4)ae[n]=e.getUint32(t),ce[n]=e.getUint32(t+=4);for(let e=16;e<80;e++){const t=0|ae[e-15],n=0|ce[e-15],r=V(t,n,1)^V(t,n,8)^K(t,n,7),i=z(t,n,1)^z(t,n,8)^Y(t,n,7),o=0|ae[e-2],s=0|ce[e-2],a=V(o,s,19)^H(o,s,61)^K(o,s,6),c=z(o,s,19)^X(o,s,61)^Y(o,s,6),d=te(i,c,ce[e-7],ce[e-16]),l=ne(d,r,a,ae[e-7],ae[e-16]);ae[e]=0|l,ce[e]=0|d}let{Ah:n,Al:r,Bh:i,Bl:o,Ch:s,Cl:a,Dh:c,Dl:d,Eh:l,El:u,Fh:p,Fl:h,Gh:f,Gl:m,Hh:y,Hl:g}=this;for(let e=0;e<80;e++){const t=V(l,u,14)^V(l,u,18)^H(l,u,41),w=z(l,u,14)^z(l,u,18)^X(l,u,41),N=l&p^~l&f,b=ie(g,w,u&h^~u&m,se[e],ce[e]),v=re(b,y,t,N,oe[e],ae[e]),x=0|b,k=V(n,r,28)^H(n,r,34)^H(n,r,39),S=z(n,r,28)^X(n,r,34)^X(n,r,39),O=n&i^n&s^i&s,W=r&o^r&a^o&a;y=0|f,g=0|m,f=0|p,m=0|h,p=0|l,h=0|u,({h:l,l:u}=G(0|c,0|d,0|v,0|x)),c=0|s,d=0|a,s=0|i,a=0|o,i=0|n,o=0|r;const I=Z(x,S,W);n=ee(I,v,k,O),r=0|I}({h:n,l:r}=G(0|this.Ah,0|this.Al,0|n,0|r)),({h:i,l:o}=G(0|this.Bh,0|this.Bl,0|i,0|o)),({h:s,l:a}=G(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l:d}=G(0|this.Dh,0|this.Dl,0|c,0|d)),({h:l,l:u}=G(0|this.Eh,0|this.El,0|l,0|u)),({h:p,l:h}=G(0|this.Fh,0|this.Fl,0|p,0|h)),({h:f,l:m}=G(0|this.Gh,0|this.Gl,0|f,0|m)),({h:y,l:g}=G(0|this.Hh,0|this.Hl,0|y,0|g)),this.set(n,r,i,o,s,a,c,d,l,u,p,h,f,m,y,g)}roundClean(){ae.fill(0),ce.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const le=F((()=>new de));function ue(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`positive integer expected, not ${e}`)}function pe(e,...t){if(!((n=e)instanceof Uint8Array||null!=n&&"object"==typeof n&&"Uint8Array"===n.constructor.name))throw new Error("Uint8Array expected");var n;if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function he(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");ue(e.outputLen),ue(e.blockLen)}function fe(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}const me="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,ye=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),ge=(e,t)=>e<<32-t|e>>>t;function we(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}(e)),pe(e),e}new Uint8Array(new Uint32Array([287454020]).buffer)[0];class Ne{clone(){return this._cloneInto()}}const be={}.toString;function ve(e){const t=t=>e().update(we(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}class xe extends Ne{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,he(e);const n=we(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,i=new Uint8Array(r);i.set(n.length>r?e.create().update(n).digest():n);for(let e=0;e<i.length;e++)i[e]^=54;this.iHash.update(i),this.oHash=e.create();for(let e=0;e<i.length;e++)i[e]^=106;this.oHash.update(i),i.fill(0)}update(e){return fe(this),this.iHash.update(e),this}digestInto(e){fe(this),pe(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:r,destroyed:i,blockLen:o,outputLen:s}=this;return e.finished=r,e.destroyed=i,e.blockLen=o,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const ke=(e,t,n)=>new xe(e,t).update(n).digest();ke.create=(e,t)=>new xe(e,t);const Se=(e,t,n)=>e&t^e&n^t&n;class Oe extends Ne{constructor(e,t,n,r){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ye(this.buffer)}update(e){fe(this);const{view:t,buffer:n,blockLen:r}=this,i=(e=we(e)).length;for(let o=0;o<i;){const s=Math.min(r-this.pos,i-o);if(s!==r)n.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===r&&(this.process(t,0),this.pos=0);else{const t=ye(e);for(;r<=i-o;o+=r)this.process(t,o)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){fe(this),function(e,t){pe(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>r-o&&(this.process(n,0),o=0);for(let e=o;e<r;e++)t[e]=0;!function(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);const i=BigInt(32),o=BigInt(4294967295),s=Number(n>>i&o),a=Number(n&o),c=r?4:0,d=r?0:4;e.setUint32(t+c,s,r),e.setUint32(t+d,a,r)}(n,r-8,BigInt(8*this.length),i),this.process(n,0);const s=ye(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,d=this.get();if(c>d.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)s.setUint32(4*e,d[e],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:i,destroyed:o,pos:s}=this;return e.length=r,e.pos=s,e.finished=i,e.destroyed=o,r%t&&e.buffer.set(n),e}}const We=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ie=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),qe=new Uint32Array(64);class Te extends Oe{constructor(){super(64,32,8,!1),this.A=0|Ie[0],this.B=0|Ie[1],this.C=0|Ie[2],this.D=0|Ie[3],this.E=0|Ie[4],this.F=0|Ie[5],this.G=0|Ie[6],this.H=0|Ie[7]}get(){const{A:e,B:t,C:n,D:r,E:i,F:o,G:s,H:a}=this;return[e,t,n,r,i,o,s,a]}set(e,t,n,r,i,o,s,a){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(e,t){for(let n=0;n<16;n++,t+=4)qe[n]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=qe[e-15],n=qe[e-2],r=ge(t,7)^ge(t,18)^t>>>3,i=ge(n,17)^ge(n,19)^n>>>10;qe[e]=i+qe[e-7]+r+qe[e-16]|0}let{A:n,B:r,C:i,D:o,E:s,F:a,G:c,H:d}=this;for(let e=0;e<64;e++){const t=d+(ge(s,6)^ge(s,11)^ge(s,25))+((l=s)&a^~l&c)+We[e]+qe[e]|0,u=(ge(n,2)^ge(n,13)^ge(n,22))+Se(n,r,i)|0;d=c,c=a,a=s,s=o+t|0,o=i,i=r,r=n,n=t+u|0}var l;n=n+this.A|0,r=r+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,d=d+this.H|0,this.set(n,r,i,o,s,a,c,d)}roundClean(){qe.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Ee=ve((()=>new Te)),Ce=BigInt(2**32-1),Ae=BigInt(32);function De(e,t=!1){return t?{h:Number(e&Ce),l:Number(e>>Ae&Ce)}:{h:0|Number(e>>Ae&Ce),l:0|Number(e&Ce)}}const Pe=function(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let i=0;i<e.length;i++){const{h:o,l:s}=De(e[i],t);[n[i],r[i]]=[o,s]}return[n,r]},Le=(e,t,n)=>e>>>n,Be=(e,t,n)=>e<<32-n|t>>>n,Me=(e,t,n)=>e>>>n|t<<32-n,Fe=(e,t,n)=>e<<32-n|t>>>n,Re=(e,t,n)=>e<<64-n|t>>>n-32,Ue=(e,t,n)=>e>>>n-32|t<<64-n,je=function(e,t,n,r){const i=(t>>>0)+(r>>>0);return{h:e+n+(i/2**32|0)|0,l:0|i}},_e=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),$e=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,Qe=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),Je=(e,t,n,r,i)=>t+n+r+i+(e/2**32|0)|0,Ke=(e,t,n,r,i,o)=>t+n+r+i+o+(e/2**32|0)|0,Ye=(e,t,n,r,i)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(i>>>0),[Ve,ze]=(()=>Pe(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((e=>BigInt(e)))))(),He=new Uint32Array(80),Xe=new Uint32Array(80);class Ge extends Oe{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:r,Ch:i,Cl:o,Dh:s,Dl:a,Eh:c,El:d,Fh:l,Fl:u,Gh:p,Gl:h,Hh:f,Hl:m}=this;return[e,t,n,r,i,o,s,a,c,d,l,u,p,h,f,m]}set(e,t,n,r,i,o,s,a,c,d,l,u,p,h,f,m){this.Ah=0|e,this.Al=0|t,this.Bh=0|n,this.Bl=0|r,this.Ch=0|i,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|d,this.Fh=0|l,this.Fl=0|u,this.Gh=0|p,this.Gl=0|h,this.Hh=0|f,this.Hl=0|m}process(e,t){for(let n=0;n<16;n++,t+=4)He[n]=e.getUint32(t),Xe[n]=e.getUint32(t+=4);for(let e=16;e<80;e++){const t=0|He[e-15],n=0|Xe[e-15],r=Me(t,n,1)^Me(t,n,8)^Le(t,n,7),i=Fe(t,n,1)^Fe(t,n,8)^Be(t,n,7),o=0|He[e-2],s=0|Xe[e-2],a=Me(o,s,19)^Re(o,s,61)^Le(o,s,6),c=Fe(o,s,19)^Ue(o,s,61)^Be(o,s,6),d=Qe(i,c,Xe[e-7],Xe[e-16]),l=Je(d,r,a,He[e-7],He[e-16]);He[e]=0|l,Xe[e]=0|d}let{Ah:n,Al:r,Bh:i,Bl:o,Ch:s,Cl:a,Dh:c,Dl:d,Eh:l,El:u,Fh:p,Fl:h,Gh:f,Gl:m,Hh:y,Hl:g}=this;for(let e=0;e<80;e++){const t=Me(l,u,14)^Me(l,u,18)^Re(l,u,41),w=Fe(l,u,14)^Fe(l,u,18)^Ue(l,u,41),N=l&p^~l&f,b=Ye(g,w,u&h^~u&m,ze[e],Xe[e]),v=Ke(b,y,t,N,Ve[e],He[e]),x=0|b,k=Me(n,r,28)^Re(n,r,34)^Re(n,r,39),S=Fe(n,r,28)^Ue(n,r,34)^Ue(n,r,39),O=n&i^n&s^i&s,W=r&o^r&a^o&a;y=0|f,g=0|m,f=0|p,m=0|h,p=0|l,h=0|u,({h:l,l:u}=je(0|c,0|d,0|v,0|x)),c=0|s,d=0|a,s=0|i,a=0|o,i=0|n,o=0|r;const I=_e(x,S,W);n=$e(I,v,k,O),r=0|I}({h:n,l:r}=je(0|this.Ah,0|this.Al,0|n,0|r)),({h:i,l:o}=je(0|this.Bh,0|this.Bl,0|i,0|o)),({h:s,l:a}=je(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l:d}=je(0|this.Dh,0|this.Dl,0|c,0|d)),({h:l,l:u}=je(0|this.Eh,0|this.El,0|l,0|u)),({h:p,l:h}=je(0|this.Fh,0|this.Fl,0|p,0|h)),({h:f,l:m}=je(0|this.Gh,0|this.Gl,0|f,0|m)),({h:y,l:g}=je(0|this.Hh,0|this.Hl,0|y,0|g)),this.set(n,r,i,o,s,a,c,d,l,u,p,h,f,m,y,g)}roundClean(){He.fill(0),Xe.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Ze=ve((()=>new Ge));function et(e){if(!Number.isSafeInteger(e))throw new Error(`Wrong integer: ${e}`)}function tt(e){return e instanceof Uint8Array||null!=e&&"object"==typeof e&&"Uint8Array"===e.constructor.name}function nt(...e){const t=e=>e,n=(e,t)=>n=>e(t(n));return{encode:e.map((e=>e.encode)).reduceRight(n,t),decode:e.map((e=>e.decode)).reduce(n,t)}}function rt(e){return{encode:t=>{if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw new Error("alphabet.encode input should be an array of numbers");return t.map((t=>{if(et(t),t<0||t>=e.length)throw new Error(`Digit index outside alphabet: ${t} (alphabet: ${e.length})`);return e[t]}))},decode:t=>{if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("alphabet.decode input should be array of strings");return t.map((t=>{if("string"!=typeof t)throw new Error(`alphabet.decode: not string element=${t}`);const n=e.indexOf(t);if(-1===n)throw new Error(`Unknown letter: "${t}". Allowed: ${e}`);return n}))}}}function it(e=""){if("string"!=typeof e)throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("join.encode input should be array of strings");for(let e of t)if("string"!=typeof e)throw new Error(`join.encode: non-string input=${e}`);return t.join(e)},decode:t=>{if("string"!=typeof t)throw new Error("join.decode input should be string");return t.split(e)}}}function ot(e,t="="){if(et(e),"string"!=typeof t)throw new Error("padding chr should be string");return{encode(n){if(!Array.isArray(n)||n.length&&"string"!=typeof n[0])throw new Error("padding.encode input should be array of strings");for(let e of n)if("string"!=typeof e)throw new Error(`padding.encode: non-string input=${e}`);for(;n.length*e%8;)n.push(t);return n},decode(n){if(!Array.isArray(n)||n.length&&"string"!=typeof n[0])throw new Error("padding.encode input should be array of strings");for(let e of n)if("string"!=typeof e)throw new Error(`padding.decode: non-string input=${e}`);let r=n.length;if(r*e%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if(!((r-1)*e%8))throw new Error("Invalid padding: string has too much padding");return n.slice(0,r)}}}function st(e){if("function"!=typeof e)throw new Error("normalize fn should be function");return{encode:e=>e,decode:t=>e(t)}}function at(e,t,n){if(t<2)throw new Error(`convertRadix: wrong from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: wrong to=${n}, base cannot be less than 2`);if(!Array.isArray(e))throw new Error("convertRadix: data should be array");if(!e.length)return[];let r=0;const i=[],o=Array.from(e);for(o.forEach((e=>{if(et(e),e<0||e>=t)throw new Error(`Wrong integer: ${e}`)}));;){let e=0,s=!0;for(let i=r;i<o.length;i++){const a=o[i],c=t*e+a;if(!Number.isSafeInteger(c)||t*e/t!==e||c-a!=t*e)throw new Error("convertRadix: carry overflow");e=c%n;const d=Math.floor(c/n);if(o[i]=d,!Number.isSafeInteger(d)||d*n+e!==c)throw new Error("convertRadix: carry overflow");s&&(d?s=!1:r=i)}if(i.push(e),s)break}for(let t=0;t<e.length-1&&0===e[t];t++)i.push(0);return i.reverse()}const ct=(e,t)=>t?ct(t,e%t):e,dt=(e,t)=>e+(t-ct(e,t));function lt(e,t,n,r){if(!Array.isArray(e))throw new Error("convertRadix2: data should be array");if(t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(dt(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${dt(t,n)}`);let i=0,o=0;const s=2**n-1,a=[];for(const r of e){if(et(r),r>=2**t)throw new Error(`convertRadix2: invalid data word=${r} from=${t}`);if(i=i<<t|r,o+t>32)throw new Error(`convertRadix2: carry overflow pos=${o} from=${t}`);for(o+=t;o>=n;o-=n)a.push((i>>o-n&s)>>>0);i&=2**o-1}if(i=i<<n-o&s,!r&&o>=t)throw new Error("Excess padding");if(!r&&i)throw new Error(`Non-zero padding: ${i}`);return r&&o>0&&a.push(i>>>0),a}function ut(e){return et(e),{encode:t=>{if(!tt(t))throw new Error("radix.encode input should be Uint8Array");return at(Array.from(t),256,e)},decode:t=>{if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw new Error("radix.decode input should be array of numbers");return Uint8Array.from(at(t,e,256))}}}function pt(e,t=!1){if(et(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(dt(8,e)>32||dt(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!tt(n))throw new Error("radix2.encode input should be Uint8Array");return lt(Array.from(n),8,e,!t)},decode:n=>{if(!Array.isArray(n)||n.length&&"number"!=typeof n[0])throw new Error("radix2.decode input should be array of numbers");return Uint8Array.from(lt(n,e,8,t))}}}const ht={alphabet:rt,chain:nt,checksum:function(e,t){if(et(e),"function"!=typeof t)throw new Error("checksum fn should be function");return{encode(n){if(!tt(n))throw new Error("checksum.encode: input should be Uint8Array");const r=t(n).slice(0,e),i=new Uint8Array(n.length+e);return i.set(n),i.set(r,n.length),i},decode(n){if(!tt(n))throw new Error("checksum.decode: input should be Uint8Array");const r=n.slice(0,-e),i=t(r).slice(0,e),o=n.slice(-e);for(let t=0;t<e;t++)if(i[t]!==o[t])throw new Error("Invalid checksum");return r}}},convertRadix:at,convertRadix2:lt,radix:ut,radix2:pt,join:it,padding:ot};pt(4),rt("0123456789ABCDEF"),it(""),pt(5),rt("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),ot(5),it(""),pt(5),rt("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),it(""),pt(5),rt("0123456789ABCDEFGHIJKLMNOPQRSTUV"),ot(5),it(""),pt(5),rt("0123456789ABCDEFGHIJKLMNOPQRSTUV"),it(""),pt(5),rt("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),it(""),st((e=>e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))),pt(6),rt("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),ot(6),it(""),pt(6),rt("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),it(""),pt(6),rt("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),ot(6),it("");rt("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),it("");const ft=(pt(4),rt("0123456789abcdef"),it(""),st((e=>{if("string"!=typeof e||e.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()})),e=>""===e[0]);function mt(e){if("string"!=typeof e)throw new TypeError("Invalid mnemonic type: "+typeof e);return e.normalize("NFKD")}function yt(e,t=128){if(ue(t),t%32!=0||t>256)throw new TypeError("Invalid entropy");return function(e,t){!function(e){pe(e,16,20,24,28,32)}(e);const n=function(e){if(!Array.isArray(e)||2048!==e.length||"string"!=typeof e[0])throw new Error("Wordlist: expected array of 2048 strings");return e.forEach((e=>{if("string"!=typeof e)throw new Error(`Wordlist: non-string element: ${e}`)})),ht.chain(ht.checksum(1,gt),ht.radix2(11,!0),ht.alphabet(e))}(t).encode(e);return n.join(ft(t)?"":" ")}(function(e=32){if(me&&"function"==typeof me.getRandomValues)return me.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}(t/8),e)}const gt=e=>{const t=8-e.length/4;return new Uint8Array([Ee(e)[0]>>t<<t])};function wt(e,t=""){return function(e,t,n,r){const{c:i,dkLen:o,DK:s,PRF:a,PRFSalt:c}=function(e,t,n,r){he(e);const i=function(e,t){if(void 0!==t&&"[object Object]"!==be.call(t))throw new Error("Options should be object or undefined");return Object.assign({dkLen:32,asyncTick:10},t)}(0,r),{c:o,dkLen:s,asyncTick:a}=i;if(ue(o),ue(s),ue(a),o<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const c=we(t),d=we(n),l=new Uint8Array(s),u=ke.create(e,c),p=u._cloneInto().update(d);return{c:o,dkLen:s,asyncTick:a,DK:l,PRF:u,PRFSalt:p}}(e,t,n,{c:2048,dkLen:64});let d;const l=new Uint8Array(4),u=ye(l),p=new Uint8Array(a.outputLen);for(let e=1,t=0;t<o;e++,t+=a.outputLen){const n=s.subarray(t,t+a.outputLen);u.setInt32(0,e,!1),(d=c._cloneInto(d)).update(l).digestInto(p),n.set(p.subarray(0,n.length));for(let e=1;e<i;e++){a._cloneInto(d).update(p).digestInto(p);for(let e=0;e<n.length;e++)n[e]^=p[e]}}return function(e,t,n,r,i){return e.destroy(),t.destroy(),r&&r.destroy(),i.fill(0),n}(a,c,s,d,p)}(Ze,function(e){const t=mt(e),n=t.split(" ");if(![12,15,18,21,24].includes(n.length))throw new Error("Invalid mnemonic");return{nfkd:t,words:n}}(e).nfkd,(e=>mt(`mnemonic${e}`))(t))}const Nt="abandon\nability\nable\nabout\nabove\nabsent\nabsorb\nabstract\nabsurd\nabuse\naccess\naccident\naccount\naccuse\nachieve\nacid\nacoustic\nacquire\nacross\nact\naction\nactor\nactress\nactual\nadapt\nadd\naddict\naddress\nadjust\nadmit\nadult\nadvance\nadvice\naerobic\naffair\nafford\nafraid\nagain\nage\nagent\nagree\nahead\naim\nair\nairport\naisle\nalarm\nalbum\nalcohol\nalert\nalien\nall\nalley\nallow\nalmost\nalone\nalpha\nalready\nalso\nalter\nalways\namateur\namazing\namong\namount\namused\nanalyst\nanchor\nancient\nanger\nangle\nangry\nanimal\nankle\nannounce\nannual\nanother\nanswer\nantenna\nantique\nanxiety\nany\napart\napology\nappear\napple\napprove\napril\narch\narctic\narea\narena\nargue\narm\narmed\narmor\narmy\naround\narrange\narrest\narrive\narrow\nart\nartefact\nartist\nartwork\nask\naspect\nassault\nasset\nassist\nassume\nasthma\nathlete\natom\nattack\nattend\nattitude\nattract\nauction\naudit\naugust\naunt\nauthor\nauto\nautumn\naverage\navocado\navoid\nawake\naware\naway\nawesome\nawful\nawkward\naxis\nbaby\nbachelor\nbacon\nbadge\nbag\nbalance\nbalcony\nball\nbamboo\nbanana\nbanner\nbar\nbarely\nbargain\nbarrel\nbase\nbasic\nbasket\nbattle\nbeach\nbean\nbeauty\nbecause\nbecome\nbeef\nbefore\nbegin\nbehave\nbehind\nbelieve\nbelow\nbelt\nbench\nbenefit\nbest\nbetray\nbetter\nbetween\nbeyond\nbicycle\nbid\nbike\nbind\nbiology\nbird\nbirth\nbitter\nblack\nblade\nblame\nblanket\nblast\nbleak\nbless\nblind\nblood\nblossom\nblouse\nblue\nblur\nblush\nboard\nboat\nbody\nboil\nbomb\nbone\nbonus\nbook\nboost\nborder\nboring\nborrow\nboss\nbottom\nbounce\nbox\nboy\nbracket\nbrain\nbrand\nbrass\nbrave\nbread\nbreeze\nbrick\nbridge\nbrief\nbright\nbring\nbrisk\nbroccoli\nbroken\nbronze\nbroom\nbrother\nbrown\nbrush\nbubble\nbuddy\nbudget\nbuffalo\nbuild\nbulb\nbulk\nbullet\nbundle\nbunker\nburden\nburger\nburst\nbus\nbusiness\nbusy\nbutter\nbuyer\nbuzz\ncabbage\ncabin\ncable\ncactus\ncage\ncake\ncall\ncalm\ncamera\ncamp\ncan\ncanal\ncancel\ncandy\ncannon\ncanoe\ncanvas\ncanyon\ncapable\ncapital\ncaptain\ncar\ncarbon\ncard\ncargo\ncarpet\ncarry\ncart\ncase\ncash\ncasino\ncastle\ncasual\ncat\ncatalog\ncatch\ncategory\ncattle\ncaught\ncause\ncaution\ncave\nceiling\ncelery\ncement\ncensus\ncentury\ncereal\ncertain\nchair\nchalk\nchampion\nchange\nchaos\nchapter\ncharge\nchase\nchat\ncheap\ncheck\ncheese\nchef\ncherry\nchest\nchicken\nchief\nchild\nchimney\nchoice\nchoose\nchronic\nchuckle\nchunk\nchurn\ncigar\ncinnamon\ncircle\ncitizen\ncity\ncivil\nclaim\nclap\nclarify\nclaw\nclay\nclean\nclerk\nclever\nclick\nclient\ncliff\nclimb\nclinic\nclip\nclock\nclog\nclose\ncloth\ncloud\nclown\nclub\nclump\ncluster\nclutch\ncoach\ncoast\ncoconut\ncode\ncoffee\ncoil\ncoin\ncollect\ncolor\ncolumn\ncombine\ncome\ncomfort\ncomic\ncommon\ncompany\nconcert\nconduct\nconfirm\ncongress\nconnect\nconsider\ncontrol\nconvince\ncook\ncool\ncopper\ncopy\ncoral\ncore\ncorn\ncorrect\ncost\ncotton\ncouch\ncountry\ncouple\ncourse\ncousin\ncover\ncoyote\ncrack\ncradle\ncraft\ncram\ncrane\ncrash\ncrater\ncrawl\ncrazy\ncream\ncredit\ncreek\ncrew\ncricket\ncrime\ncrisp\ncritic\ncrop\ncross\ncrouch\ncrowd\ncrucial\ncruel\ncruise\ncrumble\ncrunch\ncrush\ncry\ncrystal\ncube\nculture\ncup\ncupboard\ncurious\ncurrent\ncurtain\ncurve\ncushion\ncustom\ncute\ncycle\ndad\ndamage\ndamp\ndance\ndanger\ndaring\ndash\ndaughter\ndawn\nday\ndeal\ndebate\ndebris\ndecade\ndecember\ndecide\ndecline\ndecorate\ndecrease\ndeer\ndefense\ndefine\ndefy\ndegree\ndelay\ndeliver\ndemand\ndemise\ndenial\ndentist\ndeny\ndepart\ndepend\ndeposit\ndepth\ndeputy\nderive\ndescribe\ndesert\ndesign\ndesk\ndespair\ndestroy\ndetail\ndetect\ndevelop\ndevice\ndevote\ndiagram\ndial\ndiamond\ndiary\ndice\ndiesel\ndiet\ndiffer\ndigital\ndignity\ndilemma\ndinner\ndinosaur\ndirect\ndirt\ndisagree\ndiscover\ndisease\ndish\ndismiss\ndisorder\ndisplay\ndistance\ndivert\ndivide\ndivorce\ndizzy\ndoctor\ndocument\ndog\ndoll\ndolphin\ndomain\ndonate\ndonkey\ndonor\ndoor\ndose\ndouble\ndove\ndraft\ndragon\ndrama\ndrastic\ndraw\ndream\ndress\ndrift\ndrill\ndrink\ndrip\ndrive\ndrop\ndrum\ndry\nduck\ndumb\ndune\nduring\ndust\ndutch\nduty\ndwarf\ndynamic\neager\neagle\nearly\nearn\nearth\neasily\neast\neasy\necho\necology\neconomy\nedge\nedit\neducate\neffort\negg\neight\neither\nelbow\nelder\nelectric\nelegant\nelement\nelephant\nelevator\nelite\nelse\nembark\nembody\nembrace\nemerge\nemotion\nemploy\nempower\nempty\nenable\nenact\nend\nendless\nendorse\nenemy\nenergy\nenforce\nengage\nengine\nenhance\nenjoy\nenlist\nenough\nenrich\nenroll\nensure\nenter\nentire\nentry\nenvelope\nepisode\nequal\nequip\nera\nerase\nerode\nerosion\nerror\nerupt\nescape\nessay\nessence\nestate\neternal\nethics\nevidence\nevil\nevoke\nevolve\nexact\nexample\nexcess\nexchange\nexcite\nexclude\nexcuse\nexecute\nexercise\nexhaust\nexhibit\nexile\nexist\nexit\nexotic\nexpand\nexpect\nexpire\nexplain\nexpose\nexpress\nextend\nextra\neye\neyebrow\nfabric\nface\nfaculty\nfade\nfaint\nfaith\nfall\nfalse\nfame\nfamily\nfamous\nfan\nfancy\nfantasy\nfarm\nfashion\nfat\nfatal\nfather\nfatigue\nfault\nfavorite\nfeature\nfebruary\nfederal\nfee\nfeed\nfeel\nfemale\nfence\nfestival\nfetch\nfever\nfew\nfiber\nfiction\nfield\nfigure\nfile\nfilm\nfilter\nfinal\nfind\nfine\nfinger\nfinish\nfire\nfirm\nfirst\nfiscal\nfish\nfit\nfitness\nfix\nflag\nflame\nflash\nflat\nflavor\nflee\nflight\nflip\nfloat\nflock\nfloor\nflower\nfluid\nflush\nfly\nfoam\nfocus\nfog\nfoil\nfold\nfollow\nfood\nfoot\nforce\nforest\nforget\nfork\nfortune\nforum\nforward\nfossil\nfoster\nfound\nfox\nfragile\nframe\nfrequent\nfresh\nfriend\nfringe\nfrog\nfront\nfrost\nfrown\nfrozen\nfruit\nfuel\nfun\nfunny\nfurnace\nfury\nfuture\ngadget\ngain\ngalaxy\ngallery\ngame\ngap\ngarage\ngarbage\ngarden\ngarlic\ngarment\ngas\ngasp\ngate\ngather\ngauge\ngaze\ngeneral\ngenius\ngenre\ngentle\ngenuine\ngesture\nghost\ngiant\ngift\ngiggle\nginger\ngiraffe\ngirl\ngive\nglad\nglance\nglare\nglass\nglide\nglimpse\nglobe\ngloom\nglory\nglove\nglow\nglue\ngoat\ngoddess\ngold\ngood\ngoose\ngorilla\ngospel\ngossip\ngovern\ngown\ngrab\ngrace\ngrain\ngrant\ngrape\ngrass\ngravity\ngreat\ngreen\ngrid\ngrief\ngrit\ngrocery\ngroup\ngrow\ngrunt\nguard\nguess\nguide\nguilt\nguitar\ngun\ngym\nhabit\nhair\nhalf\nhammer\nhamster\nhand\nhappy\nharbor\nhard\nharsh\nharvest\nhat\nhave\nhawk\nhazard\nhead\nhealth\nheart\nheavy\nhedgehog\nheight\nhello\nhelmet\nhelp\nhen\nhero\nhidden\nhigh\nhill\nhint\nhip\nhire\nhistory\nhobby\nhockey\nhold\nhole\nholiday\nhollow\nhome\nhoney\nhood\nhope\nhorn\nhorror\nhorse\nhospital\nhost\nhotel\nhour\nhover\nhub\nhuge\nhuman\nhumble\nhumor\nhundred\nhungry\nhunt\nhurdle\nhurry\nhurt\nhusband\nhybrid\nice\nicon\nidea\nidentify\nidle\nignore\nill\nillegal\nillness\nimage\nimitate\nimmense\nimmune\nimpact\nimpose\nimprove\nimpulse\ninch\ninclude\nincome\nincrease\nindex\nindicate\nindoor\nindustry\ninfant\ninflict\ninform\ninhale\ninherit\ninitial\ninject\ninjury\ninmate\ninner\ninnocent\ninput\ninquiry\ninsane\ninsect\ninside\ninspire\ninstall\nintact\ninterest\ninto\ninvest\ninvite\ninvolve\niron\nisland\nisolate\nissue\nitem\nivory\njacket\njaguar\njar\njazz\njealous\njeans\njelly\njewel\njob\njoin\njoke\njourney\njoy\njudge\njuice\njump\njungle\njunior\njunk\njust\nkangaroo\nkeen\nkeep\nketchup\nkey\nkick\nkid\nkidney\nkind\nkingdom\nkiss\nkit\nkitchen\nkite\nkitten\nkiwi\nknee\nknife\nknock\nknow\nlab\nlabel\nlabor\nladder\nlady\nlake\nlamp\nlanguage\nlaptop\nlarge\nlater\nlatin\nlaugh\nlaundry\nlava\nlaw\nlawn\nlawsuit\nlayer\nlazy\nleader\nleaf\nlearn\nleave\nlecture\nleft\nleg\nlegal\nlegend\nleisure\nlemon\nlend\nlength\nlens\nleopard\nlesson\nletter\nlevel\nliar\nliberty\nlibrary\nlicense\nlife\nlift\nlight\nlike\nlimb\nlimit\nlink\nlion\nliquid\nlist\nlittle\nlive\nlizard\nload\nloan\nlobster\nlocal\nlock\nlogic\nlonely\nlong\nloop\nlottery\nloud\nlounge\nlove\nloyal\nlucky\nluggage\nlumber\nlunar\nlunch\nluxury\nlyrics\nmachine\nmad\nmagic\nmagnet\nmaid\nmail\nmain\nmajor\nmake\nmammal\nman\nmanage\nmandate\nmango\nmansion\nmanual\nmaple\nmarble\nmarch\nmargin\nmarine\nmarket\nmarriage\nmask\nmass\nmaster\nmatch\nmaterial\nmath\nmatrix\nmatter\nmaximum\nmaze\nmeadow\nmean\nmeasure\nmeat\nmechanic\nmedal\nmedia\nmelody\nmelt\nmember\nmemory\nmention\nmenu\nmercy\nmerge\nmerit\nmerry\nmesh\nmessage\nmetal\nmethod\nmiddle\nmidnight\nmilk\nmillion\nmimic\nmind\nminimum\nminor\nminute\nmiracle\nmirror\nmisery\nmiss\nmistake\nmix\nmixed\nmixture\nmobile\nmodel\nmodify\nmom\nmoment\nmonitor\nmonkey\nmonster\nmonth\nmoon\nmoral\nmore\nmorning\nmosquito\nmother\nmotion\nmotor\nmountain\nmouse\nmove\nmovie\nmuch\nmuffin\nmule\nmultiply\nmuscle\nmuseum\nmushroom\nmusic\nmust\nmutual\nmyself\nmystery\nmyth\nnaive\nname\nnapkin\nnarrow\nnasty\nnation\nnature\nnear\nneck\nneed\nnegative\nneglect\nneither\nnephew\nnerve\nnest\nnet\nnetwork\nneutral\nnever\nnews\nnext\nnice\nnight\nnoble\nnoise\nnominee\nnoodle\nnormal\nnorth\nnose\nnotable\nnote\nnothing\nnotice\nnovel\nnow\nnuclear\nnumber\nnurse\nnut\noak\nobey\nobject\noblige\nobscure\nobserve\nobtain\nobvious\noccur\nocean\noctober\nodor\noff\noffer\noffice\noften\noil\nokay\nold\nolive\nolympic\nomit\nonce\none\nonion\nonline\nonly\nopen\nopera\nopinion\noppose\noption\norange\norbit\norchard\norder\nordinary\norgan\norient\noriginal\norphan\nostrich\nother\noutdoor\nouter\noutput\noutside\noval\noven\nover\nown\nowner\noxygen\noyster\nozone\npact\npaddle\npage\npair\npalace\npalm\npanda\npanel\npanic\npanther\npaper\nparade\nparent\npark\nparrot\nparty\npass\npatch\npath\npatient\npatrol\npattern\npause\npave\npayment\npeace\npeanut\npear\npeasant\npelican\npen\npenalty\npencil\npeople\npepper\nperfect\npermit\nperson\npet\nphone\nphoto\nphrase\nphysical\npiano\npicnic\npicture\npiece\npig\npigeon\npill\npilot\npink\npioneer\npipe\npistol\npitch\npizza\nplace\nplanet\nplastic\nplate\nplay\nplease\npledge\npluck\nplug\nplunge\npoem\npoet\npoint\npolar\npole\npolice\npond\npony\npool\npopular\nportion\nposition\npossible\npost\npotato\npottery\npoverty\npowder\npower\npractice\npraise\npredict\nprefer\nprepare\npresent\npretty\nprevent\nprice\npride\nprimary\nprint\npriority\nprison\nprivate\nprize\nproblem\nprocess\nproduce\nprofit\nprogram\nproject\npromote\nproof\nproperty\nprosper\nprotect\nproud\nprovide\npublic\npudding\npull\npulp\npulse\npumpkin\npunch\npupil\npuppy\npurchase\npurity\npurpose\npurse\npush\nput\npuzzle\npyramid\nquality\nquantum\nquarter\nquestion\nquick\nquit\nquiz\nquote\nrabbit\nraccoon\nrace\nrack\nradar\nradio\nrail\nrain\nraise\nrally\nramp\nranch\nrandom\nrange\nrapid\nrare\nrate\nrather\nraven\nraw\nrazor\nready\nreal\nreason\nrebel\nrebuild\nrecall\nreceive\nrecipe\nrecord\nrecycle\nreduce\nreflect\nreform\nrefuse\nregion\nregret\nregular\nreject\nrelax\nrelease\nrelief\nrely\nremain\nremember\nremind\nremove\nrender\nrenew\nrent\nreopen\nrepair\nrepeat\nreplace\nreport\nrequire\nrescue\nresemble\nresist\nresource\nresponse\nresult\nretire\nretreat\nreturn\nreunion\nreveal\nreview\nreward\nrhythm\nrib\nribbon\nrice\nrich\nride\nridge\nrifle\nright\nrigid\nring\nriot\nripple\nrisk\nritual\nrival\nriver\nroad\nroast\nrobot\nrobust\nrocket\nromance\nroof\nrookie\nroom\nrose\nrotate\nrough\nround\nroute\nroyal\nrubber\nrude\nrug\nrule\nrun\nrunway\nrural\nsad\nsaddle\nsadness\nsafe\nsail\nsalad\nsalmon\nsalon\nsalt\nsalute\nsame\nsample\nsand\nsatisfy\nsatoshi\nsauce\nsausage\nsave\nsay\nscale\nscan\nscare\nscatter\nscene\nscheme\nschool\nscience\nscissors\nscorpion\nscout\nscrap\nscreen\nscript\nscrub\nsea\nsearch\nseason\nseat\nsecond\nsecret\nsection\nsecurity\nseed\nseek\nsegment\nselect\nsell\nseminar\nsenior\nsense\nsentence\nseries\nservice\nsession\nsettle\nsetup\nseven\nshadow\nshaft\nshallow\nshare\nshed\nshell\nsheriff\nshield\nshift\nshine\nship\nshiver\nshock\nshoe\nshoot\nshop\nshort\nshoulder\nshove\nshrimp\nshrug\nshuffle\nshy\nsibling\nsick\nside\nsiege\nsight\nsign\nsilent\nsilk\nsilly\nsilver\nsimilar\nsimple\nsince\nsing\nsiren\nsister\nsituate\nsix\nsize\nskate\nsketch\nski\nskill\nskin\nskirt\nskull\nslab\nslam\nsleep\nslender\nslice\nslide\nslight\nslim\nslogan\nslot\nslow\nslush\nsmall\nsmart\nsmile\nsmoke\nsmooth\nsnack\nsnake\nsnap\nsniff\nsnow\nsoap\nsoccer\nsocial\nsock\nsoda\nsoft\nsolar\nsoldier\nsolid\nsolution\nsolve\nsomeone\nsong\nsoon\nsorry\nsort\nsoul\nsound\nsoup\nsource\nsouth\nspace\nspare\nspatial\nspawn\nspeak\nspecial\nspeed\nspell\nspend\nsphere\nspice\nspider\nspike\nspin\nspirit\nsplit\nspoil\nsponsor\nspoon\nsport\nspot\nspray\nspread\nspring\nspy\nsquare\nsqueeze\nsquirrel\nstable\nstadium\nstaff\nstage\nstairs\nstamp\nstand\nstart\nstate\nstay\nsteak\nsteel\nstem\nstep\nstereo\nstick\nstill\nsting\nstock\nstomach\nstone\nstool\nstory\nstove\nstrategy\nstreet\nstrike\nstrong\nstruggle\nstudent\nstuff\nstumble\nstyle\nsubject\nsubmit\nsubway\nsuccess\nsuch\nsudden\nsuffer\nsugar\nsuggest\nsuit\nsummer\nsun\nsunny\nsunset\nsuper\nsupply\nsupreme\nsure\nsurface\nsurge\nsurprise\nsurround\nsurvey\nsuspect\nsustain\nswallow\nswamp\nswap\nswarm\nswear\nsweet\nswift\nswim\nswing\nswitch\nsword\nsymbol\nsymptom\nsyrup\nsystem\ntable\ntackle\ntag\ntail\ntalent\ntalk\ntank\ntape\ntarget\ntask\ntaste\ntattoo\ntaxi\nteach\nteam\ntell\nten\ntenant\ntennis\ntent\nterm\ntest\ntext\nthank\nthat\ntheme\nthen\ntheory\nthere\nthey\nthing\nthis\nthought\nthree\nthrive\nthrow\nthumb\nthunder\nticket\ntide\ntiger\ntilt\ntimber\ntime\ntiny\ntip\ntired\ntissue\ntitle\ntoast\ntobacco\ntoday\ntoddler\ntoe\ntogether\ntoilet\ntoken\ntomato\ntomorrow\ntone\ntongue\ntonight\ntool\ntooth\ntop\ntopic\ntopple\ntorch\ntornado\ntortoise\ntoss\ntotal\ntourist\ntoward\ntower\ntown\ntoy\ntrack\ntrade\ntraffic\ntragic\ntrain\ntransfer\ntrap\ntrash\ntravel\ntray\ntreat\ntree\ntrend\ntrial\ntribe\ntrick\ntrigger\ntrim\ntrip\ntrophy\ntrouble\ntruck\ntrue\ntruly\ntrumpet\ntrust\ntruth\ntry\ntube\ntuition\ntumble\ntuna\ntunnel\nturkey\nturn\nturtle\ntwelve\ntwenty\ntwice\ntwin\ntwist\ntwo\ntype\ntypical\nugly\numbrella\nunable\nunaware\nuncle\nuncover\nunder\nundo\nunfair\nunfold\nunhappy\nuniform\nunique\nunit\nuniverse\nunknown\nunlock\nuntil\nunusual\nunveil\nupdate\nupgrade\nuphold\nupon\nupper\nupset\nurban\nurge\nusage\nuse\nused\nuseful\nuseless\nusual\nutility\nvacant\nvacuum\nvague\nvalid\nvalley\nvalve\nvan\nvanish\nvapor\nvarious\nvast\nvault\nvehicle\nvelvet\nvendor\nventure\nvenue\nverb\nverify\nversion\nvery\nvessel\nveteran\nviable\nvibrant\nvicious\nvictory\nvideo\nview\nvillage\nvintage\nviolin\nvirtual\nvirus\nvisa\nvisit\nvisual\nvital\nvivid\nvocal\nvoice\nvoid\nvolcano\nvolume\nvote\nvoyage\nwage\nwagon\nwait\nwalk\nwall\nwalnut\nwant\nwarfare\nwarm\nwarrior\nwash\nwasp\nwaste\nwater\nwave\nway\nwealth\nweapon\nwear\nweasel\nweather\nweb\nwedding\nweekend\nweird\nwelcome\nwest\nwet\nwhale\nwhat\nwheat\nwheel\nwhen\nwhere\nwhip\nwhisper\nwide\nwidth\nwife\nwild\nwill\nwin\nwindow\nwine\nwing\nwink\nwinner\nwinter\nwire\nwisdom\nwise\nwish\nwitness\nwolf\nwoman\nwonder\nwood\nwool\nword\nwork\nworld\nworry\nworth\nwrap\nwreck\nwrestle\nwrist\nwrite\nwrong\nyard\nyear\nyellow\nyou\nyoung\nyouth\nzebra\nzero\nzone\nzoo".split("\n");class bt extends(p.vw("NanoIdGenerator")()){}const vt=a.QfV.pipe(a.T16(/^[\w-]{16}$/),a.wkx("NodeId")),xt=(e,t)=>f.sync((()=>{let n=U(le,"Symmetric key seed",e);for(let e=0;e<t.length;e++){const r=(new TextEncoder).encode(t[e]),i=new Uint8Array(r.byteLength+1);i[0]=0,i.set(r,1),n=U(le,n.slice(0,32),i)}return n.slice(32,64)}));class kt extends(p.vw("SecretBox")()){}kt.Live=w.Py(kt,kt.of({seal:(e,t)=>f.sync((()=>{const n=function(e=32){if(P.E&&"function"==typeof P.E.getRandomValues)return P.E.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}(24),r=(0,E.EY)(e,n).seal(t);return(0,c.Id)(n,r)})),open:(e,t)=>f.sync((()=>{const n=t.subarray(0,24),r=t.subarray(24);return(0,E.EY)(e,n).open(r)}))}));const St=860934419999,Ot=a.wNn.pipe(a.MM$(St),a.XeB(258280326e4),a.wkx("Millis")),Wt=s.k9(Ot)(86093442e4),It=a.wNn.pipe(a.TqQ(0,65535),a.wkx("Counter")),qt=s.k9(It)(0),Tt=e=>[new Date(e.millis).toISOString(),e.counter.toString(16).toUpperCase().padStart(4,"0"),e.node].join("-"),Et=e=>{const t=e.split("-");return{millis:Date.parse(t.slice(0,3).join("-")).valueOf(),counter:parseInt(t[3],16),node:t[4]}},Ct=s.k9(vt)("0000000000000000"),At=(e=Wt)=>({millis:e,counter:qt,node:Ct}),Dt=bt.pipe(f.flatMap((({nodeId:e})=>e)),f.map((e=>({millis:Wt,counter:qt,node:e}))));class Pt extends(p.vw("Time")()){}Pt.Live=w.Py(Pt,{now:f.suspend((()=>a.D4M(Ot)(Date.now()))).pipe(f.catchTag("ParseError",(()=>f.fail({_tag:"TimestampTimeOutOfRangeError"}))))});const Lt=e=>f.gen((function*(){const t=yield*Pt,n=yield*k,r=yield*t.now,i=Math.max(r,...e);return i-r>n.maxDrift&&(yield*f.fail({_tag:"TimestampDriftError",now:r,next:i})),i})),Bt=e=>(0,m.Fs)(q.GV(e),a.EGw(It),I.qE((()=>({_tag:"TimestampCounterOverflowError"})))),Mt=s.k9(It)(0),Ft=Object.create(null),Rt=(e,t)=>(e||0)^t,Ut=(e,t,n)=>{if(0===t.length)return e;const r=t[0],i=e[r]||{};return{...e,[r]:{...i,...Ut(i,t.slice(1),n),hash:Rt(i.hash,n)}}},jt=(e,t)=>{const n=(r=t.millis,Math.floor(r/1e3/60).toString(3).split(""));var r;const i=((e,t=0)=>{let n,r,i,o;const s=3&e.length,a=e.length-s;n=t;const c=3432918353,d=461845907;for(o=0;o<a;)i=255&e.charCodeAt(o)|(255&e.charCodeAt(++o))<<8|(255&e.charCodeAt(++o))<<16|(255&e.charCodeAt(++o))<<24,++o,i=(65535&i)*c+(((i>>>16)*c&65535)<<16)&4294967295,i=i<<15|i>>>17,i=(65535&i)*d+(((i>>>16)*d&65535)<<16)&4294967295,n^=i,n=n<<13|n>>>19,r=5*(65535&n)+((5*(n>>>16)&65535)<<16)&4294967295,n=27492+(65535&r)+((58964+(r>>>16)&65535)<<16);switch(i=0,s){case 3:i^=(255&e.charCodeAt(o+2))<<16;case 2:i^=(255&e.charCodeAt(o+1))<<8;case 1:i^=255&e.charCodeAt(o),i=(65535&i)*c+(((i>>>16)*c&65535)<<16)&4294967295,i=i<<15|i>>>17,i=(65535&i)*d+(((i>>>16)*d&65535)<<16)&4294967295,n^=i}return n^=e.length,n^=n>>>16,n=2246822507*(65535&n)+((2246822507*(n>>>16)&65535)<<16)&4294967295,n^=n>>>13,n=3266489909*(65535&n)+((3266489909*(n>>>16)&65535)<<16)&4294967295,n^=n>>>16,n>>>0})(Tt(t));return Ut({...e,hash:Rt(e.hash,i)},n,i)},_t=["0","1","2"],$t=e=>_t.filter((t=>t in e)),Qt=e=>JSON.stringify(e),Jt=p.Io("Owner"),Kt=e=>f.gen((function*(t){null==e&&(e=yt(Nt,128));const n=(e=>wt(e))(e),r=yield*f.map(xt(n,["Evolu","Owner Id"]),(e=>{let t="";for(let n=0;n<21;n++)t+=Yt[63&e[n]];return t})),i=yield*xt(n,["Evolu","Encryption Key"]);return{mnemonic:e,id:r,encryptionKey:i}})),Yt="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";var Vt=n(14816);const zt=p.Io("Sync"),Ht={_tag:"SyncStateInitial"};class Xt extends(p.vw("SyncFactory")()){}f.gen((function*(){const e=p.Ie().pipe(p.WQ(kt,yield*kt)),t=yield*h.L8();return zt.of({init:n=>f.logDebug(["Sync init",{owner:n}]).pipe(f.tap(h.Py(t,e.pipe(p.WQ(Jt,n))))),sync:({merkleTree:e,timestamp:n,messages:s})=>f.gen((function*(){yield*f.logDebug(["Sync request",{merkleTree:e,timestamp:n,messages:s}]);const t=yield*kt,a=yield*Jt,c=yield*k;return yield*f.forEach(s||[],(({timestamp:e,...n})=>f.map(t.seal(a.encryptionKey,Gt(n)),(t=>({timestamp:e,content:t}))))).pipe(f.map((t=>Vt.Vr.toBinary({messages:t,userId:a.id,nodeId:n.node,merkleTree:Qt(e)},tn))),f.flatMap((e=>r.bE(c.syncUrl).pipe(r.mu(e,"application/x-protobuf"),i.vd,o.sv))),f.map((e=>Vt.fZ.fromBinary(new Uint8Array(e),nn))),f.flatMap((e=>f.forEach(e.messages,(e=>f.map(t.open(a.encryptionKey,e.content),(t=>[t,e.timestamp])))).pipe(f.map(u.x1((([e,t])=>y.Tj(rn(e),(e=>({...e,timestamp:t})))))),f.map((t=>{return{messages:t,merkleTree:(n=e.merkleTree,JSON.parse(n))};var n})),f.tap((e=>f.logDebug(["Sync response",e])))))),f.catchTag("RequestError",(()=>f.fail({_tag:"SyncStateIsNotSynced",error:{_tag:"NetworkError"}}))),f.catchTag("ResponseError",(({response:{status:e}})=>402===e?f.fail({_tag:"SyncStateIsNotSynced",error:{_tag:"PaymentRequiredError"}}):f.fail({_tag:"SyncStateIsNotSynced",error:{_tag:"ServerError",status:e}}))))})).pipe((e=>f.flatMap(h.Tx(t),(t=>f.provide(e,t)))))})}));const Gt=({value:e,...t})=>(0,c.Id)(Zt,Vt.PV.toBinary({value:en(e),...t},tn)),Zt=new Uint8Array([0,1]),en=e=>{switch(typeof e){case"string":return{oneofKind:"stringValue",stringValue:e};case"number":return{oneofKind:"numberValue",numberValue:s.Kc(a.jJo)(e)}}return null==e?{oneofKind:void 0}:g.mg(e)?{oneofKind:"bytesValue",bytesValue:e}:{oneofKind:"jsonValue",jsonValue:JSON.stringify(e)}},tn={writerFactory:()=>new d.f({encode:e=>(new TextEncoder).encode(e)})},nn={readerFactory:e=>new l.V(e,{decode:e=>(new TextDecoder).decode(e)})},rn=e=>{if(!on(e,Zt))return y.dv();const{value:t,...n}=Vt.PV.fromBinary(e.slice(Zt.length),nn);return y.zN({value:sn(t),...n})},on=(e,t)=>{if(t.length>e.length)return!1;for(let n=0;n<t.length;n++)if(e[n]!==t[n])return!1;return!0},sn=e=>{switch(e.oneofKind){case"numberValue":return s.k9(a.jJo)(e.numberValue);case"stringValue":return e.stringValue;case"bytesValue":return e.bytesValue;case"jsonValue":return JSON.parse(e.jsonValue);case void 0:return null;default:return(0,m.GQ)(e)}};var an=n(32706),cn=n(72572);cn.ii,cn.MG,an.QW,an.oV,an.un,an.vA,an.IU,an.U9,an.Ts,an.Yz,an.y_,an.BU,an.z3,an.Os,an.pq;const dn=an.Rm;an.tp,an.kB,an.al,an.uP,an.R8,an.I1,an.CE;var ln=n(55040),un=n(27652),pn=n(12164),hn=n(61974),fn=n(23180);pn.KX;const mn=pn.PJ,yn=hn.Jt,gn=(hn.C2,hn.Ru,fn.cH),wn=(hn.$N,fn.Y3,fn.JP,fn.Gt,hn.ni,fn.sY,hn.hZ,hn._c,hn.yo,fn.BQ,hn.lF,fn.Wz,hn.gH,fn.pu,hn.VH,pn.oD,pn.Do,(e,t)=>e.reduce(((e,t)=>{switch(t.op){case"replaceAll":return t.value;case"replaceAt":return u.HC(e,t.index,t.value)}}),t)),Nn=(e,t)=>{if(void 0===e)return[{op:"replaceAll",value:t}];if(e.length!==t.length)return[{op:"replaceAll",value:t}];const n=e.length,r=[];for(let i=0;i<n;i++){const n=e[i],o=t[i];for(const e in n)if(!bn(n[e],o[e])){r.push({op:"replaceAt",value:o,index:i});break}}return n>0&&r.length===n?[{op:"replaceAll",value:t}]:r},bn=(e,t)=>{if(e===t)return!0;if(typeof e!=typeof t)return!1;if("object"==typeof e&&null!==e&&null!==t){const n=g.mg(e),r=g.mg(t);if(n&&r){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}const i=u.cy(e),o=u.cy(t);if(i&&o){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!bn(e[n],t[n]))return!1;return!0}if(!(n||r||i||o)){const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const r of n)if(!bn(e[r],t[r]))return!1;return!0}}return!1},vn=e=>({_tag:"UnexpectedError",error:e}),xn=e=>e instanceof Error?{message:e.message,name:e.name,stack:e.stack}:e;var kn=n(96949);const Sn=p.Io("Sqlite");class On extends(p.vw("SqliteFactory")()){}On.Common=w.QZ(On,f.map(On,(e=>({createSqlite:f.logTrace("SqliteFactory createSqlite").pipe(f.zipRight(e.createSqlite),f.map((e=>({...e,exec:t=>e.exec(t).pipe(f.tap((e=>{In(e.rows)})),f.tap((e=>["begin","rollback","commit"].includes(t.sql)?f.logDebug(`SQLiteCommon ${t.sql} transaction`):f.logDebug(["SQLiteCommon exec",t,e])))),transaction:t=>n=>"shared"===t?e.transaction(t)(n):f.flatMap(Sn,(e=>f.acquireUseRelease(e.exec({sql:"begin"}),(()=>n),((t,n)=>kn.N6(n)?e.exec({sql:"rollback"}):e.exec({sql:"commit"}))))).pipe(e.transaction(t))}))))}))));const Wn=e=>null!==e&&"object"==typeof e&&!g.mg(e),In=e=>{qn(e)},qn=e=>{for(let t=0;t<e.length;++t)e[t]=Tn(e[t]);return e},Tn=e=>g.Kg(e)?En(e):Array.isArray(e)?qn(e):"object"!=typeof e||null===e||g.mg(e)?e:An(e),En=e=>{if(Cn(e))try{return Tn(JSON.parse(e))}catch(e){}return e},Cn=e=>null!=e.match(/^[[{]/),An=e=>{for(const t in e)e[t]=Tn(e[t]);return e},Dn=new RegExp(`\\b(${["alter","create","delete","drop","insert","replace","update"].join("|")})\\b`),Pn=(a.QfV.pipe(a.T16(/^[\w-]{21}$/),a.wkx("Id")),a.QfV.pipe(a.pbD((e=>!isNaN(Date.parse(e)))),a.wkx("SqliteDate"))),Ln=a.wNn.pipe(a.Whr(),a.pbD((e=>0===e||1===e)),a.wkx("SqliteBoolean"));function Bn(e){return"boolean"==typeof e?!0===e?1:0:"number"==typeof e?1===e:e instanceof Date?e.toISOString():new Date(e)}a._kM({createdAt:Pn,updatedAt:Pn,isDeleted:Ln}),a._kM;const Mn=a.QfV.pipe(a.pbD((e=>{if(!Cn(e))return!0;try{JSON.parse(e)}catch(e){return!0}return!1}),{message:()=>"a string that is not stringified JSON"}),a.wkx("String")),Fn=(Mn.pipe(a.Ru6(1e3),a.wkx("String1000")),Mn.pipe(a.BpQ(1),a.Ru6(1e3),a.wkx("NonEmptyString1000")),a.wNn.pipe(a.Whr(),a.yjt(),a.wkx("PositiveInt")),p.Io("FlushSync"));class Rn extends(p.vw("AppState")()){}class Un extends(p.vw("SyncLock")()){}class jn{constructor(){this._tag="SyncLockAlreadySyncingError"}}const _n={sql:'select "id", "mnemonic", "encryptionKey" from "evolu_owner"'},$n={sql:'create table "evolu_message" ("timestamp" blob primary key, "table" blob, "row" blob, "column" blob, "value" blob)'},Qn={sql:'create index "index_evolu_message" on "evolu_message" ("table", "row", "column", "timestamp" desc)'},Jn={sql:'create table "evolu_owner" ("id" blob, "mnemonic" blob, "encryptionKey" blob, "timestamp" blob, "merkleTree" blob)'},Kn={sql:'insert into "evolu_owner" ("id", "mnemonic", "encryptionKey", "timestamp", "merkleTree") values (?, ?, ?, ?, ?)'},Yn={sql:'select "timestamp", "merkleTree" from "evolu_owner"'},Vn={sql:'select "timestamp" from "evolu_message" where "table" = ? and "row" = ? and "column" = ? order by "timestamp" desc limit ?'},zn={sql:'insert into "evolu_message" ("timestamp", "table", "row", "column", "value") values (?, ?, ?, ?, ?) on conflict do nothing'},Hn={sql:'update "evolu_owner" set "merkleTree" = ?, "timestamp" = ?'},Xn={sql:'select * from "evolu_message" where "timestamp" >= ? order by "timestamp"'};a._kM({name:a.QfV,sql:a.QfV});class Gn extends(p.vw("DbFactory")()){}const Zn=f.gen((function*(){const{createSqlite:e}=yield*On,{createSync:t}=yield*Xt,n=p.Ie().pipe(p.WQ(bt,yield*bt),p.WQ(Pt,yield*Pt),p.WQ(Un,yield*Un)),r=yield*h.L8(),i=e=>t=>f.flatMap(h.Tx(r),(n=>f.flatMap(Sn,(n=>n.transaction(e.transaction)(t))).pipe(f.provide(n)))),o=yield*mn(new Map);return{init:(i,o,s,a,c,d)=>f.gen((function*(){yield*f.logDebug(["Db init",{schema:i}]);const l=yield*e,u=p.WQ(n,Sn,l),m=yield*rr.pipe(f.tap(ir(i)),f.flatMap((e=>e.tables.map((e=>e.name)).includes("evolu_owner")?sr:ar(d).pipe(f.tap(cr(o))))),l.transaction("exclusive"),f.provide(u)),y=yield*t.pipe(f.provide(n));return yield*y.init(m),h.dz(r,f.succeed(u.pipe(p.WQ(Jt,m),p.WQ(zt,y),p.WQ(er,{onError:s,onSyncStateChange:a,onReceive:c})))),m})),loadQueries:e=>f.logDebug(["Db loadQueries",{queries:e}]).pipe(f.zipRight(tr(e,o)),i({transaction:"shared"})),mutate:(e,t)=>f.gen((function*(){yield*f.logDebug(["Db mutate",{mutations:e,queriesToRefresh:t}]);const n=yield*Pt,r=yield*Sn,[i,s]=u.jB(e,(e=>e.table.startsWith("_")));for(const e of s)if(lr(e).some((({column:e,value:t})=>"isDeleted"===e&&1===t)))yield*r.exec({sql:`delete from "${e.table}" where "id" = ?;`,parameters:[e.id]});else{const t=lr(e);for(const e of t){const r=yield*n.now;yield*pr(e,t,r)}}return i.length>0&&(yield*f.tap(cr(i),gr)),yield*tr(t,o)})).pipe(i({transaction:"exclusive"})),resetOwner:()=>f.logTrace("Db resetOwner").pipe(f.tap(yr),i({transaction:"last"})),restoreOwner:(e,t)=>f.logTrace("Db restoreOwner").pipe(f.tap(yr),f.tap(f.flatMap(rr,ir(e))),f.tap(ar(t)),i({transaction:"last"})),ensureSchema:e=>rr.pipe(f.flatMap(ir(e)),i({transaction:"exclusive"})),sync:e=>f.logDebug(["Db sync",{queriesToRefresh:e}]).pipe(f.zipRight(gr()),f.zipRight(tr(e,o)),i({transaction:"shared"})),exportDatabase:()=>f.logTrace("Db exportDatabase").pipe(f.zipRight(Sn),f.flatMap((e=>e.export())),i({transaction:"exclusive"}))}})),er=p.Io("Callbacks"),tr=(e,t)=>f.gen((function*(){const n=yield*Sn,r=yield*gn(t,(t=>f.map(f.forEach(e,(e=>{const t=br(e);return n.exec(t).pipe(f.tap(nr(t)),f.map((({rows:t})=>[e,t])))})),(e=>new Map([...t,...e]))))),i=yield*yn(t);return e.map((e=>({query:e,patches:Nn(r.get(e),i.get(e)||[])})))})),nr=e=>e.options?.logExplainQueryPlan?Sn.pipe(f.flatMap((t=>t.exec({...e,sql:`EXPLAIN QUERY PLAN ${e.sql}`}))),f.tap(dn("ExplainQueryPlan",e)),f.tap((({rows:e})=>dn((e=>e.map((t=>{let n=t.parent,r=0;for(;;){const t=e.find((e=>e.id===n));if(!t)break;n=t.parent,r++}return`${"  ".repeat(r)}${t.detail}`})).join("\n"))(e)))),f.map(m.Yi)):f.void,rr=f.gen((function*(e){yield*f.logTrace("Db getSchema");const t=yield*Sn;return{tables:yield*f.map(t.exec({sql:"\nselect\n  sqlite_master.name as tableName,\n  table_info.name as columnName\nfrom\n  sqlite_master\n  join pragma_table_info(sqlite_master.name) as table_info\n    ".trim()}),(({rows:e})=>{const t=new Map;return e.forEach((e=>{const{tableName:n,columnName:r}=e;t.has(n)||t.set(n,[]),t.get(n)?.push(r)})),globalThis.Array.from(t,(([e,t])=>({name:e,columns:t})))})),indexes:yield*f.map(t.exec({sql:"\nselect\n  name, sql\nfrom\n  sqlite_master\nwhere\n  type='index' and\n  name not like 'sqlite_%' and\n  name not like 'index_evolu_%'\n".trim()}),(e=>u.Tj(e.rows,(e=>({name:e.name,sql:e.sql.replace("CREATE INDEX","create index")})))))}})),ir=e=>t=>f.gen((function*(){yield*f.logTrace("Db ensureSchema");const n=[];if(e.tables.forEach((e=>{const r=t.tables.find((t=>t.name===e.name));r?u.Mo(T.rs)(e.columns,r.columns).forEach((t=>{n.push(`alter table "${e.name}" add column "${t}" blob;`)})):n.push(`\n  create table ${e.name} (\n    "id" text primary key,\n    ${e.columns.filter((e=>"id"!==e)).map((e=>`"${e}" blob`)).join(", ")}\n  );`.trim())})),u.Mo(or)(t.indexes,u.kP(or)(t.indexes,e.indexes)).forEach((e=>{n.push(`drop index "${e.name}";`)})),u.Mo(or)(e.indexes,t.indexes).forEach((e=>{n.push(`${e.sql};`)})),n.length>0){const e=yield*Sn;yield*e.exec({sql:n.join("\n")})}})),or=(e,t)=>e.name===t.name&&e.sql===t.sql,sr=f.logTrace("Db readOwner").pipe(f.zipRight(Sn),f.flatMap((e=>e.exec(_n))),f.map((({rows:[e]})=>({id:e.id,mnemonic:e.mnemonic,encryptionKey:e.encryptionKey})))),ar=e=>f.logTrace("Db createOwner").pipe(f.zipRight(f.all([Kt(e),Sn,Dt])),f.tap((([e,t,n])=>f.all([t.exec($n),t.exec(Qn),t.exec(Jn),t.exec({...Kn,parameters:[e.id,e.mnemonic,e.encryptionKey,Tt(n),Qt(Ft)]})]))),f.map((([e])=>e))),cr=e=>f.gen((function*(t){const{timestamp:n,merkleTree:r}=yield*dr,[i,o]=yield*f.mapAccum(e.flatMap(lr),n,((e,t)=>f.map((e=>f.gen((function*(){const t=yield*Lt([e.millis]),n=t===e.millis?yield*Bt(e.counter):Mt;return{...e,millis:t,counter:n}})))(e),(e=>[e,{...t,timestamp:Tt(e)}])))),s=yield*ur(r,o);return yield*mr(i,s),o})),dr=Sn.pipe(f.flatMap((e=>e.exec(Yn))),f.map((({rows:[{timestamp:e,merkleTree:t}]})=>({timestamp:Et(e),merkleTree:t})))),lr=e=>(0,m.Fs)(Object.entries(e.values),u.x1((([t,n])=>void 0===n||e.isInsert&&null==n?y.dv():y.zN([t,n]))),u.Tj((([t,n])=>({table:e.table,row:e.id,column:t,value:"boolean"==typeof n||n instanceof Date?Bn(n):n})))),ur=(e,t)=>f.gen((function*(){const n=yield*Sn;for(const r of t){const i=Et(r.timestamp),o=yield*f.map(n.exec({...Vn,parameters:[r.table,r.row,r.column,1]}),(({rows:e})=>e.length>0?e[0].timestamp:null));if((null==o||o<r.timestamp)&&(yield*pr(r,t,i.millis)),null==o||o!==r.timestamp){const{changes:t}=yield*n.exec({...zn,parameters:[r.timestamp,r.table,r.row,r.column,r.value]});1===t&&(e=jt(e,i))}}return e})),pr=(e,t,n)=>Sn.pipe(f.map((t=>{const r=Bn(new Date(n));return t.exec({sql:`\n    insert into\n      "${e.table}" ("id", "${e.column}", "createdAt", "updatedAt")\n    values\n      (?, ?, ?, ?)\n    on conflict do update set\n      "${e.column}" = ?,\n      "updatedAt" = ?\n        `.trim(),parameters:[e.row,e.value,r,r,e.value,r]})})),f.flatMap((e=>f.catchSomeDefect(e,(n=>s.is(hr)(n)?y.zN(fr(t).pipe(f.zipRight(e))):y.dv()))))),hr=a._kM({message:a.gPz(a.QfV.pipe(a.mKk("no such table")),a.QfV.pipe(a.mKk("no such column")),a.QfV.pipe(a.mKk("has no column")))}),fr=e=>f.gen((function*(){const t=new Map;e.forEach((e=>{const n=t.get(e.table);null!=n?n.columns.includes(e.column)||t.set(e.table,{name:e.table,columns:n.columns.concat(e.column)}):t.set(e.table,{name:e.table,columns:[e.column,"createdAt","updatedAt"]})}));const n=u.Ts(t.values());yield*f.flatMap(rr,ir({tables:n,indexes:[]}))})),mr=(e,t)=>f.flatMap(Sn,(n=>n.exec({...Hn,parameters:[Qt(t),Tt(e)]}))),yr=f.gen((function*(){yield*f.logTrace("Db dropAllTables");const e=yield*Sn,t=yield*rr;yield*f.forEach(t.tables,(t=>e.exec({sql:`drop table "${t.name}"`})))})),gr=(e=[])=>Un.pipe(f.flatMap((e=>e.tryAcquire)),f.matchEffect({onFailure:()=>f.void,onSuccess:()=>wr(e)}),f.scoped,f.forkDaemon),wr=(e=[])=>f.gen((function*(t){const n=yield*Sn,r=yield*zt,i=yield*er,o=yield*Pt,s=yield*dr.pipe(n.transaction("shared"),f.map((t=>({...t,messages:e}))),f.flatMap(ln.L8));i.onSyncStateChange({_tag:"SyncStateIsSyncing"}),yield*ln.Jt(s).pipe(f.flatMap(r.sync),f.flatMap(Nr),f.repeat({schedule:un.t5(50),until:y.YW({onNone:()=>f.gen((function*(){return i.onSyncStateChange({_tag:"SyncStateIsSynced",time:yield*o.now}),!0})),onSome:e=>f.gen((function*(){return yield*ln.hZ(s,e),!1}))})}),f.catchAllDefect((e=>f.fail(vn(xn(e))))),f.catchTag("SyncStateIsNotSynced",(e=>f.succeed(i.onSyncStateChange(e)))),f.catchAll((e=>f.succeed(i.onError(e)))))})),Nr=e=>f.flatMap(Sn,(t=>f.gen((function*(n){const{onReceive:r}=yield*er,i=yield*dr,o=yield*f.reduce(e.messages,i.timestamp,((e,t)=>(({local:e,remote:t})=>f.gen((function*(n){e.node===t.node&&(yield*f.fail({_tag:"TimestampDuplicateNodeError",node:e.node}));const r=yield*Lt([e.millis,t.millis]),i=yield*r===e.millis&&r===t.millis?Bt(Math.max(e.counter,t.counter)):r===e.millis?Bt(e.counter):r===t.millis?Bt(t.counter):I.pG(Mt);return{...e,millis:r,counter:i}})))({local:e,remote:Et(t.timestamp)}))),s=yield*ur(i.merkleTree,e.messages);return e.messages.length>0&&(yield*mr(o,s),r()),yield*((e,t)=>{if(e.hash===t.hash)return y.dv();let n=e,r=t,i=[];for(;;){const e=u.w8($t(n).concat($t(r)),T.rs);let t=null;for(let i=0;i<e.length;i++){const o=e[i],s=n[o],a=r[o];if(!s||!a)break;if(s.hash!==a.hash){t=o;break}}if(!t)return y.zN(0===(o=i).length?Wt:1e3*parseInt(o.join("").padEnd(16,"0"),3)*60);i=[...i,t],n=n[t]||Ft,r=r[t]||Ft}var o;return y.dv()})(e.merkleTree,s).pipe(f.flatMap((e=>t.exec({...Xn,parameters:[Tt(At(e))]}))),f.map((({rows:e})=>({messages:e,merkleTree:s,timestamp:o}))),f.option)})).pipe(t.transaction("exclusive")))),br=e=>{const t=JSON.parse(e);return{...t,parameters:t.parameters.map((e=>u.cy(e)?new Uint8Array(e):"object"==typeof e&&null!=e?e.json:e))}},vr=[],xr=()=>vr,kr=new WeakMap,Sr=e=>{let t=kr.get(e);return null==t&&(t={rows:e,row:e[0]},kr.set(e,t)),t};let Or=e=>crypto.getRandomValues(new Uint8Array(e)),Wr=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),"");const Ir=((e,t)=>{const n=((e,t=21)=>((e,t,n)=>{let r=(2<<Math.log(e.length-1)/Math.LN2)-1,i=-~(1.6*r*t/e.length);return(o=t)=>{let s="";for(;;){let t=n(i),a=i;for(;a--;)if(s+=e[t[a]&r]||"",s.length===o)return s}}})(e,t,Or))("0123456789abcdef",16);return w.Py(bt,bt.of({nanoid:f.sync((()=>t())),nodeId:f.sync((()=>n())),rowId:f.sync((()=>t()))}))})(0,Wr);var qr=n(28789),Tr=n(67316);function Er(e){return void 0===e||void 0===e}function Cr(e){return"string"==typeof e}function Ar(e){return"number"==typeof e}function Dr(e){return"boolean"==typeof e}function Pr(e){return null===e}function Lr(e){return"bigint"==typeof e}function Br(e){return"function"==typeof e}function Mr(e){return"object"==typeof e&&null!==e}function Fr(e){return Object.freeze(e)}function Rr(e){return Ur(e)?e:[e]}function Ur(e){return Array.isArray(e)}function jr(e){return e}const _r=Fr({is:e=>"AlterTableNode"===e.kind,create:e=>Fr({kind:"AlterTableNode",table:e}),cloneWithTableProps:(e,t)=>Fr({...e,...t}),cloneWithColumnAlteration:(e,t)=>Fr({...e,columnAlterations:e.columnAlterations?[...e.columnAlterations,t]:[t]})}),$r=Fr({is:e=>"IdentifierNode"===e.kind,create:e=>Fr({kind:"IdentifierNode",name:e})}),Qr=Fr({is:e=>"CreateIndexNode"===e.kind,create:e=>Fr({kind:"CreateIndexNode",name:$r.create(e)}),cloneWith:(e,t)=>Fr({...e,...t}),cloneWithColumns:(e,t)=>Fr({...e,columns:[...e.columns||[],...t]})}),Jr=Fr({is:e=>"CreateSchemaNode"===e.kind,create:(e,t)=>Fr({kind:"CreateSchemaNode",schema:$r.create(e),...t}),cloneWith:(e,t)=>Fr({...e,...t})}),Kr=["preserve rows","delete rows","drop"],Yr=Fr({is:e=>"CreateTableNode"===e.kind,create:e=>Fr({kind:"CreateTableNode",table:e,columns:Fr([])}),cloneWithColumn:(e,t)=>Fr({...e,columns:Fr([...e.columns,t])}),cloneWithConstraint:(e,t)=>Fr({...e,constraints:e.constraints?Fr([...e.constraints,t]):Fr([t])}),cloneWithFrontModifier:(e,t)=>Fr({...e,frontModifiers:e.frontModifiers?Fr([...e.frontModifiers,t]):Fr([t])}),cloneWithEndModifier:(e,t)=>Fr({...e,endModifiers:e.endModifiers?Fr([...e.endModifiers,t]):Fr([t])}),cloneWith:(e,t)=>Fr({...e,...t})}),Vr=Fr({is:e=>"SchemableIdentifierNode"===e.kind,create:e=>Fr({kind:"SchemableIdentifierNode",identifier:$r.create(e)}),createWithSchema:(e,t)=>Fr({kind:"SchemableIdentifierNode",schema:$r.create(e),identifier:$r.create(t)})}),zr=Fr({is:e=>"DropIndexNode"===e.kind,create:(e,t)=>Fr({kind:"DropIndexNode",name:Vr.create(e),...t}),cloneWith:(e,t)=>Fr({...e,...t})}),Hr=Fr({is:e=>"DropSchemaNode"===e.kind,create:(e,t)=>Fr({kind:"DropSchemaNode",schema:$r.create(e),...t}),cloneWith:(e,t)=>Fr({...e,...t})}),Xr=Fr({is:e=>"DropTableNode"===e.kind,create:(e,t)=>Fr({kind:"DropTableNode",table:e,...t}),cloneWith:(e,t)=>Fr({...e,...t})}),Gr=Fr({is:e=>"AliasNode"===e.kind,create:(e,t)=>Fr({kind:"AliasNode",node:e,alias:t})}),Zr=Fr({is:e=>"TableNode"===e.kind,create:e=>Fr({kind:"TableNode",table:Vr.create(e)}),createWithSchema:(e,t)=>Fr({kind:"TableNode",table:Vr.createWithSchema(e,t)})});function ei(e){return Mr(e)&&Br(e.toOperationNode)}const ti=Fr({is:e=>"SelectModifierNode"===e.kind,create:(e,t)=>Fr({kind:"SelectModifierNode",modifier:e,of:t}),createWithExpression:e=>Fr({kind:"SelectModifierNode",rawModifier:e})}),ni=Fr({is:e=>"AndNode"===e.kind,create:(e,t)=>Fr({kind:"AndNode",left:e,right:t})}),ri=Fr({is:e=>"OrNode"===e.kind,create:(e,t)=>Fr({kind:"OrNode",left:e,right:t})}),ii=Fr({is:e=>"OnNode"===e.kind,create:e=>Fr({kind:"OnNode",on:e}),cloneWithOperation:(e,t,n)=>Fr({...e,on:"And"===t?ni.create(e.on,n):ri.create(e.on,n)})}),oi=Fr({is:e=>"JoinNode"===e.kind,create:(e,t)=>Fr({kind:"JoinNode",joinType:e,table:t,on:void 0}),createWithOn:(e,t,n)=>Fr({kind:"JoinNode",joinType:e,table:t,on:ii.create(n)}),cloneWithOn:(e,t)=>Fr({...e,on:e.on?ii.cloneWithOperation(e.on,"And",t):ii.create(t)})}),si=Fr({is:e=>"BinaryOperationNode"===e.kind,create:(e,t,n)=>Fr({kind:"BinaryOperationNode",leftOperand:e,operator:t,rightOperand:n})}),ai=["->","->>"],ci=[...["=","==","!=","<>",">",">=","<","<=","in","not in","is","is not","like","not like","match","ilike","not ilike","@>","<@","&&","?","?&","!<","!>","<=>","!~","~","~*","!~*","@@","@@@","!!","<->","regexp","is distinct from","is not distinct from","+","-","*","/","%","^","&","|","#","<<",">>","&&","||"],...ai,"not","-","exists","not exists","between","between symmetric"],di=Fr({is:e=>"OperatorNode"===e.kind,create:e=>Fr({kind:"OperatorNode",operator:e})});function li(e){return Cr(e)&&ai.includes(e)}const ui=Fr({is:e=>"ColumnNode"===e.kind,create:e=>Fr({kind:"ColumnNode",column:$r.create(e)})}),pi=Fr({is:e=>"SelectAllNode"===e.kind,create:()=>Fr({kind:"SelectAllNode"})}),hi=Fr({is:e=>"ReferenceNode"===e.kind,create:(e,t)=>Fr({kind:"ReferenceNode",table:t,column:e}),createSelectAll:e=>Fr({kind:"ReferenceNode",table:e,column:pi.create()})});class fi{#e;get dynamicReference(){return this.#e}get refType(){}constructor(e){this.#e=e}toOperationNode(){return Oi(this.#e)}}function mi(e){return Mr(e)&&ei(e)&&Cr(e.dynamicReference)}const yi=Fr({is:e=>"OrderByItemNode"===e.kind,create:(e,t)=>Fr({kind:"OrderByItemNode",orderBy:e,direction:t})}),gi=Fr({is:e=>"RawNode"===e.kind,create:(e,t)=>Fr({kind:"RawNode",sqlFragments:Fr(e),parameters:Fr(t)}),createWithSql:e=>gi.create([e],[]),createWithChild:e=>gi.create(["",""],[e]),createWithChildren:e=>gi.create(new Array(e.length+1).fill(""),e)});function wi(e){return"asc"===e||"desc"===e}function Ni(e){if(2===e.length)return[bi(e[0],e[1])];if(1===e.length){const[t]=e;return Array.isArray(t)?t.map((e=>bi(e))):[bi(t)]}throw new Error(`Invalid number of arguments at order by! expected 1-2, received ${e.length}`)}function bi(e,t){const n=function(e){if(ra(e))return ta(e);if(mi(e))return e.toOperationNode();const[t,n]=e.split(" ");if(n){if(!wi(n))throw new Error(`Invalid order by direction: ${n}`);return yi.create(qi(t),vi(n))}return qi(e)}(e);if(yi.is(n)){if(t)throw new Error("Cannot specify direction twice!");return n}return yi.create(n,vi(t))}function vi(e){if(e)return"asc"===e||"desc"===e?gi.createWithSql(e):e.toOperationNode()}const xi=Fr({is:e=>"JSONReferenceNode"===e.kind,create:(e,t)=>Fr({kind:"JSONReferenceNode",reference:e,traversal:t}),cloneWithTraversal:(e,t)=>Fr({...e,traversal:t})}),ki=Fr({is:e=>"JSONOperatorChainNode"===e.kind,create:e=>Fr({kind:"JSONOperatorChainNode",operator:e,values:Fr([])}),cloneWithValue:(e,t)=>Fr({...e,values:Fr([...e.values,t])})}),Si=Fr({is:e=>"JSONPathNode"===e.kind,create:e=>Fr({kind:"JSONPathNode",inOperator:e,pathLegs:Fr([])}),cloneWithLeg:(e,t)=>Fr({...e,pathLegs:Fr([...e.pathLegs,t])})});function Oi(e){return Cr(e)?qi(e):e.toOperationNode()}function Wi(e){return Ur(e)?e.map((e=>Ii(e))):[Ii(e)]}function Ii(e){return ra(e)?ta(e):Oi(e)}function qi(e){if(!e.includes("."))return hi.create(ui.create(e));const t=e.split(".").map(Ci);if(3===t.length)return function(e){const[t,n,r]=e;return hi.create(ui.create(r),Zr.createWithSchema(t,n))}(t);if(2===t.length)return function(e){const[t,n]=e;return hi.create(ui.create(n),Zr.create(t))}(t);throw new Error(`invalid column reference ${e}`)}function Ti(e){return ui.create(e)}function Ei(e){if(e.includes(" ")){const[t,n]=e.split(" ").map(Ci);if(!wi(n))throw new Error(`invalid order direction "${n}" next to "${t}"`);return Ni([t,n])[0]}return Ti(e)}function Ci(e){return e.trim()}const Ai=Fr({is:e=>"PrimitiveValueListNode"===e.kind,create:e=>Fr({kind:"PrimitiveValueListNode",values:Fr([...e])})}),Di=Fr({is:e=>"ValueListNode"===e.kind,create:e=>Fr({kind:"ValueListNode",values:Fr(e)})}),Pi=Fr({is:e=>"ValueNode"===e.kind,create:e=>Fr({kind:"ValueNode",value:e}),createImmediate:e=>Fr({kind:"ValueNode",value:e,immediate:!0})});function Li(e){return ra(e)?ta(e):Pi.create(e)}function Bi(e){return Ar(e)||Dr(e)||Pr(e)}function Mi(e){if(!Bi(e))throw new Error(`unsafe immediate value ${JSON.stringify(e)}`);return Pi.createImmediate(e)}const Fi=Fr({is:e=>"ParensNode"===e.kind,create:e=>Fr({kind:"ParensNode",node:e})});function Ri(e){if(3===e.length)return Ui(e[0],e[1],e[2]);if(1===e.length)return Li(e[0]);throw new Error(`invalid arguments: ${JSON.stringify(e)}`)}function Ui(e,t,n){return function(e){return"is"===e||"is not"===e}(t)&&Qi(n)?si.create(Ii(e),Ji(t),Pi.createImmediate(n)):si.create(Ii(e),Ji(t),Ur(r=n)?function(e){return e.some(ra)?Di.create(e.map((e=>Li(e)))):Ai.create(e)}(r):Li(r));var r}function ji(e,t,n){return si.create(Ii(e),Ji(t),Ii(n))}function _i(e,t){return $i(Object.entries(e).filter((([,e])=>!Er(e))).map((([e,t])=>Ui(e,Qi(t)?"is":"=",t))),t)}function $i(e,t,n=!0){const r="and"===t?ni.create:ri.create;if(0===e.length)return si.create(Pi.createImmediate(1),di.create("="),Pi.createImmediate("and"===t?1:0));let i=Ki(e[0]);for(let t=1;t<e.length;++t)i=r(i,Ki(e[t]));return e.length>1&&n?Fi.create(i):i}function Qi(e){return Pr(e)||Dr(e)}function Ji(e){if(Cr(e)&&ci.includes(e))return di.create(e);if(ei(e))return e.toOperationNode();throw new Error(`invalid operator ${JSON.stringify(e)}`)}function Ki(e){return ei(e)?e.toOperationNode():e}const Yi=Fr({is:e=>"OrderByNode"===e.kind,create:e=>Fr({kind:"OrderByNode",items:Fr([...e])}),cloneWithItems:(e,t)=>Fr({...e,items:Fr([...e.items,...t])})}),Vi=Fr({is:e=>"PartitionByNode"===e.kind,create:e=>Fr({kind:"PartitionByNode",items:Fr(e)}),cloneWithItems:(e,t)=>Fr({...e,items:Fr([...e.items,...t])})}),zi=Fr({is:e=>"OverNode"===e.kind,create:()=>Fr({kind:"OverNode"}),cloneWithOrderByItems:(e,t)=>Fr({...e,orderBy:e.orderBy?Yi.cloneWithItems(e.orderBy,t):Yi.create(t)}),cloneWithPartitionByItems:(e,t)=>Fr({...e,partitionBy:e.partitionBy?Vi.cloneWithItems(e.partitionBy,t):Vi.create(t)})});function Hi(e,t){Object.defineProperties(e.prototype,{then:{enumerable:!1,value:()=>{throw new Error(t)}}})}class Xi{#t;constructor(e){this.#t=Fr(e)}on(...e){return new Xi({...this.#t,joinNode:oi.cloneWithOn(this.#t.joinNode,Ri(e))})}onRef(e,t,n){return new Xi({...this.#t,joinNode:oi.cloneWithOn(this.#t.joinNode,ji(e,t,n))})}onTrue(){return new Xi({...this.#t,joinNode:oi.cloneWithOn(this.#t.joinNode,gi.createWithSql("true"))})}$call(e){return e(this)}toOperationNode(){return this.#t.joinNode}}Hi(Xi,"don't await JoinBuilder instances. They are never executed directly and are always just a part of a query.");const Gi=Fr({is:e=>"PartitionByItemNode"===e.kind,create:e=>Fr({kind:"PartitionByItemNode",partitionBy:e})});function Zi(e){return Wi(e).map(Gi.create)}class eo{#t;constructor(e){this.#t=Fr(e)}orderBy(e,t){return new eo({overNode:zi.cloneWithOrderByItems(this.#t.overNode,Ni([e,t]))})}partitionBy(e){return new eo({overNode:zi.cloneWithPartitionByItems(this.#t.overNode,Zi(e))})}$call(e){return e(this)}toOperationNode(){return this.#t.overNode}}Hi(eo,"don't await OverBuilder instances. They are never executed directly and are always just a part of a query.");const to=Fr({is:e=>"SelectionNode"===e.kind,create:e=>Fr({kind:"SelectionNode",selection:e}),createSelectAll:()=>Fr({kind:"SelectionNode",selection:pi.create()}),createSelectAllFromTable:e=>Fr({kind:"SelectionNode",selection:hi.createSelectAll(e)})});function no(e){return Br(e)?no(e(ea())):Ur(e)?e.map((e=>ro(e))):[ro(e)]}function ro(e){return Cr(e)?to.create(function(e){const t=" as ";if(e.includes(t)){const[n,r]=e.split(t).map(Ci);return Gr.create(qi(n),$r.create(r))}return qi(e)}(e)):mi(e)?to.create(e.toOperationNode()):to.create(na(e))}function io(e){return e?Array.isArray(e)?e.map(oo):[oo(e)]:[to.createSelectAll()]}function oo(e){if(Cr(e))return to.createSelectAllFromTable(aa(e));throw new Error(`invalid value selectAll expression: ${JSON.stringify(e)}`)}const so=Fr({is:e=>"ValuesNode"===e.kind,create:e=>Fr({kind:"ValuesNode",values:Fr(e)})}),ao=Fr({is:e=>"DefaultInsertValueNode"===e.kind,create:()=>Fr({kind:"DefaultInsertValueNode"})});function co(e){const t=Br(e)?e(ea()):e;return function(e){const t=function(e){const t=new Map;for(const n of e){const e=Object.keys(n);for(const r of e)t.has(r)||void 0===n[r]||t.set(r,t.size)}return t}(e);return[Fr([...t.keys()].map(ui.create)),so.create(e.map((e=>function(e,t){const n=Object.keys(e),r=Array.from({length:t.size});let i=!1;for(const o of n){const n=t.get(o);if(Er(n))continue;const s=e[o];(Er(s)||ra(s))&&(i=!0),r[n]=s}if(n.length<t.size||i){const e=ao.create();return Di.create(r.map((t=>Er(t)?e:Li(t))))}return Ai.create(r)}(e,t))))]}(Ur(t)?t:Fr([t]))}const lo=Fr({is:e=>"InsertQueryNode"===e.kind,create:(e,t,n)=>Fr({kind:"InsertQueryNode",into:e,...t&&{with:t},replace:n}),createWithoutInto:()=>Fr({kind:"InsertQueryNode"}),cloneWith:(e,t)=>Fr({...e,...t})}),uo=Fr({is:e=>"FromNode"===e.kind,create:e=>Fr({kind:"FromNode",froms:Fr(e)}),cloneWithFroms:(e,t)=>Fr({...e,froms:Fr([...e.froms,...t])})}),po=Fr({is:e=>"GroupByNode"===e.kind,create:e=>Fr({kind:"GroupByNode",items:Fr(e)}),cloneWithItems:(e,t)=>Fr({...e,items:Fr([...e.items,...t])})}),ho=Fr({is:e=>"HavingNode"===e.kind,create:e=>Fr({kind:"HavingNode",having:e}),cloneWithOperation:(e,t,n)=>Fr({...e,having:"And"===t?ni.create(e.having,n):ri.create(e.having,n)})}),fo=Fr({is:e=>"SelectQueryNode"===e.kind,create:e=>Fr({kind:"SelectQueryNode",...e&&{with:e}}),createFrom:(e,t)=>Fr({kind:"SelectQueryNode",from:uo.create(e),...t&&{with:t}}),cloneWithSelections:(e,t)=>Fr({...e,selections:e.selections?Fr([...e.selections,...t]):Fr(t)}),cloneWithDistinctOn:(e,t)=>Fr({...e,distinctOn:e.distinctOn?Fr([...e.distinctOn,...t]):Fr(t)}),cloneWithFrontModifier:(e,t)=>Fr({...e,frontModifiers:e.frontModifiers?Fr([...e.frontModifiers,t]):Fr([t])}),cloneWithEndModifier:(e,t)=>Fr({...e,endModifiers:e.endModifiers?Fr([...e.endModifiers,t]):Fr([t])}),cloneWithOrderByItems:(e,t)=>Fr({...e,orderBy:e.orderBy?Yi.cloneWithItems(e.orderBy,t):Yi.create(t)}),cloneWithGroupByItems:(e,t)=>Fr({...e,groupBy:e.groupBy?po.cloneWithItems(e.groupBy,t):po.create(t)}),cloneWithLimit:(e,t)=>Fr({...e,limit:t}),cloneWithOffset:(e,t)=>Fr({...e,offset:t}),cloneWithFetch:(e,t)=>Fr({...e,fetch:t}),cloneWithHaving:(e,t)=>Fr({...e,having:e.having?ho.cloneWithOperation(e.having,"And",t):ho.create(t)}),cloneWithSetOperations:(e,t)=>Fr({...e,setOperations:e.setOperations?Fr([...e.setOperations,...t]):Fr([...t])}),cloneWithoutSelections:e=>Fr({...e,selections:[]}),cloneWithoutLimit:e=>Fr({...e,limit:void 0}),cloneWithoutOffset:e=>Fr({...e,offset:void 0}),cloneWithoutOrderBy:e=>Fr({...e,orderBy:void 0})}),mo=Fr({is:e=>"UpdateQueryNode"===e.kind,create:(e,t)=>Fr({kind:"UpdateQueryNode",table:e,...t&&{with:t}}),createWithoutTable:()=>Fr({kind:"UpdateQueryNode"}),cloneWithFromItems:(e,t)=>Fr({...e,from:e.from?uo.cloneWithFroms(e.from,t):uo.create(t)}),cloneWithUpdates:(e,t)=>Fr({...e,updates:e.updates?Fr([...e.updates,...t]):t}),cloneWithLimit:(e,t)=>Fr({...e,limit:t})}),yo=Fr({is:e=>"UsingNode"===e.kind,create:e=>Fr({kind:"UsingNode",tables:Fr(e)}),cloneWithTables:(e,t)=>Fr({...e,tables:Fr([...e.tables,...t])})}),go=Fr({is:e=>"DeleteQueryNode"===e.kind,create:(e,t)=>Fr({kind:"DeleteQueryNode",from:uo.create(e),...t&&{with:t}}),cloneWithOrderByItems:(e,t)=>Fr({...e,orderBy:e.orderBy?Yi.cloneWithItems(e.orderBy,t):Yi.create(t)}),cloneWithoutOrderBy:e=>Fr({...e,orderBy:void 0}),cloneWithLimit:(e,t)=>Fr({...e,limit:t}),cloneWithoutLimit:e=>Fr({...e,limit:void 0}),cloneWithUsing:(e,t)=>Fr({...e,using:void 0!==e.using?yo.cloneWithTables(e.using,t):yo.create(t)})}),wo=Fr({is:e=>"WhereNode"===e.kind,create:e=>Fr({kind:"WhereNode",where:e}),cloneWithOperation:(e,t,n)=>Fr({...e,where:"And"===t?ni.create(e.where,n):ri.create(e.where,n)})}),No=Fr({is:e=>"ReturningNode"===e.kind,create:e=>Fr({kind:"ReturningNode",selections:Fr(e)}),cloneWithSelections:(e,t)=>Fr({...e,selections:e.selections?Fr([...e.selections,...t]):Fr(t)})}),bo=Fr({is:e=>"ExplainNode"===e.kind,create:(e,t)=>Fr({kind:"ExplainNode",format:e,options:t})}),vo=Fr({is:e=>"WhenNode"===e.kind,create:e=>Fr({kind:"WhenNode",condition:e}),cloneWithResult:(e,t)=>Fr({...e,result:t})}),xo=Fr({is:e=>"MergeQueryNode"===e.kind,create:(e,t)=>Fr({kind:"MergeQueryNode",into:e,...t&&{with:t}}),cloneWithUsing:(e,t)=>Fr({...e,using:t}),cloneWithWhen:(e,t)=>Fr({...e,whens:e.whens?Fr([...e.whens,t]):Fr([t])}),cloneWithThen:(e,t)=>Fr({...e,whens:e.whens?Fr([...e.whens.slice(0,-1),vo.cloneWithResult(e.whens[e.whens.length-1],t)]):void 0})}),ko=Fr({is:e=>fo.is(e)||lo.is(e)||mo.is(e)||go.is(e)||xo.is(e),cloneWithWhere:(e,t)=>Fr({...e,where:e.where?wo.cloneWithOperation(e.where,"And",t):wo.create(t)}),cloneWithJoin:(e,t)=>Fr({...e,joins:e.joins?Fr([...e.joins,t]):Fr([t])}),cloneWithReturning:(e,t)=>Fr({...e,returning:e.returning?No.cloneWithSelections(e.returning,t):No.create(t)}),cloneWithoutReturning:e=>Fr({...e,returning:void 0}),cloneWithoutWhere:e=>Fr({...e,where:void 0}),cloneWithExplain:(e,t,n)=>Fr({...e,explain:bo.create(t,n?.toOperationNode())}),cloneWithTop:(e,t)=>Fr({...e,top:t})}),So=Fr({is:e=>"ColumnUpdateNode"===e.kind,create:(e,t)=>Fr({kind:"ColumnUpdateNode",column:e,value:t})});function Oo(...e){return 2===e.length?[So.create(Ii(e[0]),Li(e[1]))]:Wo(e[0])}function Wo(e){const t=Br(e)?e(ea()):e;return Object.entries(t).filter((([e,t])=>void 0!==t)).map((([e,t])=>So.create(ui.create(e),Li(t))))}const Io=Fr({is:e=>"OnDuplicateKeyNode"===e.kind,create:e=>Fr({kind:"OnDuplicateKeyNode",updates:e})});class qo{insertId;numInsertedOrUpdatedRows;constructor(e,t){this.insertId=e,this.numInsertedOrUpdatedRows=t}}class To extends Error{node;constructor(e){super("no result"),this.node=e}}function Eo(e){return Object.prototype.hasOwnProperty.call(e,"prototype")}const Co=Fr({is:e=>"OnConflictNode"===e.kind,create:()=>Fr({kind:"OnConflictNode"}),cloneWith:(e,t)=>Fr({...e,...t}),cloneWithIndexWhere:(e,t)=>Fr({...e,indexWhere:e.indexWhere?wo.cloneWithOperation(e.indexWhere,"And",t):wo.create(t)}),cloneWithIndexOrWhere:(e,t)=>Fr({...e,indexWhere:e.indexWhere?wo.cloneWithOperation(e.indexWhere,"Or",t):wo.create(t)}),cloneWithUpdateWhere:(e,t)=>Fr({...e,updateWhere:e.updateWhere?wo.cloneWithOperation(e.updateWhere,"And",t):wo.create(t)}),cloneWithUpdateOrWhere:(e,t)=>Fr({...e,updateWhere:e.updateWhere?wo.cloneWithOperation(e.updateWhere,"Or",t):wo.create(t)}),cloneWithoutIndexWhere:e=>Fr({...e,indexWhere:void 0}),cloneWithoutUpdateWhere:e=>Fr({...e,updateWhere:void 0})});class Ao{#t;constructor(e){this.#t=Fr(e)}column(e){const t=ui.create(e);return new Ao({...this.#t,onConflictNode:Co.cloneWith(this.#t.onConflictNode,{columns:this.#t.onConflictNode.columns?Fr([...this.#t.onConflictNode.columns,t]):Fr([t])})})}columns(e){const t=e.map(ui.create);return new Ao({...this.#t,onConflictNode:Co.cloneWith(this.#t.onConflictNode,{columns:this.#t.onConflictNode.columns?Fr([...this.#t.onConflictNode.columns,...t]):Fr(t)})})}constraint(e){return new Ao({...this.#t,onConflictNode:Co.cloneWith(this.#t.onConflictNode,{constraint:$r.create(e)})})}expression(e){return new Ao({...this.#t,onConflictNode:Co.cloneWith(this.#t.onConflictNode,{indexExpression:e.toOperationNode()})})}where(...e){return new Ao({...this.#t,onConflictNode:Co.cloneWithIndexWhere(this.#t.onConflictNode,Ri(e))})}whereRef(e,t,n){return new Ao({...this.#t,onConflictNode:Co.cloneWithIndexWhere(this.#t.onConflictNode,ji(e,t,n))})}clearWhere(){return new Ao({...this.#t,onConflictNode:Co.cloneWithoutIndexWhere(this.#t.onConflictNode)})}doNothing(){return new Do({...this.#t,onConflictNode:Co.cloneWith(this.#t.onConflictNode,{doNothing:!0})})}doUpdateSet(e){return new Po({...this.#t,onConflictNode:Co.cloneWith(this.#t.onConflictNode,{updates:Wo(e)})})}$call(e){return e(this)}}Hi(Ao,"don't await OnConflictBuilder instances.");class Do{#t;constructor(e){this.#t=Fr(e)}toOperationNode(){return this.#t.onConflictNode}}Hi(Do,"don't await OnConflictDoNothingBuilder instances.");class Po{#t;constructor(e){this.#t=Fr(e)}where(...e){return new Po({...this.#t,onConflictNode:Co.cloneWithUpdateWhere(this.#t.onConflictNode,Ri(e))})}whereRef(e,t,n){return new Po({...this.#t,onConflictNode:Co.cloneWithUpdateWhere(this.#t.onConflictNode,ji(e,t,n))})}clearWhere(){return new Po({...this.#t,onConflictNode:Co.cloneWithoutUpdateWhere(this.#t.onConflictNode)})}$call(e){return e(this)}toOperationNode(){return this.#t.onConflictNode}}Hi(Po,"don't await OnConflictUpdateBuilder instances.");const Lo=Fr({is:e=>"TopNode"===e.kind,create:(e,t)=>Fr({kind:"TopNode",expression:e,modifiers:t})});function Bo(e,t){if(!Ar(e)&&!Lr(e))throw new Error(`Invalid top expression: ${e}`);if(!Er(t)&&!function(e){return"percent"===e||"with ties"===e||"percent with ties"===e}(t))throw new Error(`Invalid top modifiers: ${t}`);return Lo.create(e,t)}class Mo{#t;constructor(e){this.#t=Fr(e)}values(e){const[t,n]=co(e);return new Mo({...this.#t,queryNode:lo.cloneWith(this.#t.queryNode,{columns:t,values:n})})}columns(e){return new Mo({...this.#t,queryNode:lo.cloneWith(this.#t.queryNode,{columns:Fr(e.map(ui.create))})})}expression(e){return new Mo({...this.#t,queryNode:lo.cloneWith(this.#t.queryNode,{values:ta(e)})})}defaultValues(){return new Mo({...this.#t,queryNode:lo.cloneWith(this.#t.queryNode,{defaultValues:!0})})}ignore(){return new Mo({...this.#t,queryNode:lo.cloneWith(this.#t.queryNode,{ignore:!0})})}top(e,t){return new Mo({...this.#t,queryNode:ko.cloneWithTop(this.#t.queryNode,Bo(e,t))})}onConflict(e){return new Mo({...this.#t,queryNode:lo.cloneWith(this.#t.queryNode,{onConflict:e(new Ao({onConflictNode:Co.create()})).toOperationNode()})})}onDuplicateKeyUpdate(e){return new Mo({...this.#t,queryNode:lo.cloneWith(this.#t.queryNode,{onDuplicateKey:Io.create(Wo(e))})})}returning(e){return new Mo({...this.#t,queryNode:ko.cloneWithReturning(this.#t.queryNode,no(e))})}returningAll(){return new Mo({...this.#t,queryNode:ko.cloneWithReturning(this.#t.queryNode,io())})}clearReturning(){return new Mo({...this.#t,queryNode:ko.cloneWithoutReturning(this.#t.queryNode)})}$call(e){return e(this)}$if(e,t){return e?t(this):new Mo({...this.#t})}$castTo(){return new Mo(this.#t)}$narrowType(){return new Mo(this.#t)}$assertType(){return new Mo(this.#t)}withPlugin(e){return new Mo({...this.#t,executor:this.#t.executor.withPlugin(e)})}toOperationNode(){return this.#t.executor.transformQuery(this.#t.queryNode,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){const e=this.compile(),t=e.query,n=await this.#t.executor.executeQuery(e,this.#t.queryId);return this.#t.executor.adapter.supportsReturning&&t.returning?n.rows:[new qo(n.insertId,n.numAffectedRows??n.numUpdatedOrDeletedRows)]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=To){const t=await this.executeTakeFirst();if(void 0===t)throw Eo(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async*stream(e=100){const t=this.compile(),n=this.#t.executor.stream(t,e,this.#t.queryId);for await(const e of n)yield*e.rows}async explain(e,t){const n=new Mo({...this.#t,queryNode:ko.cloneWithExplain(this.#t.queryNode,e,t)});return await n.execute()}}Hi(Mo,"don't await InsertQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");class Fo{numDeletedRows;constructor(e){this.numDeletedRows=e}}const Ro=Fr({is:e=>"LimitNode"===e.kind,create:e=>Fr({kind:"LimitNode",limit:e})});class Uo{#t;constructor(e){this.#t=Fr(e)}where(...e){return new Uo({...this.#t,queryNode:ko.cloneWithWhere(this.#t.queryNode,Ri(e))})}whereRef(e,t,n){return new Uo({...this.#t,queryNode:ko.cloneWithWhere(this.#t.queryNode,ji(e,t,n))})}clearWhere(){return new Uo({...this.#t,queryNode:ko.cloneWithoutWhere(this.#t.queryNode)})}top(e,t){return new Uo({...this.#t,queryNode:ko.cloneWithTop(this.#t.queryNode,Bo(e,t))})}using(e){return new Uo({...this.#t,queryNode:go.cloneWithUsing(this.#t.queryNode,ia(e))})}innerJoin(...e){return new Uo({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("InnerJoin",e))})}leftJoin(...e){return new Uo({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("LeftJoin",e))})}rightJoin(...e){return new Uo({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("RightJoin",e))})}fullJoin(...e){return new Uo({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("FullJoin",e))})}returning(e){return new Uo({...this.#t,queryNode:ko.cloneWithReturning(this.#t.queryNode,no(e))})}returningAll(e){return new Uo({...this.#t,queryNode:ko.cloneWithReturning(this.#t.queryNode,io(e))})}clearReturning(){return new Uo({...this.#t,queryNode:ko.cloneWithoutReturning(this.#t.queryNode)})}clearLimit(){return new Uo({...this.#t,queryNode:go.cloneWithoutLimit(this.#t.queryNode)})}clearOrderBy(){return new Uo({...this.#t,queryNode:go.cloneWithoutOrderBy(this.#t.queryNode)})}orderBy(e,t){return new Uo({...this.#t,queryNode:go.cloneWithOrderByItems(this.#t.queryNode,Ni([e,t]))})}limit(e){return new Uo({...this.#t,queryNode:go.cloneWithLimit(this.#t.queryNode,Ro.create(Li(e)))})}$call(e){return e(this)}$if(e,t){return e?t(this):new Uo({...this.#t})}$castTo(){return new Uo(this.#t)}$narrowType(){return new Uo(this.#t)}$assertType(){return new Uo(this.#t)}withPlugin(e){return new Uo({...this.#t,executor:this.#t.executor.withPlugin(e)})}toOperationNode(){return this.#t.executor.transformQuery(this.#t.queryNode,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){const e=this.compile(),t=e.query,n=await this.#t.executor.executeQuery(e,this.#t.queryId);return this.#t.executor.adapter.supportsReturning&&t.returning?n.rows:[new Fo(n.numAffectedRows??n.numUpdatedOrDeletedRows??BigInt(0))]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=To){const t=await this.executeTakeFirst();if(void 0===t)throw Eo(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async*stream(e=100){const t=this.compile(),n=this.#t.executor.stream(t,e,this.#t.queryId);for await(const e of n)yield*e.rows}async explain(e,t){const n=new Uo({...this.#t,queryNode:ko.cloneWithExplain(this.#t.queryNode,e,t)});return await n.execute()}}Hi(Uo,"don't await DeleteQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");class jo{numUpdatedRows;numChangedRows;constructor(e,t){this.numUpdatedRows=e,this.numChangedRows=t}}class _o{#t;constructor(e){this.#t=Fr(e)}where(...e){return new _o({...this.#t,queryNode:ko.cloneWithWhere(this.#t.queryNode,Ri(e))})}whereRef(e,t,n){return new _o({...this.#t,queryNode:ko.cloneWithWhere(this.#t.queryNode,ji(e,t,n))})}clearWhere(){return new _o({...this.#t,queryNode:ko.cloneWithoutWhere(this.#t.queryNode)})}top(e,t){return new _o({...this.#t,queryNode:ko.cloneWithTop(this.#t.queryNode,Bo(e,t))})}from(e){return new _o({...this.#t,queryNode:mo.cloneWithFromItems(this.#t.queryNode,ia(e))})}innerJoin(...e){return new _o({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("InnerJoin",e))})}leftJoin(...e){return new _o({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("LeftJoin",e))})}rightJoin(...e){return new _o({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("RightJoin",e))})}fullJoin(...e){return new _o({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("FullJoin",e))})}limit(e){return new _o({...this.#t,queryNode:mo.cloneWithLimit(this.#t.queryNode,Ro.create(Li(e)))})}set(...e){return new _o({...this.#t,queryNode:mo.cloneWithUpdates(this.#t.queryNode,Oo(...e))})}returning(e){return new _o({...this.#t,queryNode:ko.cloneWithReturning(this.#t.queryNode,no(e))})}returningAll(){return new _o({...this.#t,queryNode:ko.cloneWithReturning(this.#t.queryNode,io())})}clearReturning(){return new _o({...this.#t,queryNode:ko.cloneWithoutReturning(this.#t.queryNode)})}$call(e){return e(this)}$if(e,t){return e?t(this):new _o({...this.#t})}$castTo(){return new _o(this.#t)}$narrowType(){return new _o(this.#t)}$assertType(){return new _o(this.#t)}withPlugin(e){return new _o({...this.#t,executor:this.#t.executor.withPlugin(e)})}toOperationNode(){return this.#t.executor.transformQuery(this.#t.queryNode,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){const e=this.compile(),t=e.query,n=await this.#t.executor.executeQuery(e,this.#t.queryId);return this.#t.executor.adapter.supportsReturning&&t.returning?n.rows:[new jo(n.numAffectedRows??n.numUpdatedOrDeletedRows??BigInt(0),n.numChangedRows)]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=To){const t=await this.executeTakeFirst();if(void 0===t)throw Eo(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async*stream(e=100){const t=this.compile(),n=this.#t.executor.stream(t,e,this.#t.queryId);for await(const e of n)yield*e.rows}async explain(e,t){const n=new _o({...this.#t,queryNode:ko.cloneWithExplain(this.#t.queryNode,e,t)});return await n.execute()}}Hi(_o,"don't await UpdateQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");const $o=Fr({is:e=>"CommonTableExpressionNameNode"===e.kind,create:(e,t)=>Fr({kind:"CommonTableExpressionNameNode",table:Zr.create(e),columns:t?Fr(t.map(ui.create)):void 0})}),Qo=Fr({is:e=>"CommonTableExpressionNode"===e.kind,create:(e,t)=>Fr({kind:"CommonTableExpressionNode",name:e,expression:t}),cloneWith:(e,t)=>Fr({...e,...t})});class Jo{#t;constructor(e){this.#t=Fr(e)}materialized(){return new Jo({...this.#t,node:Qo.cloneWith(this.#t.node,{materialized:!0})})}notMaterialized(){return new Jo({...this.#t,node:Qo.cloneWith(this.#t.node,{materialized:!1})})}toOperationNode(){return this.#t.node}}function Ko(e,t){const n=t(new ys({executor:ls})).toOperationNode();return Br(e)?e(function(e){return t=>new Jo({node:Qo.create(Yo(t),e)})}(n)).toOperationNode():Qo.create(Yo(e),n)}function Yo(e){if(e.includes("(")){const t=e.split(/[\(\)]/),n=t[0],r=t[1].split(",").map((e=>e.trim()));return $o.create(n,r)}return $o.create(e)}Hi(Jo,"don't await CTEBuilder instances. They are never executed directly and are always just a part of a query.");const Vo=Fr({is:e=>"WithNode"===e.kind,create:(e,t)=>Fr({kind:"WithNode",expressions:Fr([e]),...t}),cloneWithExpression:(e,t)=>Fr({...e,expressions:Fr([...e.expressions,t])})}),zo=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"];function Ho(){return new Xo}class Xo{#n;get queryId(){return void 0===this.#n&&(this.#n=function(e){let t="";for(let e=0;e<8;++e)t+=zo[~~(Math.random()*zo.length)];return t}()),this.#n}}class Go{nodeStack=[];#r=Fr({AliasNode:this.transformAlias.bind(this),ColumnNode:this.transformColumn.bind(this),IdentifierNode:this.transformIdentifier.bind(this),SchemableIdentifierNode:this.transformSchemableIdentifier.bind(this),RawNode:this.transformRaw.bind(this),ReferenceNode:this.transformReference.bind(this),SelectQueryNode:this.transformSelectQuery.bind(this),SelectionNode:this.transformSelection.bind(this),TableNode:this.transformTable.bind(this),FromNode:this.transformFrom.bind(this),SelectAllNode:this.transformSelectAll.bind(this),AndNode:this.transformAnd.bind(this),OrNode:this.transformOr.bind(this),ValueNode:this.transformValue.bind(this),ValueListNode:this.transformValueList.bind(this),PrimitiveValueListNode:this.transformPrimitiveValueList.bind(this),ParensNode:this.transformParens.bind(this),JoinNode:this.transformJoin.bind(this),OperatorNode:this.transformOperator.bind(this),WhereNode:this.transformWhere.bind(this),InsertQueryNode:this.transformInsertQuery.bind(this),DeleteQueryNode:this.transformDeleteQuery.bind(this),ReturningNode:this.transformReturning.bind(this),CreateTableNode:this.transformCreateTable.bind(this),AddColumnNode:this.transformAddColumn.bind(this),ColumnDefinitionNode:this.transformColumnDefinition.bind(this),DropTableNode:this.transformDropTable.bind(this),DataTypeNode:this.transformDataType.bind(this),OrderByNode:this.transformOrderBy.bind(this),OrderByItemNode:this.transformOrderByItem.bind(this),GroupByNode:this.transformGroupBy.bind(this),GroupByItemNode:this.transformGroupByItem.bind(this),UpdateQueryNode:this.transformUpdateQuery.bind(this),ColumnUpdateNode:this.transformColumnUpdate.bind(this),LimitNode:this.transformLimit.bind(this),OffsetNode:this.transformOffset.bind(this),OnConflictNode:this.transformOnConflict.bind(this),OnDuplicateKeyNode:this.transformOnDuplicateKey.bind(this),CreateIndexNode:this.transformCreateIndex.bind(this),DropIndexNode:this.transformDropIndex.bind(this),ListNode:this.transformList.bind(this),PrimaryKeyConstraintNode:this.transformPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.transformUniqueConstraint.bind(this),ReferencesNode:this.transformReferences.bind(this),CheckConstraintNode:this.transformCheckConstraint.bind(this),WithNode:this.transformWith.bind(this),CommonTableExpressionNode:this.transformCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.transformCommonTableExpressionName.bind(this),HavingNode:this.transformHaving.bind(this),CreateSchemaNode:this.transformCreateSchema.bind(this),DropSchemaNode:this.transformDropSchema.bind(this),AlterTableNode:this.transformAlterTable.bind(this),DropColumnNode:this.transformDropColumn.bind(this),RenameColumnNode:this.transformRenameColumn.bind(this),AlterColumnNode:this.transformAlterColumn.bind(this),ModifyColumnNode:this.transformModifyColumn.bind(this),AddConstraintNode:this.transformAddConstraint.bind(this),DropConstraintNode:this.transformDropConstraint.bind(this),ForeignKeyConstraintNode:this.transformForeignKeyConstraint.bind(this),CreateViewNode:this.transformCreateView.bind(this),DropViewNode:this.transformDropView.bind(this),GeneratedNode:this.transformGenerated.bind(this),DefaultValueNode:this.transformDefaultValue.bind(this),OnNode:this.transformOn.bind(this),ValuesNode:this.transformValues.bind(this),SelectModifierNode:this.transformSelectModifier.bind(this),CreateTypeNode:this.transformCreateType.bind(this),DropTypeNode:this.transformDropType.bind(this),ExplainNode:this.transformExplain.bind(this),DefaultInsertValueNode:this.transformDefaultInsertValue.bind(this),AggregateFunctionNode:this.transformAggregateFunction.bind(this),OverNode:this.transformOver.bind(this),PartitionByNode:this.transformPartitionBy.bind(this),PartitionByItemNode:this.transformPartitionByItem.bind(this),SetOperationNode:this.transformSetOperation.bind(this),BinaryOperationNode:this.transformBinaryOperation.bind(this),UnaryOperationNode:this.transformUnaryOperation.bind(this),UsingNode:this.transformUsing.bind(this),FunctionNode:this.transformFunction.bind(this),CaseNode:this.transformCase.bind(this),WhenNode:this.transformWhen.bind(this),JSONReferenceNode:this.transformJSONReference.bind(this),JSONPathNode:this.transformJSONPath.bind(this),JSONPathLegNode:this.transformJSONPathLeg.bind(this),JSONOperatorChainNode:this.transformJSONOperatorChain.bind(this),TupleNode:this.transformTuple.bind(this),MergeQueryNode:this.transformMergeQuery.bind(this),MatchedNode:this.transformMatched.bind(this),AddIndexNode:this.transformAddIndex.bind(this),CastNode:this.transformCast.bind(this),FetchNode:this.transformFetch.bind(this),TopNode:this.transformTop.bind(this)});transformNode(e){if(!e)return e;this.nodeStack.push(e);const t=this.transformNodeImpl(e);return this.nodeStack.pop(),Fr(t)}transformNodeImpl(e){return this.#r[e.kind](e)}transformNodeList(e){return e?Fr(e.map((e=>this.transformNode(e)))):e}transformSelectQuery(e){return{kind:"SelectQueryNode",from:this.transformNode(e.from),selections:this.transformNodeList(e.selections),distinctOn:this.transformNodeList(e.distinctOn),joins:this.transformNodeList(e.joins),groupBy:this.transformNode(e.groupBy),orderBy:this.transformNode(e.orderBy),where:this.transformNode(e.where),frontModifiers:this.transformNodeList(e.frontModifiers),endModifiers:this.transformNodeList(e.endModifiers),limit:this.transformNode(e.limit),offset:this.transformNode(e.offset),with:this.transformNode(e.with),having:this.transformNode(e.having),explain:this.transformNode(e.explain),setOperations:this.transformNodeList(e.setOperations),fetch:this.transformNode(e.fetch),top:this.transformNode(e.top)}}transformSelection(e){return{kind:"SelectionNode",selection:this.transformNode(e.selection)}}transformColumn(e){return{kind:"ColumnNode",column:this.transformNode(e.column)}}transformAlias(e){return{kind:"AliasNode",node:this.transformNode(e.node),alias:this.transformNode(e.alias)}}transformTable(e){return{kind:"TableNode",table:this.transformNode(e.table)}}transformFrom(e){return{kind:"FromNode",froms:this.transformNodeList(e.froms)}}transformReference(e){return{kind:"ReferenceNode",column:this.transformNode(e.column),table:this.transformNode(e.table)}}transformAnd(e){return{kind:"AndNode",left:this.transformNode(e.left),right:this.transformNode(e.right)}}transformOr(e){return{kind:"OrNode",left:this.transformNode(e.left),right:this.transformNode(e.right)}}transformValueList(e){return{kind:"ValueListNode",values:this.transformNodeList(e.values)}}transformParens(e){return{kind:"ParensNode",node:this.transformNode(e.node)}}transformJoin(e){return{kind:"JoinNode",joinType:e.joinType,table:this.transformNode(e.table),on:this.transformNode(e.on)}}transformRaw(e){return{kind:"RawNode",sqlFragments:Fr([...e.sqlFragments]),parameters:this.transformNodeList(e.parameters)}}transformWhere(e){return{kind:"WhereNode",where:this.transformNode(e.where)}}transformInsertQuery(e){return{kind:"InsertQueryNode",into:this.transformNode(e.into),columns:this.transformNodeList(e.columns),values:this.transformNode(e.values),returning:this.transformNode(e.returning),onConflict:this.transformNode(e.onConflict),onDuplicateKey:this.transformNode(e.onDuplicateKey),with:this.transformNode(e.with),ignore:e.ignore,replace:e.replace,explain:this.transformNode(e.explain),defaultValues:e.defaultValues,top:this.transformNode(e.top)}}transformValues(e){return{kind:"ValuesNode",values:this.transformNodeList(e.values)}}transformDeleteQuery(e){return{kind:"DeleteQueryNode",from:this.transformNode(e.from),using:this.transformNode(e.using),joins:this.transformNodeList(e.joins),where:this.transformNode(e.where),returning:this.transformNode(e.returning),with:this.transformNode(e.with),orderBy:this.transformNode(e.orderBy),limit:this.transformNode(e.limit),explain:this.transformNode(e.explain),top:this.transformNode(e.top)}}transformReturning(e){return{kind:"ReturningNode",selections:this.transformNodeList(e.selections)}}transformCreateTable(e){return{kind:"CreateTableNode",table:this.transformNode(e.table),columns:this.transformNodeList(e.columns),constraints:this.transformNodeList(e.constraints),temporary:e.temporary,ifNotExists:e.ifNotExists,onCommit:e.onCommit,frontModifiers:this.transformNodeList(e.frontModifiers),endModifiers:this.transformNodeList(e.endModifiers),selectQuery:this.transformNode(e.selectQuery)}}transformColumnDefinition(e){return{kind:"ColumnDefinitionNode",column:this.transformNode(e.column),dataType:this.transformNode(e.dataType),references:this.transformNode(e.references),primaryKey:e.primaryKey,autoIncrement:e.autoIncrement,unique:e.unique,notNull:e.notNull,unsigned:e.unsigned,defaultTo:this.transformNode(e.defaultTo),check:this.transformNode(e.check),generated:this.transformNode(e.generated),frontModifiers:this.transformNodeList(e.frontModifiers),endModifiers:this.transformNodeList(e.endModifiers),nullsNotDistinct:e.nullsNotDistinct,identity:e.identity}}transformAddColumn(e){return{kind:"AddColumnNode",column:this.transformNode(e.column)}}transformDropTable(e){return{kind:"DropTableNode",table:this.transformNode(e.table),ifExists:e.ifExists,cascade:e.cascade}}transformOrderBy(e){return{kind:"OrderByNode",items:this.transformNodeList(e.items)}}transformOrderByItem(e){return{kind:"OrderByItemNode",orderBy:this.transformNode(e.orderBy),direction:this.transformNode(e.direction)}}transformGroupBy(e){return{kind:"GroupByNode",items:this.transformNodeList(e.items)}}transformGroupByItem(e){return{kind:"GroupByItemNode",groupBy:this.transformNode(e.groupBy)}}transformUpdateQuery(e){return{kind:"UpdateQueryNode",table:this.transformNode(e.table),from:this.transformNode(e.from),joins:this.transformNodeList(e.joins),where:this.transformNode(e.where),updates:this.transformNodeList(e.updates),returning:this.transformNode(e.returning),with:this.transformNode(e.with),explain:this.transformNode(e.explain),limit:this.transformNode(e.limit),top:this.transformNode(e.top)}}transformColumnUpdate(e){return{kind:"ColumnUpdateNode",column:this.transformNode(e.column),value:this.transformNode(e.value)}}transformLimit(e){return{kind:"LimitNode",limit:this.transformNode(e.limit)}}transformOffset(e){return{kind:"OffsetNode",offset:this.transformNode(e.offset)}}transformOnConflict(e){return{kind:"OnConflictNode",columns:this.transformNodeList(e.columns),constraint:this.transformNode(e.constraint),indexExpression:this.transformNode(e.indexExpression),indexWhere:this.transformNode(e.indexWhere),updates:this.transformNodeList(e.updates),updateWhere:this.transformNode(e.updateWhere),doNothing:e.doNothing}}transformOnDuplicateKey(e){return{kind:"OnDuplicateKeyNode",updates:this.transformNodeList(e.updates)}}transformCreateIndex(e){return{kind:"CreateIndexNode",name:this.transformNode(e.name),table:this.transformNode(e.table),columns:this.transformNodeList(e.columns),unique:e.unique,using:this.transformNode(e.using),ifNotExists:e.ifNotExists,where:this.transformNode(e.where),nullsNotDistinct:e.nullsNotDistinct}}transformList(e){return{kind:"ListNode",items:this.transformNodeList(e.items)}}transformDropIndex(e){return{kind:"DropIndexNode",name:this.transformNode(e.name),table:this.transformNode(e.table),ifExists:e.ifExists,cascade:e.cascade}}transformPrimaryKeyConstraint(e){return{kind:"PrimaryKeyConstraintNode",columns:this.transformNodeList(e.columns),name:this.transformNode(e.name)}}transformUniqueConstraint(e){return{kind:"UniqueConstraintNode",columns:this.transformNodeList(e.columns),name:this.transformNode(e.name),nullsNotDistinct:e.nullsNotDistinct}}transformForeignKeyConstraint(e){return{kind:"ForeignKeyConstraintNode",columns:this.transformNodeList(e.columns),references:this.transformNode(e.references),name:this.transformNode(e.name),onDelete:e.onDelete,onUpdate:e.onUpdate}}transformSetOperation(e){return{kind:"SetOperationNode",operator:e.operator,expression:this.transformNode(e.expression),all:e.all}}transformReferences(e){return{kind:"ReferencesNode",table:this.transformNode(e.table),columns:this.transformNodeList(e.columns),onDelete:e.onDelete,onUpdate:e.onUpdate}}transformCheckConstraint(e){return{kind:"CheckConstraintNode",expression:this.transformNode(e.expression),name:this.transformNode(e.name)}}transformWith(e){return{kind:"WithNode",expressions:this.transformNodeList(e.expressions),recursive:e.recursive}}transformCommonTableExpression(e){return{kind:"CommonTableExpressionNode",name:this.transformNode(e.name),materialized:e.materialized,expression:this.transformNode(e.expression)}}transformCommonTableExpressionName(e){return{kind:"CommonTableExpressionNameNode",table:this.transformNode(e.table),columns:this.transformNodeList(e.columns)}}transformHaving(e){return{kind:"HavingNode",having:this.transformNode(e.having)}}transformCreateSchema(e){return{kind:"CreateSchemaNode",schema:this.transformNode(e.schema),ifNotExists:e.ifNotExists}}transformDropSchema(e){return{kind:"DropSchemaNode",schema:this.transformNode(e.schema),ifExists:e.ifExists,cascade:e.cascade}}transformAlterTable(e){return{kind:"AlterTableNode",table:this.transformNode(e.table),renameTo:this.transformNode(e.renameTo),setSchema:this.transformNode(e.setSchema),columnAlterations:this.transformNodeList(e.columnAlterations),addConstraint:this.transformNode(e.addConstraint),dropConstraint:this.transformNode(e.dropConstraint),addIndex:this.transformNode(e.addIndex),dropIndex:this.transformNode(e.dropIndex)}}transformDropColumn(e){return{kind:"DropColumnNode",column:this.transformNode(e.column)}}transformRenameColumn(e){return{kind:"RenameColumnNode",column:this.transformNode(e.column),renameTo:this.transformNode(e.renameTo)}}transformAlterColumn(e){return{kind:"AlterColumnNode",column:this.transformNode(e.column),dataType:this.transformNode(e.dataType),dataTypeExpression:this.transformNode(e.dataTypeExpression),setDefault:this.transformNode(e.setDefault),dropDefault:e.dropDefault,setNotNull:e.setNotNull,dropNotNull:e.dropNotNull}}transformModifyColumn(e){return{kind:"ModifyColumnNode",column:this.transformNode(e.column)}}transformAddConstraint(e){return{kind:"AddConstraintNode",constraint:this.transformNode(e.constraint)}}transformDropConstraint(e){return{kind:"DropConstraintNode",constraintName:this.transformNode(e.constraintName),ifExists:e.ifExists,modifier:e.modifier}}transformCreateView(e){return{kind:"CreateViewNode",name:this.transformNode(e.name),temporary:e.temporary,orReplace:e.orReplace,ifNotExists:e.ifNotExists,materialized:e.materialized,columns:this.transformNodeList(e.columns),as:this.transformNode(e.as)}}transformDropView(e){return{kind:"DropViewNode",name:this.transformNode(e.name),ifExists:e.ifExists,materialized:e.materialized,cascade:e.cascade}}transformGenerated(e){return{kind:"GeneratedNode",byDefault:e.byDefault,always:e.always,identity:e.identity,stored:e.stored,expression:this.transformNode(e.expression)}}transformDefaultValue(e){return{kind:"DefaultValueNode",defaultValue:this.transformNode(e.defaultValue)}}transformOn(e){return{kind:"OnNode",on:this.transformNode(e.on)}}transformSelectModifier(e){return{kind:"SelectModifierNode",modifier:e.modifier,rawModifier:this.transformNode(e.rawModifier),of:this.transformNodeList(e.of)}}transformCreateType(e){return{kind:"CreateTypeNode",name:this.transformNode(e.name),enum:this.transformNode(e.enum)}}transformDropType(e){return{kind:"DropTypeNode",name:this.transformNode(e.name),ifExists:e.ifExists}}transformExplain(e){return{kind:"ExplainNode",format:e.format,options:this.transformNode(e.options)}}transformSchemableIdentifier(e){return{kind:"SchemableIdentifierNode",schema:this.transformNode(e.schema),identifier:this.transformNode(e.identifier)}}transformAggregateFunction(e){return{kind:"AggregateFunctionNode",aggregated:this.transformNodeList(e.aggregated),distinct:e.distinct,filter:this.transformNode(e.filter),func:e.func,over:this.transformNode(e.over)}}transformOver(e){return{kind:"OverNode",orderBy:this.transformNode(e.orderBy),partitionBy:this.transformNode(e.partitionBy)}}transformPartitionBy(e){return{kind:"PartitionByNode",items:this.transformNodeList(e.items)}}transformPartitionByItem(e){return{kind:"PartitionByItemNode",partitionBy:this.transformNode(e.partitionBy)}}transformBinaryOperation(e){return{kind:"BinaryOperationNode",leftOperand:this.transformNode(e.leftOperand),operator:this.transformNode(e.operator),rightOperand:this.transformNode(e.rightOperand)}}transformUnaryOperation(e){return{kind:"UnaryOperationNode",operator:this.transformNode(e.operator),operand:this.transformNode(e.operand)}}transformUsing(e){return{kind:"UsingNode",tables:this.transformNodeList(e.tables)}}transformFunction(e){return{kind:"FunctionNode",func:e.func,arguments:this.transformNodeList(e.arguments)}}transformCase(e){return{kind:"CaseNode",value:this.transformNode(e.value),when:this.transformNodeList(e.when),else:this.transformNode(e.else),isStatement:e.isStatement}}transformWhen(e){return{kind:"WhenNode",condition:this.transformNode(e.condition),result:this.transformNode(e.result)}}transformJSONReference(e){return{kind:"JSONReferenceNode",reference:this.transformNode(e.reference),traversal:this.transformNode(e.traversal)}}transformJSONPath(e){return{kind:"JSONPathNode",inOperator:this.transformNode(e.inOperator),pathLegs:this.transformNodeList(e.pathLegs)}}transformJSONPathLeg(e){return{kind:"JSONPathLegNode",type:e.type,value:e.value}}transformJSONOperatorChain(e){return{kind:"JSONOperatorChainNode",operator:this.transformNode(e.operator),values:this.transformNodeList(e.values)}}transformTuple(e){return{kind:"TupleNode",values:this.transformNodeList(e.values)}}transformMergeQuery(e){return{kind:"MergeQueryNode",into:this.transformNode(e.into),using:this.transformNode(e.using),whens:this.transformNodeList(e.whens),with:this.transformNode(e.with),top:this.transformNode(e.top)}}transformMatched(e){return{kind:"MatchedNode",not:e.not,bySource:e.bySource}}transformAddIndex(e){return{kind:"AddIndexNode",name:this.transformNode(e.name),columns:this.transformNodeList(e.columns),unique:e.unique,using:this.transformNode(e.using),ifNotExists:e.ifNotExists}}transformCast(e){return{kind:"CastNode",expression:this.transformNode(e.expression),dataType:this.transformNode(e.dataType)}}transformFetch(e){return{kind:"FetchNode",rowCount:this.transformNode(e.rowCount),modifier:e.modifier}}transformTop(e){return{kind:"TopNode",expression:e.expression,modifiers:e.modifiers}}transformDataType(e){return e}transformSelectAll(e){return e}transformIdentifier(e){return e}transformValue(e){return e}transformPrimitiveValueList(e){return e}transformOperator(e){return e}transformDefaultInsertValue(e){return e}}const Zo=Fr({AlterTableNode:!0,CreateIndexNode:!0,CreateSchemaNode:!0,CreateTableNode:!0,CreateTypeNode:!0,CreateViewNode:!0,DeleteQueryNode:!0,DropIndexNode:!0,DropSchemaNode:!0,DropTableNode:!0,DropTypeNode:!0,DropViewNode:!0,InsertQueryNode:!0,RawNode:!0,SelectQueryNode:!0,UpdateQueryNode:!0,MergeQueryNode:!0});class es extends Go{#i;#o=new Set;#s=new Set;constructor(e){super(),this.#i=e}transformNodeImpl(e){if(!this.#a(e))return super.transformNodeImpl(e);const t=this.#c(e);for(const e of t)this.#s.add(e);const n=this.#d(e);for(const e of n)this.#o.add(e);const r=super.transformNodeImpl(e);for(const e of n)this.#o.delete(e);for(const e of t)this.#s.delete(e);return r}transformSchemableIdentifier(e){const t=super.transformSchemableIdentifier(e);return t.schema||!this.#o.has(e.identifier.name)?t:{...t,schema:$r.create(this.#i)}}transformReferences(e){const t=super.transformReferences(e);return t.table.table.schema?t:{...t,table:Zr.createWithSchema(this.#i,t.table.table.identifier.name)}}#a(e){return e.kind in Zo}#d(e){const t=new Set;if("name"in e&&e.name&&Vr.is(e.name)&&this.#l(e.name,t),"from"in e&&e.from)for(const n of e.from.froms)this.#u(n,t);if("into"in e&&e.into&&this.#u(e.into,t),"table"in e&&e.table&&this.#u(e.table,t),"joins"in e&&e.joins)for(const n of e.joins)this.#u(n.table,t);return"using"in e&&e.using&&this.#u(e.using,t),t}#c(e){const t=new Set;return"with"in e&&e.with&&this.#p(e.with,t),t}#u(e,t){const n=Zr.is(e)?e:Gr.is(e)&&Zr.is(e.node)?e.node:null;n&&this.#l(n.table,t)}#l(e,t){const n=e.identifier.name;this.#o.has(n)||this.#s.has(n)||t.add(n)}#p(e,t){for(const n of e.expressions){const e=n.name.table.table.identifier.name;this.#s.has(e)||t.add(e)}}}class ts{#h;constructor(e){this.#h=new es(e)}transformQuery(e){return this.#h.transformNode(e.node)}async transformResult(e){return e.result}}const ns=Fr({is:e=>"MatchedNode"===e.kind,create:(e,t=!1)=>Fr({kind:"MatchedNode",not:e,bySource:t})});function rs(e,t,n){return vo.create($i([ns.create(!e.isMatched,e.bySource),...t&&t.length>0?[3===t.length&&n?ji(t[0],t[1],t[2]):Ri(t)]:[]],"and",!1))}function is(e){return Cr(e)?gi.create([e],[]):ei(e)?e.toOperationNode():e}class os{#f;#m;#y;constructor(){this.#f=new Promise(((e,t)=>{this.#y=t,this.#m=e}))}get promise(){return this.#f}resolve=e=>{this.#m&&this.#m(e)};reject=e=>{this.#y&&this.#y(e)}}const ss=new Set,as=Fr([]);class cs{#g;constructor(e=as){this.#g=e}get plugins(){return this.#g}transformQuery(e,t){for(const n of this.#g){const r=n.transformQuery({node:e,queryId:t});if(r.kind!==e.kind)throw new Error(["KyselyPlugin.transformQuery must return a node","of the same kind that was given to it.",`The plugin was given a ${e.kind}`,`but it returned a ${r.kind}`].join(" "));e=r}return e}async executeQuery(e,t){return await this.provideConnection((async n=>{const r=await n.executeQuery(e),i=await this.#w(r,t);return function(e,t){const{numAffectedRows:n}=e;var r;void 0===n&&void 0===e.numUpdatedOrDeletedRows||void 0!==n&&void 0!==t.numAffectedRows||(r="kysely:warning: outdated driver/plugin detected! QueryResult.numUpdatedOrDeletedRows is deprecated and will be removed in a future release.",ss.has(r)||(ss.add(r),console.log(r)))}(r,i),i}))}async*stream(e,t,n){const r=new os,i=new os;this.provideConnection((async e=>(r.resolve(e),await i.promise))).catch((e=>r.reject(e)));const o=await r.promise;try{for await(const r of o.streamQuery(e,t))yield await this.#w(r,n)}finally{i.resolve()}}async#w(e,t){for(const n of this.#g)e=await n.transformResult({result:e,queryId:t});return e}}class ds extends cs{get adapter(){throw new Error("this query cannot be compiled to SQL")}compileQuery(){throw new Error("this query cannot be compiled to SQL")}provideConnection(){throw new Error("this query cannot be executed")}withConnectionProvider(){throw new Error("this query cannot have a connection provider")}withPlugin(e){return new ds([...this.plugins,e])}withPlugins(e){return new ds([...this.plugins,...e])}withPluginAtFront(e){return new ds([e,...this.plugins])}withoutPlugins(){return new ds([])}}const ls=new ds;class us{numChangedRows;constructor(e){this.numChangedRows=e}}class ps{#t;constructor(e){this.#t=Fr(e)}top(e,t){return new ps({...this.#t,queryNode:ko.cloneWithTop(this.#t.queryNode,Bo(e,t))})}using(...e){return new hs({...this.#t,queryNode:xo.cloneWithUsing(this.#t.queryNode,gs("Using",e))})}}Hi(ps,"don't await MergeQueryBuilder instances directly. To execute the query you need to call `execute` when available.");class hs{#t;constructor(e){this.#t=Fr(e)}top(e,t){return new hs({...this.#t,queryNode:ko.cloneWithTop(this.#t.queryNode,Bo(e,t))})}whenMatched(){return this.#N([])}whenMatchedAnd(...e){return this.#N(e)}whenMatchedAndRef(e,t,n){return this.#N([e,t,n],!0)}#N(e,t){return new fs({...this.#t,queryNode:xo.cloneWithWhen(this.#t.queryNode,rs({isMatched:!0},e,t))})}whenNotMatched(){return this.#b([])}whenNotMatchedAnd(...e){return this.#b(e)}whenNotMatchedAndRef(e,t,n){return this.#b([e,t,n],!0)}whenNotMatchedBySource(){return this.#b([],!1,!0)}whenNotMatchedBySourceAnd(...e){return this.#b(e,!1,!0)}whenNotMatchedBySourceAndRef(e,t,n){return this.#b([e,t,n],!0,!0)}#b(e,t=!1,n=!1){const r={...this.#t,queryNode:xo.cloneWithWhen(this.#t.queryNode,rs({isMatched:!1,bySource:n},e,t))};return new(n?fs:ms)(r)}$call(e){return e(this)}$if(e,t){return e?t(this):new hs({...this.#t})}toOperationNode(){return this.#t.executor.transformQuery(this.#t.queryNode,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.#t.queryNode,this.#t.queryId)}async execute(){const e=this.compile(),t=await this.#t.executor.executeQuery(e,this.#t.queryId);return[new us(t.numAffectedRows)]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=To){const t=await this.executeTakeFirst();if(void 0===t)throw Eo(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}}Hi(hs,"don't await WheneableMergeQueryBuilder instances directly. To execute the query you need to call `execute`.");class fs{#t;constructor(e){this.#t=Fr(e)}thenDelete(){return new hs({...this.#t,queryNode:xo.cloneWithThen(this.#t.queryNode,is("delete"))})}thenDoNothing(){return new hs({...this.#t,queryNode:xo.cloneWithThen(this.#t.queryNode,is("do nothing"))})}thenUpdate(e){return new hs({...this.#t,queryNode:xo.cloneWithThen(this.#t.queryNode,is(e(new _o({queryId:this.#t.queryId,executor:ls,queryNode:mo.createWithoutTable()}))))})}thenUpdateSet(...e){return this.thenUpdate((t=>t.set(...e)))}}Hi(fs,"don't await MatchedThenableMergeQueryBuilder instances directly. To execute the query you need to call `execute` when available.");class ms{#t;constructor(e){this.#t=Fr(e)}thenDoNothing(){return new hs({...this.#t,queryNode:xo.cloneWithThen(this.#t.queryNode,is("do nothing"))})}thenInsertValues(e){const[t,n]=co(e);return new hs({...this.#t,queryNode:xo.cloneWithThen(this.#t.queryNode,is(lo.cloneWith(lo.createWithoutInto(),{columns:t,values:n})))})}}Hi(ms,"don't await NotMatchedThenableMergeQueryBuilder instances directly. To execute the query you need to call `execute` when available.");class ys{#t;constructor(e){this.#t=Fr(e)}selectFrom(e){return Es({queryId:Ho(),executor:this.#t.executor,queryNode:fo.createFrom(ia(e),this.#t.withNode)})}selectNoFrom(e){return Es({queryId:Ho(),executor:this.#t.executor,queryNode:fo.cloneWithSelections(fo.create(this.#t.withNode),no(e))})}insertInto(e){return new Mo({queryId:Ho(),executor:this.#t.executor,queryNode:lo.create(aa(e),this.#t.withNode)})}replaceInto(e){return new Mo({queryId:Ho(),executor:this.#t.executor,queryNode:lo.create(aa(e),this.#t.withNode,!0)})}deleteFrom(e){return new Uo({queryId:Ho(),executor:this.#t.executor,queryNode:go.create(ia(e),this.#t.withNode)})}updateTable(e){return new _o({queryId:Ho(),executor:this.#t.executor,queryNode:mo.create(oa(e),this.#t.withNode)})}mergeInto(e){return new ps({queryId:Ho(),executor:this.#t.executor,queryNode:xo.create(sa(e),this.#t.withNode)})}with(e,t){const n=Ko(e,t);return new ys({...this.#t,withNode:this.#t.withNode?Vo.cloneWithExpression(this.#t.withNode,n):Vo.create(n)})}withRecursive(e,t){const n=Ko(e,t);return new ys({...this.#t,withNode:this.#t.withNode?Vo.cloneWithExpression(this.#t.withNode,n):Vo.create(n,{recursive:!0})})}withPlugin(e){return new ys({...this.#t,executor:this.#t.executor.withPlugin(e)})}withoutPlugins(){return new ys({...this.#t,executor:this.#t.executor.withoutPlugins()})}withSchema(e){return new ys({...this.#t,executor:this.#t.executor.withPluginAtFront(new ts(e))})}}function gs(e,t){if(3===t.length)return function(e,t,n,r){return oi.createWithOn(e,oa(t),ji(n,"=",r))}(e,t[0],t[1],t[2]);if(2===t.length)return function(e,t,n){return n(function(e,t){return new Xi({joinNode:oi.create(e,oa(t))})}(e,t)).toOperationNode()}(e,t[0],t[1]);throw new Error("not implemented")}const ws=Fr({is:e=>"OffsetNode"===e.kind,create:e=>Fr({kind:"OffsetNode",offset:e})}),Ns=Fr({is:e=>"GroupByItemNode"===e.kind,create:e=>Fr({kind:"GroupByItemNode",groupBy:e})});function bs(e){return Wi(e=Br(e)?e(ea()):e).map(Ns.create)}const vs=Fr({is:e=>"SetOperationNode"===e.kind,create:(e,t,n)=>Fr({kind:"SetOperationNode",operator:e,expression:t,all:n})});function xs(e,t,n){return Br(t)&&(t=t(Zs())),Ur(t)||(t=[t]),t.map((t=>vs.create(e,ta(t),n)))}class ks{#v;constructor(e){this.#v=e}get expressionType(){}as(e){return new Ss(this,e)}or(...e){return new Os(ri.create(this.#v,Ri(e)))}and(...e){return new Ws(ni.create(this.#v,Ri(e)))}$castTo(){return new ks(this.#v)}$notNull(){return new ks(this.#v)}toOperationNode(){return this.#v}}class Ss{#x;#k;constructor(e,t){this.#x=e,this.#k=t}get expression(){return this.#x}get alias(){return this.#k}toOperationNode(){return Gr.create(this.#x.toOperationNode(),ei(this.#k)?this.#k.toOperationNode():$r.create(this.#k))}}class Os{#v;constructor(e){this.#v=e}get expressionType(){}as(e){return new Ss(this,e)}or(...e){return new Os(ri.create(this.#v,Ri(e)))}$castTo(){return new Os(this.#v)}toOperationNode(){return Fi.create(this.#v)}}class Ws{#v;constructor(e){this.#v=e}get expressionType(){}as(e){return new Ss(this,e)}and(...e){return new Ws(ni.create(this.#v,Ri(e)))}$castTo(){return new Ws(this.#v)}toOperationNode(){return Fi.create(this.#v)}}const Is=(e,t)=>({kind:"FetchNode",rowCount:Pi.create(e),modifier:t});function qs(e,t){if(!Ar(e)&&!Lr(e))throw new Error(`Invalid fetch row count: ${e}`);if("only"!==(n=t)&&"with ties"!==n)throw new Error(`Invalid fetch modifier: ${t}`);var n;return Is(e,t)}class Ts{#t;constructor(e){this.#t=Fr(e)}get expressionType(){}get isSelectQueryBuilder(){return!0}where(...e){return new Ts({...this.#t,queryNode:ko.cloneWithWhere(this.#t.queryNode,Ri(e))})}whereRef(e,t,n){return new Ts({...this.#t,queryNode:ko.cloneWithWhere(this.#t.queryNode,ji(e,t,n))})}having(...e){return new Ts({...this.#t,queryNode:fo.cloneWithHaving(this.#t.queryNode,Ri(e))})}havingRef(e,t,n){return new Ts({...this.#t,queryNode:fo.cloneWithHaving(this.#t.queryNode,ji(e,t,n))})}select(e){return new Ts({...this.#t,queryNode:fo.cloneWithSelections(this.#t.queryNode,no(e))})}distinctOn(e){return new Ts({...this.#t,queryNode:fo.cloneWithDistinctOn(this.#t.queryNode,Wi(e))})}modifyFront(e){return new Ts({...this.#t,queryNode:fo.cloneWithFrontModifier(this.#t.queryNode,ti.createWithExpression(e.toOperationNode()))})}modifyEnd(e){return new Ts({...this.#t,queryNode:fo.cloneWithEndModifier(this.#t.queryNode,ti.createWithExpression(e.toOperationNode()))})}distinct(){return new Ts({...this.#t,queryNode:fo.cloneWithFrontModifier(this.#t.queryNode,ti.create("Distinct"))})}forUpdate(e){return new Ts({...this.#t,queryNode:fo.cloneWithEndModifier(this.#t.queryNode,ti.create("ForUpdate",e?Rr(e).map(aa):void 0))})}forShare(e){return new Ts({...this.#t,queryNode:fo.cloneWithEndModifier(this.#t.queryNode,ti.create("ForShare",e?Rr(e).map(aa):void 0))})}forKeyShare(e){return new Ts({...this.#t,queryNode:fo.cloneWithEndModifier(this.#t.queryNode,ti.create("ForKeyShare",e?Rr(e).map(aa):void 0))})}forNoKeyUpdate(e){return new Ts({...this.#t,queryNode:fo.cloneWithEndModifier(this.#t.queryNode,ti.create("ForNoKeyUpdate",e?Rr(e).map(aa):void 0))})}skipLocked(){return new Ts({...this.#t,queryNode:fo.cloneWithEndModifier(this.#t.queryNode,ti.create("SkipLocked"))})}noWait(){return new Ts({...this.#t,queryNode:fo.cloneWithEndModifier(this.#t.queryNode,ti.create("NoWait"))})}selectAll(e){return new Ts({...this.#t,queryNode:fo.cloneWithSelections(this.#t.queryNode,io(e))})}innerJoin(...e){return new Ts({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("InnerJoin",e))})}leftJoin(...e){return new Ts({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("LeftJoin",e))})}rightJoin(...e){return new Ts({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("RightJoin",e))})}fullJoin(...e){return new Ts({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("FullJoin",e))})}innerJoinLateral(...e){return new Ts({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("LateralInnerJoin",e))})}leftJoinLateral(...e){return new Ts({...this.#t,queryNode:ko.cloneWithJoin(this.#t.queryNode,gs("LateralLeftJoin",e))})}orderBy(...e){return new Ts({...this.#t,queryNode:fo.cloneWithOrderByItems(this.#t.queryNode,Ni(e))})}groupBy(e){return new Ts({...this.#t,queryNode:fo.cloneWithGroupByItems(this.#t.queryNode,bs(e))})}limit(e){return new Ts({...this.#t,queryNode:fo.cloneWithLimit(this.#t.queryNode,Ro.create(Li(e)))})}offset(e){return new Ts({...this.#t,queryNode:fo.cloneWithOffset(this.#t.queryNode,ws.create(Li(e)))})}fetch(e,t="only"){return new Ts({...this.#t,queryNode:fo.cloneWithFetch(this.#t.queryNode,qs(e,t))})}top(e,t){return new Ts({...this.#t,queryNode:ko.cloneWithTop(this.#t.queryNode,Bo(e,t))})}union(e){return new Ts({...this.#t,queryNode:fo.cloneWithSetOperations(this.#t.queryNode,xs("union",e,!1))})}unionAll(e){return new Ts({...this.#t,queryNode:fo.cloneWithSetOperations(this.#t.queryNode,xs("union",e,!0))})}intersect(e){return new Ts({...this.#t,queryNode:fo.cloneWithSetOperations(this.#t.queryNode,xs("intersect",e,!1))})}intersectAll(e){return new Ts({...this.#t,queryNode:fo.cloneWithSetOperations(this.#t.queryNode,xs("intersect",e,!0))})}except(e){return new Ts({...this.#t,queryNode:fo.cloneWithSetOperations(this.#t.queryNode,xs("except",e,!1))})}exceptAll(e){return new Ts({...this.#t,queryNode:fo.cloneWithSetOperations(this.#t.queryNode,xs("except",e,!0))})}as(e){return new Cs(this,e)}clearSelect(){return new Ts({...this.#t,queryNode:fo.cloneWithoutSelections(this.#t.queryNode)})}clearWhere(){return new Ts({...this.#t,queryNode:ko.cloneWithoutWhere(this.#t.queryNode)})}clearLimit(){return new Ts({...this.#t,queryNode:fo.cloneWithoutLimit(this.#t.queryNode)})}clearOffset(){return new Ts({...this.#t,queryNode:fo.cloneWithoutOffset(this.#t.queryNode)})}clearOrderBy(){return new Ts({...this.#t,queryNode:fo.cloneWithoutOrderBy(this.#t.queryNode)})}$call(e){return e(this)}$if(e,t){return e?t(this):new Ts({...this.#t})}$castTo(){return new Ts(this.#t)}$narrowType(){return new Ts(this.#t)}$assertType(){return new Ts(this.#t)}$asTuple(){return new ks(this.toOperationNode())}withPlugin(e){return new Ts({...this.#t,executor:this.#t.executor.withPlugin(e)})}toOperationNode(){return this.#t.executor.transformQuery(this.#t.queryNode,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){const e=this.compile();return(await this.#t.executor.executeQuery(e,this.#t.queryId)).rows}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=To){const t=await this.executeTakeFirst();if(void 0===t)throw Eo(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async*stream(e=100){const t=this.compile(),n=this.#t.executor.stream(t,e,this.#t.queryId);for await(const e of n)yield*e.rows}async explain(e,t){const n=new Ts({...this.#t,queryNode:ko.cloneWithExplain(this.#t.queryNode,e,t)});return await n.execute()}}function Es(e){return new Ts(e)}Hi(Ts,"don't await SelectQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");class Cs{#S;#k;constructor(e,t){this.#S=e,this.#k=t}get expression(){return this.#S}get alias(){return this.#k}get isAliasedSelectQueryBuilder(){return!0}toOperationNode(){return Gr.create(this.#S.toOperationNode(),$r.create(this.#k))}}Hi(Cs,"don't await AliasedSelectQueryBuilder instances directly. AliasedSelectQueryBuilder should never be executed directly since it's always a part of another query.");const As=Fr({is:e=>"AggregateFunctionNode"===e.kind,create:(e,t=[])=>Fr({kind:"AggregateFunctionNode",func:e,aggregated:t}),cloneWithDistinct:e=>Fr({...e,distinct:!0}),cloneWithFilter:(e,t)=>Fr({...e,filter:e.filter?wo.cloneWithOperation(e.filter,"And",t):wo.create(t)}),cloneWithOrFilter:(e,t)=>Fr({...e,filter:e.filter?wo.cloneWithOperation(e.filter,"Or",t):wo.create(t)}),cloneWithOver:(e,t)=>Fr({...e,over:t})}),Ds=Fr({is:e=>"FunctionNode"===e.kind,create:(e,t)=>Fr({kind:"FunctionNode",func:e,arguments:t})});class Ps{#t;constructor(e){this.#t=Fr(e)}get expressionType(){}as(e){return new Ls(this,e)}distinct(){return new Ps({...this.#t,aggregateFunctionNode:As.cloneWithDistinct(this.#t.aggregateFunctionNode)})}filterWhere(...e){return new Ps({...this.#t,aggregateFunctionNode:As.cloneWithFilter(this.#t.aggregateFunctionNode,Ri(e))})}filterWhereRef(e,t,n){return new Ps({...this.#t,aggregateFunctionNode:As.cloneWithFilter(this.#t.aggregateFunctionNode,ji(e,t,n))})}over(e){const t=new eo({overNode:zi.create()});return new Ps({...this.#t,aggregateFunctionNode:As.cloneWithOver(this.#t.aggregateFunctionNode,(e?e(t):t).toOperationNode())})}$call(e){return e(this)}$castTo(){return new Ps(this.#t)}$notNull(){return new Ps(this.#t)}toOperationNode(){return this.#t.aggregateFunctionNode}}Hi(Ps,"don't await AggregateFunctionBuilder instances. They are never executed directly and are always just a part of a query.");class Ls{#O;#k;constructor(e,t){this.#O=e,this.#k=t}get expression(){return this.#O}get alias(){return this.#k}toOperationNode(){return Gr.create(this.#O.toOperationNode(),$r.create(this.#k))}}function Bs(){const e=(e,t)=>new ks(Ds.create(e,Wi(t??[]))),t=(e,t)=>new Ps({aggregateFunctionNode:As.create(e,t?Wi(t):void 0)});return Object.assign(e,{agg:t,avg:e=>t("avg",[e]),coalesce:(...t)=>e("coalesce",t),count:e=>t("count",[e]),countAll:e=>new Ps({aggregateFunctionNode:As.create("count",io(e))}),max:e=>t("max",[e]),min:e=>t("min",[e]),sum:e=>t("sum",[e]),any:t=>e("any",[t]),jsonAgg:e=>new Ps({aggregateFunctionNode:As.create("json_agg",[Cr(e)?aa(e):e.toOperationNode()])}),toJson:e=>new ks(Ds.create("to_json",[Cr(e)?aa(e):e.toOperationNode()]))})}const Ms=Fr({is:e=>"UnaryOperationNode"===e.kind,create:(e,t)=>Fr({kind:"UnaryOperationNode",operator:e,operand:t})});const Fs=Fr({is:e=>"CaseNode"===e.kind,create:e=>Fr({kind:"CaseNode",value:e}),cloneWithWhen:(e,t)=>Fr({...e,when:Fr(e.when?[...e.when,t]:[t])}),cloneWithThen:(e,t)=>Fr({...e,when:e.when?Fr([...e.when.slice(0,-1),vo.cloneWithResult(e.when[e.when.length-1],t)]):void 0}),cloneWith:(e,t)=>Fr({...e,...t})});class Rs{#t;constructor(e){this.#t=Fr(e)}when(...e){return new Us({...this.#t,node:Fs.cloneWithWhen(this.#t.node,vo.create(Ri(e)))})}}class Us{#t;constructor(e){this.#t=Fr(e)}then(e){return new js({...this.#t,node:Fs.cloneWithThen(this.#t.node,Bi(e)?Mi(e):Li(e))})}}class js{#t;constructor(e){this.#t=Fr(e)}when(...e){return new Us({...this.#t,node:Fs.cloneWithWhen(this.#t.node,vo.create(Ri(e)))})}else(e){return new _s({...this.#t,node:Fs.cloneWith(this.#t.node,{else:Bi(e)?Mi(e):Li(e)})})}end(){return new ks(Fs.cloneWith(this.#t.node,{isStatement:!1}))}endCase(){return new ks(Fs.cloneWith(this.#t.node,{isStatement:!0}))}}class _s{#t;constructor(e){this.#t=Fr(e)}end(){return new ks(Fs.cloneWith(this.#t.node,{isStatement:!1}))}endCase(){return new ks(Fs.cloneWith(this.#t.node,{isStatement:!0}))}}const $s=Fr({is:e=>"JSONPathLegNode"===e.kind,create:(e,t)=>Fr({kind:"JSONPathLegNode",type:e,value:t})});class Qs{#v;constructor(e){this.#v=e}at(e){return this.#W("ArrayLocation",e)}key(e){return this.#W("Member",e)}#W(e,t){return xi.is(this.#v)?new Js(xi.cloneWithTraversal(this.#v,Si.is(this.#v.traversal)?Si.cloneWithLeg(this.#v.traversal,$s.create(e,t)):ki.cloneWithValue(this.#v.traversal,Pi.createImmediate(t)))):new Js(Si.cloneWithLeg(this.#v,$s.create(e,t)))}}class Js extends Qs{#v;constructor(e){super(e),this.#v=e}get expressionType(){}as(e){return new Ks(this,e)}$castTo(){return new Qs(this.#v)}$notNull(){return new Qs(this.#v)}toOperationNode(){return this.#v}}class Ks{#I;#k;constructor(e,t){this.#I=e,this.#k=t}get expression(){return this.#I}get alias(){return this.#k}toOperationNode(){return Gr.create(this.#I.toOperationNode(),ei(this.#k)?this.#k.toOperationNode():$r.create(this.#k))}}const Ys=Fr({is:e=>"TupleNode"===e.kind,create:e=>Fr({kind:"TupleNode",values:Fr(e)})}),Vs=["varchar","char","text","integer","int2","int4","int8","smallint","bigint","boolean","real","double precision","float4","float8","decimal","numeric","binary","bytea","date","datetime","time","timetz","timestamp","timestamptz","serial","bigserial","uuid","json","jsonb","blob"],zs=[/^varchar\(\d+\)$/,/^char\(\d+\)$/,/^decimal\(\d+, \d+\)$/,/^numeric\(\d+, \d+\)$/,/^binary\(\d+\)$/,/^datetime\(\d+\)$/,/^time\(\d+\)$/,/^timez\(\d+\)$/,/^timestamp\(\d+\)$/,/^timestamptz\(\d+\)$/],Hs=Fr({is:e=>"DataTypeNode"===e.kind,create:e=>Fr({kind:"DataTypeNode",dataType:e})});function Xs(e){if(ei(e))return e.toOperationNode();if(function(e){return!!Vs.includes(e)||!!zs.some((t=>t.test(e)))}(e))return Hs.create(e);throw new Error(`invalid column data type ${JSON.stringify(e)}`)}const Gs=Fr({is:e=>"CastNode"===e.kind,create:(e,t)=>Fr({kind:"CastNode",expression:e,dataType:t})});function Zs(e=ls){function t(e,t){return new ks((n=e,r=t,Ms.create(di.create(n),Ii(r))));var n,r}const n=Object.assign((function(e,t,n){return new ks(Ui(e,t,n))}),{fn:void 0,eb:void 0,selectFrom:t=>Es({queryId:Ho(),executor:e,queryNode:fo.createFrom(ia(t))}),case:e=>new Rs({node:Fs.create(Er(e)?void 0:Ii(e))}),ref:(e,t)=>Er(t)?new ks(qi(e)):new Qs(function(e,t){const n=qi(e);if(li(t))return xi.create(n,ki.create(di.create(t)));const r=t.slice(0,-1);if(li(r))return xi.create(n,Si.create(di.create(r)));throw new Error(`Invalid JSON operator: ${t}`)}(e,t)),jsonPath:()=>new Qs(Si.create()),table:e=>new ks(aa(e)),val:e=>new ks(Li(e)),refTuple:(...e)=>new ks(Ys.create(e.map(Ii))),tuple:(...e)=>new ks(Ys.create(e.map(Li))),lit:e=>new ks(Mi(e)),unary:t,not:e=>t("not",e),exists:e=>t("exists",e),neg:e=>t("-",e),between:(e,t,n)=>new ks(si.create(Ii(e),di.create("between"),ni.create(Li(t),Li(n)))),betweenSymmetric:(e,t,n)=>new ks(si.create(Ii(e),di.create("between symmetric"),ni.create(Li(t),Li(n)))),and:e=>Ur(e)?new ks($i(e,"and")):new ks(_i(e,"and")),or:e=>Ur(e)?new ks($i(e,"or")):new ks(_i(e,"or")),parens(...e){const t=Ri(e);return Fi.is(t)?new ks(t):new ks(Fi.create(t))},cast:(e,t)=>new ks(Gs.create(Ii(e),Xs(t))),withSchema:t=>Zs(e.withPluginAtFront(new ts(t)))});return n.fn=Bs(),n.eb=n,n}function ea(e){return Zs()}function ta(e){if(ei(e))return e.toOperationNode();if(Br(e))return e(ea()).toOperationNode();throw new Error(`invalid expression: ${JSON.stringify(e)}`)}function na(e){if(ei(e))return e.toOperationNode();if(Br(e))return e(ea()).toOperationNode();throw new Error(`invalid aliased expression: ${JSON.stringify(e)}`)}function ra(e){return function(e){return Mr(e)&&"expressionType"in e&&ei(e)}(e)||function(e){return Mr(e)&&"expression"in e&&Cr(e.alias)&&ei(e)}(e)||Br(e)}function ia(e){return Ur(e)?e.map((e=>oa(e))):[oa(e)]}function oa(e){return Cr(e)?sa(e):na(e)}function sa(e){const t=" as ";if(e.includes(t)){const[n,r]=e.split(t).map(ca);return Gr.create(aa(n),$r.create(r))}return aa(e)}function aa(e){if(e.includes(".")){const[t,n]=e.split(".").map(ca);return Zr.createWithSchema(t,n)}return Zr.create(e)}function ca(e){return e.trim()}const da=Fr({is:e=>"AddColumnNode"===e.kind,create:e=>Fr({kind:"AddColumnNode",column:e})}),la=Fr({is:e=>"ColumnDefinitionNode"===e.kind,create:(e,t)=>Fr({kind:"ColumnDefinitionNode",column:ui.create(e),dataType:t}),cloneWithFrontModifier:(e,t)=>Fr({...e,frontModifiers:e.frontModifiers?Fr([...e.frontModifiers,t]):[t]}),cloneWithEndModifier:(e,t)=>Fr({...e,endModifiers:e.endModifiers?Fr([...e.endModifiers,t]):[t]}),cloneWith:(e,t)=>Fr({...e,...t})}),ua=Fr({is:e=>"DropColumnNode"===e.kind,create:e=>Fr({kind:"DropColumnNode",column:ui.create(e)})}),pa=Fr({is:e=>"RenameColumnNode"===e.kind,create:(e,t)=>Fr({kind:"RenameColumnNode",column:ui.create(e),renameTo:ui.create(t)})}),ha=Fr({is:e=>"CheckConstraintNode"===e.kind,create:(e,t)=>Fr({kind:"CheckConstraintNode",expression:e,name:t?$r.create(t):void 0})}),fa=["no action","restrict","cascade","set null","set default"],ma=Fr({is:e=>"ReferencesNode"===e.kind,create:(e,t)=>Fr({kind:"ReferencesNode",table:e,columns:Fr([...t])}),cloneWithOnDelete:(e,t)=>Fr({...e,onDelete:t}),cloneWithOnUpdate:(e,t)=>Fr({...e,onUpdate:t})});function ya(e){return ei(e)?e.toOperationNode():Pi.createImmediate(e)}const ga=Fr({is:e=>"GeneratedNode"===e.kind,create:e=>Fr({kind:"GeneratedNode",...e}),createWithExpression:e=>Fr({kind:"GeneratedNode",always:!0,expression:e}),cloneWith:(e,t)=>Fr({...e,...t})}),wa=Fr({is:e=>"DefaultValueNode"===e.kind,create:e=>Fr({kind:"DefaultValueNode",defaultValue:e})});function Na(e){if(fa.includes(e))return e;throw new Error(`invalid OnModifyForeignAction ${e}`)}class ba{#v;constructor(e){this.#v=e}autoIncrement(){return new ba(la.cloneWith(this.#v,{autoIncrement:!0}))}identity(){return new ba(la.cloneWith(this.#v,{identity:!0}))}primaryKey(){return new ba(la.cloneWith(this.#v,{primaryKey:!0}))}references(e){const t=qi(e);if(!t.table||pi.is(t.column))throw new Error(`invalid call references('${e}'). The reference must have format table.column or schema.table.column`);return new ba(la.cloneWith(this.#v,{references:ma.create(t.table,[t.column])}))}onDelete(e){if(!this.#v.references)throw new Error("on delete constraint can only be added for foreign keys");return new ba(la.cloneWith(this.#v,{references:ma.cloneWithOnDelete(this.#v.references,Na(e))}))}onUpdate(e){if(!this.#v.references)throw new Error("on update constraint can only be added for foreign keys");return new ba(la.cloneWith(this.#v,{references:ma.cloneWithOnUpdate(this.#v.references,Na(e))}))}unique(){return new ba(la.cloneWith(this.#v,{unique:!0}))}notNull(){return new ba(la.cloneWith(this.#v,{notNull:!0}))}unsigned(){return new ba(la.cloneWith(this.#v,{unsigned:!0}))}defaultTo(e){return new ba(la.cloneWith(this.#v,{defaultTo:wa.create(ya(e))}))}check(e){return new ba(la.cloneWith(this.#v,{check:ha.create(e.toOperationNode())}))}generatedAlwaysAs(e){return new ba(la.cloneWith(this.#v,{generated:ga.createWithExpression(e.toOperationNode())}))}generatedAlwaysAsIdentity(){return new ba(la.cloneWith(this.#v,{generated:ga.create({identity:!0,always:!0})}))}generatedByDefaultAsIdentity(){return new ba(la.cloneWith(this.#v,{generated:ga.create({identity:!0,byDefault:!0})}))}stored(){if(!this.#v.generated)throw new Error("stored() can only be called after generatedAlwaysAs");return new ba(la.cloneWith(this.#v,{generated:ga.cloneWith(this.#v.generated,{stored:!0})}))}modifyFront(e){return new ba(la.cloneWithFrontModifier(this.#v,e.toOperationNode()))}nullsNotDistinct(){return new ba(la.cloneWith(this.#v,{nullsNotDistinct:!0}))}modifyEnd(e){return new ba(la.cloneWithEndModifier(this.#v,e.toOperationNode()))}$call(e){return e(this)}toOperationNode(){return this.#v}}Hi(ba,"don't await ColumnDefinitionBuilder instances directly.");const va=Fr({is:e=>"ModifyColumnNode"===e.kind,create:e=>Fr({kind:"ModifyColumnNode",column:e})}),xa=Fr({is:e=>"ForeignKeyConstraintNode"===e.kind,create:(e,t,n,r)=>Fr({kind:"ForeignKeyConstraintNode",columns:e,references:ma.create(t,n),name:r?$r.create(r):void 0}),cloneWith:(e,t)=>Fr({...e,...t})});class ka{#v;constructor(e){this.#v=e}onDelete(e){return new ka(xa.cloneWith(this.#v,{onDelete:Na(e)}))}onUpdate(e){return new ka(xa.cloneWith(this.#v,{onUpdate:Na(e)}))}$call(e){return e(this)}toOperationNode(){return this.#v}}Hi(ka,"don't await ForeignKeyConstraintBuilder instances directly.");const Sa=Fr({is:e=>"AddConstraintNode"===e.kind,create:e=>Fr({kind:"AddConstraintNode",constraint:e})}),Oa=Fr({is:e=>"UniqueConstraintNode"===e.kind,create:(e,t,n)=>Fr({kind:"UniqueConstraintNode",columns:Fr(e.map(ui.create)),name:t?$r.create(t):void 0,nullsNotDistinct:n}),cloneWith:(e,t)=>Fr({...e,...t})}),Wa=Fr({is:e=>"DropConstraintNode"===e.kind,create:e=>Fr({kind:"DropConstraintNode",constraintName:$r.create(e)}),cloneWith:(e,t)=>Fr({...e,...t})}),Ia=Fr({is:e=>"AlterColumnNode"===e.kind,create:(e,t,n)=>Fr({kind:"AlterColumnNode",column:ui.create(e),[t]:n})});class qa{#q;constructor(e){this.#q=e}setDataType(e){return new Ta(Ia.create(this.#q,"dataType",Xs(e)))}setDefault(e){return new Ta(Ia.create(this.#q,"setDefault",ya(e)))}dropDefault(){return new Ta(Ia.create(this.#q,"dropDefault",!0))}setNotNull(){return new Ta(Ia.create(this.#q,"setNotNull",!0))}dropNotNull(){return new Ta(Ia.create(this.#q,"dropNotNull",!0))}$call(e){return e(this)}}class Ta{#T;constructor(e){this.#T=e}toOperationNode(){return this.#T}}class Ea{#t;constructor(e){this.#t=Fr(e)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}Hi(Ea,"don't await AlterTableExecutor instances directly. To execute the query you need to call `execute`");class Ca{#t;constructor(e){this.#t=Fr(e)}onDelete(e){return new Ca({...this.#t,constraintBuilder:this.#t.constraintBuilder.onDelete(e)})}onUpdate(e){return new Ca({...this.#t,constraintBuilder:this.#t.constraintBuilder.onUpdate(e)})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(_r.cloneWithTableProps(this.#t.node,{addConstraint:Sa.create(this.#t.constraintBuilder.toOperationNode())}),this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}Hi(Ca,"don't await AlterTableAddForeignKeyConstraintBuilder instances directly. To execute the query you need to call `execute`");class Aa{#t;constructor(e){this.#t=Fr(e)}ifExists(){return new Aa({...this.#t,node:_r.cloneWithTableProps(this.#t.node,{dropConstraint:Wa.cloneWith(this.#t.node.dropConstraint,{ifExists:!0})})})}cascade(){return new Aa({...this.#t,node:_r.cloneWithTableProps(this.#t.node,{dropConstraint:Wa.cloneWith(this.#t.node.dropConstraint,{modifier:"cascade"})})})}restrict(){return new Aa({...this.#t,node:_r.cloneWithTableProps(this.#t.node,{dropConstraint:Wa.cloneWith(this.#t.node.dropConstraint,{modifier:"restrict"})})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}Hi(Aa,"don't await AlterTableDropConstraintBuilder instances directly. To execute the query you need to call `execute`");const Da=Fr({is:e=>"PrimaryKeyConstraintNode"===e.kind,create:(e,t)=>Fr({kind:"PrimaryKeyConstraintNode",columns:Fr(e.map(ui.create)),name:t?$r.create(t):void 0})}),Pa=Fr({is:e=>"AddIndexNode"===e.kind,create:e=>Fr({kind:"AddIndexNode",name:$r.create(e)}),cloneWith:(e,t)=>Fr({...e,...t}),cloneWithColumns:(e,t)=>Fr({...e,columns:[...e.columns||[],...t]})});class La{#t;constructor(e){this.#t=Fr(e)}unique(){return new La({...this.#t,node:_r.cloneWithTableProps(this.#t.node,{addIndex:Pa.cloneWith(this.#t.node.addIndex,{unique:!0})})})}column(e){return new La({...this.#t,node:_r.cloneWithTableProps(this.#t.node,{addIndex:Pa.cloneWithColumns(this.#t.node.addIndex,[Ei(e)])})})}columns(e){return new La({...this.#t,node:_r.cloneWithTableProps(this.#t.node,{addIndex:Pa.cloneWithColumns(this.#t.node.addIndex,e.map(Ei))})})}expression(e){return new La({...this.#t,node:_r.cloneWithTableProps(this.#t.node,{addIndex:Pa.cloneWithColumns(this.#t.node.addIndex,[e.toOperationNode()])})})}using(e){return new La({...this.#t,node:_r.cloneWithTableProps(this.#t.node,{addIndex:Pa.cloneWith(this.#t.node.addIndex,{using:gi.createWithSql(e)})})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}Hi(La,"don't await AlterTableAddIndexBuilder instances directly. To execute the query you need to call `execute`");class Ba{#v;constructor(e){this.#v=e}toOperationNode(){return this.#v}nullsNotDistinct(){return new Ba(Oa.cloneWith(this.#v,{nullsNotDistinct:!0}))}}Hi(Ba,"don't await UniqueConstraintNodeBuilder instances directly.");class Ma{#t;constructor(e){this.#t=Fr(e)}renameTo(e){return new Ea({...this.#t,node:_r.cloneWithTableProps(this.#t.node,{renameTo:aa(e)})})}setSchema(e){return new Ea({...this.#t,node:_r.cloneWithTableProps(this.#t.node,{setSchema:$r.create(e)})})}alterColumn(e,t){const n=t(new qa(e));return new Fa({...this.#t,node:_r.cloneWithColumnAlteration(this.#t.node,n.toOperationNode())})}dropColumn(e){return new Fa({...this.#t,node:_r.cloneWithColumnAlteration(this.#t.node,ua.create(e))})}renameColumn(e,t){return new Fa({...this.#t,node:_r.cloneWithColumnAlteration(this.#t.node,pa.create(e,t))})}addColumn(e,t,n=jr){const r=n(new ba(la.create(e,Xs(t))));return new Fa({...this.#t,node:_r.cloneWithColumnAlteration(this.#t.node,da.create(r.toOperationNode()))})}modifyColumn(e,t,n=jr){const r=n(new ba(la.create(e,Xs(t))));return new Fa({...this.#t,node:_r.cloneWithColumnAlteration(this.#t.node,va.create(r.toOperationNode()))})}addUniqueConstraint(e,t,n=jr){const r=n(new Ba(Oa.create(t,e)));return new Ea({...this.#t,node:_r.cloneWithTableProps(this.#t.node,{addConstraint:Sa.create(r.toOperationNode())})})}addCheckConstraint(e,t){return new Ea({...this.#t,node:_r.cloneWithTableProps(this.#t.node,{addConstraint:Sa.create(ha.create(t.toOperationNode(),e))})})}addForeignKeyConstraint(e,t,n,r){return new Ca({...this.#t,constraintBuilder:new ka(xa.create(t.map(ui.create),aa(n),r.map(ui.create),e))})}addPrimaryKeyConstraint(e,t){return new Ea({...this.#t,node:_r.cloneWithTableProps(this.#t.node,{addConstraint:Sa.create(Da.create(t,e))})})}dropConstraint(e){return new Aa({...this.#t,node:_r.cloneWithTableProps(this.#t.node,{dropConstraint:Wa.create(e)})})}addIndex(e){return new La({...this.#t,node:_r.cloneWithTableProps(this.#t.node,{addIndex:Pa.create(e)})})}dropIndex(e){return new Ea({...this.#t,node:_r.cloneWithTableProps(this.#t.node,{dropIndex:zr.create(e)})})}$call(e){return e(this)}}class Fa{#t;constructor(e){this.#t=Fr(e)}alterColumn(e,t){const n=t(new qa(e));return new Fa({...this.#t,node:_r.cloneWithColumnAlteration(this.#t.node,n.toOperationNode())})}dropColumn(e){return new Fa({...this.#t,node:_r.cloneWithColumnAlteration(this.#t.node,ua.create(e))})}renameColumn(e,t){return new Fa({...this.#t,node:_r.cloneWithColumnAlteration(this.#t.node,pa.create(e,t))})}addColumn(e,t,n=jr){const r=n(new ba(la.create(e,Xs(t))));return new Fa({...this.#t,node:_r.cloneWithColumnAlteration(this.#t.node,da.create(r.toOperationNode()))})}modifyColumn(e,t,n=jr){const r=n(new ba(la.create(e,Xs(t))));return new Fa({...this.#t,node:_r.cloneWithColumnAlteration(this.#t.node,va.create(r.toOperationNode()))})}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}Hi(Ma,"don't await AlterTableBuilder instances"),Hi(qa,"don't await AlterColumnBuilder instances"),Hi(Fa,"don't await AlterTableColumnAlteringBuilder instances directly. To execute the query you need to call `execute`");class Ra extends Go{transformValue(e){return{...super.transformValue(e),immediate:!0}}}class Ua{#t;constructor(e){this.#t=Fr(e)}ifNotExists(){return new Ua({...this.#t,node:Qr.cloneWith(this.#t.node,{ifNotExists:!0})})}unique(){return new Ua({...this.#t,node:Qr.cloneWith(this.#t.node,{unique:!0})})}nullsNotDistinct(){return new Ua({...this.#t,node:Qr.cloneWith(this.#t.node,{nullsNotDistinct:!0})})}on(e){return new Ua({...this.#t,node:Qr.cloneWith(this.#t.node,{table:aa(e)})})}column(e){return new Ua({...this.#t,node:Qr.cloneWithColumns(this.#t.node,[Ei(e)])})}columns(e){return new Ua({...this.#t,node:Qr.cloneWithColumns(this.#t.node,e.map(Ei))})}expression(e){return new Ua({...this.#t,node:Qr.cloneWithColumns(this.#t.node,[e.toOperationNode()])})}using(e){return new Ua({...this.#t,node:Qr.cloneWith(this.#t.node,{using:gi.createWithSql(e)})})}where(...e){const t=new Ra;return new Ua({...this.#t,node:ko.cloneWithWhere(this.#t.node,t.transformNode(Ri(e)))})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}Hi(Ua,"don't await CreateIndexBuilder instances directly. To execute the query you need to call `execute`");class ja{#t;constructor(e){this.#t=Fr(e)}ifNotExists(){return new ja({...this.#t,node:Jr.cloneWith(this.#t.node,{ifNotExists:!0})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}function _a(e){if(Kr.includes(e))return e;throw new Error(`invalid OnCommitAction ${e}`)}Hi(ja,"don't await CreateSchemaBuilder instances directly. To execute the query you need to call `execute`");class $a{#t;constructor(e){this.#t=Fr(e)}temporary(){return new $a({...this.#t,node:Yr.cloneWith(this.#t.node,{temporary:!0})})}onCommit(e){return new $a({...this.#t,node:Yr.cloneWith(this.#t.node,{onCommit:_a(e)})})}ifNotExists(){return new $a({...this.#t,node:Yr.cloneWith(this.#t.node,{ifNotExists:!0})})}addColumn(e,t,n=jr){const r=n(new ba(la.create(e,Xs(t))));return new $a({...this.#t,node:Yr.cloneWithColumn(this.#t.node,r.toOperationNode())})}addPrimaryKeyConstraint(e,t){return new $a({...this.#t,node:Yr.cloneWithConstraint(this.#t.node,Da.create(t,e))})}addUniqueConstraint(e,t,n=jr){const r=n(new Ba(Oa.create(t,e)));return new $a({...this.#t,node:Yr.cloneWithConstraint(this.#t.node,r.toOperationNode())})}addCheckConstraint(e,t){return new $a({...this.#t,node:Yr.cloneWithConstraint(this.#t.node,ha.create(t.toOperationNode(),e))})}addForeignKeyConstraint(e,t,n,r,i=jr){const o=i(new ka(xa.create(t.map(ui.create),aa(n),r.map(ui.create),e)));return new $a({...this.#t,node:Yr.cloneWithConstraint(this.#t.node,o.toOperationNode())})}modifyFront(e){return new $a({...this.#t,node:Yr.cloneWithFrontModifier(this.#t.node,e.toOperationNode())})}modifyEnd(e){return new $a({...this.#t,node:Yr.cloneWithEndModifier(this.#t.node,e.toOperationNode())})}as(e){return new $a({...this.#t,node:Yr.cloneWith(this.#t.node,{selectQuery:ta(e)})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}Hi($a,"don't await CreateTableBuilder instances directly. To execute the query you need to call `execute`");class Qa{#t;constructor(e){this.#t=Fr(e)}on(e){return new Qa({...this.#t,node:zr.cloneWith(this.#t.node,{table:aa(e)})})}ifExists(){return new Qa({...this.#t,node:zr.cloneWith(this.#t.node,{ifExists:!0})})}cascade(){return new Qa({...this.#t,node:zr.cloneWith(this.#t.node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}Hi(Qa,"don't await DropIndexBuilder instances directly. To execute the query you need to call `execute`");class Ja{#t;constructor(e){this.#t=Fr(e)}ifExists(){return new Ja({...this.#t,node:Hr.cloneWith(this.#t.node,{ifExists:!0})})}cascade(){return new Ja({...this.#t,node:Hr.cloneWith(this.#t.node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}Hi(Ja,"don't await DropSchemaBuilder instances directly. To execute the query you need to call `execute`");class Ka{#t;constructor(e){this.#t=Fr(e)}ifExists(){return new Ka({...this.#t,node:Xr.cloneWith(this.#t.node,{ifExists:!0})})}cascade(){return new Ka({...this.#t,node:Xr.cloneWith(this.#t.node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}Hi(Ka,"don't await DropTableBuilder instances directly. To execute the query you need to call `execute`");const Ya=Fr({is:e=>"CreateViewNode"===e.kind,create:e=>Fr({kind:"CreateViewNode",name:Vr.create(e)}),cloneWith:(e,t)=>Fr({...e,...t})});class Va{#h=new Ra;transformQuery(e){return this.#h.transformNode(e.node)}transformResult(e){return Promise.resolve(e.result)}}class za{#t;constructor(e){this.#t=Fr(e)}temporary(){return new za({...this.#t,node:Ya.cloneWith(this.#t.node,{temporary:!0})})}materialized(){return new za({...this.#t,node:Ya.cloneWith(this.#t.node,{materialized:!0})})}ifNotExists(){return new za({...this.#t,node:Ya.cloneWith(this.#t.node,{ifNotExists:!0})})}orReplace(){return new za({...this.#t,node:Ya.cloneWith(this.#t.node,{orReplace:!0})})}columns(e){return new za({...this.#t,node:Ya.cloneWith(this.#t.node,{columns:e.map(Ti)})})}as(e){const t=e.withPlugin(new Va).toOperationNode();return new za({...this.#t,node:Ya.cloneWith(this.#t.node,{as:t})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}Hi(za,"don't await CreateViewBuilder instances directly. To execute the query you need to call `execute`");const Ha=Fr({is:e=>"DropViewNode"===e.kind,create:e=>Fr({kind:"DropViewNode",name:Vr.create(e)}),cloneWith:(e,t)=>Fr({...e,...t})});class Xa{#t;constructor(e){this.#t=Fr(e)}materialized(){return new Xa({...this.#t,node:Ha.cloneWith(this.#t.node,{materialized:!0})})}ifExists(){return new Xa({...this.#t,node:Ha.cloneWith(this.#t.node,{ifExists:!0})})}cascade(){return new Xa({...this.#t,node:Ha.cloneWith(this.#t.node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}Hi(Xa,"don't await DropViewBuilder instances directly. To execute the query you need to call `execute`");const Ga=Fr({is:e=>"CreateTypeNode"===e.kind,create:e=>Fr({kind:"CreateTypeNode",name:e}),cloneWithEnum:(e,t)=>Fr({...e,enum:Di.create(t.map((e=>Pi.createImmediate(e))))})});class Za{#t;constructor(e){this.#t=Fr(e)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}asEnum(e){return new Za({...this.#t,node:Ga.cloneWithEnum(this.#t.node,e)})}$call(e){return e(this)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}Hi(Za,"don't await CreateTypeBuilder instances directly. To execute the query you need to call `execute`");const ec=Fr({is:e=>"DropTypeNode"===e.kind,create:e=>Fr({kind:"DropTypeNode",name:e}),cloneWith:(e,t)=>Fr({...e,...t})});class tc{#t;constructor(e){this.#t=Fr(e)}ifExists(){return new tc({...this.#t,node:ec.cloneWith(this.#t.node,{ifExists:!0})})}$call(e){return e(this)}toOperationNode(){return this.#t.executor.transformQuery(this.#t.node,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){await this.#t.executor.executeQuery(this.compile(),this.#t.queryId)}}function nc(e){if(e.includes(".")){const t=e.split(".").map(rc);if(2===t.length)return Vr.createWithSchema(t[0],t[1]);throw new Error(`invalid schemable identifier ${e}`)}return Vr.create(e)}function rc(e){return e.trim()}Hi(tc,"don't await DropTypeBuilder instances directly. To execute the query you need to call `execute`");class ic{#E;constructor(e){this.#E=e}createTable(e){return new $a({queryId:Ho(),executor:this.#E,node:Yr.create(aa(e))})}dropTable(e){return new Ka({queryId:Ho(),executor:this.#E,node:Xr.create(aa(e))})}createIndex(e){return new Ua({queryId:Ho(),executor:this.#E,node:Qr.create(e)})}dropIndex(e){return new Qa({queryId:Ho(),executor:this.#E,node:zr.create(e)})}createSchema(e){return new ja({queryId:Ho(),executor:this.#E,node:Jr.create(e)})}dropSchema(e){return new Ja({queryId:Ho(),executor:this.#E,node:Hr.create(e)})}alterTable(e){return new Ma({queryId:Ho(),executor:this.#E,node:_r.create(aa(e))})}createView(e){return new za({queryId:Ho(),executor:this.#E,node:Ya.create(e)})}dropView(e){return new Xa({queryId:Ho(),executor:this.#E,node:Ha.create(e)})}createType(e){return new Za({queryId:Ho(),executor:this.#E,node:Ga.create(nc(e))})}dropType(e){return new tc({queryId:Ho(),executor:this.#E,node:ec.create(nc(e))})}withPlugin(e){return new ic(this.#E.withPlugin(e))}withoutPlugins(){return new ic(this.#E.withoutPlugins())}withSchema(e){return new ic(this.#E.withPluginAtFront(new ts(e)))}}class oc{ref(e){return new fi(e)}}class sc{#C;constructor(e){this.#C=e}async provideConnection(e){const t=await this.#C.acquireConnection();try{return await e(t)}finally{await this.#C.releaseConnection(t)}}}class ac extends cs{#A;#D;#P;constructor(e,t,n,r=[]){super(r),this.#A=e,this.#D=t,this.#P=n}get adapter(){return this.#D}compileQuery(e){return this.#A.compileQuery(e)}provideConnection(e){return this.#P.provideConnection(e)}withPlugins(e){return new ac(this.#A,this.#D,this.#P,[...this.plugins,...e])}withPlugin(e){return new ac(this.#A,this.#D,this.#P,[...this.plugins,e])}withPluginAtFront(e){return new ac(this.#A,this.#D,this.#P,[e,...this.plugins])}withConnectionProvider(e){return new ac(this.#A,this.#D,e,[...this.plugins])}withoutPlugins(){return new ac(this.#A,this.#D,this.#P,[])}}function cc(){return"undefined"!=typeof performance&&Br(performance.now)?performance.now():Date.now()}class dc{#C;#L;#B;#M;#F;#R=new WeakSet;constructor(e,t){this.#M=!1,this.#C=e,this.#L=t}async init(){if(this.#F)throw new Error("driver has already been destroyed");this.#B||(this.#B=this.#C.init().then((()=>{this.#M=!0})).catch((e=>(this.#B=void 0,Promise.reject(e))))),await this.#B}async acquireConnection(){if(this.#F)throw new Error("driver has already been destroyed");this.#M||await this.init();const e=await this.#C.acquireConnection();return this.#R.has(e)||(this.#U()&&this.#j(e),this.#R.add(e)),e}async releaseConnection(e){await this.#C.releaseConnection(e)}beginTransaction(e,t){return this.#C.beginTransaction(e,t)}commitTransaction(e){return this.#C.commitTransaction(e)}rollbackTransaction(e){return this.#C.rollbackTransaction(e)}async destroy(){this.#B&&(await this.#B,this.#F||(this.#F=this.#C.destroy().catch((e=>(this.#F=void 0,Promise.reject(e))))),await this.#F)}#U(){return this.#L.isLevelEnabled("query")||this.#L.isLevelEnabled("error")}#j(e){const t=e.executeQuery;e.executeQuery=async n=>{let r;const i=cc();try{return await t.call(e,n)}catch(e){throw r=e,await this.#_(e,n,i),e}finally{r||await this.#$(n,i)}}}async#_(e,t,n){await this.#L.error((()=>({level:"error",error:e,query:t,queryDurationMillis:this.#Q(n)})))}async#$(e,t){await this.#L.query((()=>({level:"query",query:e,queryDurationMillis:this.#Q(t)})))}#Q(e){return cc()-e}}const lc=()=>{};class uc{#J;#K;constructor(e){this.#J=e}async provideConnection(e){for(;this.#K;)await this.#K.catch(lc);return this.#K=this.#Y(e).finally((()=>{this.#K=void 0})),this.#K}async#Y(e){return await e(this.#J)}}const pc=["read uncommitted","read committed","repeatable read","serializable","snapshot"];Fr(["query","error"]);class hc{#V;#z;constructor(e){Br(e)?(this.#z=e,this.#V=Fr({query:!0,error:!0})):(this.#z=fc,this.#V=Fr({query:e.includes("query"),error:e.includes("error")}))}isLevelEnabled(e){return this.#V[e]}async query(e){this.#V.query&&await this.#z(e())}async error(e){this.#V.error&&await this.#z(e())}}function fc(e){"query"===e.level?(console.log(`kysely:query: ${e.query.sql}`),console.log(`kysely:query: duration: ${e.queryDurationMillis.toFixed(1)}ms`)):"error"===e.level&&(e.error instanceof Error?console.error(`kysely:error: ${e.error.stack??e.error.message}`):console.error(`kysely:error: ${JSON.stringify({error:e.error,query:e.query.sql,queryDurationMillis:e.queryDurationMillis})}`))}class mc extends ys{#t;constructor(e){let t,n;if(Mr(r=e)&&Mr(r.config)&&Mr(r.driver)&&Mr(r.executor)&&Mr(r.dialect))t={executor:e.executor},n={...e};else{const r=e.dialect,i=r.createDriver(),o=r.createQueryCompiler(),s=r.createAdapter(),a=new hc(e.log??[]),c=new dc(i,a),d=new sc(c),l=new ac(o,s,d,e.plugins??[]);t={executor:l},n={config:e,executor:l,dialect:r,driver:c}}var r;super(t),this.#t=Fr(n)}get schema(){return new ic(this.#t.executor)}get dynamic(){return new oc}get introspection(){return this.#t.dialect.createIntrospector(this.withoutPlugins())}case(e){return new Rs({node:Fs.create(Er(e)?void 0:ta(e))})}get fn(){return Bs()}transaction(){return new wc({...this.#t})}connection(){return new gc({...this.#t})}withPlugin(e){return new mc({...this.#t,executor:this.#t.executor.withPlugin(e)})}withoutPlugins(){return new mc({...this.#t,executor:this.#t.executor.withoutPlugins()})}withSchema(e){return new mc({...this.#t,executor:this.#t.executor.withPluginAtFront(new ts(e))})}withTables(){return new mc({...this.#t})}async destroy(){await this.#t.driver.destroy()}get isTransaction(){return!1}getExecutor(){return this.#t.executor}executeQuery(e,t=Ho()){const n=Mr(r=e)&&Br(r.compile)?e.compile():e;var r;return this.getExecutor().executeQuery(n,t)}}class yc extends mc{#t;constructor(e){super(e),this.#t=e}get isTransaction(){return!0}transaction(){throw new Error("calling the transaction method for a Transaction is not supported")}connection(){throw new Error("calling the connection method for a Transaction is not supported")}async destroy(){throw new Error("calling the destroy method for a Transaction is not supported")}withPlugin(e){return new yc({...this.#t,executor:this.#t.executor.withPlugin(e)})}withoutPlugins(){return new yc({...this.#t,executor:this.#t.executor.withoutPlugins()})}withSchema(e){return new yc({...this.#t,executor:this.#t.executor.withPluginAtFront(new ts(e))})}withTables(){return new yc({...this.#t})}}class gc{#t;constructor(e){this.#t=Fr(e)}async execute(e){return this.#t.executor.provideConnection((async t=>{const n=this.#t.executor.withConnectionProvider(new uc(t)),r=new mc({...this.#t,executor:n});return await e(r)}))}}Hi(gc,"don't await ConnectionBuilder instances directly. To execute the query you need to call the `execute` method");class wc{#t;constructor(e){this.#t=Fr(e)}setIsolationLevel(e){return new wc({...this.#t,isolationLevel:e})}async execute(e){const{isolationLevel:t,...n}=this.#t,r={isolationLevel:t};return function(e){if(e.isolationLevel&&!pc.includes(e.isolationLevel))throw new Error(`invalid transaction isolation level ${e.isolationLevel}`)}(r),this.#t.executor.provideConnection((async t=>{const i=this.#t.executor.withConnectionProvider(new uc(t)),o=new yc({...n,executor:i});try{await this.#t.driver.beginTransaction(t,r);const n=await e(o);return await this.#t.driver.commitTransaction(t),n}catch(e){throw await this.#t.driver.rollbackTransaction(t),e}}))}}Hi(wc,"don't await TransactionBuilder instances directly. To execute the transaction you need to call the `execute` method");class Nc{get supportsCreateIfNotExists(){return!0}get supportsTransactionalDdl(){return!1}get supportsReturning(){return!1}}class bc extends Nc{get supportsTransactionalDdl(){return!1}get supportsReturning(){return!0}async acquireMigrationLock(e,t){}async releaseMigrationLock(e,t){}}class vc{async init(){}async acquireConnection(){return new xc}async beginTransaction(){}async commitTransaction(){}async rollbackTransaction(){}async releaseConnection(){}async destroy(){}}class xc{async executeQuery(){return{rows:[]}}async*streamQuery(){}}class kc{nodeStack=[];get parentNode(){return this.nodeStack[this.nodeStack.length-2]}#H=Fr({AliasNode:this.visitAlias.bind(this),ColumnNode:this.visitColumn.bind(this),IdentifierNode:this.visitIdentifier.bind(this),SchemableIdentifierNode:this.visitSchemableIdentifier.bind(this),RawNode:this.visitRaw.bind(this),ReferenceNode:this.visitReference.bind(this),SelectQueryNode:this.visitSelectQuery.bind(this),SelectionNode:this.visitSelection.bind(this),TableNode:this.visitTable.bind(this),FromNode:this.visitFrom.bind(this),SelectAllNode:this.visitSelectAll.bind(this),AndNode:this.visitAnd.bind(this),OrNode:this.visitOr.bind(this),ValueNode:this.visitValue.bind(this),ValueListNode:this.visitValueList.bind(this),PrimitiveValueListNode:this.visitPrimitiveValueList.bind(this),ParensNode:this.visitParens.bind(this),JoinNode:this.visitJoin.bind(this),OperatorNode:this.visitOperator.bind(this),WhereNode:this.visitWhere.bind(this),InsertQueryNode:this.visitInsertQuery.bind(this),DeleteQueryNode:this.visitDeleteQuery.bind(this),ReturningNode:this.visitReturning.bind(this),CreateTableNode:this.visitCreateTable.bind(this),AddColumnNode:this.visitAddColumn.bind(this),ColumnDefinitionNode:this.visitColumnDefinition.bind(this),DropTableNode:this.visitDropTable.bind(this),DataTypeNode:this.visitDataType.bind(this),OrderByNode:this.visitOrderBy.bind(this),OrderByItemNode:this.visitOrderByItem.bind(this),GroupByNode:this.visitGroupBy.bind(this),GroupByItemNode:this.visitGroupByItem.bind(this),UpdateQueryNode:this.visitUpdateQuery.bind(this),ColumnUpdateNode:this.visitColumnUpdate.bind(this),LimitNode:this.visitLimit.bind(this),OffsetNode:this.visitOffset.bind(this),OnConflictNode:this.visitOnConflict.bind(this),OnDuplicateKeyNode:this.visitOnDuplicateKey.bind(this),CreateIndexNode:this.visitCreateIndex.bind(this),DropIndexNode:this.visitDropIndex.bind(this),ListNode:this.visitList.bind(this),PrimaryKeyConstraintNode:this.visitPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.visitUniqueConstraint.bind(this),ReferencesNode:this.visitReferences.bind(this),CheckConstraintNode:this.visitCheckConstraint.bind(this),WithNode:this.visitWith.bind(this),CommonTableExpressionNode:this.visitCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.visitCommonTableExpressionName.bind(this),HavingNode:this.visitHaving.bind(this),CreateSchemaNode:this.visitCreateSchema.bind(this),DropSchemaNode:this.visitDropSchema.bind(this),AlterTableNode:this.visitAlterTable.bind(this),DropColumnNode:this.visitDropColumn.bind(this),RenameColumnNode:this.visitRenameColumn.bind(this),AlterColumnNode:this.visitAlterColumn.bind(this),ModifyColumnNode:this.visitModifyColumn.bind(this),AddConstraintNode:this.visitAddConstraint.bind(this),DropConstraintNode:this.visitDropConstraint.bind(this),ForeignKeyConstraintNode:this.visitForeignKeyConstraint.bind(this),CreateViewNode:this.visitCreateView.bind(this),DropViewNode:this.visitDropView.bind(this),GeneratedNode:this.visitGenerated.bind(this),DefaultValueNode:this.visitDefaultValue.bind(this),OnNode:this.visitOn.bind(this),ValuesNode:this.visitValues.bind(this),SelectModifierNode:this.visitSelectModifier.bind(this),CreateTypeNode:this.visitCreateType.bind(this),DropTypeNode:this.visitDropType.bind(this),ExplainNode:this.visitExplain.bind(this),DefaultInsertValueNode:this.visitDefaultInsertValue.bind(this),AggregateFunctionNode:this.visitAggregateFunction.bind(this),OverNode:this.visitOver.bind(this),PartitionByNode:this.visitPartitionBy.bind(this),PartitionByItemNode:this.visitPartitionByItem.bind(this),SetOperationNode:this.visitSetOperation.bind(this),BinaryOperationNode:this.visitBinaryOperation.bind(this),UnaryOperationNode:this.visitUnaryOperation.bind(this),UsingNode:this.visitUsing.bind(this),FunctionNode:this.visitFunction.bind(this),CaseNode:this.visitCase.bind(this),WhenNode:this.visitWhen.bind(this),JSONReferenceNode:this.visitJSONReference.bind(this),JSONPathNode:this.visitJSONPath.bind(this),JSONPathLegNode:this.visitJSONPathLeg.bind(this),JSONOperatorChainNode:this.visitJSONOperatorChain.bind(this),TupleNode:this.visitTuple.bind(this),MergeQueryNode:this.visitMergeQuery.bind(this),MatchedNode:this.visitMatched.bind(this),AddIndexNode:this.visitAddIndex.bind(this),CastNode:this.visitCast.bind(this),FetchNode:this.visitFetch.bind(this),TopNode:this.visitTop.bind(this)});visitNode=e=>{this.nodeStack.push(e),this.#H[e.kind](e),this.nodeStack.pop()}}class Sc extends kc{#X="";#G=[];get numParameters(){return this.#G.length}compileQuery(e){return this.#X="",this.#G=[],this.visitNode(e),Fr({query:e,sql:this.getSql(),parameters:[...this.#G]})}getSql(){return this.#X}visitSelectQuery(e){const t=!(void 0===this.parentNode||Fi.is(this.parentNode)||lo.is(this.parentNode)||Yr.is(this.parentNode)||Ya.is(this.parentNode)||vs.is(this.parentNode));void 0===this.parentNode&&e.explain&&(this.visitNode(e.explain),this.append(" ")),t&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append("select"),e.distinctOn&&(this.append(" "),this.compileDistinctOn(e.distinctOn)),e.frontModifiers?.length&&(this.append(" "),this.compileList(e.frontModifiers," ")),e.top&&(this.append(" "),this.visitNode(e.top)),e.selections&&(this.append(" "),this.compileList(e.selections)),e.from&&(this.append(" "),this.visitNode(e.from)),e.joins&&(this.append(" "),this.compileList(e.joins," ")),e.where&&(this.append(" "),this.visitNode(e.where)),e.groupBy&&(this.append(" "),this.visitNode(e.groupBy)),e.having&&(this.append(" "),this.visitNode(e.having)),e.setOperations&&(this.append(" "),this.compileList(e.setOperations," ")),e.orderBy&&(this.append(" "),this.visitNode(e.orderBy)),e.limit&&(this.append(" "),this.visitNode(e.limit)),e.offset&&(this.append(" "),this.visitNode(e.offset)),e.fetch&&(this.append(" "),this.visitNode(e.fetch)),e.endModifiers?.length&&(this.append(" "),this.compileList(this.sortSelectModifiers([...e.endModifiers])," ")),t&&this.append(")")}visitFrom(e){this.append("from "),this.compileList(e.froms)}visitSelection(e){this.visitNode(e.selection)}visitColumn(e){this.visitNode(e.column)}compileDistinctOn(e){this.append("distinct on ("),this.compileList(e),this.append(")")}compileList(e,t=", "){const n=e.length-1;for(let r=0;r<=n;r++)this.visitNode(e[r]),r<n&&this.append(t)}visitWhere(e){this.append("where "),this.visitNode(e.where)}visitHaving(e){this.append("having "),this.visitNode(e.having)}visitInsertQuery(e){const t=this.nodeStack.find(ko.is),n=t!==e;!n&&e.explain&&(this.visitNode(e.explain),this.append(" ")),n&&!xo.is(t)&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append(e.replace?"replace":"insert"),e.ignore&&this.append(" ignore"),e.top&&(this.append(" "),this.visitNode(e.top)),e.into&&(this.append(" into "),this.visitNode(e.into)),e.columns&&(this.append(" ("),this.compileList(e.columns),this.append(")")),e.values&&(this.append(" "),this.visitNode(e.values)),e.defaultValues&&(this.append(" "),this.append("default values")),e.onConflict&&(this.append(" "),this.visitNode(e.onConflict)),e.onDuplicateKey&&(this.append(" "),this.visitNode(e.onDuplicateKey)),e.returning&&(this.append(" "),this.visitNode(e.returning)),n&&!xo.is(t)&&this.append(")")}visitValues(e){this.append("values "),this.compileList(e.values)}visitDeleteQuery(e){const t=this.nodeStack.find(ko.is)!==e;!t&&e.explain&&(this.visitNode(e.explain),this.append(" ")),t&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append("delete "),e.top&&(this.visitNode(e.top),this.append(" ")),this.visitNode(e.from),e.using&&(this.append(" "),this.visitNode(e.using)),e.joins&&(this.append(" "),this.compileList(e.joins," ")),e.where&&(this.append(" "),this.visitNode(e.where)),e.orderBy&&(this.append(" "),this.visitNode(e.orderBy)),e.limit&&(this.append(" "),this.visitNode(e.limit)),e.returning&&(this.append(" "),this.visitNode(e.returning)),t&&this.append(")")}visitReturning(e){this.append("returning "),this.compileList(e.selections)}visitAlias(e){this.visitNode(e.node),this.append(" as "),this.visitNode(e.alias)}visitReference(e){e.table&&(this.visitNode(e.table),this.append(".")),this.visitNode(e.column)}visitSelectAll(e){this.append("*")}visitIdentifier(e){this.append(this.getLeftIdentifierWrapper()),this.compileUnwrappedIdentifier(e),this.append(this.getRightIdentifierWrapper())}compileUnwrappedIdentifier(e){if(!Cr(e.name))throw new Error("a non-string identifier was passed to compileUnwrappedIdentifier.");this.append(this.sanitizeIdentifier(e.name))}visitAnd(e){this.visitNode(e.left),this.append(" and "),this.visitNode(e.right)}visitOr(e){this.visitNode(e.left),this.append(" or "),this.visitNode(e.right)}visitValue(e){e.immediate?this.appendImmediateValue(e.value):this.appendValue(e.value)}visitValueList(e){this.append("("),this.compileList(e.values),this.append(")")}visitTuple(e){this.append("("),this.compileList(e.values),this.append(")")}visitPrimitiveValueList(e){this.append("(");const{values:t}=e;for(let e=0;e<t.length;++e)this.appendValue(t[e]),e!==t.length-1&&this.append(", ");this.append(")")}visitParens(e){this.append("("),this.visitNode(e.node),this.append(")")}visitJoin(e){this.append(Ic[e.joinType]),this.append(" "),this.visitNode(e.table),e.on&&(this.append(" "),this.visitNode(e.on))}visitOn(e){this.append("on "),this.visitNode(e.on)}visitRaw(e){const{sqlFragments:t,parameters:n}=e;for(let e=0;e<t.length;++e)this.append(t[e]),n.length>e&&this.visitNode(n[e])}visitOperator(e){this.append(e.operator)}visitTable(e){this.visitNode(e.table)}visitSchemableIdentifier(e){e.schema&&(this.visitNode(e.schema),this.append(".")),this.visitNode(e.identifier)}visitCreateTable(e){this.append("create "),e.frontModifiers&&e.frontModifiers.length>0&&(this.compileList(e.frontModifiers," "),this.append(" ")),e.temporary&&this.append("temporary "),this.append("table "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.table),e.selectQuery?(this.append(" as "),this.visitNode(e.selectQuery)):(this.append(" ("),this.compileList([...e.columns,...e.constraints??[]]),this.append(")"),e.onCommit&&(this.append(" on commit "),this.append(e.onCommit)),e.endModifiers&&e.endModifiers.length>0&&(this.append(" "),this.compileList(e.endModifiers," ")))}visitColumnDefinition(e){this.visitNode(e.column),this.append(" "),this.visitNode(e.dataType),e.unsigned&&this.append(" unsigned"),e.frontModifiers&&e.frontModifiers.length>0&&(this.append(" "),this.compileList(e.frontModifiers," ")),e.generated&&(this.append(" "),this.visitNode(e.generated)),e.identity&&this.append(" identity"),e.defaultTo&&(this.append(" "),this.visitNode(e.defaultTo)),e.notNull&&this.append(" not null"),e.unique&&this.append(" unique"),e.nullsNotDistinct&&this.append(" nulls not distinct"),e.primaryKey&&this.append(" primary key"),e.autoIncrement&&(this.append(" "),this.append(this.getAutoIncrement())),e.references&&(this.append(" "),this.visitNode(e.references)),e.check&&(this.append(" "),this.visitNode(e.check)),e.endModifiers&&e.endModifiers.length>0&&(this.append(" "),this.compileList(e.endModifiers," "))}getAutoIncrement(){return"auto_increment"}visitReferences(e){this.append("references "),this.visitNode(e.table),this.append(" ("),this.compileList(e.columns),this.append(")"),e.onDelete&&(this.append(" on delete "),this.append(e.onDelete)),e.onUpdate&&(this.append(" on update "),this.append(e.onUpdate))}visitDropTable(e){this.append("drop table "),e.ifExists&&this.append("if exists "),this.visitNode(e.table),e.cascade&&this.append(" cascade")}visitDataType(e){this.append(e.dataType)}visitOrderBy(e){this.append("order by "),this.compileList(e.items)}visitOrderByItem(e){this.visitNode(e.orderBy),e.direction&&(this.append(" "),this.visitNode(e.direction))}visitGroupBy(e){this.append("group by "),this.compileList(e.items)}visitGroupByItem(e){this.visitNode(e.groupBy)}visitUpdateQuery(e){const t=this.nodeStack.find(ko.is),n=t!==e;!n&&e.explain&&(this.visitNode(e.explain),this.append(" ")),n&&!xo.is(t)&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append("update "),e.top&&(this.visitNode(e.top),this.append(" ")),e.table&&(this.visitNode(e.table),this.append(" ")),this.append("set "),e.updates&&this.compileList(e.updates),e.from&&(this.append(" "),this.visitNode(e.from)),e.joins&&(this.append(" "),this.compileList(e.joins," ")),e.where&&(this.append(" "),this.visitNode(e.where)),e.limit&&(this.append(" "),this.visitNode(e.limit)),e.returning&&(this.append(" "),this.visitNode(e.returning)),n&&!xo.is(t)&&this.append(")")}visitColumnUpdate(e){this.visitNode(e.column),this.append(" = "),this.visitNode(e.value)}visitLimit(e){this.append("limit "),this.visitNode(e.limit)}visitOffset(e){this.append("offset "),this.visitNode(e.offset)}visitOnConflict(e){this.append("on conflict"),e.columns?(this.append(" ("),this.compileList(e.columns),this.append(")")):e.constraint?(this.append(" on constraint "),this.visitNode(e.constraint)):e.indexExpression&&(this.append(" ("),this.visitNode(e.indexExpression),this.append(")")),e.indexWhere&&(this.append(" "),this.visitNode(e.indexWhere)),!0===e.doNothing?this.append(" do nothing"):e.updates&&(this.append(" do update set "),this.compileList(e.updates),e.updateWhere&&(this.append(" "),this.visitNode(e.updateWhere)))}visitOnDuplicateKey(e){this.append("on duplicate key update "),this.compileList(e.updates)}visitCreateIndex(e){this.append("create "),e.unique&&this.append("unique "),this.append("index "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.name),e.table&&(this.append(" on "),this.visitNode(e.table)),e.using&&(this.append(" using "),this.visitNode(e.using)),e.columns&&(this.append(" ("),this.compileList(e.columns),this.append(")")),e.nullsNotDistinct&&this.append(" nulls not distinct"),e.where&&(this.append(" "),this.visitNode(e.where))}visitDropIndex(e){this.append("drop index "),e.ifExists&&this.append("if exists "),this.visitNode(e.name),e.table&&(this.append(" on "),this.visitNode(e.table)),e.cascade&&this.append(" cascade")}visitCreateSchema(e){this.append("create schema "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.schema)}visitDropSchema(e){this.append("drop schema "),e.ifExists&&this.append("if exists "),this.visitNode(e.schema),e.cascade&&this.append(" cascade")}visitPrimaryKeyConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("primary key ("),this.compileList(e.columns),this.append(")")}visitUniqueConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("unique"),e.nullsNotDistinct&&this.append(" nulls not distinct"),this.append(" ("),this.compileList(e.columns),this.append(")")}visitCheckConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("check ("),this.visitNode(e.expression),this.append(")")}visitForeignKeyConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("foreign key ("),this.compileList(e.columns),this.append(") "),this.visitNode(e.references),e.onDelete&&(this.append(" on delete "),this.append(e.onDelete)),e.onUpdate&&(this.append(" on update "),this.append(e.onUpdate))}visitList(e){this.compileList(e.items)}visitWith(e){this.append("with "),e.recursive&&this.append("recursive "),this.compileList(e.expressions)}visitCommonTableExpression(e){this.visitNode(e.name),this.append(" as "),Dr(e.materialized)&&(e.materialized||this.append("not "),this.append("materialized ")),this.visitNode(e.expression)}visitCommonTableExpressionName(e){this.visitNode(e.table),e.columns&&(this.append("("),this.compileList(e.columns),this.append(")"))}visitAlterTable(e){this.append("alter table "),this.visitNode(e.table),this.append(" "),e.renameTo&&(this.append("rename to "),this.visitNode(e.renameTo)),e.setSchema&&(this.append("set schema "),this.visitNode(e.setSchema)),e.addConstraint&&this.visitNode(e.addConstraint),e.dropConstraint&&this.visitNode(e.dropConstraint),e.columnAlterations&&this.compileColumnAlterations(e.columnAlterations),e.addIndex&&this.visitNode(e.addIndex),e.dropIndex&&this.visitNode(e.dropIndex)}visitAddColumn(e){this.append("add column "),this.visitNode(e.column)}visitRenameColumn(e){this.append("rename column "),this.visitNode(e.column),this.append(" to "),this.visitNode(e.renameTo)}visitDropColumn(e){this.append("drop column "),this.visitNode(e.column)}visitAlterColumn(e){this.append("alter column "),this.visitNode(e.column),this.append(" "),e.dataType&&(this.announcesNewColumnDataType()&&this.append("type "),this.visitNode(e.dataType),e.dataTypeExpression&&(this.append("using "),this.visitNode(e.dataTypeExpression))),e.setDefault&&(this.append("set default "),this.visitNode(e.setDefault)),e.dropDefault&&this.append("drop default"),e.setNotNull&&this.append("set not null"),e.dropNotNull&&this.append("drop not null")}visitModifyColumn(e){this.append("modify column "),this.visitNode(e.column)}visitAddConstraint(e){this.append("add "),this.visitNode(e.constraint)}visitDropConstraint(e){this.append("drop constraint "),e.ifExists&&this.append("if exists "),this.visitNode(e.constraintName),"cascade"===e.modifier?this.append(" cascade"):"restrict"===e.modifier&&this.append(" restrict")}visitSetOperation(e){this.append(e.operator),this.append(" "),e.all&&this.append("all "),this.visitNode(e.expression)}visitCreateView(e){this.append("create "),e.orReplace&&this.append("or replace "),e.materialized&&this.append("materialized "),e.temporary&&this.append("temporary "),this.append("view "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.name),this.append(" "),e.columns&&(this.append("("),this.compileList(e.columns),this.append(") ")),e.as&&(this.append("as "),this.visitNode(e.as))}visitDropView(e){this.append("drop "),e.materialized&&this.append("materialized "),this.append("view "),e.ifExists&&this.append("if exists "),this.visitNode(e.name),e.cascade&&this.append(" cascade")}visitGenerated(e){this.append("generated "),e.always&&this.append("always "),e.byDefault&&this.append("by default "),this.append("as "),e.identity&&this.append("identity"),e.expression&&(this.append("("),this.visitNode(e.expression),this.append(")")),e.stored&&this.append(" stored")}visitDefaultValue(e){this.append("default "),this.visitNode(e.defaultValue)}visitSelectModifier(e){e.rawModifier?this.visitNode(e.rawModifier):this.append(Oc[e.modifier]),e.of&&(this.append(" of "),this.compileList(e.of,", "))}visitCreateType(e){this.append("create type "),this.visitNode(e.name),e.enum&&(this.append(" as enum "),this.visitNode(e.enum))}visitDropType(e){this.append("drop type "),e.ifExists&&this.append("if exists "),this.visitNode(e.name)}visitExplain(e){this.append("explain"),(e.options||e.format)&&(this.append(" "),this.append(this.getLeftExplainOptionsWrapper()),e.options&&(this.visitNode(e.options),e.format&&this.append(this.getExplainOptionsDelimiter())),e.format&&(this.append("format"),this.append(this.getExplainOptionAssignment()),this.append(e.format)),this.append(this.getRightExplainOptionsWrapper()))}visitDefaultInsertValue(e){this.append("default")}visitAggregateFunction(e){this.append(e.func),this.append("("),e.distinct&&this.append("distinct "),this.compileList(e.aggregated),this.append(")"),e.filter&&(this.append(" filter("),this.visitNode(e.filter),this.append(")")),e.over&&(this.append(" "),this.visitNode(e.over))}visitOver(e){this.append("over("),e.partitionBy&&(this.visitNode(e.partitionBy),e.orderBy&&this.append(" ")),e.orderBy&&this.visitNode(e.orderBy),this.append(")")}visitPartitionBy(e){this.append("partition by "),this.compileList(e.items)}visitPartitionByItem(e){this.visitNode(e.partitionBy)}visitBinaryOperation(e){this.visitNode(e.leftOperand),this.append(" "),this.visitNode(e.operator),this.append(" "),this.visitNode(e.rightOperand)}visitUnaryOperation(e){this.visitNode(e.operator),this.isMinusOperator(e.operator)||this.append(" "),this.visitNode(e.operand)}isMinusOperator(e){return di.is(e)&&"-"===e.operator}visitUsing(e){this.append("using "),this.compileList(e.tables)}visitFunction(e){this.append(e.func),this.append("("),this.compileList(e.arguments),this.append(")")}visitCase(e){this.append("case"),e.value&&(this.append(" "),this.visitNode(e.value)),e.when&&(this.append(" "),this.compileList(e.when," ")),e.else&&(this.append(" else "),this.visitNode(e.else)),this.append(" end"),e.isStatement&&this.append(" case")}visitWhen(e){this.append("when "),this.visitNode(e.condition),e.result&&(this.append(" then "),this.visitNode(e.result))}visitJSONReference(e){this.visitNode(e.reference),this.visitNode(e.traversal)}visitJSONPath(e){e.inOperator&&this.visitNode(e.inOperator),this.append("'$");for(const t of e.pathLegs)this.visitNode(t);this.append("'")}visitJSONPathLeg(e){const t="ArrayLocation"===e.type;this.append(t?"[":"."),this.append(String(e.value)),t&&this.append("]")}visitJSONOperatorChain(e){for(let t=0,n=e.values.length;t<n;t++)t===n-1?this.visitNode(e.operator):this.append("->"),this.visitNode(e.values[t])}visitMergeQuery(e){e.with&&(this.visitNode(e.with),this.append(" ")),this.append("merge "),e.top&&(this.visitNode(e.top),this.append(" ")),this.append("into "),this.visitNode(e.into),e.using&&(this.append(" "),this.visitNode(e.using)),e.whens&&(this.append(" "),this.compileList(e.whens))}visitMatched(e){e.not&&this.append("not "),this.append("matched"),e.bySource&&this.append(" by source")}visitAddIndex(e){this.append("add "),e.unique&&this.append("unique "),this.append("index "),this.visitNode(e.name),e.columns&&(this.append(" ("),this.compileList(e.columns),this.append(")")),e.using&&(this.append(" using "),this.visitNode(e.using))}visitCast(e){this.append("cast("),this.visitNode(e.expression),this.append(" as "),this.visitNode(e.dataType),this.append(")")}visitFetch(e){this.append("fetch next "),this.visitNode(e.rowCount),this.append(` rows ${e.modifier}`)}visitTop(e){this.append(`top(${e.expression})`),e.modifiers&&this.append(` ${e.modifiers}`)}append(e){this.#X+=e}appendValue(e){this.addParameter(e),this.append(this.getCurrentParameterPlaceholder())}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getCurrentParameterPlaceholder(){return"$"+this.numParameters}getLeftExplainOptionsWrapper(){return"("}getExplainOptionAssignment(){return" "}getExplainOptionsDelimiter(){return", "}getRightExplainOptionsWrapper(){return")"}sanitizeIdentifier(e){const t=this.getLeftIdentifierWrapper(),n=this.getRightIdentifierWrapper();let r="";for(const i of e)r+=i,i===t?r+=t:i===n&&(r+=n);return r}addParameter(e){this.#G.push(e)}appendImmediateValue(e){if(Cr(e))this.append(`'${e}'`);else if(Ar(e)||Dr(e))this.append(e.toString());else if(Pr(e))this.append("null");else if(e instanceof Date)this.appendImmediateValue(e.toISOString());else{if(!Lr(e))throw new Error(`invalid immediate value ${e}`);this.appendImmediateValue(e.toString())}}sortSelectModifiers(e){return e.sort(((e,t)=>e.modifier&&t.modifier?Wc[e.modifier]-Wc[t.modifier]:1)),Fr(e)}compileColumnAlterations(e){this.compileList(e)}announcesNewColumnDataType(){return!0}}const Oc=Fr({ForKeyShare:"for key share",ForNoKeyUpdate:"for no key update",ForUpdate:"for update",ForShare:"for share",NoWait:"nowait",SkipLocked:"skip locked",Distinct:"distinct"}),Wc=Fr({ForKeyShare:1,ForNoKeyUpdate:1,ForUpdate:1,ForShare:1,NoWait:2,SkipLocked:2,Distinct:0}),Ic=Fr({InnerJoin:"inner join",LeftJoin:"left join",RightJoin:"right join",FullJoin:"full join",LateralInnerJoin:"inner join lateral",LateralLeftJoin:"left join lateral",Using:"using"}),qc=/"/g;class Tc extends Sc{getCurrentParameterPlaceholder(){return"?"}getLeftExplainOptionsWrapper(){return""}getRightExplainOptionsWrapper(){return""}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getAutoIncrement(){return"autoincrement"}sanitizeIdentifier(e){return e.replace(qc,'""')}visitDefaultInsertValue(e){this.append("null")}}let Ec,Cc,Ac,Dc,Pc=!1;const Lc=(e,t)=>{"string"!=typeof t.data&&!0!==Pc&&(clearTimeout(Ec),Ec=void 0,Ec=setTimeout((()=>{Pc=!0,e({refreshQueries:!0})(),clearTimeout(Ec),clearTimeout(Cc),Cc=setTimeout((()=>{Pc=!1}),500)}),500))},Bc=(e,t,n)=>t.externalWebsocketConnection?(t.externalWebsocketConnection.send(JSON.stringify({message:"subscribe",channelId:n.id})),t.externalWebsocketConnection.addEventListener("message",(t=>Lc(e,t))),t.externalWebsocketConnection):t.enableWebsocketConnection?(Dc=new WebSocket(t.syncUrl?.replace("http","ws")),Dc.addEventListener("message",(t=>Lc(e,t))),Dc.onerror=e=>{console.error("WebSocket error:",e)},Dc.onclose=()=>{Ac=setTimeout((()=>Bc(e,t,n)),3e3)},Dc.onopen=()=>{Dc.send(JSON.stringify({message:"subscribe",channelId:n.id})),clearTimeout(Ac)},Dc):void 0,Mc=e=>f.sync((()=>{const t=new Set;let n=e;return{subscribe:e=>(t.add(e),()=>{t.delete(e)}),getState:()=>n,setState:e=>f.sync((()=>{e!==n&&(n=e,t.forEach((e=>e())))}))}}));class Fc extends(p.vw("EvoluFactory")()){}Fc.Common=w.QZ(Fc,f.gen((function*(){const e=yield*f.map(f.serviceOption(Fn),y.WL((()=>e=>e()))),t=p.Ie().pipe(p.WQ(Gn,yield*Gn),p.WQ(bt,yield*bt),p.WQ(Fn,e),p.WQ(Rn,yield*Rn)),n=new Map;return Fc.of({createEvolu:(e,{indexes:r,initialData:i,mnemonic:o,...s}={})=>{const a=O(s),c=s?.name||S.name,d={tables:Rc(e),indexes:r||[]};let l=n.get(c);return null==l?(l=jc(d,a,i,o).pipe(f.provide(t),a.runSync),n.set(c,l)):l.ensureSchema(d),l}})})));const Rc=e=>(0,m.Fs)(Uc(e),Tr.Wo,u.Tj((([e,t])=>({name:e,columns:Object.keys(Uc(t))})))),Uc=e=>{const t={},n=qr.dw(e.ast);for(let e=0;e<n.length;e++){const r=n[e];t[r.name]=(0,a.L8n)(r.type)}return t},jc=(e,t,n,r)=>f.gen((function*(){yield*f.logTrace("EvoluFactory createEvolu");const i=yield*k,o=yield*Gn,s=yield*Rn,a=yield*bt,c=yield*Fn,d=yield*o.createDb,l=yield*Mc(null),p=yield*Mc(null),h=yield*Mc(new Map),y=yield*Mc(Ht),w=new Map,N=new Map,b=e=>e.pipe(f.catchAllDefect((e=>f.fail(vn(e)))),f.tapError(f.logError),f.tapError(l.setState)),v=(0,m.L3)(b,t.runFork),x=(0,m.L3)(b,t.runSync),S=(0,m.L3)(b,t.runPromise),O=yield*f.provideService(_c(n),bt,a),W=({refreshQueries:e})=>()=>{f.flatMap(d.sync(e?[...N.keys()]:[]),C()).pipe(v)};d.init(e,O,(e=>{f.fail(e).pipe(v)}),(e=>{f.logDebug(["Evolu handleSyncStateChange",{state:e}]).pipe(f.zipRight(y.setState(e)),v)}),(()=>{f.gen((function*(){yield*f.logTrace("Evolu handleDbReceive"),P();const e=[...N.keys()];e.length>0&&(yield*f.flatMap(d.loadQueries(e),C()))})).pipe(v)}),r).pipe(f.tap(W({refreshQueries:!1})),f.flatMap(p.setState),f.catchTag("NotSupportedPlatformError",(()=>f.void)),v);let I=!1;const T=new Promise((e=>{p.subscribe((()=>{const t=p.getState();I||"string"!=typeof t?.id||(I=!0,e(Bc(W,i,t)))}))})),E=yield*s.init({onRequestSync:W({refreshQueries:!0}),reloadUrl:i.reloadUrl}),C=e=>t=>f.logDebug(["Evolu handlePatches",{patches:t}]).pipe(f.zipRight(A(t)),f.tap((e=>f.forEach(t,(({query:t})=>D(t,e.get(t)||xr()))))),f.tap((t=>{e?.flushSync?c((()=>{h.setState(t).pipe(x)})):h.setState(t).pipe(x)}))),A=e=>f.sync((()=>{const t=h.getState();if(0===e.length)return t;const n=u.Tj(e,(({query:e,patches:n})=>[e,wn(n,t.get(e)||xr())]));return new Map([...t,...n])})),D=(e,t)=>f.sync((()=>{const n=w.get(e);if(!n)return;const r=Sr(t);"fulfilled"!==n.promise.status?n.resolve(r):n.promise=Promise.resolve(r),Object.assign(n.promise,{status:"fulfilled",value:r}),n.releaseOnResolve&&w.delete(e)})),P=()=>{[...w.entries()].filter((([e])=>!N.has(e))).forEach((([e,t])=>{"fulfilled"===t.promise.status?w.delete(e):t.releaseOnResolve=!0}))},L=(()=>{let e=[];return(t,{id:n,...r},i)=>{f.logDebug(["Evolu mutate",{table:t,id:n,values:r}]).pipe(x);const o=null==n;return o&&(n=a.rowId.pipe(x)),e=[...e,[{table:t,id:n,values:r,isInsert:o},i]],1===e.length&&queueMicrotask((()=>{const[t,n]=u.$1(e);e=[];const r=n.filter(g.EA);P(),d.mutate(t,[...N.keys()]).pipe(f.flatMap(C({flushSync:r.length>0})),f.tap((()=>{r.forEach((e=>e()))})),v)})),{id:n}}})(),B={socket:T,subscribeError:l.subscribe,getError:l.getState,createQuery:(e,t)=>(0,m.Fs)(e($c).compile(),(e=>{if(n=e.sql,Dn.test(n))throw new Error("SQL mutation (INSERT, UPDATE, DELETE, etc.) isn't allowed in the Evolu `createQuery` function. Kysely suggests it because there is no read-only Kysely yet, and removing such an API is not possible. For mutations, use Evolu mutation API.");var n;const r=e.parameters;return{sql:e.sql,parameters:r,...t&&{options:t}}}),(e=>(({sql:e,parameters:t=[],options:n})=>{const r={sql:e,parameters:t.map((e=>g.mg(e)?u.Ts(e):Wn(e)?{json:e}:e)),...n&&{options:n}};return JSON.stringify(r)})(e))),loadQuery:(()=>{let e=[];return t=>{f.logDebug(["Evolu loadQuery",{query:br(t)}]).pipe(x);let n=w.get(t);if(!n){let r=m.Yi;const i=new Promise((e=>{r=e}));n={resolve:r,promise:i,releaseOnResolve:!1},w.set(t,n),e=[...e,t],1===e.length&&queueMicrotask((()=>{d.loadQueries(u.Qq(e)).pipe(f.flatMap(C()),v),e=[]}))}return n.promise}})(),loadQueries:e=>e.map(B.loadQuery),subscribeQuery:e=>t=>{N.set(e,q.GV(N.get(e)??0));const n=h.subscribe(t);return()=>{const t=N.get(e);null!=t&&t>1?N.set(e,q.Kt(t)):N.delete(e),n()}},getQuery:e=>Sr(h.getState().get(e)||xr()),subscribeOwner:p.subscribe,getOwner:p.getState,subscribeSyncState:y.subscribe,getSyncState:y.getState,create:L,update:L,createOrUpdate:L,resetOwner:e=>f.gen((function*(){yield*d.resetOwner(),!1!==e?.reload&&(yield*E.reset)})).pipe(S),restoreOwner:(t,n)=>f.gen((function*(){yield*d.restoreOwner(e,t),!1!==n?.reload&&(yield*E.reset)})).pipe(S),reloadApp:()=>{E.reset.pipe(v)},ensureSchema:e=>{d.ensureSchema(e).pipe(v)},exportDatabase:()=>d.exportDatabase().pipe(S)};return B})),_c=(e=m.Yi)=>f.map(bt,(t=>{const n=[],r=(e,{id:r,...i})=>(null==r&&(r=t.rowId.pipe(f.runSync)),n.push({isInsert:!0,id:r,table:e,values:i}),{id:r});return e({create:r,createOrUpdate:r}),n})),$c=new mc({dialect:{createAdapter:()=>new bc,createDriver:()=>new vc,createIntrospector(){throw"Not implemeneted"},createQueryCompiler:()=>new Tc}}),Qc=($c.schema.createIndex.bind($c.schema),e=>f.map(k,(t=>`evolu:${t.name}:${e}`))),Jc=(w.Py(Rn,{init:({reloadUrl:e,onRequestSync:t})=>f.sync((()=>{if("undefined"==typeof document)return{reset:f.void};const n="evolu:reloadAllTabs",r=()=>{location.replace(e)};let i;window.addEventListener("storage",(e=>{e.key===n&&r()}));const o=()=>{null==i&&(t(),i=window.setTimeout((()=>{i=null}),50))};return window.addEventListener("online",o),document.addEventListener("visibilitychange",(()=>{"hidden"!==document.visibilityState&&o()})),window.addEventListener("focus",o),{reset:f.sync((()=>{localStorage.setItem(n,Date.now().toString()),r()}))}}))}),w.Py(Un,{tryAcquire:f.gen((function*(){yield*f.logTrace("SyncLock tryAcquire");const e=yield*Qc("SyncLock"),t=f.async((t=>{navigator.locks.request(e,{ifAvailable:!0},(e=>{if(null!=e)return new Promise((e=>{f.logTrace("SyncLock acquired").pipe(f.zipRight(f.succeed({release:f.logTrace("SyncLock released").pipe(f.tap(f.sync(e)))})),t)}));f.logTrace("SyncLock not acquired").pipe(f.zipRight(f.fail(new jn)),t)}))}));return yield*f.acquireRelease(t,(({release:e})=>e))}))}));var Kc=n(61960);globalThis.sqlite3Worker1Promiser=function e(t=e.defaultConfig){if(1===arguments.length&&"function"==typeof arguments[0]){const n=t;(t=Object.assign(Object.create(null),e.defaultConfig)).onready=n}else t=Object.assign(Object.create(null),e.defaultConfig,t);const n=Object.create(null),r=function(){},i=t.onerror||r,o=t.debug||r,s=t.generateMessageId?void 0:Object.create(null),a=t.generateMessageId||function(e){return e.type+"#"+(s[e.type]=(s[e.type]||0)+1)},c=(...e)=>{throw new Error(e.join(" "))};let d,l;return t.worker||(t.worker=e.defaultConfig.worker),"function"==typeof t.worker&&(t.worker=t.worker()),t.worker.onmessage=function(e){e=e.data,o("worker1.onmessage",e);let r=n[e.messageId];if(!r)return e&&"sqlite3-api"===e.type&&"worker1-ready"===e.result?void(t.onready&&t.onready(l)):(r=n[e.type],r&&r.onrow?void r.onrow(e):void(t.onunhandled?t.onunhandled(arguments[0]):i("sqlite3Worker1Promiser() unhandled worker message:",e)));switch(delete n[e.messageId],e.type){case"error":return void r.reject(e);case"open":d||(d=e.dbId);break;case"close":e.dbId===d&&(d=void 0)}try{r.resolve(e)}catch(e){r.reject(e)}},l=function(){let e;1===arguments.length?e=arguments[0]:2===arguments.length?(e=Object.create(null),e.type=arguments[0],e.args=arguments[1],e.dbId=e.args.dbId):c("Invalid arguments for sqlite3Worker1Promiser()-created factory."),e.dbId||"open"===e.type||(e.dbId=d),e.messageId=a(e),e.departureTime=performance.now();const r=Object.create(null);let i;r.message=e,"exec"===e.type&&e.args&&("function"==typeof e.args.callback?(i=e.messageId+":row",r.onrow=e.args.callback,e.args.callback=i,n[i]=r):"string"==typeof e.args.callback&&c("exec callback may not be a string when using the Promise interface."));let s=new Promise((function(i,s){r.resolve=i,r.reject=s,n[e.messageId]=r,o("Posting",e.type,"message to Worker dbId="+(d||"default")+":",e),t.worker.postMessage(e)}));return i&&(s=s.finally((()=>delete n[i]))),s}},globalThis.sqlite3Worker1Promiser.defaultConfig={worker:function(){return new Worker(new URL(n.p+n.u(104),n.b),{type:void 0})},onerror:(...e)=>console.error("worker1 promiser error",...e)},sqlite3Worker1Promiser.v2=function(e){let t;"function"==typeof e?(t=e,e={}):"function"==typeof e?.onready&&(t=e.onready,delete e.onready);const n=Object.create(null);e=Object.assign(e||Object.create(null),{onready:async function(e){try{t&&await t(e),n.resolve(e)}catch(e){n.reject(e)}}});const r=new Promise((function(e,t){n.resolve=e,n.reject=t}));try{this.original(e)}catch(e){n.reject(e)}return r}.bind({original:sqlite3Worker1Promiser}),sqlite3Worker1Promiser.v2,self.sqlite3Worker1Promiser;const Yc=Kc.A;globalThis.sqlite3ApiConfig={warn:m.Yi};const Vc=w.QZ(On,f.gen((function*(){const e=yield*bt,t=Yc();return On.of({createSqlite:f.gen((function*(){const n=yield*f.flatMap(Qc("SqliteBroadcastChannel"),zc);n.onMessage=e=>{switch(e._tag){case"Exec":r=[...r,e];break;case"ExecError":case"ExecSuccess":r=u.pb(r,(t=>t.id!==e.id)),i(e);break;default:(0,m.GQ)(e)}};let r=[];const i=e=>{const t=o.get(e.id);t&&(t(e),o.delete(e.id))},o=new Map,s=yield*k,a=O(s);f.logTrace("SqliteWeb connection lock request").pipe(f.zipRight(Qc("SqliteConnection")),f.flatMap((e=>f.async((n=>{navigator.locks.request(e,(()=>new Promise((()=>{n(f.promise((()=>t)))}))))})))),f.tap(f.logTrace("SqliteWeb connection lock granted")),f.flatMap((e=>f.promise((()=>e.installOpfsSAHPoolVfs({name:s.name}))).pipe(f.map((t=>({sqlite:new t.OpfsSAHPoolDb("/evolu1.db"),sqlite3:e})))))),f.tap((({sqlite:e,sqlite3:t})=>{const o=(r,i)=>f.try({try:()=>{return r.sql===Hc.sql?[{file:t.capi.sqlite3_js_db_export(e)}]:e.exec(r.sql,{returnValue:"resultRows",rowMode:"object",bind:(n=r.parameters||[],n.map((e=>Wn(e)?JSON.stringify(e):e)))});var n},catch:xn}).pipe((e=>t=>e.options?.logQueryExecutionTime?f.Do.pipe(f.let("start",(()=>performance.now())),f.bind("result",(()=>t)),f.let("elapsed",(({start:e})=>performance.now()-e)),f.tap((({elapsed:t})=>dn(`QueryExecutionTime: ${t}ms`,e))),f.map((({result:e})=>e))):t)(r),f.match({onSuccess:t=>{n.postMessage({_tag:"ExecSuccess",id:i,result:{rows:t,changes:e.changes()}})},onFailure:e=>{n.postMessage({_tag:"ExecError",id:i,error:e})}}),a.runSync);n.onMessage=e=>{switch(e._tag){case"Exec":o(e.query,e.id);break;case"ExecSuccess":case"ExecError":i(e);break;default:(0,m.GQ)(e)}},r.forEach((e=>{o(e.query,e.id)})),r=[]}))).pipe(f.provideService(k,s),a.runPromise);const c=yield*Qc("SqliteTransaction");return Sn.of({exec:t=>f.flatMap(e.nanoid,(e=>f.async((r=>{o.set(e,(e=>{switch(e._tag){case"ExecSuccess":r(f.succeed(e.result));break;case"ExecError":r(f.die(e.error))}})),n.postMessage({_tag:"Exec",id:e,query:t})})))),transaction:e=>t=>f.acquireUseRelease(f.async((t=>{navigator.locks.request(c,{mode:"last"===e?"exclusive":e},(()=>new Promise((e=>{t(f.succeed(e))}))))})),(()=>t),(t=>f.sync((()=>{"last"!==e&&t()})))),export:()=>f.flatMap(e.nanoid,(e=>f.async((t=>{o.set(e,(e=>{switch(e._tag){case"ExecSuccess":t(f.succeed(e.result.rows[0].file));break;case"ExecError":t(f.die(e.error))}})),n.postMessage({_tag:"Exec",id:e,query:Hc})}))))})}))})}))),zc=e=>f.sync((()=>{const t=new BroadcastChannel(e),n={postMessage:e=>{t.postMessage(e),n.onMessage(e)},onMessage:m.Yi};return t.onmessage=e=>{n.onMessage(e.data)},n})),Hc={sql:"export database"},Xc=w.Py(Xt,{createSync:f.sync((()=>(e=>{const t=new Map;e.onmessage=({data:e})=>{const n=t.get(e.id);n&&(n(e.response),t.delete(e.id))};return new Proxy(e,{get:(e,n)=>(...r)=>f.flatMap(k,(i=>f.async((o=>{const s=[],a=r.map((e=>{if("function"!=typeof e)return e;const t=new MessageChannel;return t.port1.onmessage=({data:t})=>{e(...t)},s.push(t.port2),t.port2})),c=Wr();t.set(c,(e=>{o(f[e._tag](e.value))}));const d={id:c,name:n,args:a,config:i};e.postMessage(d,s)}))))})})(new Worker(new URL(n.p+n.u(840),n.b),{type:void 0}))))});Zn.pipe(f.provide(w.Um(On.Common.pipe(w.Gt(Vc),w.Gt(Ir)),Ir,Pt.Live,Xc,Jc)),f.runSync,(e=>{let t=null;onmessage=({data:{id:n,name:r,args:i,config:o}})=>{null==t&&(t=O(o));const s=i.map((e=>e instanceof MessagePort?(...t)=>{e.postMessage(t)}:e));t.runFork(e[r](...s).pipe(f.map((e=>({id:n,response:{_tag:"succeed",value:e}}))),f.catchAll((e=>f.succeed({id:n,response:{_tag:"fail",value:e}}))),f.catchAllDefect((e=>f.succeed({id:n,response:{_tag:"die",value:xn(e)}}))),f.tap((e=>postMessage(e)))))}}))},58600:(e,t,n)=>{n.d(t,{$1:()=>J,$v:()=>W,BC:()=>N,BE:()=>j,Bq:()=>ae,C:()=>X,CN:()=>h,D8:()=>y,E$:()=>te,EI:()=>x,HC:()=>F,HV:()=>T,Hs:()=>w,Ie:()=>re,KC:()=>Z,Kl:()=>L,Ln:()=>A,Mo:()=>ne,OM:()=>be,OY:()=>Q,Ou:()=>K,Qq:()=>we,Rm:()=>E,Rx:()=>C,TS:()=>he,Tj:()=>oe,Ts:()=>m,Uk:()=>M,XK:()=>fe,Y6:()=>f,Yz:()=>le,bt:()=>ye,cy:()=>v,d5:()=>I,di:()=>_,fj:()=>Ne,g9:()=>P,gI:()=>z,gR:()=>V,gv:()=>D,i8:()=>B,iI:()=>k,jB:()=>pe,kP:()=>ee,mA:()=>de,nc:()=>g,of:()=>ie,pb:()=>ue,qI:()=>se,t8:()=>me,u2:()=>b,v4:()=>q,w8:()=>ge,x1:()=>ce,yU:()=>$});var r=n(43977),i=n(35309),o=n(61369),s=n(11174),a=n(54987),c=n(77948),d=n(59877),l=n(56572),u=n(67316),p=n(22859);const h=e=>new Array(e),f=(e,t)=>{const n=Math.max(1,Math.floor(e)),r=new Array(n);for(let e=0;e<n;e++)r[e]=t(e);return r},m=e=>Array.isArray(e)?e:Array.from(e),y=e=>Array.isArray(e)?e:[e],g=(u.Wo,c.$r,(0,o.XY)(2,((e,{onEmpty:t,onNonEmpty:n})=>k(e)?n(q(e),C(e)):t()))),w=(0,o.XY)(2,((e,t)=>[t,...e])),N=(0,o.XY)(2,((e,t)=>[...e,t])),b=(0,o.XY)(2,((e,t)=>m(e).concat(m(t)))),v=Array.isArray,x=s.E,k=s.E,S=(e,t)=>e<0||e>=t.length,O=(0,o.XY)(2,((e,t)=>{const n=Math.floor(t);return S(n,e)?c.dv():c.zN(e[n])})),W=(0,o.XY)(2,((e,t)=>{const n=Math.floor(t);if(S(n,e))throw new Error(`Index ${n} out of bounds`);return e[n]})),I=O(0),q=W(0),T=e=>k(e)?c.zN(E(e)):c.dv(),E=e=>e[e.length-1],C=e=>e.slice(1),A=(0,o.XY)(2,((e,t)=>z(e,((e,t)=>{let n=0;for(const r of e){if(!t(r,n))break;n++}return n})(e,t)))),D=(0,o.XY)(2,((e,t)=>{const n=m(e);return n.slice((r=t,i=n,Math.floor(Math.min(Math.max(0,r),i.length))),n.length);var r,i})),P=(0,o.XY)(2,((e,t)=>{let n=0;for(const r of e){if(t(r,n))return c.zN(n);n++}return c.dv()})),L=(0,o.XY)(2,((e,t)=>{const n=m(e);for(let e=n.length-1;e>=0;e--)if(t(n[e],e))return c.zN(e);return c.dv()})),B=a.i8,M=(0,o.XY)(2,((e,t)=>{const n=m(e);for(let e=n.length-1;e>=0;e--){const r=n[e],i=t(r,e);if((0,l.Lm)(i)){if(i)return c.zN(r)}else if(c.Ru(i))return i}return c.dv()})),F=(0,o.XY)(3,((e,t,n)=>R(e,t,(()=>n)))),R=(0,o.XY)(3,((e,t,n)=>c.WL(U(e,t,n),(()=>Array.from(e))))),U=(0,o.XY)(3,((e,t,n)=>{const r=Array.from(e);if(S(t,r))return c.dv();const i=n(r[t]);return r[t]=i,c.zN(r)})),j=e=>Array.from(e).reverse(),_=(0,o.XY)(2,((e,t)=>{const n=Array.from(e);return n.sort(t),n})),$=(0,o.XY)(2,((e,t)=>Q(e,t,p.L8))),Q=(0,o.XY)(3,((e,t,n)=>{const r=m(e),i=m(t);if(k(r)&&k(i)){const e=[n(q(r),q(i))],t=Math.min(r.length,i.length);for(let o=1;o<t;o++)e[o]=n(r[o],i[o]);return e}return[]})),J=e=>{const t=m(e);if(k(t)){const e=[t[0][0]],n=[t[0][1]];for(let r=1;r<t.length;r++)e[r]=t[r][0],n[r]=t[r][1];return[e,n]}return[[],[]]},K=e=>(0,o.XY)(2,((t,n)=>{for(const r of t)if(e(n,r))return!0;return!1})),Y=r.XY(),V=K(Y),z=(0,o.XY)(2,((e,t)=>{const n=Array.from(e),r=Math.floor(t);return k(n)?r>=1?H(n,r):[[],n]:[n,[]]})),H=(0,o.XY)(2,((e,t)=>{const n=Math.max(1,Math.floor(t));return n>=e.length?[X(e),[]]:[w(e.slice(1,n),q(e)),e.slice(n)]})),X=e=>e.slice(),G=(0,o.XY)(3,((e,t,n)=>{const r=m(e),i=m(t);return k(r)?k(i)?ge(n)(b(r,i)):r:i})),Z=(0,o.XY)(2,((e,t)=>G(e,t,Y))),ee=e=>{const t=K(e);return(0,o.XY)(2,((e,n)=>m(e).filter((e=>t(n,e)))))},te=ee(Y),ne=e=>{const t=K(e);return(0,o.XY)(2,((e,n)=>m(e).filter((e=>!t(n,e)))))},re=()=>[],ie=e=>[e],oe=(0,o.XY)(2,((e,t)=>e.map(t))),se=(0,o.XY)(2,((e,t)=>{if((e=>0===e.length)(e))return[];const n=[];for(let r=0;r<e.length;r++){const i=t(e[r],r);for(let e=0;e<i.length;e++)n.push(i[e])}return n})),ae=se(o.D_),ce=(0,o.XY)(2,((e,t)=>{const n=m(e),r=[];for(let e=0;e<n.length;e++){const i=t(n[e],e);c.Ru(i)&&r.push(i.value)}return r})),de=(0,o.XY)(2,((e,t)=>{let n=0;const r=[];for(const i of e){const e=t(i,n);if(!c.Ru(e))break;r.push(e.value),n++}return r})),le=ce(o.D_),ue=(0,o.XY)(2,((e,t)=>{const n=m(e),r=[];for(let e=0;e<n.length;e++)t(n[e],e)&&r.push(n[e]);return r})),pe=(0,o.XY)(2,((e,t)=>{const n=[],r=[],i=m(e);for(let e=0;e<i.length;e++)t(i[e],e)?r.push(i[e]):n.push(i[e]);return[n,r]})),he=(0,o.XY)(3,((e,t,n)=>m(e).reduce(((e,t,r)=>n(e,t,r)),t))),fe=(0,o.XY)(3,((e,t,n)=>m(e).reduceRight(((e,t,r)=>n(e,t,r)),t))),me=(e,t)=>{const n=[];let r,i=e;for(;c.Ru(r=t(i));){const[e,t]=r.value;n.push(e),i=t}return n},ye=(d.YO,i.YO),ge=(0,o.XY)(2,((e,t)=>{const n=m(e);if(k(n)){const e=[q(n)],r=C(n);for(const n of r)e.every((e=>!t(n,e)))&&e.push(n);return e}return[]})),we=e=>ge(e,r.XY()),Ne=(0,o.XY)(2,((e,t)=>m(e).join(t))),be=(0,o.XY)(3,((e,t,n)=>{let r=0,i=t;const o=[];for(const t of e){const e=n(i,t,r);i=e[0],o.push(e[1]),r++}return[i,o]}))},55519:(e,t,n)=>{n.r(t),n.d(t,{Do:()=>En,EffectTypeId:()=>g,Tag:()=>io,acquireRelease:()=>lt,acquireReleaseInterruptible:()=>ut,acquireUseRelease:()=>pt,addFinalizer:()=>ht,all:()=>S,allSuccesses:()=>W,allWith:()=>O,allowInterrupt:()=>Ue,andThen:()=>Hn,annotateCurrentSpan:()=>$i,annotateLogs:()=>$r,annotateLogsScoped:()=>Qr,annotateSpans:()=>_i,ap:()=>Ii,as:()=>Xe,asSome:()=>Ge,asSomeError:()=>Ze,asVoid:()=>et,async:()=>z,asyncEffect:()=>H,awaitAllChildren:()=>Ot,bind:()=>Cn,bindTo:()=>An,blocked:()=>qi,cacheRequestResult:()=>Ai,cached:()=>v,cachedFunction:()=>x,cachedInvalidateWithTTL:()=>b,cachedWithTTL:()=>N,catch:()=>ge,catchAll:()=>we,catchAllCause:()=>Ne,catchAllDefect:()=>be,catchIf:()=>ve,catchSome:()=>xe,catchSomeCause:()=>ke,catchSomeDefect:()=>Se,catchTag:()=>Oe,catchTags:()=>We,cause:()=>Ie,checkInterruptible:()=>je,clock:()=>Vt,clockWith:()=>zt,configProviderWith:()=>pn,console:()=>Gt,consoleWith:()=>Zt,context:()=>mn,contextWith:()=>yn,contextWithEffect:()=>gn,currentParentSpan:()=>Ji,currentSpan:()=>Qi,custom:()=>X,daemonChildren:()=>Wt,delay:()=>nn,descriptor:()=>It,descriptorWith:()=>qt,die:()=>re,dieMessage:()=>ie,dieSync:()=>oe,diffFiberRefs:()=>Tt,disconnect:()=>_e,dropUntil:()=>I,dropWhile:()=>q,either:()=>Pn,ensuring:()=>ft,ensuringChild:()=>Et,ensuringChildren:()=>Ct,eventually:()=>qe,every:()=>T,exists:()=>E,exit:()=>Ln,fail:()=>Z,failCause:()=>te,failCauseSync:()=>ne,failSync:()=>ee,fiberId:()=>At,fiberIdWith:()=>Dt,filter:()=>C,filterMap:()=>A,filterOrDie:()=>Rn,filterOrDieMessage:()=>Un,filterOrElse:()=>jn,filterOrFail:()=>_n,finalizersMask:()=>wt,findFirst:()=>D,firstSuccessOf:()=>P,flatMap:()=>zn,flatten:()=>Xn,flip:()=>tt,flipWith:()=>nt,forEach:()=>L,forever:()=>dr,fork:()=>Pt,forkAll:()=>Bt,forkDaemon:()=>Lt,forkIn:()=>Mt,forkScoped:()=>Ft,forkWithErrorHandler:()=>Rt,fromFiber:()=>Ut,fromFiberEffect:()=>jt,fromNullable:()=>no,functionWithSpan:()=>Zi,gen:()=>se,getFiberRefs:()=>Nr,getRuntimeFlags:()=>ri,head:()=>B,if:()=>Fn,ignore:()=>Te,ignoreLogged:()=>Ee,inheritFiberRefs:()=>br,interrupt:()=>$e,interruptWith:()=>Qe,interruptible:()=>Je,interruptibleMask:()=>Ke,intoDeferred:()=>Bn,isEffect:()=>w,isFailure:()=>qr,isSuccess:()=>Tr,iterate:()=>lr,labelMetrics:()=>ci,labelMetricsScoped:()=>li,let:()=>Dn,liftPredicate:()=>He,linkSpans:()=>Vi,locally:()=>vr,locallyScoped:()=>kr,locallyScopedWith:()=>Sr,locallyWith:()=>xr,log:()=>Pr,logAnnotations:()=>Jr,logDebug:()=>Mr,logError:()=>Ur,logFatal:()=>jr,logInfo:()=>Fr,logTrace:()=>Br,logWarning:()=>Rr,logWithLevel:()=>Lr,loop:()=>ur,makeSemaphore:()=>fi,makeSpan:()=>zi,makeSpanScoped:()=>Hi,map:()=>rt,mapAccum:()=>it,mapBoth:()=>ot,mapError:()=>st,mapErrorCause:()=>at,mapInputContext:()=>wn,match:()=>Er,matchCause:()=>Cr,matchCauseEffect:()=>Ar,matchEffect:()=>Dr,merge:()=>ct,mergeAll:()=>M,metricLabels:()=>ui,negate:()=>dt,never:()=>ae,none:()=>ce,onError:()=>mt,onExit:()=>yt,onInterrupt:()=>Ye,once:()=>k,option:()=>Mn,optionFromOptional:()=>ro,orDie:()=>Yr,orDieWith:()=>Vr,orElse:()=>zr,orElseFail:()=>Hr,orElseSucceed:()=>Xr,parallelErrors:()=>Ce,parallelFinalizers:()=>gt,partition:()=>F,patchFiberRefs:()=>Or,patchRuntimeFlags:()=>ii,promise:()=>de,provide:()=>Nn,provideService:()=>bn,provideServiceEffect:()=>vn,race:()=>Zn,raceAll:()=>Gn,raceFirst:()=>er,raceWith:()=>tr,random:()=>Gr,randomWith:()=>Zr,reduce:()=>R,reduceEffect:()=>U,reduceRight:()=>j,reduceWhile:()=>_,repeat:()=>pr,repeatN:()=>hr,repeatOrElse:()=>fr,replicate:()=>$,replicateEffect:()=>Q,request:()=>Ci,retry:()=>De,retryOrElse:()=>Pe,runCallback:()=>yi,runFork:()=>mi,runPromise:()=>gi,runPromiseExit:()=>wi,runRequestBlock:()=>Ti,runSync:()=>Ni,runSyncExit:()=>bi,runtime:()=>ni,sandbox:()=>Ae,schedule:()=>mr,scheduleForked:()=>yr,scheduleFrom:()=>gr,scope:()=>bt,scopeWith:()=>vt,scoped:()=>xt,sequentialFinalizers:()=>Nt,serviceConstants:()=>On,serviceFunction:()=>xn,serviceFunctionEffect:()=>kn,serviceFunctions:()=>Sn,serviceMembers:()=>Wn,serviceOption:()=>In,serviceOptional:()=>qn,setFiberRefs:()=>Wr,sleep:()=>rn,spanAnnotations:()=>Ki,spanLinks:()=>Yi,step:()=>Ei,succeed:()=>le,succeedNone:()=>ue,succeedSome:()=>pe,summarized:()=>nr,supervised:()=>_t,suspend:()=>he,sync:()=>fe,tagMetrics:()=>ai,tagMetricsScoped:()=>di,takeUntil:()=>J,takeWhile:()=>K,tap:()=>rr,tapBoth:()=>ir,tapDefect:()=>or,tapError:()=>sr,tapErrorCause:()=>cr,tapErrorTag:()=>ar,timed:()=>on,timedWith:()=>sn,timeout:()=>an,timeoutFail:()=>dn,timeoutFailCause:()=>ln,timeoutOption:()=>cn,timeoutTo:()=>un,tracer:()=>Bi,tracerWith:()=>Mi,transplant:()=>$t,try:()=>Le,tryMap:()=>Be,tryMapPromise:()=>Me,tryPromise:()=>Fe,uninterruptible:()=>Ve,uninterruptibleMask:()=>ze,unless:()=>$n,unlessEffect:()=>Qn,unsafeMakeSemaphore:()=>hi,unsandbox:()=>Re,updateFiberRefs:()=>Ir,updateService:()=>Tn,useSpan:()=>Xi,using:()=>kt,validate:()=>vi,validateAll:()=>Y,validateFirst:()=>V,validateWith:()=>xi,void:()=>me,when:()=>Jn,whenEffect:()=>Kn,whenFiberRef:()=>Yn,whenRef:()=>Vn,whileLoop:()=>wr,withClock:()=>Xt,withClockScoped:()=>Ht,withConcurrency:()=>Qt,withConfigProvider:()=>hn,withConfigProviderScoped:()=>fn,withConsole:()=>tn,withConsoleScoped:()=>en,withEarlyRelease:()=>St,withFiberRuntime:()=>G,withLogSpan:()=>_r,withMaxOpsBeforeYield:()=>Yt,withMetric:()=>pi,withParentSpan:()=>to,withRandom:()=>ei,withRandomScoped:()=>ti,withRequestBatching:()=>Di,withRequestCache:()=>Li,withRequestCaching:()=>Pi,withRuntimeFlagsPatch:()=>oi,withRuntimeFlagsPatchScoped:()=>si,withScheduler:()=>Jt,withSchedulingPriority:()=>Kt,withSpan:()=>Gi,withSpanScoped:()=>eo,withTracer:()=>Fi,withTracerEnabled:()=>Ui,withTracerScoped:()=>Ri,withTracerTiming:()=>ji,withUnhandledErrorLogLevel:()=>Kr,yieldNow:()=>ye,zip:()=>ki,zipLeft:()=>Si,zipRight:()=>Oi,zipWith:()=>Wi});var r=n(61369),i=n(32706),o=n(83768),s=n(20808),a=n(72620),c=n(44862),d=n(12164),l=n(60356),u=n(86881),p=n(99752),h=n(3611),f=n(80561),m=n(66172),y=n(71108);const g=a.$n1,w=a.yw5,N=d.PO,b=d.CJ,v=s.Bj,x=d.L_,k=s.Oo,S=l.Q7,O=l._y,W=l.XU,I=s.Cm,q=s.Hd,T=s.Si,E=l.t2,C=l.pb,A=s.x1,D=s.i8,P=s.Dd,L=l.jJ,B=s.d5,M=l.B1,F=l.jB,R=s.TS,U=l.GH,j=s.XK,_=s.KE,$=l.aA,Q=l.Xr,J=s.QK,K=s.v6,Y=l.wM,V=l.nO,z=a.bIC,H=h.a1,X=a.IeY,G=a.$we,Z=a.fJG,ee=a.gOk,te=a.ATB,ne=a.pVV,re=a.F_Q,ie=a.GSS,oe=a.Kbz,se=s.Jk,ae=a.ZmZ,ce=s.dv,de=s.iv,le=a.PyW,ue=s.lw,pe=s.nG,he=a.DYE,fe=a.OH5,me=a.rIH,ye=a.m9E,ge=s.nb,we=a.h9N,Ne=a.uPo,be=s.IK,ve=a.XWm,xe=a._Oy,ke=s.RJ,Se=s.Nu,Oe=s.Ku,We=s.lo,Ie=s.c1,qe=s.u4,Te=s.Xe,Ee=s.XP,Ce=s.Zk,Ae=s._S,De=f.nn,Pe=f.H_,Le=s.bS,Be=s.gZ,Me=s.xA,Fe=s.$m,Re=s.Pb,Ue=s.vV,je=a._5X,_e=l.Zf,$e=a.GaK,Qe=a.IPo,Je=a.Inz,Ke=a.eMl,Ye=a.nAr,Ve=a.rfi,ze=a.FcF,He=s.VW,Xe=a.as,Ge=s.Xx,Ze=s.t2,et=a.NLW,tt=a.UUz,nt=s.AA,rt=a.TjK,it=s.OM,ot=a.UcN,st=a.xm_,at=s.aW,ct=s.h1,dt=s.ze,lt=l.Q5,ut=l.p5,pt=a.jGc,ht=l.U9,ft=l.ye,mt=a.S5A,yt=a.cfM,gt=l.dJ,wt=l.ct,Nt=l.PO,bt=l.z8,vt=l.NB,xt=l.sZ,kt=l.v,St=l.lg,Ot=d.PC,Wt=l.e7,It=s.yu,qt=s.U$,Tt=s.Ek,Et=d.GR,Ct=d.jE,At=a.ABT,Dt=a.g1G,Pt=l.Zy,Lt=l.LX,Bt=d.Oy,Mt=d.ar,Ft=d.x6,Rt=l.Bh,Ut=d.$T,jt=d.qK,_t=d.Tg,$t=a.sK9,Qt=a.KyM,Jt=y.kW,Kt=a.FRe,Yt=a.jDN,Vt=s.pm,zt=s.RK,Ht=l.rh,Xt=c.V6,Gt=i.k2,Zt=i.un,en=i.Q_,tn=i.QW,nn=s.cb,rn=s.yy,on=s.ay,sn=s.yW,an=d.wR,cn=d.D5,dn=d.AN,ln=d.ny,un=d.nH,pn=c.aP,hn=c.gm,fn=l.Ek,mn=a._OA,yn=s.sx,gn=a.d_m,wn=a.kyh,Nn=u.up,bn=s.Pf,vn=s.c7,xn=s.A3,kn=s.p4,Sn=s.KO,On=s.XN,Wn=s.ZF,In=s.N,qn=s.gB,Tn=s.bU,En=s.Do,Cn=s.oI,An=s.Jr,Dn=s.zM,Pn=a.gPK,Ln=a.NS5,Bn=a._ig,Mn=s.uK,Fn=a.tDT,Rn=s.kr,Un=s.Nf,jn=s.Pm,_n=s.W$,$n=s.NJ,Qn=s.ix,Jn=s.z7,Kn=a.iK2,Yn=s.iz,Vn=s.mf,zn=a.qIB,Hn=a.hgn,Xn=a.Bqz,Gn=l.Vd,Zn=l.O4,er=d.KT,tr=l.wV,nr=s.Uy,rr=a.Mim,ir=s.Bi,or=s.nA,sr=s.sF,ar=s.TN,cr=s.Ly,dr=s.i4,lr=s.nl,ur=s.HW,pr=f.Mj,hr=s.wn,fr=f.g2,mr=f.mg,yr=d.Rq,gr=f.Av,wr=a.iMI,Nr=s.rQ,br=s.EN,vr=a.woH,xr=a.q1t,kr=l.Eq,Sr=l._1,Or=s.Bz,Wr=s.Z,Ir=s.En,qr=s.N6,Tr=s.oJ,Er=s.YW,Cr=a.D$$,Ar=a.khu,Dr=a.tvg,Pr=s.Rm,Lr=(e,...t)=>s.lI(e)(...t),Br=s.om,Mr=s.MD,Fr=s.fH,Rr=s.FF,Ur=s.Og,jr=s.Zc,_r=s.f1,$r=s.sw,Qr=l.gs,Jr=s.rr,Kr=a.EYO,Yr=a.QgK,Vr=a.kS9,zr=a.NWQ,Hr=s.xS,Xr=s.DM,Gr=s.yT,Zr=c.Gx,ei=c.Ii,ti=l.AA,ni=h.fA,ri=a.m$m,ii=a.$QS,oi=a.cay,si=l.qH,ai=s.G6,ci=s.Mw,di=l.Yt,li=l.oi,ui=a.SLb,pi=s.Xz,hi=d.RI,fi=d.VH,mi=h.C9,yi=h.HZ,gi=h.w$,wi=h.MN,Ni=h.wg,bi=h.ej,vi=l.tf,xi=l.xJ,ki=l.SJ,Si=l.Ne,Oi=l.OC,Wi=l.cw,Ii=(0,r.XY)(2,((e,t)=>Wi(e,t,((e,t)=>e(t))))),qi=a.Z5i,Ti=a.UFt,Ei=a.PMw,Ci=(0,r.XY)((e=>m.ks(e[0])),p.kc),Ai=p.QA,Di=a.mHP,Pi=p.f0,Li=p.Uj,Bi=s.kJ,Mi=c.wT,Fi=c._o,Ri=l.i4,Ui=a.nDN,ji=a.MaT,_i=s.Mu,$i=s.ww,Qi=s._3,Ji=s.Wj,Ki=s.Fu,Yi=s.Wb,Vi=s.A_,zi=s.Z9,Hi=l.Rd,Xi=s.gv,Gi=s.fR,Zi=s.RO,eo=l.zr,to=s.hq,no=s.k$,ro=s.SM,io=e=>()=>{const t=Error.stackTraceLimit;Error.stackTraceLimit=2;const n=new Error;function r(){}Error.stackTraceLimit=t,Object.setPrototypeOf(r,o.XI),r.key=e,Object.defineProperty(r,"stack",{get:()=>n.stack});const i=new Map;return new Proxy(r,{get(e,t,n){if("use"===t)return e=>a.hgn(r,e);if(t in r)return r[t];if(i.has(t))return i.get(t);const o=(...e)=>a.hgn(r,(n=>"function"==typeof n[t]?(i.set(t,((...e)=>a.hgn(r,(n=>n[t](...e))))),n[t](...e)):(i.set(t,a.hgn(r,(e=>e[t]))),n[t]))),s=a.hgn(r,(e=>e[t]));return Object.assign(o,s),Object.setPrototypeOf(o,Object.getPrototypeOf(s)),i.set(t,o),o}})}},61369:(e,t,n)=>{n.d(t,{D_:()=>o,Fs:()=>p,GQ:()=>u,L3:()=>h,MN:()=>d,Tn:()=>r,XY:()=>i,Yi:()=>l,dY:()=>s,f4:()=>c,ue:()=>a});const r=e=>"function"==typeof e,i=function(e,t){if("function"==typeof e)return function(){return e(arguments)?t.apply(this,arguments):e=>t(e,...arguments)};switch(e){case 0:case 1:throw new RangeError(`Invalid arity ${e}`);case 2:return function(e,n){return arguments.length>=2?t(e,n):function(n){return t(n,e)}};case 3:return function(e,n,r){return arguments.length>=3?t(e,n,r):function(r){return t(r,e,n)}};case 4:return function(e,n,r,i){return arguments.length>=4?t(e,n,r,i):function(i){return t(i,e,n,r)}};case 5:return function(e,n,r,i,o){return arguments.length>=5?t(e,n,r,i,o):function(o){return t(o,e,n,r,i)}};default:return function(){if(arguments.length>=e)return t.apply(this,arguments);const n=arguments;return function(e){return t(e,...n)}}}},o=e=>e,s=e=>()=>e,a=s(!0),c=s(!1),d=s(void 0),l=d,u=e=>{throw new Error("Called `absurd` function which should be uncallable")};function p(e,t,n,r,i,o,s,a,c){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return n(t(e));case 4:return r(n(t(e)));case 5:return i(r(n(t(e))));case 6:return o(i(r(n(t(e)))));case 7:return s(o(i(r(n(t(e))))));case 8:return a(s(o(i(r(n(t(e)))))));case 9:return c(a(s(o(i(r(n(t(e))))))));default:{let e=arguments[0];for(let t=1;t<arguments.length;t++)e=arguments[t](e);return e}}}function h(e,t,n,r,i,o,s,a,c){switch(arguments.length){case 1:return e;case 2:return function(){return t(e.apply(this,arguments))};case 3:return function(){return n(t(e.apply(this,arguments)))};case 4:return function(){return r(n(t(e.apply(this,arguments))))};case 5:return function(){return i(r(n(t(e.apply(this,arguments)))))};case 6:return function(){return o(i(r(n(t(e.apply(this,arguments))))))};case 7:return function(){return s(o(i(r(n(t(e.apply(this,arguments)))))))};case 8:return function(){return a(s(o(i(r(n(t(e.apply(this,arguments))))))))};case 9:return function(){return c(a(s(o(i(r(n(t(e.apply(this,arguments)))))))))}}}},86780:(e,t,n)=>{n.d(t,{Gt:()=>u,Py:()=>l,QZ:()=>a,Um:()=>d,_O:()=>s,h1:()=>c,jq:()=>o});var r=n(86881),i=n(8624);r.Lc,r.mH,r.IW,r.pL,r.sw,r.Mu;const o=r.jq,s=(r.LT,r.h9,r.uP,r._O),a=(r.F_,r.Kb,r.vf,r.uS),c=(r.AC,r.Nf,r.Ie,r.XE,r.fJ,r.gO,r.AT,r.pV,r.qI,r.Bq,r.pn,r.Xx,r.ql,r.Tj,r.xm,r.YW,r.D$,r.Bj,r.h1),d=r.Um,l=(r.Qg,r.NW,r.le,r.Cv,r.sk,r.wo,r.q1,r.Eq,r._1,r.L5,r.z8,r.P1,r.dm,r.qA,r.eu,r.Py),u=(r.Or,r.DY,r.OH,r.Jc,r.Mi,r.sF,r.Ly,r.Qf,r.Yp,r.Gt);r.S5,r.OY,r.vM,r.A2,i.e2,i.$5,i.cL,i.mv,r.fR,r.hq,r.vh,r.H7},4676:(e,t,n)=>{n.d(t,{GV:()=>s,Kt:()=>a,U5:()=>d,pH:()=>c,qg:()=>l});var r=n(35309),i=n(8578),o=n(59877);n(56572).Et;const s=e=>e+1,a=e=>e-1,c=(r.ai,o.ai),d=e=>{const t=Math.ceil(Math.log(e)/Math.log(2));return Math.max(Math.pow(2,t),2)},l=e=>{if("NaN"===e)return i.zN(NaN);if("Infinity"===e)return i.zN(1/0);if("-Infinity"===e)return i.zN(-1/0);if(""===e.trim())return i.dv;const t=Number(e);return Number.isNaN(t)?i.dv:i.zN(t)}},56572:(e,t,n)=>{n.d(t,{$J:()=>w,$P:()=>x,$X:()=>O,$y:()=>b,Bm:()=>d,EA:()=>p,Et:()=>s,Gv:()=>y,Kg:()=>o,Lm:()=>a,Pd:()=>f,Tn:()=>l,b0:()=>u,i5:()=>g,kZ:()=>h,mg:()=>v,sI:()=>c,u4:()=>S,wD:()=>N,xZ:()=>k,zz:()=>i});var r=n(61369);const i=e=>!!e,o=e=>"string"==typeof e,s=e=>"number"==typeof e,a=e=>"boolean"==typeof e,c=e=>"bigint"==typeof e,d=e=>"symbol"==typeof e,l=r.Tn,u=e=>void 0===e,p=e=>void 0!==e,h=e=>null===e,f=e=>!1,m=e=>"object"==typeof e&&null!==e,y=e=>m(e)||l(e),g=(0,r.XY)(2,((e,t)=>y(e)&&t in e)),w=(0,r.XY)(2,((e,t)=>g(e,"_tag")&&e._tag===t)),N=e=>null==e,b=e=>null!=e,v=e=>e instanceof Uint8Array,x=e=>e instanceof Date,k=e=>g(e,Symbol.iterator),S=e=>m(e)&&!Array.isArray(e),O=e=>g(e,"then")&&l(e.then)},27652:(e,t,n)=>{n.d(t,{Bd:()=>i,i4:()=>o,ji:()=>a,t5:()=>s});var r=n(80561);r.NU,r.rk,r.g7,r.VN,r.Y4,r.hg,r.y8,r.as,r.NL,r.FX,r.z6,r.ab,r.vt,r.IE,r.Fh,r.Mc,r.wu,r.tB,r.Zz,r.zQ,r.ky,r.K7,r.U9,r.BW,r.SD,r.mK,r.Nw,r.ol,r.iq,r.xA,r.Uc,r.$E;const i=r.Bd,o=(r.p0,r.gP,r.k$,r.vk,r.ye,r.EV,r.$_,r.Zu,r.i4),s=(r._E,r.Ht,r.Xx,r.cf,r.D_,r.y$,r.SV,r.et,r.q3,r.sn,r.Tj,r.WK,r.cM,r.y1,r.Nb,r.u1,r.Oo,r.le,r.Pp,r.Pf,r.oG,r.$y,r.Vf,r.O5,r.FP,r.fE,r.t5),a=(r.TS,r.GH,r.i4,r.Xu,r.yj,r.uw,r.eF,r.Qn,r.ji);r.ds,r.Py,r.OH,r.EM,r.NZ,r.t8,r.KC,r.q2,r.RY,r.GE,r.m$,r.HI,r.jB,r.O9,r.vm,r.v,r.ph,r.Ix,r.pi,r.aN,r.OY},32706:(e,t,n)=>{n.d(t,{BU:()=>v,CE:()=>A,I1:()=>C,IU:()=>y,Os:()=>k,QW:()=>p,Q_:()=>h,R8:()=>E,Rm:()=>O,Ts:()=>w,U9:()=>g,Yz:()=>N,al:()=>q,k2:()=>l,kB:()=>I,oV:()=>f,pq:()=>S,tp:()=>W,uP:()=>T,un:()=>u,vA:()=>m,y_:()=>b,z3:()=>x});var r=n(89702),i=n(61369),o=n(72620),s=n(44862),a=n(72572),c=n(60356),d=n(86881);const l=o.TjK(o.U8_(s.qJ),r.Jt(a.MG)),u=e=>o.uPR(s.qJ,(t=>e(r.Jt(t,a.MG)))),p=(0,i.XY)(2,((e,t)=>o.q1t(e,s.qJ,r.WQ(a.MG,t)))),h=e=>c._1(s.qJ,r.WQ(a.MG,e)),f=e=>d.dm(c._1(s.qJ,r.WQ(a.MG,e))),m=(e,...t)=>u((n=>n.assert(e,...t))),y=u((e=>e.clear)),g=e=>u((t=>t.count(e))),w=e=>u((t=>t.countReset(e))),N=(...e)=>u((t=>t.debug(...e))),b=(e,t)=>u((n=>n.dir(e,t))),v=(...e)=>u((t=>t.dirxml(...e))),x=(...e)=>u((t=>t.error(...e))),k=e=>u((t=>c.Q5(t.group(e),(()=>t.groupEnd)))),S=(...e)=>u((t=>t.info(...e))),O=(...e)=>u((t=>t.log(...e))),W=(e,t)=>u((n=>n.table(e,t))),I=e=>u((t=>c.Q5(t.time(e),(()=>t.timeEnd(e))))),q=(e,...t)=>u((n=>n.timeLog(e,...t))),T=(...e)=>u((t=>t.trace(...e))),E=(...e)=>u((t=>t.warn(...e))),C=(0,i.XY)((e=>o.yw5(e[0])),((e,t)=>u((n=>o.jGc(n.group(t),(()=>e),(()=>n.groupEnd)))))),A=(0,i.XY)((e=>o.yw5(e[0])),((e,t)=>u((n=>o.jGc(n.time(t),(()=>e),(()=>n.timeEnd(t)))))))},83768:(e,t,n)=>{n.d(t,{$v:()=>O,Ie:()=>x,Jt:()=>W,KA:()=>f,L8:()=>k,Sr:()=>u,Up:()=>T,WQ:()=>S,XI:()=>h,aE:()=>N,cJ:()=>E,dz:()=>b,h1:()=>q,ii:()=>y,og:()=>w,om:()=>I,vw:()=>m});var r=n(43977),i=n(61369),o=n(67337),s=n(83845),a=n(53533),c=n(56572),d=n(68498),l=n(8578);const u=Symbol.for("effect/Context/Tag"),p=Symbol.for("effect/STM"),h={...d.MS,_tag:"Tag",_op:"Tag",[p]:d.Hs,[u]:{_Service:e=>e,_Identifier:e=>e},toString(){return(0,s.GP)(this.toJSON())},toJSON(){return{_id:"Tag",key:this.key,stack:this.stack}},[s.FX](){return this.toJSON()},of:e=>e,context(e){return k(this,e)}},f=e=>{const t=Error.stackTraceLimit;Error.stackTraceLimit=2;const n=new Error;Error.stackTraceLimit=t;const r=Object.create(h);return Object.defineProperty(r,"stack",{get:()=>n.stack}),r.key=e,r},m=e=>()=>{const t=Error.stackTraceLimit;Error.stackTraceLimit=2;const n=new Error;function r(){}return Error.stackTraceLimit=t,Object.setPrototypeOf(r,h),r.key=e,Object.defineProperty(r,"stack",{get:()=>n.stack}),r},y=Symbol.for("effect/Context"),g={[y]:{_Services:e=>e},[r.HR](e){if(N(e)&&this.unsafeMap.size===e.unsafeMap.size){for(const t of this.unsafeMap.keys())if(!e.unsafeMap.has(t)||!r.aI(this.unsafeMap.get(t),e.unsafeMap.get(t)))return!1;return!0}return!1},[o.HR](){return o.PO(this,o.ai(this.unsafeMap.size))},pipe(){return(0,a.t)(this,arguments)},toString(){return(0,s.GP)(this.toJSON())},toJSON(){return{_id:"Context",services:Array.from(this.unsafeMap).map(s.U2)}},[s.FX](){return this.toJSON()}},w=e=>{const t=Object.create(g);return t.unsafeMap=e,t},N=e=>(0,c.i5)(e,y),b=e=>(0,c.i5)(e,u),v=w(new Map),x=()=>v,k=(e,t)=>w(new Map([[e.key,t]])),S=(0,i.XY)(3,((e,t,n)=>{const r=new Map(e.unsafeMap);return r.set(t.key,n),w(r)})),O=(0,i.XY)(2,((e,t)=>{if(!e.unsafeMap.has(t.key))throw(e=>{const t=new Error("Service not found"+(e.key?`: ${String(e.key)}`:""));if(e.stack){const n=e.stack.split("\n");if(n.length>2){const e=n[2].match(/at (.*)/);e&&(t.message=t.message+` (defined at ${e[1]})`)}}if(t.stack){const e=t.stack.split("\n");e.splice(1,3),t.stack=e.join("\n")}return t})(t);return e.unsafeMap.get(t.key)})),W=O,I=(0,i.XY)(2,((e,t)=>e.unsafeMap.has(t.key)?l.zN(e.unsafeMap.get(t.key)):l.dv)),q=(0,i.XY)(2,((e,t)=>{const n=new Map(e.unsafeMap);for(const[e,r]of t.unsafeMap)n.set(e,r);return w(n)})),T=(...e)=>t=>{const n=new Set(e.map((e=>e.key))),r=new Map;for(const[e,i]of t.unsafeMap.entries())n.has(e)&&r.set(e,i);return w(r)},E=(...e)=>t=>{const n=new Map(t.unsafeMap);for(const t of e)n.delete(t.key);return w(n)}},20808:(e,t,n)=>{n.d(t,{$m:()=>kt,A3:()=>Bt,AA:()=>le,A_:()=>Kt,Bi:()=>mt,Bj:()=>Re,Bz:()=>Ve,Cm:()=>X,DM:()=>Ke,Dd:()=>de,Do:()=>Y,EN:()=>be,Ek:()=>K,En:()=>Tt,FF:()=>Te,Fu:()=>Ht,G6:()=>ut,HW:()=>Pe,Hd:()=>G,IK:()=>P,Jk:()=>me,Jr:()=>z,KE:()=>tt,KO:()=>Mt,Ku:()=>M,Ly:()=>Nt,MD:()=>Ie,Mu:()=>$t,Mw:()=>pt,N:()=>Ut,N6:()=>ve,NJ:()=>Wt,Nf:()=>re,Nu:()=>B,OM:()=>Me,Og:()=>Ee,Oo:()=>$e,Pb:()=>qt,Pf:()=>He,Pm:()=>ie,QK:()=>ht,RJ:()=>L,RK:()=>U,RO:()=>nn,Rm:()=>Oe,SM:()=>on,Si:()=>pe,TN:()=>wt,TS:()=>Ze,U$:()=>$,Uy:()=>lt,VW:()=>oe,W$:()=>se,Wb:()=>Xt,Wj:()=>Qt,XK:()=>et,XN:()=>Ft,XP:()=>Ne,Xe:()=>we,Xx:()=>E,Xz:()=>Pt,YW:()=>ue,Z:()=>st,Z9:()=>zt,ZF:()=>Rt,Zc:()=>Ce,Zk:()=>Ye,_3:()=>Jt,_S:()=>ot,aW:()=>Fe,ay:()=>bt,bS:()=>A,bU:()=>Et,c1:()=>R,c7:()=>Xe,cb:()=>_,d5:()=>ge,dv:()=>_e,ex:()=>Gt,f1:()=>Ae,fH:()=>qe,fR:()=>tn,gB:()=>jt,gZ:()=>St,gv:()=>Zt,h1:()=>Ue,hq:()=>en,i4:()=>fe,i8:()=>ae,iv:()=>ze,ix:()=>It,iz:()=>At,k$:()=>rn,kJ:()=>xt,kr:()=>ne,lI:()=>Se,lo:()=>F,lw:()=>ct,mf:()=>Dt,nA:()=>yt,nG:()=>dt,nb:()=>D,nl:()=>ke,oI:()=>V,oJ:()=>xe,om:()=>We,p4:()=>Lt,pm:()=>j,rQ:()=>ye,rr:()=>De,sF:()=>gt,sw:()=>T,sx:()=>Z,t2:()=>C,u4:()=>ee,uK:()=>Qe,v6:()=>ft,vV:()=>Q,wn:()=>rt,ww:()=>_t,x1:()=>te,xA:()=>Ot,xI:()=>Vt,xS:()=>Je,yT:()=>Ge,yW:()=>vt,yu:()=>J,yy:()=>at,z7:()=>Ct,zM:()=>H,ze:()=>je});var r=n(30276),i=n(58600),o=n(28420),s=n(31651),a=n(89702),c=n(84073),d=n(11486),l=n(61369),u=n(5583),p=n(49942),h=n(89425),f=n(34321),m=n(4971),y=n(77948),g=n(56572),w=n(55040),N=n(32028),b=n(8197),v=n(14969),x=n(72620),k=n(44862),S=n(91276),O=n(92538),W=n(58762),I=n(66932),q=n(27514);const T=(0,l.XY)((e=>x.yw5(e[0])),(function(){const e=arguments;return x.q1t(e[0],x.Umi,"string"==typeof e[1]?u.hZ(e[1],e[2]):t=>Object.entries(e[1]).reduce(((e,[t,n])=>u.hZ(e,t,n)),t))})),E=e=>x.TjK(e,y.zN),C=e=>x.xm_(e,y.zN),A=e=>{let t,n;return"function"==typeof e?t=e:(t=e.try,n=e.catch),x.OH5((()=>{try{return t()}catch(e){throw x.eO_(b.fJ(n?n(e):new x.Uis(e)))}}))},D=(0,l.XY)(3,((e,t,n)=>x.h9N(e,(e=>g.i5(e,t)&&e[t]===n.failure?n.onFailure(e):x.fJG(e))))),P=(0,l.XY)(2,((e,t)=>x.uPo(e,(e=>{const n=b.I6(e,(e=>b.VY(e)?y.zN(e):y.dv()));switch(n._tag){case"None":return x.ATB(e);case"Some":return t(n.value.defect)}})))),L=(0,l.XY)(2,((e,t)=>x.khu(e,{onFailure:e=>{const n=t(e);switch(n._tag){case"None":return x.ATB(e);case"Some":return n.value}},onSuccess:x.PyW}))),B=(0,l.XY)(2,((e,t)=>x.uPo(e,(e=>{const n=b.I6(e,(e=>b.VY(e)?y.zN(e):y.dv()));switch(n._tag){case"None":return x.ATB(e);case"Some":{const r=t(n.value.defect);return"Some"===r._tag?r.value:x.ATB(e)}}})))),M=(0,l.XY)(3,((e,t,n)=>x.XWm(e,g.$J(t),n))),F=(0,l.XY)(2,((e,t)=>{let n;return x.XWm(e,(e=>(n??=Object.keys(t),g.i5(e,"_tag")&&g.Kg(e._tag)&&n.includes(e._tag))),(e=>t[e._tag](e)))})),R=e=>x.D$$(e,{onFailure:l.D_,onSuccess:()=>b.Ie}),U=s.RK,j=U(x.PyW),_=(0,l.XY)(2,((e,t)=>x.aNH(s.yy(t),e))),$=e=>x.$we(((t,n)=>e({id:t.id(),status:n,interruptors:b.ml(t.getFiberRef(x.LGt))}))),Q=$((e=>p.Ej(e.interruptors)>0?x.GaK:x.rIH)),J=$(x.PyW),K=e=>lt(e,ye,O.Ui),Y=x.PyW({}),V=S.oI(x.TjK,x.qIB),z=S.Jr(x.TjK),H=S.zM(x.TjK),X=(0,l.XY)(2,((e,t)=>x.DYE((()=>{const n=e[Symbol.iterator](),r=[];let i,o=x.PyW(!1),s=0;for(;(i=n.next())&&!i.done;){const e=i.value,n=s++;o=x.qIB(o,(i=>i?(r.push(e),x.PyW(!0)):t(e,n)))}return x.TjK(o,(()=>r))})))),G=(0,l.XY)(2,((e,t)=>x.DYE((()=>{const n=e[Symbol.iterator](),r=[];let i,o=x.PyW(!0),s=0;for(;(i=n.next())&&!i.done;){const e=i.value,n=s++;o=x.qIB(o,(i=>x.TjK(i?t(e,n):x.PyW(!1),(t=>(t||r.push(e),t)))))}return x.TjK(o,(()=>r))})))),Z=e=>x.TjK(x._OA(),e),ee=e=>x.NWQ(e,(()=>x.qIB(x.m9E(),(()=>ee(e))))),te=(0,l.XY)(2,((e,t)=>x.TjK(x.CFK(e,l.D_),i.x1(t)))),ne=(0,l.XY)(3,((e,t,n)=>ie(e,t,(e=>x.Kbz((()=>n(e))))))),re=(0,l.XY)(3,((e,t,n)=>ie(e,t,(()=>x.GSS(n))))),ie=(0,l.XY)(3,((e,t,n)=>x.qIB(e,(e=>t(e)?x.PyW(e):n(e))))),oe=(0,l.XY)(3,((e,t,n)=>x.DYE((()=>t(e)?x.PyW(e):x.fJG(n(e)))))),se=(0,l.XY)((e=>x.yw5(e[0])),((e,t,n)=>ie(e,t,(e=>void 0===n?x.fJG(new x.kJg):x.gOk((()=>n(e))))))),ae=(0,l.XY)(2,((e,t)=>x.DYE((()=>{const n=e[Symbol.iterator](),r=n.next();return r.done?x.PyW(y.dv()):ce(n,0,t,r.value)})))),ce=(e,t,n,r)=>x.qIB(n(r,t),(i=>{if(i)return x.PyW(y.zN(r));const o=e.next();return o.done?x.PyW(y.dv()):ce(e,t+1,n,o.value)})),de=e=>x.DYE((()=>{const t=o.Ts(e);return o.J_(t)?(0,l.Fs)(o.Rx(t),i.TS(o.v4(t),((e,t)=>x.NWQ(e,(()=>t))))):x.Kbz((()=>new x.nAV("Received an empty collection of effects")))})),le=(0,l.XY)(2,((e,t)=>x.UUz(t(x.UUz(e))))),ue=(0,l.XY)(2,((e,t)=>x.tvg(e,{onFailure:e=>x.PyW(t.onFailure(e)),onSuccess:e=>x.PyW(t.onSuccess(e))}))),pe=(0,l.XY)(2,((e,t)=>x.DYE((()=>he(e[Symbol.iterator](),0,t))))),he=(e,t,n)=>{const r=e.next();return r.done?x.PyW(!0):x.qIB(n(r.value,t),(r=>r?he(e,t+1,n):x.PyW(r)))},fe=e=>{const t=x.qIB(x.qIB(e,(()=>x.m9E())),(()=>t));return t},me=function(){let e;return e=1===arguments.length?arguments[0]:arguments[1].bind(arguments[0]),x.DYE((()=>{const t=e(l.Fs),n=(0,r.sn)((()=>t.next())),i=e=>e.done?x.PyW(e.value):x.qIB((0,r.ku)(e.value),(e=>i((0,r.sn)((()=>t.next(e))))));return i(n)}))},ye=x.$we((e=>x.PyW(e.getFiberRefs()))),ge=e=>x.qIB(e,(e=>{const t=e[Symbol.iterator]().next();return t.done?x.fJG(new x.kJg):x.PyW(t.value)})),we=e=>ue(e,{onFailure:l.Yi,onSuccess:l.Yi}),Ne=e=>x.khu(e,{onFailure:e=>Ie(e,"An error was silently ignored because it is not anticipated to be useful"),onSuccess:()=>x.rIH}),be=e=>Tt(((t,n)=>d.rl(n,t,e))),ve=e=>ue(e,{onFailure:l.ue,onSuccess:l.f4}),xe=e=>ue(e,{onFailure:l.f4,onSuccess:l.ue}),ke=(e,t)=>x.DYE((()=>t.while(e)?x.qIB(t.body(e),(e=>ke(e,t))):x.PyW(e))),Se=e=>(...t)=>{const n=y.k$(e);let r;for(let e=0,n=t.length;e<n;e++){const n=t[e];b.Aj(n)&&(r=void 0!==r?b.il(r,n):n,t=[...t.slice(0,e),...t.slice(e+1)],e--)}return void 0===r&&(r=b.Ie),x.$we((e=>(e.log(t,r,n),x.rIH)))},Oe=Se(),We=Se(f.Cn),Ie=Se(f.y),qe=Se(f.R2),Te=Se(f.N5),Ee=Se(f.$D),Ce=Se(f.Lj),Ae=(0,l.XY)(2,((e,t)=>x.qIB(s.Ru,(n=>x.q1t(e,x.krO,h.Hs(m.L(t,n))))))),De=x.U8_(x.Umi),Pe=(e,t)=>t.discard?Be(e,t.while,t.step,t.body):x.TjK(Le(e,t.while,t.step,t.body),i.Ts),Le=(e,t,n,r)=>x.DYE((()=>t(e)?x.qIB(r(e),(i=>x.TjK(Le(n(e),t,n,r),h.Hs(i)))):x.OH5((()=>h.Ie())))),Be=(e,t,n,r)=>x.DYE((()=>t(e)?x.qIB(r(e),(()=>Be(n(e),t,n,r))):x.rIH)),Me=(0,l.XY)(3,((e,t,n)=>x.DYE((()=>{const r=e[Symbol.iterator](),i=[];let o,s=x.PyW(t),a=0;for(;!(o=r.next()).done;){const e=a++,t=o.value;s=x.qIB(s,(r=>x.TjK(n(r,t,e),(([e,t])=>(i.push(t),e)))))}return x.TjK(s,(e=>[e,i]))})))),Fe=(0,l.XY)(2,((e,t)=>x.khu(e,{onFailure:e=>x.pVV((()=>t(e))),onSuccess:x.PyW}))),Re=e=>(0,l.Fs)(x.WW4(),x.qIB((t=>(0,l.Fs)((e=>lt(e,x.yU6(ye,x.m$m),(([e,t],[n,r])=>[O.Ui(e,n),I.Ui(t,r)])))(e),x._ig(t),$e,x.TjK((e=>x.aNH(e,(0,l.Fs)(x.gn0(t),x.qIB((([e,t])=>x.as(x.yU6(Ve(e[0]),x.$QS(e[1])),t))))))))))),Ue=e=>x.tvg(e,{onFailure:e=>x.PyW(e),onSuccess:x.PyW}),je=e=>x.TjK(e,(e=>!e)),_e=e=>x.qIB(e,(e=>{switch(e._tag){case"None":return x.rIH;case"Some":return x.fJG(new x.kJg)}})),$e=e=>x.TjK(w.L8(!0),(t=>x.NLW(x.iK2(e,w.C2(t,!1))))),Qe=e=>x.tvg(e,{onFailure:()=>x.PyW(y.dv()),onSuccess:e=>x.PyW(y.zN(e))}),Je=(0,l.XY)(2,((e,t)=>x.NWQ(e,(()=>x.gOk(t))))),Ke=(0,l.XY)(2,((e,t)=>x.NWQ(e,(()=>x.OH5(t))))),Ye=e=>x.khu(e,{onFailure:e=>{const t=i.Ts(b.e9(e));return 0===t.length?x.ATB(e):x.fJG(t)},onSuccess:x.PyW}),Ve=e=>Tt(((t,n)=>(0,l.Fs)(e,O.F6(t,n)))),ze=e=>e.length>=1?x.bIC(((t,n)=>{e(n).then((e=>t(x.xtk(e))),(e=>t(x.V2G(e))))})):x.bIC((t=>{e().then((e=>t(x.xtk(e))),(e=>t(x.V2G(e))))})),He=(0,l.XY)(3,((e,t,n)=>x.d_m((r=>x.PpN(e,a.WQ(r,t,n)))))),Xe=(0,l.XY)(3,((e,t,n)=>x.d_m((r=>x.qIB(n,(n=>x.PpN(e,(0,l.Fs)(r,a.WQ(t,n))))))))),Ge=k.Gx(x.PyW),Ze=(0,l.XY)(3,((e,t,n)=>i.Ts(e).reduce(((e,t,r)=>x.qIB(e,(e=>n(e,t,r)))),x.PyW(t)))),et=(0,l.XY)(3,((e,t,n)=>i.Ts(e).reduceRight(((e,t,r)=>x.qIB(e,(e=>n(t,e,r)))),x.PyW(t)))),tt=(0,l.XY)(3,((e,t,n)=>x.qIB(x.OH5((()=>e[Symbol.iterator]())),(e=>nt(e,0,t,n.while,n.body))))),nt=(e,t,n,r,i)=>{const o=e.next();return!o.done&&r(n)?x.qIB(i(n,o.value,t),(n=>nt(e,t+1,n,r,i))):x.PyW(n)},rt=(0,l.XY)(2,((e,t)=>x.DYE((()=>it(e,t))))),it=(e,t)=>x.qIB(e,(n=>t<=0?x.PyW(n):x.aNH(x.m9E(),it(e,t-1)))),ot=e=>x.khu(e,{onFailure:x.fJG,onSuccess:x.PyW}),st=e=>x.DYE((()=>d.Au(e))),at=s.yy,ct=x.PyW(y.dv()),dt=e=>x.PyW(y.zN(e)),lt=(0,l.XY)(3,((e,t,n)=>x.qIB(t,(r=>x.qIB(e,(e=>x.TjK(t,(t=>[n(r,t),e])))))))),ut=(0,l.XY)((e=>x.yw5(e[0])),(function(){return pt(arguments[0],"string"==typeof arguments[1]?[W.L8(arguments[1],arguments[2])]:Object.entries(arguments[1]).map((([e,t])=>W.L8(e,t))))})),pt=(0,l.XY)(2,((e,t)=>x.q1t(e,x.b1P,(e=>i.KC(e,t))))),ht=(0,l.XY)(2,((e,t)=>x.DYE((()=>{const n=e[Symbol.iterator](),r=[];let i,o=x.PyW(!1),s=0;for(;(i=n.next())&&!i.done;){const e=i.value,n=s++;o=x.qIB(o,(i=>i?x.PyW(!0):(r.push(e),t(e,n))))}return x.TjK(o,(()=>r))})))),ft=(0,l.XY)(2,((e,t)=>x.DYE((()=>{const n=e[Symbol.iterator](),r=[];let i,o=x.PyW(!0),s=0;for(;(i=n.next())&&!i.done;){const e=i.value,n=s++;o=x.qIB(o,(i=>(0,l.Fs)(i?t(e,n):x.PyW(!1),x.TjK((t=>(t&&r.push(e),t))))))}return x.TjK(o,(()=>r))})))),mt=(0,l.XY)(2,((e,{onFailure:t,onSuccess:n})=>x.khu(e,{onFailure:e=>{const n=b.vE(e);switch(n._tag){case"Left":return x.aNH(t(n.left),x.ATB(e));case"Right":return x.ATB(e)}},onSuccess:e=>x.as(n(e),e)}))),yt=(0,l.XY)(2,((e,t)=>x.uPo(e,(e=>y.YW(b.AW(e),{onNone:()=>x.ATB(e),onSome:n=>x.aNH(t(n),x.ATB(e))}))))),gt=(0,l.XY)(2,((e,t)=>x.khu(e,{onFailure:e=>{const n=b.vE(e);switch(n._tag){case"Left":return x.aNH(t(n.left),x.ATB(e));case"Right":return x.ATB(e)}},onSuccess:x.PyW}))),wt=(0,l.XY)(3,((e,t,n)=>gt(e,(e=>g.$J(e,t)?n(e):x.rIH)))),Nt=(0,l.XY)(2,((e,t)=>x.khu(e,{onFailure:e=>x.aNH(t(e),x.ATB(e)),onSuccess:x.PyW}))),bt=e=>vt(e,s.s0),vt=(0,l.XY)(2,((e,t)=>lt(e,t,((e,t)=>c.cF(t-e))))),xt=(0,N.wT)(x.PyW),kt=e=>{let t,n;return"function"==typeof e?t=e:(t=e.try,n=e.catch),t.length>=1?x.bIC(((e,r)=>{try{t(r).then((t=>e(x.xtk(t))),(t=>e(x.fJG(n?n(t):new x.Uis(t)))))}catch(t){e(x.fJG(n?n(t):new x.Uis(t)))}})):x.bIC((e=>{try{t().then((t=>e(x.xtk(t))),(t=>e(x.fJG(n?n(t):new x.Uis(t)))))}catch(t){e(x.fJG(n?n(t):new x.Uis(t)))}}))},St=(0,l.XY)(2,((e,t)=>x.qIB(e,(e=>A({try:()=>t.try(e),catch:t.catch}))))),Ot=(0,l.XY)(2,((e,t)=>x.qIB(e,(e=>kt({try:t.try.length>=1?n=>t.try(e,n):()=>t.try(e),catch:t.catch}))))),Wt=(0,l.XY)(2,((e,t)=>x.DYE((()=>t()?ct:E(e))))),It=(0,l.XY)(2,((e,t)=>x.qIB(t,(t=>t?ct:E(e))))),qt=e=>Fe(e,b.Bq),Tt=e=>x.$we((t=>(t.setFiberRefs(e(t.id(),t.getFiberRefs())),x.rIH))),Et=(0,l.XY)(3,((e,t,n)=>x.kyh(e,(e=>a.WQ(e,t,n(a.$v(e,t))))))),Ct=(0,l.XY)(2,((e,t)=>x.DYE((()=>t()?x.TjK(e,y.zN):x.PyW(y.dv()))))),At=(0,l.XY)(3,((e,t,n)=>x.qIB(x.U8_(t),(t=>n(t)?x.TjK(e,(e=>[t,y.zN(e)])):x.PyW([t,y.dv()]))))),Dt=(0,l.XY)(3,((e,t,n)=>x.qIB(w.Jt(t),(t=>n(t)?x.TjK(e,(e=>[t,y.zN(e)])):x.PyW([t,y.dv()]))))),Pt=(0,l.XY)(2,((e,t)=>t(e))),Lt=(e,t)=>(...n)=>x.qIB(e,(e=>t(e)(...n))),Bt=(e,t)=>(...n)=>x.TjK(e,(e=>t(e)(...n))),Mt=e=>new Proxy({},{get:(t,n,r)=>(...t)=>x.qIB(e,(e=>e[n](...t)))}),Ft=e=>new Proxy({},{get:(t,n,r)=>x.qIB(e,(e=>x.yw5(e[n])?e[n]:x.PyW(e[n])))}),Rt=e=>({functions:Mt(e),constants:Ft(e)}),Ut=e=>x.TjK(x._OA(),a.om(e)),jt=e=>x.qIB(x._OA(),a.om(e)),_t=function(){const e=arguments;return we(x.qIB(Jt,(t=>x.OH5((()=>{if("string"==typeof e[0])t.attribute(e[0],e[1]);else for(const n in e[0])t.attribute(n,e[0][n])})))))},$t=(0,l.XY)((e=>x.yw5(e[0])),(function(){const e=arguments;return x.q1t(e[0],x.BzD,"string"==typeof e[1]?u.hZ(e[1],e[2]):t=>Object.entries(e[1]).reduce(((e,[t,n])=>u.hZ(e,t,n)),t))})),Qt=jt(q.Te),Jt=x.qIB(x._OA(),(e=>{const t=e.unsafeMap.get(q.Te.key);return void 0!==t&&"Span"===t._tag?x.PyW(t):x.fJG(new x.kJg)})),Kt=(0,l.XY)((e=>x.yw5(e[0])),((e,t,n)=>x.q1t(e,x.s$T,o.BC({_tag:"SpanLink",span:t,attributes:n??{}})))),Yt=BigInt(0),Vt=(e,t,n)=>{if(!1===e.getFiberRef(x.MP9))return x.bVS(t);const r=e.getFiberRef(x.Fi1),c=e.getFiberRef(k.qJ),l=a.Jt(c,q.Ez),p=a.Jt(c,s.zD),h=e.getFiberRef(x.QYw),f=e.getFiberRefs(),m=d.Jt(f,x.BzD),g=d.Jt(f,x.s$T),w=n.parent?y.zN(n.parent):n.root?y.dv():a.om(r,q.Te),N="Some"===g._tag?void 0!==n.links?[...o.h3(g.value),...n.links??[]]:o.h3(g.value):n.links??i.Ie(),v=l.span(t,w,n.context??a.Ie(),N,h?p.unsafeCurrentTimeNanos():Yt,n.kind??"internal");return"function"==typeof n.captureStackTrace&&b.rF.set(v,n.captureStackTrace),"Some"===m._tag&&u.jJ(m.value,((e,t)=>v.attribute(t,e))),void 0!==n.attributes&&Object.entries(n.attributes).forEach((([e,t])=>v.attribute(e,t))),v},zt=(e,t)=>(t=q.ZA(t),x.$we((n=>x.PyW(Vt(n,e,t))))),Ht=x.U8_(x.BzD),Xt=x.U8_(x.s$T),Gt=(e,t,n,r)=>x.OH5((()=>{"Ended"!==e.status._tag&&(x.VE1(t)&&b.rF.has(e)&&e.attribute("code.stacktrace",b.rF.get(e)()),e.end(r?n.unsafeCurrentTimeNanos():Yt,t))})),Zt=(e,...t)=>{const n=q.ZA(1===t.length?void 0:t[0]),r=t[t.length-1];return x.$we((t=>{const i=Vt(t,e,n),o=t.getFiberRef(x.QYw),s=a.Jt(t.getFiberRef(k.qJ),v.hV);return x.cfM(r(i),(e=>Gt(i,e,s,o)))}))},en=(0,l.XY)(2,((e,t)=>He(e,q.Te,t))),tn=function(){const e="string"!=typeof arguments[0],t=e?arguments[1]:arguments[0],n=q.ZA(e?arguments[2]:arguments[1]);if(e){const e=arguments[0];return Zt(t,n,(t=>en(e,t)))}return e=>Zt(t,n,(t=>en(e,t)))},nn=e=>function(){let t=e.captureStackTrace??!1;if(!1!==e.captureStackTrace){const e=Error.stackTraceLimit;Error.stackTraceLimit=2;const n=new Error;Error.stackTraceLimit=e;let r=!1;t=()=>{if(!1!==r)return r;if(n.stack){const e=n.stack.trim().split("\n");return r=e.slice(2).join("\n").trim(),r}}}return x.DYE((()=>{const n="function"==typeof e.options?e.options.apply(null,arguments):e.options;return tn(x.DYE((()=>(0,r.sn)((()=>e.body.apply(this,arguments))))),n.name,{...n,captureStackTrace:t})}))},rn=e=>null==e?x.fJG(new x.kJg):x.PyW(e),on=e=>x.h9N(x.TjK(e,y.zN),(e=>x.QRo(e)?ct:x.fJG(e)))},72572:(e,t,n)=>{n.d(t,{MG:()=>s,ii:()=>o,nS:()=>a});var r=n(89702),i=n(72620);const o=Symbol.for("effect/Console"),s=r.Io("effect/Console"),a={[o]:o,assert:(e,...t)=>i.OH5((()=>{console.assert(e,...t)})),clear:i.OH5((()=>{console.clear()})),count:e=>i.OH5((()=>{console.count(e)})),countReset:e=>i.OH5((()=>{console.countReset(e)})),debug:(...e)=>i.OH5((()=>{console.debug(...e)})),dir:(e,t)=>i.OH5((()=>{console.dir(e,t)})),dirxml:(...e)=>i.OH5((()=>{console.dirxml(...e)})),error:(...e)=>i.OH5((()=>{console.error(...e)})),group:e=>e?.collapsed?i.OH5((()=>console.groupCollapsed(e?.label))):i.OH5((()=>console.group(e?.label))),groupEnd:i.OH5((()=>{console.groupEnd()})),info:(...e)=>i.OH5((()=>{console.info(...e)})),log:(...e)=>i.OH5((()=>{console.log(...e)})),table:(e,t)=>i.OH5((()=>{console.table(e,t)})),time:e=>i.OH5((()=>console.time(e))),timeEnd:e=>i.OH5((()=>console.timeEnd(e))),timeLog:(e,...t)=>i.OH5((()=>{console.timeLog(e,...t)})),trace:(...e)=>i.OH5((()=>{console.trace(...e)})),warn:(...e)=>i.OH5((()=>{console.warn(...e)})),unsafe:console}},12164:(e,t,n)=>{n.d(t,{$T:()=>R,AN:()=>V,CJ:()=>E,D5:()=>H,Do:()=>ne,GR:()=>P,KT:()=>Q,KX:()=>G,L_:()=>$,Oy:()=>B,PC:()=>q,PJ:()=>te,PO:()=>T,RI:()=>W,Rq:()=>J,S1:()=>ie,SH:()=>ae,Tg:()=>K,VH:()=>I,XJ:()=>oe,ar:()=>M,gh:()=>se,jE:()=>L,nH:()=>X,ny:()=>z,oD:()=>re,qK:()=>U,wR:()=>Y,x6:()=>F});var r=n(84073),i=n(43977),o=n(96949),s=n(95602),a=n(61369),c=n(67337),d=n(14349),l=n(77948),u=n(53533),p=n(56572),h=n(20209),f=n(71108),m=n(8197),y=n(20808),g=n(72620),w=n(32628),N=n(24285),b=n(60356),v=n(8977),x=n(61974),k=n(80561),S=n(35021);class O{permits;waiters=new Set;taken=0;constructor(e){this.permits=e}get free(){return this.permits-this.taken}take=e=>g.bIC((t=>{if(this.free<e){const n=()=>{this.free<e||(this.waiters.delete(n),this.taken+=e,t(g.PyW(e)))};return this.waiters.add(n),g.OH5((()=>{this.waiters.delete(n)}))}return this.taken+=e,t(g.PyW(e))}));updateTaken=e=>g.$we((t=>(this.taken=e(this.taken),this.waiters.size>0&&t.getFiberRef(f.X_).scheduleTask((()=>{const e=this.waiters.values();let t=e.next();for(;!1===t.done&&this.free>0;)t.value(),t=e.next()}),t.getFiberRef(g.QPU)),g.PyW(this.free))));release=e=>this.updateTaken((t=>t-e));releaseAll=this.updateTaken((e=>0));withPermits=e=>t=>g.FcF((n=>g.qIB(n(this.take(e)),(e=>b.ye(n(t),this.release(e))))))}const W=e=>new O(e),I=e=>g.OH5((()=>W(e))),q=e=>L(e,b.C6),T=(0,a.XY)(2,((e,t)=>g.TjK(E(e,t),(e=>e[0])))),E=(0,a.XY)(2,((e,t)=>{const n=r.D4(t);return g.qIB(g._OA(),(t=>g.TjK(te(l.dv()),(r=>[g.PpN(A(e,n,r),t),D(r)]))))})),C=(e,t,n)=>{const i=r.kE(r.D4(t));return(0,a.Fs)(g.WW4(),g.Mim((t=>g._ig(e,t))),g.TjK((e=>l.zN([n+i,e]))))},A=(e,t,n)=>g.FcF((r=>(0,a.Fs)(y.RK((e=>e.currentTimeMillis)),g.qIB((r=>re(n,(n=>{switch(n._tag){case"None":return l.zN(C(e,t,r));case"Some":{const[i]=n.value;return i-r<=0?l.zN(C(e,t,r)):l.dv()}}})))),g.qIB((e=>l.$I(e)?g.GSS("BUG: Effect.cachedInvalidate - please report an issue at https://github.com/Effect-TS/effect/issues"):r(g.gn0(e.value[1]))))))),D=e=>x.hZ(e,l.dv()),P=(0,a.XY)(2,((e,t)=>L(e,(e=>t(b.qm(e)))))),L=(0,a.XY)(2,((e,t)=>g.qIB(S.u4,(n=>(0,a.Fs)(K(e,n),b.ye(g.qIB(n.value,t))))))),B=(0,a.XY)((e=>p.xZ(e[0])),((e,t)=>t?.discard?g.QZV(e,b.Zy):g.TjK(g.CFK(e,b.Zy),b.qm))),M=(0,a.XY)(2,((e,t)=>g.FcF((n=>g.qIB(t.fork(w.il),(t=>(0,a.Fs)(n(e),g.cfM((e=>t.close(e))),b.LX,g.Mim((e=>t.addFinalizer((()=>g.g1G((t=>i.aI(t,e.id())?g.rIH:g.NLW(g.OLv(e))))))))))))))),F=e=>b.NB((t=>M(e,t))),R=e=>N.fj(e),U=e=>g.DYE((()=>g.qIB(e,N.fj))),j=Symbol.for("effect/Effect/memoizeFunction.key");class _{a;eq;[j]=j;constructor(e,t){this.a=e,this.eq=t}[i.HR](e){return!!p.i5(e,j)&&(this.eq?this.eq(this.a,e.a):i.aI(this.a,e.a))}[c.HR](){return this.eq?0:c.PO(this,c.tW(this.a))}}const $=(e,t)=>(0,a.Fs)(g.OH5((()=>d.Ie())),g.qIB(te),g.TjK((n=>r=>(0,a.Fs)(n.modifyEffect((n=>{const i=(0,a.Fs)(n,d.Jt(new _(r,t)));return l.$I(i)?(0,a.Fs)(g.WW4(),g.Mim((t=>(0,a.Fs)(y.Ek(e(r)),g._ig(t),b.Zy))),g.TjK((e=>[e,(0,a.Fs)(n,d.hZ(new _(r,t),e))]))):g.PyW([i.value,n])})),g.qIB(g.gn0),g.qIB((([e,t])=>(0,a.Fs)(y.Bz(e),g.as(t)))))))),Q=(0,a.XY)(2,((e,t)=>(0,a.Fs)(g.NS5(e),b.O4(g.NS5(t)),(e=>g.Bqz(e))))),J=(0,a.XY)(2,((e,t)=>(0,a.Fs)(e,k.mg(t),F))),K=(0,a.XY)(2,((e,t)=>g.q1t(b.me,(e=>e.zip(t)))(e))),Y=(0,a.XY)(2,((e,t)=>V(e,{onTimeout:()=>g.x6Q(t),duration:t}))),V=(0,a.XY)(2,((e,{duration:t,onTimeout:n})=>g.Bqz(X(e,{onTimeout:()=>g.gOk(n),onSuccess:g.PyW,duration:t})))),z=(0,a.XY)(2,((e,{duration:t,onTimeout:n})=>g.Bqz(X(e,{onTimeout:()=>g.pVV(n),onSuccess:g.PyW,duration:t})))),H=(0,a.XY)(2,((e,t)=>X(e,{duration:t,onSuccess:l.zN,onTimeout:l.dv}))),X=(0,a.XY)(2,((e,{duration:t,onSuccess:n,onTimeout:r})=>g.g1G((i=>b.Fp(e,g.Inz(y.yy(t)),{onSelfWin:(e,t)=>g.qIB(e.await,(r=>"Success"===r._tag?g.qIB(e.inheritAll,(()=>g.as(g._tB(t,i),n(r.value)))):g.qIB(g._tB(t,i),(()=>g.cbD(r.cause))))),onOtherWin:(e,t)=>g.qIB(e.await,(n=>"Success"===n._tag?g.qIB(e.inheritAll,(()=>g.as(g._tB(t,i),r()))):g.qIB(g._tB(t,i),(()=>g.cbD(n.cause))))),otherScope:v.gm}))))),G=Symbol.for("effect/Ref/SynchronizedRef"),Z={_A:e=>e};class ee{ref;withLock;[G]=Z;[x.ll]=x.VO;[h.ii];constructor(e,t){this.ref=e,this.withLock=t,this[h.ii]=h.ii,this.get=x.Jt(this.ref)}get;modify(e){return this.modifyEffect((t=>g.PyW(e(t))))}modifyEffect(e){return this.withLock((0,a.Fs)(g.qIB(x.Jt(this.ref),e),g.qIB((([e,t])=>g.as(x.hZ(this.ref,t),e)))))}pipe(){return(0,u.t)(this,arguments)}}const te=e=>g.OH5((()=>ne(e))),ne=e=>{const t=x.s$(e),n=W(1);return new ee(t,n.withPermits(1))},re=(0,a.XY)(2,((e,t)=>e.modifyEffect((e=>{const n=t(e);switch(n._tag){case"None":return g.PyW([e,e]);case"Some":return g.TjK(n.value,(e=>[e,e]))}})))),ie=(0,a.XY)(2,((e,t)=>ae(e,t,((e,t)=>[e,t])))),oe=(0,a.XY)(2,((e,t)=>ae(e,t,((e,t)=>e)))),se=(0,a.XY)(2,((e,t)=>ae(e,t,((e,t)=>t)))),ae=(0,a.XY)(3,((e,t,n)=>({[N.QV]:N.GP,id:()=>(0,a.Fs)(e.id(),s.Do(t.id())),await:(0,a.Fs)(e.await,g.Bqz,b.cw(g.Bqz(t.await),n,{concurrent:!0}),g.NS5),children:e.children,inheritAll:g.aNH(t.inheritAll,e.inheritAll),poll:g.OYO(e.poll,t.poll,((e,t)=>(0,a.Fs)(e,l.qI((e=>(0,a.Fs)(t,l.Tj((t=>o.OY(e,t,{onSuccess:n,onFailure:m._7}))))))))),interruptAsFork:n=>g.aNH(e.interruptAsFork(n),t.interruptAsFork(n)),pipe(){return(0,u.t)(this,arguments)}})))},23180:(e,t,n)=>{n.d(t,{BQ:()=>u,Gt:()=>d,JP:()=>c,Wz:()=>p,Y3:()=>a,cH:()=>s,pu:()=>h,sY:()=>l});var r=n(61369),i=n(77948),o=n(72620);const s=(0,r.XY)(2,((e,t)=>e.modifyEffect((e=>o.TjK(t(e),(t=>[e,t])))))),a=(0,r.XY)(2,((e,t)=>e.modifyEffect((e=>{const n=t(e);switch(n._tag){case"None":return o.PyW([e,e]);case"Some":return o.TjK(n.value,(t=>[e,t]))}})))),c=(0,r.XY)(2,((e,t)=>e.modify(t))),d=(0,r.XY)(2,((e,t)=>e.modifyEffect(t))),l=(0,r.XY)(3,((e,t,n)=>e.modifyEffect((e=>(0,r.Fs)(n(e),i.WL((()=>o.PyW([t,e])))))))),u=(0,r.XY)(2,((e,t)=>e.modifyEffect((e=>o.TjK(t(e),(e=>[void 0,e])))))),p=(0,r.XY)(2,((e,t)=>e.modifyEffect((e=>o.TjK(t(e),(e=>[e,e])))))),h=(0,r.XY)(2,((e,t)=>e.modifyEffect((e=>{const n=t(e);switch(n._tag){case"None":return o.PyW([void 0,e]);case"Some":return o.TjK(n.value,(e=>[void 0,e]))}}))))}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var o=r[e]={exports:{}};return n[e](o,o.exports,i),o.exports}i.m=n,i.x=()=>{var e=i.O(void 0,[939,960],(()=>i(35925)));return i.O(e)},e=[],i.O=(t,n,r,o)=>{if(!n){var s=1/0;for(l=0;l<e.length;l++){for(var[n,r,o]=e[l],a=!0,c=0;c<n.length;c++)(!1&o||s>=o)&&Object.keys(i.O).every((e=>i.O[e](n[c])))?n.splice(c--,1):(a=!1,o<s&&(s=o));if(a){e.splice(l--,1);var d=r();void 0!==d&&(t=d)}}return t}o=o||0;for(var l=e.length;l>0&&e[l-1][2]>o;l--)e[l]=e[l-1];e[l]=[n,r,o]},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,n)=>(i.f[n](e,t),t)),[])),i.u=e=>e+".js",i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),(()=>{i.b=self.location+"";var e={925:1};i.f.i=(t,n)=>{e[t]||importScripts(i.p+i.u(t))};var t=self.webpackChunkstarpyapp=self.webpackChunkstarpyapp||[],n=t.push.bind(t);t.push=t=>{var[r,o,s]=t;for(var a in o)i.o(o,a)&&(i.m[a]=o[a]);for(s&&s(i);r.length;)e[r.pop()]=1;n(t)}})(),t=i.x,i.x=()=>Promise.all([i.e(939),i.e(960)]).then(t),i.x()})();