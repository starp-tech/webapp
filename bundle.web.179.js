(()=>{var e={47488:(e,t,n)=>{var r,a;r=[n(41935),n(58653),n(16976),n(20293),n(77914),n(48800),n(12961),n(95004),n(45976),n(58660)],void 0===(a=function(e,t,r,a,o,l,i,u,d,c){"use strict";var s=n(64836);e=s(e),t=s(t),a=s(a),i=s(i),(0,o.enableFreeze)(!0);var f="@font-face {\n  src: url("+a.default+");\n  font-family: Ionicons;\n}",p=document.createElement("style");p.type="text/css",p.styleSheet?p.styleSheet.cssText=f:p.appendChild(document.createTextNode(f)),document.head.appendChild(p),(0,c.initUserData)().then((function(){(0,d.createRoot)(document.getElementById("root")).render((0,u.createElement)(i.default))}))}.apply(t,r))||(e.exports=a)},12961:(e,t,n)=>{var r,a;r=[t,n(10434),n(43747),n(95004),n(6098),n(22152),n(78100),n(58660),n(44104),n(48736),n(52254),n(23774),n(82513),n(51641)],void 0===(a=function(e,r,a,o,l,i,u,d,c,s,f,p,m,v){"use strict";var y=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0,r=y(r),o=y(o),l=y(l),i=y(i),u=y(u),l.default.ignoreAllLogs();var g=(0,r.default)({},f.MD3DarkTheme,{fonts:(0,f.configureFonts)({config:{default:{fontFamily:'Roboto, "Helvetica Neue", Helvetica, Arial, sans-serif',fontWeight:"400",letterSpacing:.5,lineHeight:22,fontSize:20}},isV3:!0})});t.default=function(){var e=(0,s.useUserData)(),t=e.userDataState,r=e.userDataDispatch;return console.info("app"),o.default.createElement(m.Provider,{store:p.store},o.default.createElement(v.QueryClientProvider,{client:d.queryClient},o.default.createElement(c.UserCtx.Provider,{value:d.UserData},o.default.createElement(c.PeerCtx.Provider,{value:{}},o.default.createElement(c.PartyCtx.Provider,{value:{}},o.default.createElement(c.LocalCtx.Provider,{value:{}},o.default.createElement(c.MediaCtx.Provider,{value:d.MediaState},o.default.createElement(c.UserDataState.Provider,{value:t},o.default.createElement(c.UserDataDispatch.Provider,{value:r},o.default.createElement(a.SafeAreaProvider,null,o.default.createElement(f.PaperProvider,{theme:g},o.default.createElement(o.default.Fragment,null,o.default.createElement("style",{type:"text/css"},"\n                          @font-face {\n                            font-family: 'MaterialCommunityIcons';\n                            src: url("+n(22355)+") format('truetype');\n                          }\n                        "),o.default.createElement(o.default.Fragment,null)),o.default.createElement(u.default,null))))))))))))}}.apply(t,r))||(e.exports=a)},67634:(e,t,n)=>{var r,a;r=[t,n(64687),n(10434),n(58660),n(25707),n(69531)],void 0===(a=function(e,r,a,o,l,i){"use strict";var u=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),t.sendChatMessage=t.getPublicMessages=t.genMnemonic=t.createNewParty=void 0,r=u(r),a=u(a),l=u(l);var d=t.sendChatMessage=function(e,t,n,i){var u,d,c,s,f;return r.default.async((function(p){for(;;)switch(p.prev=p.next){case 0:return void 0===i&&(i={}),p.next=3,r.default.awrap((0,o.getUserData)());case 3:return u=p.sent,d=l.default.v4(),c={id:d,text:t,userId:u.id,chatId:e,folderId:e,messageStatus:"sent",userName:u.name,createdAt:(new Date).valueOf()},s=(0,a.default)({},c,i),p.next=9,r.default.awrap((0,o.createDBConn)(e,n));case 9:return f=p.sent,p.next=12,r.default.awrap((0,o.writeItem)(s,f));case 12:return p.abrupt("return",s);case 13:case"end":return p.stop()}}),null,null,null,Promise)},c=(t.getPublicMessages=function(e,t,n,a){var l,i,u,d,c,s;return r.default.async((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===n&&(n=15),void 0===a&&(a=0),t.prev=2,t.next=5,r.default.awrap((0,o.getById)(e));case 5:if(!(u=t.sent)||!u.mnemonic){t.next=10;break}return t.next=9,r.default.awrap((0,o.createDBConn)(e,u.mnemonic,!0));case 9:d=t.sent;case 10:return c=null==(l=d)?void 0:l.createQuery((function(t){return t.selectFrom("item").selectAll().where("chatId","=",e).orderBy("createdAt","desc").limit(n).offset(a)})),t.next=13,r.default.awrap(null==(i=d)?void 0:i.loadQuery(c));case 13:return s=t.sent,t.abrupt("return",s.rows.map((function(e){return e.item})));case 17:t.prev=17,t.t0=t.catch(2),console.error("getPublicMessages error",t.t0);case 20:return t.abrupt("return",[]);case 21:case"end":return t.stop()}}),null,null,[[2,17]],Promise)},t.createNewParty=function(e){var t,n,l;return r.default.async((function(i){for(;;)switch(i.prev=i.next){case 0:return console.info("createNewParty",e),i.next=3,r.default.awrap((0,o.getUserData)());case 3:return t=i.sent,n=e.id,l=(0,a.default)({},e,{id:n,authorId:t.id,authorName:t.name,isContact:!0,mnemonic:c()}),i.next=8,r.default.awrap((0,o.writeItem)(l));case 8:return i.sent,i.next=11,r.default.awrap(d(n,t.name+" has created chat "+e.name,l.mnemonic,{system:!0}));case 11:return i.abrupt("return",l);case 12:case"end":return i.stop()}}),null,null,null,Promise)},t.genMnemonic=function(){return[i.faker.animal.bird().split(" ").join("").toLowerCase(),i.faker.animal.bird().split(" ").join("").toLowerCase(),i.faker.color.human().split(" ").join("").toLowerCase(),i.faker.color.human().split(" ").join("").toLowerCase(),i.faker.color.human().split(" ").join("").toLowerCase(),i.faker.animal.fish().split(" ").join("").toLowerCase(),i.faker.animal.fish().split(" ").join("").toLowerCase(),i.faker.animal.fish().split(" ").join("").toLowerCase(),i.faker.animal.insect().split(" ").join("").toLowerCase(),i.faker.hacker.noun().split(" ").join("").toLowerCase(),i.faker.hacker.noun().split(" ").join("").toLowerCase(),i.faker.hacker.noun().split(" ").join("").toLowerCase()].join(" ")})}.apply(t,r))||(e.exports=a)},68049:(e,t,n)=>{var r,a;r=[t,n(10434),n(27424),n(64687),n(47350),n(39249),n(51641)],void 0===(a=function(e,r,a,o,l,i,u){"use strict";var d=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),t.writeItem=t.queryClient=t.indexAllFoldersForDB=t.getUserData=t.getPublicFolderContent=t.getFoldersByType=t.getFolderContent=t.getById=t.findByOriginalId=t.findBy=t.evolu=t.createDBConn=void 0,r=d(r),a=d(a),o=d(o);var c=t.queryClient=new u.QueryClient({defaultOptions:{queries:{refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1}}}),s=(0,l.database)({item:i.ItemTable}),f={};window.dbConns=f;var p={},m=t.createDBConn=function(e,t,n){if(void 0===e&&(e="starpy2"),f[e])return f[e];if(t&&p[t])return p[t];var r={name:e};t&&(r.mnemonic=t);var a=(0,l.createEvolu)(s,r);return f[e]=a,t&&(p[t]=a),!0===n?new Promise((function(t){y(a).then((function(){return t(a)})),a.subscribeSyncState((function(){var t;return o.default.async((function(n){for(;;)switch(n.prev=n.next){case 0:"SyncStateIsSynced"===(t=a.getSyncState())._tag&&(console.info("state",t,e),y(a),c.refetchQueries(["folderData_"+e]),c.refetchQueries(["folderContent_"+e]),c.refetchQueries(["project_"+e]),c.refetchQueries(["projectLayers",e]),c.refetchQueries(["encodedMedia",e]),c.refetchQueries(["folderContent_"+e+"_comments"]));case 2:case"end":return n.stop()}}),null,null,null,Promise)}))})):a},v={},y=t.indexAllFoldersForDB=function(e){var t,n;return o.default.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,t=null==e?void 0:e.createQuery((function(e){return e.selectFrom("item").selectAll().where("mnemonic","is not",null).where("isDeleted","is",null)})),r.next=4,o.default.awrap(null==e?void 0:e.loadQuery(t));case 4:n=r.sent,console.info("folders",n.rows),n.rows.map((function(t){return o.default.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(v[t.id]){n.next=5;break}v[t.id]=!0,f[t.id]=e,n.next=18;break;case 5:return console.info("indexing db for folder",t.id),n.next=8,o.default.awrap(c.refetchQueries(["folderData_"+t.id]));case 8:return n.next=10,o.default.awrap(c.refetchQueries(["folderContent_"+t.id]));case 10:return n.next=12,o.default.awrap(c.refetchQueries(["project_"+t.id]));case 12:return n.next=14,o.default.awrap(c.refetchQueries(["projectLayers",t.id]));case 14:return n.next=16,o.default.awrap(c.refetchQueries(["encodedMedia",t.id]));case 16:return n.next=18,o.default.awrap(c.refetchQueries(["folderContent_"+t.id+"_comments"]));case 18:case"end":return n.stop()}}),null,null,null,Promise)})),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(0),console.error(r.t0);case 12:case"end":return r.stop()}}),null,null,[[0,9]],Promise)},g=t.evolu=m(),h=(t.getUserData=function(e){var t,n,l,i,u;return o.default.async((function(d){for(;;)switch(d.prev=d.next){case 0:return e||(e=localStorage.getItem("authToken")),t={},d.next=4,o.default.awrap(w("userDoc",!0));case 4:return n=d.sent,l=(0,a.default)(n,1),i=l[0],d.next=9,o.default.awrap(w("isDevice",!0));case 9:return u=d.sent,d.abrupt("return",(0,r.default)({},i,t,{photo:null==t?void 0:t.picture,devices:u}));case 11:case"end":return d.stop()}}),null,null,null,Promise)},t.getFolderContent=function(e){var t,n,r,a,l,i;return o.default.async((function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,o.default.awrap(b(e));case 2:if(r=u.sent,a=g,!r||!r.mnemonic){u.next=8;break}return u.next=7,o.default.awrap(m(e,r.mnemonic,!0));case 7:a=u.sent;case 8:return l=null==(t=a)?void 0:t.createQuery((function(t){return t.selectFrom("item").selectAll().where("folderId","=",e).where("isDeleted","is",null).orderBy("orderId","asc").orderBy("lastUpdated","desc")})),u.next=11,o.default.awrap(null==(n=a)?void 0:n.loadQuery(l));case 11:return i=u.sent,u.abrupt("return",i.rows.map((function(e){return e.item})));case 13:case"end":return u.stop()}}),null,null,null,Promise)}),w=(t.getPublicFolderContent=function(e){return o.default.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",h(e));case 1:case"end":return t.stop()}}),null,null,null,Promise)},t.getFoldersByType=function(e){var t,n;return o.default.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t=null==g?void 0:g.createQuery((function(t){return t.selectFrom("item").selectAll().where("folderType","=",e).where("folderId","is",null).where("isDeleted","is",null)})),r.next=3,o.default.awrap(null==g?void 0:g.loadQuery(t));case 3:return n=r.sent,r.abrupt("return",n.rows.map((function(e){return e.item})));case 5:case"end":return r.stop()}}),null,null,null,Promise)},t.writeItem=function(e,t){var n,r,a;return o.default.async((function(l){for(;;)switch(l.prev=l.next){case 0:if(n=new URL(window.location.toString()).searchParams.get("parentFolderId"),!e.folderId&&!n){l.next=7;break}return l.next=5,o.default.awrap(b(e.folderId||n));case 5:(r=l.sent)&&r.mnemonic&&(t=m(e.folderId,r.mnemonic),(e.isFolder||e.isEditorLayer||e.isEditorProject)&&(e.mnemonic=r.mnemonic,f[e.id]=t,!0),(e.isMediaNew||e.isEncoderProject)&&(e.extractor="wt"));case 7:return console.info("writeItem data",e),l.next=10,o.default.awrap((t||g).createOrUpdate("item",{id:e.id,title:e.title,name:e.name,item:e,isFolder:e.isFolder,isContact:e.isContact,isMediaNew:e.isMediaNew,isDevice:e.isDevice,userDoc:e.userDoc,folderId:e.folderId,folderType:e.folderType,chatId:e.chatId,createdAt:e.createdAt,isDeleted:e.isDeleted,isEditorProject:e.isDeleted,isEditorLayer:e.isDeleted,orderId:e.orderId||1,mnemonic:e.mnemonic,lastUpdated:(new Date).valueOf()}));case 10:if(a=l.sent,!e.mnemonic||!e.isFolder||t){l.next=16;break}return console.info("create a new index for a new folder"),l.next=15,o.default.awrap(m(e.folderId,e.mnemonic,!0));case 15:t=l.sent;case 16:return l.abrupt("return",a);case 17:case"end":return l.stop()}}),null,null,null,Promise)},t.findByOriginalId=function(e){return o.default.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",w("originalId",e));case 1:case"end":return t.stop()}}),null,null,null,Promise)},t.findBy=function(e,t){var n,r;return o.default.async((function(a){for(;;)switch(a.prev=a.next){case 0:return n=null==g?void 0:g.createQuery((function(n){return n.selectFrom("item").selectAll().where(e,"=",t)})),a.next=3,o.default.awrap(null==g?void 0:g.loadQuery(n));case 3:return r=a.sent,console.info("findBy",r),a.abrupt("return",r.rows.map((function(e){return e.item})));case 6:case"end":return a.stop()}}),null,null,null,Promise)}),b=t.getById=function(e,t){var n,r,a,l,i,u,d,c;return o.default.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(l=g,!t){s.next=14;break}if((l=f[t])||e===t){s.next=14;break}return s.next=6,o.default.awrap(b(t));case 6:if(null==(i=s.sent)||!i.mnemonic){s.next=13;break}return s.next=10,o.default.awrap(m(i.id,i.mnemonic));case 10:l=s.sent,s.next=14;break;case 13:l=g;case 14:return u=null==(n=l)?void 0:n.createQuery((function(t){return t.selectFrom("item").selectAll().where("id","=",e)})),s.next=17,o.default.awrap(null==(r=l)?void 0:r.loadQuery(u));case 17:if(d=s.sent,(null!=(c=null==d||null==(a=d.row)?void 0:a.item)&&c.isFolder||null!=c&&c.isEditorLayer||null!=c&&c.isEditorProject)&&!f[c.id]&&c.mnemonic&&(f[c]=l),c||""===e||void 0===e||null===e){s.next=25;break}if(!f[e]||e===t){s.next=25;break}return s.next=24,o.default.awrap(b(e,e));case 24:return s.abrupt("return",s.sent);case 25:return s.abrupt("return",c);case 26:case"end":return s.stop()}}),null,null,null,Promise)}}.apply(t,r))||(e.exports=a)},39249:(e,t,n)=>{var r,a;r=[t,n(33658),n(624)],void 0===(a=function(e,n,r){"use strict";function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),t.ItemTable=void 0;var o=(n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&{}.hasOwnProperty.call(e,l)){var i=o?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(r,l,i):r[l]=e[l]}return r.default=e,n&&n.set(e,r),r}(n)).Struct({foo:n.String,bar:n.Boolean}),l=(0,r.id)("Item");t.ItemTable=(0,r.table)({id:l,name:r.String1000,title:r.String1000,isCompleted:r.SqliteBoolean,item:o,isMediaNew:r.SqliteBoolean,isContact:r.SqliteBoolean,folderId:r.String1000,isDevice:r.SqliteBoolean,isFolder:r.SqliteBoolean,folderType:r.String1000,userDoc:r.SqliteBoolean,chatId:r.String1000,orderId:r.String1000,lastUpdated:r.String1000,isEditorProject:r.SqliteBoolean,isEditorLayer:r.SqliteBoolean,mnemonic:r.String1000})}.apply(t,r))||(e.exports=a)},58660:(e,t,n)=>{var r,a;r=[t,n(64687),n(58794),n(68049),n(77527),n(67634),n(9280),n(97794),n(22152),n(76242)],void 0===(a=function(e,r,a,o,l,i,u,d,c,s){"use strict";var f=n(64836);Object.defineProperty(e,"__esModule",{value:!0});var p={UserData:!0,setPubCallback:!0,MediaState:!0,writePublicData:!0,initUserData:!0,stopVideo:!0,publicPartyPref:!0,deleteById:!0,setOpenItem:!0,removeFile:!0,downloadFile:!0,getUnreadMessages:!0,extractMedia:!0,DocumentPicker:!0,setWindowClosedCallback:!0,getPublicPartyList:!0,evolu:!0,createDBConn:!0};t.UserData=t.MediaState=t.DocumentPicker=void 0,Object.defineProperty(e,"createDBConn",{enumerable:!0,get:function(){return o.createDBConn}}),t.downloadFile=t.deleteById=void 0,Object.defineProperty(e,"evolu",{enumerable:!0,get:function(){return o.evolu}}),t.writePublicData=t.stopVideo=t.setWindowClosedCallback=t.setPubCallback=t.setOpenItem=t.removeFile=t.publicPartyPref=t.initUserData=t.getUnreadMessages=t.getPublicPartyList=t.extractMedia=void 0,r=f(r),Object.keys(a).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(p,t)||t in e&&e[t]===a[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return a[t]}}))})),Object.keys(o).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(p,t)||t in e&&e[t]===o[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return o[t]}}))})),Object.keys(l).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(p,t)||t in e&&e[t]===l[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return l[t]}}))})),Object.keys(i).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(p,t)||t in e&&e[t]===i[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return i[t]}}))})),c=f(c);var m=a.domain+"api/v1/",v=t.UserData={user:{id:"test",name:"test"},searchEnabled:!1,searchFolder:{id:"search",title:"Search Data"},colors:a.colors,searchItems:[],currentFolderIds:{}},y=(t.setPubCallback=function(e,t){playPartyById(t,!0)},t.MediaState={currentVideo:null,currentVideoId:null,isLoading:!1,isPlaying:!1,openItemId:null,enqMedia:l.enqMedia,setOpenItem:function(e){return y.openItemId=e.id===y.openItemId?null:e.id}});t.writePublicData=function(e){var t,n,o;return r.default.async((function(l){for(;;)switch(l.prev=l.next){case 0:return t=a.domain+"api/v1/backend/writePublicData",n={url:t,method:"POST",credentials:"include",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}},console.info("write fetch params",n),l.t0=r.default,l.next=6,r.default.awrap(fetch(t,n));case 6:return l.t1=l.sent.json(),l.next=9,l.t0.awrap.call(l.t0,l.t1);case 9:return o=l.sent,l.abrupt("return",o);case 11:case"end":return l.stop()}}),null,null,null,Promise)},t.initUserData=function(){var e,t,n,a,i,c;return r.default.async((function(f){for(;;)switch(f.prev=f.next){case 0:return f.prev=0,f.next=3,r.default.awrap((0,s.doInitialMigration)(o.writeItem,o.getUserData));case 3:return v.user=f.sent,f.next=6,r.default.awrap((0,d.getUserAgent)());case 6:return e=f.sent.replace(/[^\w\s]/gi,""),f.next=9,r.default.awrap((0,d.getBaseOs)());case 9:return t=f.sent,n=(0,u.getBrowserName)()||"web",console.info("browserName",n),a=e+t+n,f.next=15,r.default.awrap((0,o.getById)(a));case 15:if((i=f.sent)&&i.manufacturer){f.next=21;break}return c={id:a,manufacturer:n,isDevice:!0,userAgent:e,createdAt:(new Date).valueOf(),model:n,os:t,platform:"web"},console.info(c),f.next=21,r.default.awrap((0,o.writeItem)(c));case 21:return console.info("initUserData",v),f.next=24,r.default.awrap((0,l.startUpMediaSharing)());case 24:f.next=29;break;case 26:f.prev=26,f.t0=f.catch(0),console.error("initUserData Error",f.t0);case 29:case"end":return f.stop()}}),null,null,[[0,26]],Promise)},t.stopVideo=function(){hideVideoPlayer()},t.publicPartyPref=function(){},t.deleteById=function(e){},t.setOpenItem=function(){},t.removeFile=function(){},t.downloadFile=function(){},t.getUnreadMessages=function(){},t.extractMedia=function(e){var t,n,a;return r.default.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,r.default.awrap((0,l.getWT)(e));case 2:return a=o.sent,console.info("onMedia",a),o.abrupt("return",{url:a.magnetURI,title:a.name,originalId:a.infoHash,id:a.infoHash,filename:a.files[0].name,extractor:"wt",isFolder:!!(a.files&&(null==(t=a.files)?void 0:t.length)>-1)||void 0,files:a.files&&(null==(n=a.files)?void 0:n.length)>-1?a.files:void 0});case 5:case"end":return o.stop()}}),null,null,null,Promise)},t.DocumentPicker={pickSingle:function(){return r.default.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var t;return r.default.async((function(n){for(;;)switch(n.prev=n.next){case 0:(t=document.getElementById("fileInput")).click(),t.addEventListener("change",(function(){var n,a;return r.default.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(t.files.length>0)){r.next=4;break}return n=t.files[0],a={file:n,type:n.type,title:n.name,name:n.name,extractor:"local",size:n.size,originalId:n.name+n.size},r.abrupt("return",e(a));case 4:case"end":return r.stop()}}),null,null,null,Promise)}));case 4:case"end":return n.stop()}}),null,null,null,Promise)})));case 1:case"end":return e.stop()}}),null,null,null,Promise)}},t.setWindowClosedCallback=function(e){},t.getPublicPartyList=function(){var e;return r.default.async((function(t){for(;;)switch(t.prev=t.next){case 0:return e=m+"party-list",t.t0=r.default,t.next=4,r.default.awrap(fetch(e));case 4:return t.t1=t.sent.json(),t.next=7,t.t0.awrap.call(t.t0,t.t1);case 7:return t.abrupt("return",t.sent.rows.map((function(e){return e.value})));case 8:case"end":return t.stop()}}),null,null,null,Promise)}}.apply(t,r))||(e.exports=a)},77527:(e,t,n)=>{var r,a;r=[t,n(861),n(10434),n(64687),n(30165),n(38800),n(58660),n(624)],void 0===(a=function(e,r,a,o,l,i,u,d){"use strict";var c=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"FFmpeg",{enumerable:!0,get:function(){return l.FFmpeg}}),t.enqMedia=t.encodeProject=t.encodeMedia=t.downloadFileById=t.cancelEncoding=void 0,Object.defineProperty(e,"fetchFile",{enumerable:!0,get:function(){return i.fetchFile}}),t.startUpMediaSharing=t.shareFolder=t.shareFileToWT=t.recursiveShare=t.getWT=t.getVideoWT=t.getTotalTime=t.getProjectMedia=t.getNextActiveProjectMedia=t.getMediaAndEnq=t.getFileReaderOpfs=t.getFileOpfs=t.getActiveProjectLayer=t.genRenderCmd=t.genExecTime=t.genExecCmd=void 0,Object.defineProperty(e,"toBlobURL",{enumerable:!0,get:function(){return i.toBlobURL}}),t.writeFileOpfs=void 0,r=c(r),a=c(a),o=c(o),console.info("ffmpeg",l.FFmpeg);var s,f,p,m="starp",v={iceServers:[{urls:["stun:turn.starpy.me","turn:turn.starpy.me"],username:"username1",credential:"password1"}],sdpSemantics:"unified-plan",bundlePolicy:"max-bundle",iceCandidatePoolsize:1},y="https://unpkg.com/@ffmpeg/core@0.12.6/dist/umd",g=t.recursiveShare=function(e){var t;return o.default.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.isDownloaded){n.next=8;break}return n.prev=1,M(e.id,e.folderId),n.abrupt("return",e);case 6:n.prev=6,n.t0=n.catch(1);case 8:if(!(e.isFolder||e.isEditorProject||e.isEditorLayer)){n.next=15;break}return n.next=11,o.default.awrap((0,u.getFolderContent)(e.id));case 11:return t=n.sent,n.next=14,o.default.awrap(Promise.all(t.map(g)));case 14:return n.abrupt("return",n.sent);case 15:return n.abrupt("return",void 0);case 16:case"end":return n.stop()}}),null,null,[[1,6]],Promise)},h=t.shareFolder=function(e){var t,n;return o.default.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,o.default.awrap((0,u.getFolderContent)(e.id));case 2:t=r.sent,n=0;case 4:if(!(n<t.length)){r.next=10;break}return r.next=7,o.default.awrap(g(t[n]));case 7:n++,r.next=4;break;case 10:case"end":return r.stop()}}),null,null,null,Promise)},w=(t.startUpMediaSharing=function(){var e,t,n,r;return o.default.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,e=u.evolu.createQuery((function(e){return e.selectFrom("item").selectAll().where("isFolder","=",(0,d.cast)(!0)).where("mnemonic","is not",null).orderBy("createdAt","desc")})),a.next=4,o.default.awrap(u.evolu.loadQuery(e));case 4:t=a.sent.rows.map((function(e){return e.item})),n=0;case 6:if(!(n<t.length)){a.next=13;break}return r=t[n],a.next=10,o.default.awrap(h(r));case 10:n++,a.next=6;break;case 13:a.next=18;break;case 15:a.prev=15,a.t0=a.catch(0),console.error("startUpMediaSharing error",a.t0);case 18:case"end":return a.stop()}}),null,null,[[0,15]],Promise)},t.downloadFileById=function(e,t,n){var r,a,l,i,d;return o.default.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,o.default.awrap((0,u.getById)(e,t));case 2:if("wt"!==(null==(r=c.sent)?void 0:r.extractor)){c.next=21;break}return c.next=6,o.default.awrap(k(r));case 6:if(!(a=c.sent)){c.next=21;break}return C[e]&&(l=C[e]).on("download",(function(e){n&&n(l.progress)})),c.t0=o.default,c.next=12,o.default.awrap(fetch(a));case 12:return c.t1=c.sent.arrayBuffer(),c.next=15,c.t0.awrap.call(c.t0,c.t1);case 15:return i=c.sent,(d=new File([i],r.filename)).name=r.filename,c.next=20,o.default.awrap(b(r,d));case 20:return c.abrupt("return",c.sent);case 21:case"end":return c.stop()}}),null,null,null,Promise)}),b=t.writeFileOpfs=function(e,t){var n,r,a,l,i;return o.default.async((function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,o.default.awrap(window.navigator.storage.getDirectory(m));case 2:return n=d.sent,d.next=5,o.default.awrap(n.getDirectoryHandle(e.folderId,{create:!0}));case 5:return r=d.sent,a=e.id+"_"+t.name,d.next=9,o.default.awrap(r.getFileHandle(a,{create:!0}));case 9:return l=d.sent,d.next=12,o.default.awrap(l.createWritable());case 12:return i=d.sent,d.next=15,o.default.awrap(i.write(t));case 15:return d.next=17,o.default.awrap(i.close());case 17:if(e.isDownloaded){d.next=21;break}return e.isDownloaded=!0,d.next=21,o.default.awrap((0,u.writeItem)(e));case 21:return d.abrupt("return",l);case 22:case"end":return d.stop()}}),null,null,null,Promise)},P=t.getFileOpfs=function(e){var t,n;return o.default.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,o.default.awrap(x(e));case 2:return t=r.sent,n=URL.createObjectURL(t),r.abrupt("return",n);case 5:case"end":return r.stop()}}),null,null,null,Promise)},x=t.getFileReaderOpfs=function(e){var t,n,r,a,l;return o.default.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,o.default.awrap(window.navigator.storage.getDirectory(m));case 2:return t=i.sent,i.next=5,o.default.awrap(t.getDirectoryHandle(e.folderId,{create:!0}));case 5:return n=i.sent,r=e.id+"_"+e.filename,i.next=9,o.default.awrap(n.getFileHandle(r));case 9:return a=i.sent,i.next=12,o.default.awrap(null==a?void 0:a.getFile());case 12:return l=i.sent,i.abrupt("return",l);case 14:case"end":return i.stop()}}),null,null,null,Promise)},E=["wss://media.starpy.me"],I=function(){return o.default.async((function(e){for(;;)switch(e.prev=e.next){case 0:return(s=new WebTorrent({tracker:{rtcConfig:v,announce:E},announce:E})).on("error",(function(e){console.error("playMediaLink err: "+e.message)})),e.next=4,o.default.awrap(new Promise((function(e){navigator.serviceWorker.register("/sw.min.js").then((function(t){var n=t.active||t.waiting||t.installing,r=function(t){f=t;var n="activated"===t.state;return n&&(console.info("after load worker"),s.loadWorker(t,e)),n};r(n)||f.addEventListener("statechange",(function(e){var t=e.target;return r(t)}))}))})));case 4:case"end":return e.stop()}}),null,null,null,Promise)},F=function(e){var t,n,r,a;return(null==e||null==(t=e.name)?void 0:t.endsWith(".mp4"))||(null==e||null==(n=e.name)?void 0:n.endsWith(".webm"))||(null==e||null==(r=e.name)?void 0:r.endsWith(".mkv"))||(null==e||null==(a=e.name)?void 0:a.endsWith(".mov"))},C={},S=function(e,t){var n,r,a;return o.default.async((function(l){for(;;)switch(l.prev=l.next){case 0:return!(r=t?e.files.find((function(e){return e.name||e.filename===t})):e.files.find((function(e){return F(e)})))&&null!=(n=e.files)&&n.length&&(r=e.files[0]),l.next=4,o.default.awrap(new Promise((function(e,t){var n;null==(n=r)||n.getStreamURL((function(n,r){if(n)return t(n);e(r)}))})));case 4:return a=l.sent,console.info("after stream url",a),l.abrupt("return",a);case 7:case"end":return l.stop()}}),null,null,null,Promise)},k=t.getVideoWT=function(e,t){return o.default.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(console.info("get video wt",e,s),s){n.next=4;break}return n.next=4,o.default.awrap(I());case 4:return n.next=6,o.default.awrap(new Promise((function(n,r){return o.default.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!C[e.id]){a.next=7;break}return a.t0=n,a.next=4,o.default.awrap(S(C[e.id],t));case 4:return a.t1=a.sent,(0,a.t0)(a.t1),a.abrupt("return");case 7:s.add(e.url,(function(a){var l;return o.default.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,C[e.id]=a,console.info("after mediaclient add",a),i.next=5,o.default.awrap(S(a,t));case 5:l=i.sent,n(l),i.next=13;break;case 9:i.prev=9,i.t0=i.catch(0),console.error("playMediaLink err",i.t0),r(i.t0);case 13:case"end":return i.stop()}}),null,null,[[0,9]],Promise)}));case 8:case"end":return a.stop()}}),null,null,null,Promise)})));case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}}),null,null,null,Promise)},M=(t.getWT=function(e){return o.default.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(s){t.next=3;break}return t.next=3,o.default.awrap(I());case 3:return t.next=5,o.default.awrap(new Promise((function(t,n){return o.default.async((function(n){for(;;)switch(n.prev=n.next){case 0:s.add(e,(function(e){return o.default.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t(e));case 1:case"end":return n.stop()}}),null,null,null,Promise)}));case 1:case"end":return n.stop()}}),null,null,null,Promise)})));case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),null,null,null,Promise)},t.shareFileToWT=function(e,t){var n,r;return o.default.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(console.info("share file wt",n,r,s),s){a.next=4;break}return a.next=4,o.default.awrap(I());case 4:return a.next=6,o.default.awrap((0,u.getById)(e,t));case 6:return n=a.sent,a.next=9,o.default.awrap(x(n));case 9:return r=a.sent,console.info("share wt",n,r),a.next=13,o.default.awrap(new Promise((function(e,t){s.seed(r,{announce:E},(function(r){return o.default.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,console.info("after wt create",r),"wt"!==n.extractor||!n.url){a.next=4;break}return a.abrupt("return",e(n));case 4:return n.url=r.magnetURI,n.extractor="wt",n.isDownloaded=!0,a.next=9,o.default.awrap((0,u.writeItem)(n));case 9:e(n),a.next=16;break;case 12:a.prev=12,a.t0=a.catch(0),console.error("playMediaLink err",a.t0),t(a.t0);case 16:case"end":return a.stop()}}),null,null,[[0,12]],Promise)}))})));case 13:return a.abrupt("return",a.sent);case 14:case"end":return a.stop()}}),null,null,null,Promise)}),O=(t.getMediaAndEnq=function(e,t){var n;return o.default.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,o.default.awrap((0,u.getById)(e));case 2:if(n=r.sent,console.info("playing media",n),"local"!==n.extractor){r.next=8;break}return r.next=7,o.default.awrap(P(n));case 7:n.url=r.sent;case 8:return r.abrupt("return",O(n,t));case 9:case"end":return r.stop()}}),null,null,null,Promise)},t.enqMedia=function(e,t){return o.default.async((function(n){for(;;)switch(n.prev=n.next){case 0:return setupPartyView(null,e),n.abrupt("return",playMediaLink(e.url,e.currentPosition,t));case 2:case"end":return n.stop()}}),null,null,null,Promise)}),T=t.cancelEncoding=function(){try{p.terminate()}catch(e){}},_={},j=t.encodeMedia=function(e,t,n){var r,u,d,c,s,f,v,g,h,x,E,I,F,C,S,k,M;return o.default.async((function(O){for(;;)switch(O.prev=O.next){case 0:if(r=e.isCopy||(null==e?void 0:e.id),u=(0,a.default)({},e,{id:r}),d=r+"_"+(null==e?void 0:e.filename),c=e.encoding,s=(null==c?void 0:c.lastUpdated)||0,console.info("cachedId",s),f=".output."+s+"."+((null==c?void 0:c.output)||"mp4"),v=d+f,O.prev=8,!_[r]){O.next=11;break}return O.abrupt("return",_[r]);case 11:if(0!==s){O.next=16;break}return O.next=14,o.default.awrap(P(u));case 14:return _[r]=O.sent,O.abrupt("return",_[r]);case 16:return O.next=18,o.default.awrap(window.navigator.storage.getDirectory(m));case 18:return g=O.sent,O.next=21,o.default.awrap(g.getDirectoryHandle(u.folderId));case 21:return h=O.sent,O.next=24,o.default.awrap(h.getFileHandle(r+"_"+v));case 24:return x=O.sent,O.next=27,o.default.awrap(null==x?void 0:x.getFile());case 27:if(!(E=O.sent)){O.next=31;break}return _[r]=URL.createObjectURL(E),O.abrupt("return",_[r]);case 31:O.next=36;break;case 33:O.prev=33,O.t0=O.catch(8),console.error("get cache error",O.t0);case 36:return T(),p=new l.FFmpeg,window.ffmpeg=p,p.on("log",(function(e){e.message})),p.on("progress",(function(e){t&&t(e.progress)})),O.t1=o.default,O.t2=p,O.next=45,o.default.awrap((0,i.toBlobURL)(y+"/ffmpeg-core.js","text/javascript"));case 45:return O.t3=O.sent,O.next=48,o.default.awrap((0,i.toBlobURL)(y+"/ffmpeg-core.wasm","application/wasm"));case 48:return O.t4=O.sent,O.t5={coreURL:O.t3,wasmURL:O.t4},O.t6=O.t2.load.call(O.t2,O.t5),O.next=53,O.t1.awrap.call(O.t1,O.t6);case 53:return O.prev=53,O.prev=54,O.next=57,o.default.awrap(P(u));case 57:I=O.sent,O.next=74;break;case 60:return O.prev=60,O.t7=O.catch(54),console.info("file not found locally downloading",O.t7),O.next=65,o.default.awrap(w(u.id,u.folderId,t));case 65:return F=O.sent,console.info("dlFIle",F),O.t8=URL,O.next=70,o.default.awrap(F.getFile());case 70:if(O.t9=O.sent,I=O.t8.createObjectURL.call(O.t8,O.t9),0!==s){O.next=74;break}return O.abrupt("return",j(e,t,n));case 74:return console.info("before write",I),O.next=77,o.default.awrap((0,i.fetchFile)(I));case 77:return C=O.sent,O.next=80,o.default.awrap(p.writeFile(d,C));case 80:return S=L(u,n),console.info("after write",S),O.next=84,o.default.awrap(p.exec(S));case 84:return console.info("after exec"),O.next=87,o.default.awrap(p.readFile(v));case 87:return k=O.sent,console.info("after processing",k),k.name=v,O.t10=o.default,O.next=93,o.default.awrap(b(u,k));case 93:return O.t11=O.sent.getFile(),O.next=96,O.t10.awrap.call(O.t10,O.t11);case 96:return M=O.sent,_[u.id]=URL.createObjectURL(M),O.abrupt("return",_[u.id]);case 101:O.prev=101,O.t12=O.catch(53),console.error("ffmpeg error ",O.t12);case 104:case"end":return O.stop()}}),null,null,[[8,33],[53,101],[54,60]],Promise)},D=(t.encodeProject=function(e,t,n,r,a){var u,d,c,s,f,m,v,g;return o.default.async((function(h){for(;;)switch(h.prev=h.next){case 0:return h.prev=0,d=D(e,t,n),e.id,c=d.files.filter((function(e){return"-i"!==e})),console.info("encodeProject",e,t,n,d),(null==(u=e.editor)?void 0:u.lastUpdated)||0,h.next=8,o.default.awrap(Promise.all(d.medias.map((function(e){return j(e,(function(t){console.info("encoding media",e.id,t)}),n)}))));case 8:return s=h.sent,console.info("encoded",s,c,d.execCmd),T(),p=new l.FFmpeg,window.ffmpeg=p,p.on("log",(function(e){var t=e.message;console.log("ffmpeg",t),a&&a(t)})),p.on("progress",(function(e){console.info("ffmpeg progress",e),r&&r(e)})),h.t0=o.default,h.t1=p,h.next=19,o.default.awrap((0,i.toBlobURL)(y+"/ffmpeg-core.js","text/javascript"));case 19:return h.t2=h.sent,h.next=22,o.default.awrap((0,i.toBlobURL)(y+"/ffmpeg-core.wasm","application/wasm"));case 22:return h.t3=h.sent,h.t4={coreURL:h.t2,wasmURL:h.t3},h.t5=h.t1.load.call(h.t1,h.t4),h.next=27,h.t0.awrap.call(h.t0,h.t5);case 27:return h.prev=27,f=d.outFileId,h.next=31,o.default.awrap(Promise.all(s.map((function(e,t){var n,r;return o.default.async((function(a){for(;;)switch(a.prev=a.next){case 0:return n=c[t],a.next=3,o.default.awrap((0,i.fetchFile)(e));case 3:return r=a.sent,a.next=6,o.default.awrap(p.writeFile(n,r));case 6:case"end":return a.stop()}}),null,null,null,Promise)}))));case 31:return console.info("after loading files into ffmpeg"),h.next=34,o.default.awrap(p.exec(d.execCmd));case 34:return m=h.sent,console.info("after exec",m,f),h.next=38,o.default.awrap(p.readFile(f));case 38:return v=h.sent,console.info("after processing",v),v.name=f,h.t6=o.default,h.next=44,o.default.awrap(b(e,v));case 44:return h.t7=h.sent.getFile(),h.next=47,h.t6.awrap.call(h.t6,h.t7);case 47:return g=h.sent,_[e.id]=URL.createObjectURL(g),console.info("cachedMedia for project",_[e.id]),h.abrupt("return",_[e.id]);case 53:h.prev=53,h.t8=h.catch(27),console.error("encodeProject error",h.t8);case 56:h.next=61;break;case 58:h.prev=58,h.t9=h.catch(0),console.error("encodeproject error",h.t9);case 61:case"end":return h.stop()}}),null,null,[[0,58],[27,53]],Promise)},t.genRenderCmd=function(e,t,n){var o,l,i,u,d,c;if(void 0===(null==e?void 0:e.id)||(null==t?void 0:t.length)<1)return{execCmd:[],medias:[],files:[]};var s=e.id+"_"+e.title,f=e.editor,p=s+(".output."+((null==f?void 0:f.lastUpdated)||0)+"."+((null==f?void 0:f.output)||"mp4")),m=window.navigator.hardwareConcurrency.toString(),v=null!=f&&f.code&&""!=f.code[0]?f.code.filter((function(e){return""!==e})).map((function(e){return e.trim().replace(/[\r\n]+/gm,"").trim()})):[],y=null==t?void 0:t.map((function(e){var t;return null==e||null==(t=e.media)?void 0:t.map((function(t){return(0,a.default)({},t,{layer:e})}))})).flat().filter((function(e){return e})).filter((function(e){return!e.isContact})),g=(null==y?void 0:y.map((function(e){var t,n;return["-i",(null==e?void 0:e.id)+"_"+(null==e?void 0:e.filename)+".output."+((null==e||null==(t=e.encoding)?void 0:t.lastUpdated)||0)+"."+((null==e||null==(n=e.encoding)?void 0:n.output)||"mp4")]})).flat())||[],h=null==t?void 0:t.reduce((function(e,t){var n;return!0===e?e:!(null!=(n=t.editor)&&n.muted)}),!1),w=null==t?void 0:t.reduce((function(e,t){var n;return!0===e?e:!(null!=(n=t.editor)&&n.videoDisabled)}),!1),b=h?"[a_concat]":"",P=h?["-map",b]:[],x=w?"[v_concat]":"",E=w?["-map",x]:[],I=(null==e||null==(o=e.editor)?void 0:o.aspectRatio)||"16/9",F="scale="+((null==f?void 0:f.width)||1280)+":"+((null==f?void 0:f.height)||720)+",setdar="+I,C=(null==y?void 0:y.map((function(e,t){var n,r,a,o,l,i,u="["+t+":v]trim=start="+((null==e?void 0:e.encoding.start)||0)+":end="+parseInt((null==e||null==(n=e.encoding)?void 0:n.end)||(null==e?void 0:e.duration))+",setpts=PTS-STARTPTS,"+F+"[v"+t+"]",d="["+t+":a]atrim=start="+((null==e?void 0:e.encoding.start)||0)+":end="+parseInt((null==e||null==(r=e.encoding)?void 0:r.end)||(null==e?void 0:e.duration))+",asetpts=PTS-STARTPTS[a"+t+"]",c=u+", \n"+d;return null!=e&&null!=(a=e.layer)&&null!=(o=a.editor)&&o.muted&&(c=u),null!=e&&null!=(l=e.layer)&&null!=(i=l.editor)&&i.videoDisabled&&(c=d),c})))||[],S=(null==y?void 0:y.filter((function(e){var t,n;return!0!==(null==e||null==(t=e.layer)||null==(n=t.editor)?void 0:n.videoDisabled)})).length)||1,k=(null==y?void 0:y.filter((function(e){var t,n;return!0!==(null==e||null==(t=e.layer)||null==(n=t.editor)?void 0:n.muted)})).length)||1,M=((null==y||null==(l=y.map((function(e,t){var n,r;if(!0!==(null==(n=e.layer)||null==(r=n.editor)?void 0:r.videoDisabled))return"[v"+t+"]"})))?void 0:l.filter((function(e){return e})).join(""))||"")+"concat=n="+S+":v=1:a=0"+x+";\n"+(((null==y||null==(i=y.map((function(e,t){var n,r;if(!0!==(null==(n=e.layer)||null==(r=n.editor)?void 0:r.muted))return"[a"+t+"]"})))||null==(u=i.filter((function(e){return e})))?void 0:u.join(""))||"")+"concat=n="+k+":v=0:a=1"+b);return C.push(M),{execCmd:[].concat((0,r.default)(g),["-crf",(null==f||null==(d=f.compressionLevel)?void 0:d.toString())||"20","-threads",m,"-filter_complex",""+C.join(";\n"),"-preset",(null==f?void 0:f.preset)||"veryfast","-movflags","+faststart"],(0,r.default)(v),E,P,["-r",(null==f||null==(c=f.framerate)?void 0:c.toString())||"30",p]),medias:y,files:g,outFileId:p}}),L=t.genExecCmd=function(e,t){var n;if(void 0===(null==e?void 0:e.id))return[];var a=e.id+"_"+e.filename,o=e.encoding,l=a+(".output."+((null==o?void 0:o.lastUpdated)||0)+"."+((null==o?void 0:o.output)||"mp4")),i=window.navigator.hardwareConcurrency.toString(),u=null!=o&&o.code&&""!=o.code[0]?o.code.filter((function(e){return""!==e})).map((function(e){return e.trim().replace(/[\r\n]+/gm,"").trim()})):[],d=t?[]:["-ss",A((null==o?void 0:o.start)||0),"-to",A((null==o?void 0:o.end)||(null==e?void 0:e.duration))];return["-i",a,"-crf",(null==o||null==(n=o.compressionLevel)?void 0:n.toString())||"20","-threads",i,"-filter_complex","scale="+((null==o?void 0:o.width)||1280)+"x"+((null==o?void 0:o.height)||720),"-preset",(null==o?void 0:o.preset)||"veryfast","-movflags","+faststart"].concat(d,(0,r.default)(u),[l])},A=t.genExecTime=function(e,t){var n=parseInt(e,10),r=parseInt(n/60,10),a=parseInt(n-60*r,10);return 1===r.toString().length&&(r="0"+r),1===a.toString().length&&(a="0"+a),""+(t?"":"00:")+r+(t?",":":")+a},B=t.getActiveProjectLayer=function(e,t){for(var n,r,a=0,o=0;void 0===(null==(l=n)?void 0:l.id);){var l,i,u,d;if(r=e[a],a>e.length+1)throw console.error("layers",e,a),"no_layer_found";if(void 0!==(null==(i=r)?void 0:i.id))if(!0!==(null==(u=r)||null==(d=u.editor)?void 0:d.videoDisabled))n=r.media.reduce((function(e,n){var r,a;return e.id?e:(e+=((null==n||null==(r=n.encoding)?void 0:r.end)||(null==n?void 0:n.duration))-((null==n||null==(a=n.encoding)?void 0:a.start)||0))>=t?n:(o=e,e)}),0),a++;else a++;else a++}return{offset:o,layer:r,activeLayer:a,activeMedia:n}},R=t.getNextActiveProjectMedia=function(e,t,n){var r,a,o=t+(((null==n||null==(r=n.encoding)?void 0:r.end)||(null==n?void 0:n.duration))-((null==n||null==(a=n.encoding)?void 0:a.start)||0))+1,l=B(e,o);return console.info("nextPosition",o,l),l},U=t.getTotalTime=function(e){return e.reduce((function(e,t){var n,r=null==(n=t.media)?void 0:n.reduce((function(e,t){var n,r;return e+=((null==t||null==(n=t.encoding)?void 0:n.end)||(null==t?void 0:t.duration))-((null==t||null==(r=t.encoding)?void 0:r.start)||0)}),0);return r?e>r?e:r>e?r:void 0:e}),0)};t.getProjectMedia=function(e,t,n){var r,a,l,i,u,d,c,s,f,p;return o.default.async((function(m){for(;;)switch(m.prev=m.next){case 0:if(a=B(e,t),l=a.offset,i=a.layer,u=a.activeLayer,d=a.activeMedia,c=t-l+parseFloat((null==d?void 0:d.encoding.start)||0),s=U(e),console.info("getProjectMedia offset",c,t,l,d.encoding.start,null==d?void 0:d.id),f=function(){var t;return o.default.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t=j(d,n,!0),r.abrupt("return",new Promise((function(n){t.then((function(t){var r;return o.default.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(n(t),a.prev=1,!(r=R(e,l,d))){a.next=6;break}return a.next=6,o.default.awrap(j(r.activeMedia,(function(){}),!0));case 6:a.next=11;break;case 8:a.prev=8,a.t0=a.catch(1),console.error("prepare next video error",a.t0);case 11:case"end":return a.stop()}}),null,null,[[1,8]],Promise)}))})));case 2:case"end":return r.stop()}}),null,null,null,Promise)},void 0===(null==d?void 0:d.id)){m.next=11;break}return m.next=8,o.default.awrap(f());case 8:m.t0=m.sent,m.next=12;break;case 11:m.t0=null;case 12:return p=m.t0,m.abrupt("return",{url:p,currentPosition:c,muted:null==i||null==(r=i.editor)?void 0:r.muted,activeMedia:d,totalTime:s,offset:l,activeLayer:u});case 14:case"end":return m.stop()}}),null,null,null,Promise)}}.apply(t,r))||(e.exports=a)},9280:(e,t)=>{var n;void 0===(n=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),t.niceBytes=t.getBrowserName=void 0;t.getBrowserName=function(){var e=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0;if(e)return"opera";if("undefined"!==typeof window.InstallTrigger)return"firefox";if(/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||"undefined"!==typeof window.safari&&window.safari.pushNotification).toString())return"apple-safari";var t=!!window.document.documentMode;return t?"microsoft-internet-explorer":t||!window.StyleMedia?window.chrome?"google-chrome":window.isChrome&&-1!=window.navigator.userAgent.indexOf("Edg")?"microsoft-edge":(window.isChrome||e)&&!!window.CSS?"blink":void 0:"microsoft-edge"};var n=["bytes","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"];t.niceBytes=function(e){for(var t=0,r=parseInt(e,10)||0;r>=1024&&++t;)r/=1024;return r.toFixed(r<10&&t>0?1:0)+" "+n[t]}}.apply(t,[t]))||(e.exports=n)},78100:(e,t,n)=>{var r,a;r=[t,n(95004),n(1054),n(84862),n(44780),n(44104),n(16976)],void 0===(a=function(e,r,a,o,l,i,u){"use strict";var d=n(64836);function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0,r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var l=a?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(r),a=d(a),l=d(l);var s={prefixes:["starpy://","https://starpy.me"],config:{screens:{Starp:{path:"webapp",screens:{FilesTab:{path:"media",screens:{Folder:{path:"folder/:folderId"},Files:{path:"/"}}},SettingsTab:{path:"settings",screens:{Devices:{path:"devices"},Settings:{path:"/"}}},ContactsTab:{path:"contact",screens:{Chat:{path:"chat/:chatId"},Contacts:{path:"/"},Folder:{path:"folder/:folderId"}}},EncoderTab:{path:"encoder",screens:{EncoderProjects:{path:"/"},EncoderProject:{path:"project/:projectId"},Folder:{path:"folder/:folderId"}}},EditorTab:{path:"editor",screens:{EditorProjects:{path:"/"},EditorProject:{path:"project/:projectId"},Folder:{path:"folder/:folderId"}}}}}}}};t.default=function(){var e=(0,r.useContext)(i.UserCtx),t={dark:!0,colors:{primary:null==e?void 0:e.colors.textColor,background:null==e?void 0:e.colors.backgroundColor,card:null==e?void 0:e.colors.navBorderColor,text:null==e?void 0:e.colors.navTextColor,border:null==e?void 0:e.colors.navBorderColor,notification:"black"}};return r.default.createElement(u.GestureHandlerRootView,{style:{width:"100%",height:"100%"}},r.default.createElement(o.NavigationContainer,{theme:t,linking:s,fallback:r.default.createElement(a.default,null,"Loading...")},r.default.createElement(l.default,null)))}}.apply(t,r))||(e.exports=a)},29266:(e,t,n)=>{var r,a;r=[t,n(64687),n(10434),n(27424),n(95004),n(52254),n(86533),n(22152),n(39385),n(89555),n(76671),n(25707),n(44104),n(47683),n(84862),n(51641),n(55894),n(11220),n(94313),n(25649),n(60183),n(51979),n(51005),n(58660)],void 0===(a=function(e,r,a,o,l,i,u,d,c,s,f,p,m,v,y,g,h,w,b,P,x,E,I,F){"use strict";var C=n(64836);function S(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(S=function(e){return e?n:t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),t.default=function(e){var t,n,d,C,S=e.options,_=e.route,j=e.createNewParty,D=e.writeItem,L=e.DocumentPicker,A=e.extractMedia,B=(e.ftsIndex,e.searchDatabaseOnIndex,e.getById),R=e.getUserData,U=e.getFolderContent,z=(0,y.useNavigation)(),W=(0,i.useTheme)(),N=(0,g.useQueryClient)(),Q=(0,f.useAppDispatch)(),H=((0,f.useAppSelector)((function(e){return e.editor.pixelsPerSecond})),l.default.useState(!1)),V=(0,o.default)(H,2),q=V[0],K=V[1],G=(0,l.useState)(""),J=(0,o.default)(G,2),X=J[0],Y=J[1],$=(0,l.useState)(""),Z=(0,o.default)($,2),ee=Z[0],te=Z[1],ne=(0,s.default)(),re=ne.width,ae=ne.height,oe=(0,l.useState)(""),le=(0,o.default)(oe,2),ie=le[0],ue=le[1],de=(0,l.useContext)(m.UserDataState),ce=(0,g.useQuery)("UserData",(function(){return R()})),se=(ce.data,null==(t=ce.data)?void 0:t.id),fe=(0,l.useState)(!1),pe=(0,o.default)(fe,2),me=pe[0],ve=pe[1],ye=(0,l.useState)(!1),ge=(0,o.default)(ye,2),he=(ge[0],ge[1],(0,g.useMutation)((function(e){return D(e)}),{retry:!0})),we=(0,y.getFocusedRouteNameFromRoute)(_),be=(0,u.getHeaderTitle)(S,we),Pe=(0,y.useNavigationState)((function(e){var t,n,r;return null==(t=e.routes[0])||null==(n=t.state)||null==(r=n.routes)?void 0:r.find((function(e){return e.name===we}))})),xe=(null==Pe||null==(n=Pe.state)?void 0:n.routes[(null==Pe||null==(d=Pe.state)?void 0:d.index)||0])||{},Ee=(null==xe?void 0:xe.params)||{},Ie=["Devices","Folder","Chat","EncoderProject","EditorProject"].includes(null==xe?void 0:xe.name),Fe=(null==Ee?void 0:Ee.folderId)||Ee.parentFolderId,Ce=(0,g.useQuery)("folderData_"+Fe,(function(){return B(Fe)}),{retry:!0,enabled:!!Fe}),Se=(null==Ee?void 0:Ee.parentFolderId)||(null==(C=Ce.data)?void 0:C.folderId),ke=v.FolderType.contact;"FilesTab"===we&&(ke=v.FolderType.media);"SettingsTab"===we&&(ke=v.FolderType.settings);"EncoderTab"===we&&(ke=v.FolderType.encoder);"EditorTab"===we&&(ke=v.FolderType.editor);var Me="new_"+ke,Oe=(0,I.useMediaPlayer)(),Te=F.encoderProjectTypes.includes(ke);(0,l.useMemo)((function(){!function(){var e,t,n;r.default.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(-1!==ee.search("http")||-1!==ee.search("magnet")){o.next=2;break}return o.abrupt("return");case 2:if(console.info(ee),!0!==me){o.next=5;break}return o.abrupt("return");case 5:return ve(!0),setTimeout((function(){ve(!1)}),2e4),o.next=9,r.default.awrap(A(ee));case 9:if(!(e=o.sent)||!e.id){o.next=25;break}return t=e.id,o.prev=12,n=(0,a.default)({},e,{originalId:t,id:p.default.v4(),folderId:Fe||Me,userId:de.user.id,date:(new Date).valueOf(),isMediaNew:!0,isFolder:!(!e.files||!e.files.length)||void 0,files:e.files&&e.files.map((function(e){return{name:e.name,size:e.length}}))}),console.info("new media",n),o.next=17,r.default.awrap(he.mutateAsync(n));case 17:return o.next=19,r.default.awrap(N.refetchQueries({queryKey:Fe?"folderContent_"+Fe:"folderContent_"+ke}));case 19:te(""),o.next=25;break;case 22:o.prev=22,o.t0=o.catch(12),console.error("extractLink",o.t0);case 25:ve(!1);case 26:case"end":return o.stop()}}),null,null,[[12,22]],Promise)}()}),[ee]);var _e=re>700&&!0,je=M;"party"===ie&&(je=T);"search"===ie&&(je="type to search");var De=[v.FolderType.media,v.FolderType.editor,v.FolderType.encoder].includes(ke),Le=!0,Ae="EditorProject"===(null==xe?void 0:xe.name);Ae&&(De=!1,Le=!1);return console.info("folderType",ke,De),l.default.createElement(l.default.Fragment,null,l.default.createElement(i.Appbar.Header,{theme:W},!q&&Ie?l.default.createElement(i.Appbar.Action,{icon:"chevron-left",onPress:function(){if(ke===v.FolderType.contact)return Se?void z.navigate("ContactsTab",{screen:"Folder",params:{folderId:Se}}):(console.info("navigate to Contacts"),void z.navigate("Contacts"));if(ke===v.FolderType.settings)return console.info("navigate to Contacts"),void z.navigate("Settings");if(ke===v.FolderType.editor)return Se?void z.navigate("EditorTab",{screen:"Folder",params:{folderId:Se}}):void z.navigate("EditorProjects");if(ke===v.FolderType.encoder)return Se?void z.navigate("EncoderTab",{screen:"Folder",params:{folderId:Se}}):(console.info("navigate to Encoder"),void z.navigate("EncoderProjects"));if(ke===v.FolderType.media)return Se?void z.navigate("FilesTab",{screen:"Folder",params:{folderId:Se}}):(console.info("navigate to FilesTab"),void z.navigate("Files"));if(!0===z.canGoBack())return z.goBack()}}):null,q?null:l.default.createElement(i.Appbar.Content,{title:be,theme:W}),q?l.default.createElement(c.default,{style:{width:"100%"}},l.default.createElement(i.TextInput,{placeholder:je,onChangeText:function(e){return"search"===ie?te(e):Y(e)},style:{width:"100%",textAlignVertical:"bottom",lineHeight:30,padding:10,height:40},theme:W,value:"search"===ie?ee:X,left:l.default.createElement(i.TextInput.Icon,{style:{marginTop:20},icon:"arrow-left-circle",onPress:function(){K(!1),ue("")}}),autoFocus:!0,maxLength:100,right:l.default.createElement(i.TextInput.Icon,{style:{marginTop:20},onPress:function(){var e,t,n,a;return r.default.async((function(o){for(;;)switch(o.prev=o.next){case 0:console.info("mode",ie),o.prev=1,o.t0=ie,o.next="party"===o.t0?5:"folder"===o.t0?13:"search"===o.t0?18:21;break;case 5:return console.info("createNewParty"),e=se+"_"+p.default.v4(),o.next=9,r.default.awrap(j({id:e,name:X,creatorId:se,partyId:e,isParty:!0,folderId:Fe||Me}));case 9:return t=o.sent,z.navigate("Chat",{chatId:e,name:X,mnemonic:t.mnemonic,parentFolderId:Fe||Me}),console.info("createNewParty done",t),o.abrupt("break",21);case 13:return n="folder_"+p.default.v4()+"_"+se,a={id:n,title:X,isFolder:!0,date:(new Date).valueOf(),userId:se,folderType:ke,folderId:Fe},o.next=17,r.default.awrap(he.mutateAsync(a));case 17:return o.abrupt("break",21);case 18:return K(!1),ue(""),o.abrupt("break",21);case 21:o.next=26;break;case 23:o.prev=23,o.t1=o.catch(1),console.error("onClickExtra err",o.t1);case 26:if(!Fe){o.next=31;break}return o.next=29,r.default.awrap(N.refetchQueries({queryKey:"folderContent_"+Fe}));case 29:o.next=33;break;case 31:return o.next=33,r.default.awrap(N.refetchQueries({queryKey:"folders_"+ke}));case 33:return K(!1),ue(""),o.abrupt("return",!0);case 36:case"end":return o.stop()}}),null,null,[[1,23]],Promise)},icon:"check-circle",loading:me})})):null,Le&&!q?l.default.createElement(i.Tooltip,{title:"Create a folder"},l.default.createElement(i.Appbar.Action,{icon:"folder-plus",onPress:function(){return K(!0),void ue("folder")}})):null,Ae&&l.default.createElement(E.default,{projectId:Ee.projectId,getById:B,writeItem:D,routeParams:Ee,getFolderContent:U}),q||"contact"!==ke?null:l.default.createElement(i.Tooltip,{title:"Create a chat"},l.default.createElement(i.Appbar.Action,{icon:"chat-plus",onPress:function(){return K(!0),void ue("party")}})),De&&!q?l.default.createElement(i.Tooltip,{title:"Select a file"},l.default.createElement(i.Appbar.Action,{icon:"file-plus",onPress:function(){return function(){var e,t,n,a;return r.default.async((function(o){for(;;)switch(o.prev=o.next){case 0:return K(!1),ue("media"),o.next=4,r.default.awrap(L.pickSingle({presentationStyle:"fullScreen"}));case 4:if(e=o.sent,console.info("pickerResult",e),e){o.next=8;break}return o.abrupt("return");case 8:t=e.uri,n=Fe||Me,console.info("isEncoderProject",Te),a={id:p.default.v4().toString(),url:t,title:e.name,originalId:e.name,filename:e.name,fileType:e.type,folderId:n,userId:se,date:(new Date).valueOf(),isMediaNew:!Te,isEncoderProject:Te,type:e.file.type,size:e.file.size,extractor:"local"},Q((0,h.startOnboarding)({file:e.file,media:a}));case 13:case"end":return o.stop()}}),null,null,null,Promise)}()}})):null,_e||q?null:l.default.createElement(i.Appbar.Action,{icon:"magnify",onPress:function(){return K(!0),void ue("search")}}),_e?l.default.createElement(i.Searchbar,{loading:me,mode:"bar",placeholder:ke===v.FolderType.contact?O:k,theme:W,style:{height:40,width:300},inputStyle:{paddingBottom:14},value:ee,onChangeText:te}):null),l.default.createElement(w.default,{projectId:Ee.projectId,writeItem:D,userId:se,folderType:ke,hideMedialModal:function(){Q((0,h.cancel)())},folderId:Fe||Se,routeName:null==xe?void 0:xe.name,isEncoderProject:Te}),Oe.currentMediaId?l.default.createElement(b.default,{getById:B,height:ae,writeItem:D,media:Oe,routeParams:Ee}):null,"EncoderProject"===(null==xe?void 0:xe.name)?l.default.createElement(P.default,{projectId:Ee.projectId,getById:B,height:ae,folderId:Fe||Se,writeItem:D}):null,"EditorProject"===(null==xe?void 0:xe.name)?l.default.createElement(x.default,{projectId:Ee.projectId,getById:B,height:ae,writeItem:D,routeParams:Ee,folderId:Fe||Se,getFolderContent:U}):null)},r=C(r),a=C(a),o=C(o),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=S(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var l=a?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(l),d=C(d),c=C(c),s=C(s),p=C(p),w=C(w),b=C(b),P=C(P),x=C(x),E=C(E);var k="type to search your collection",M="Type name of the folder",O="type to search your contacts",T="Type name of the new chat"}.apply(t,r))||(e.exports=a)},16350:(e,t,n)=>{var r,a;r=[t,n(10434),n(95004),n(17342),n(59372),n(82499),n(47683),n(33466)],void 0===(a=function(e,r,a,o,l,i,u,d){"use strict";var c=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),t.createChatStack=void 0,r=c(r),a=c(a),l=c(l),i=c(i),d=c(d);var s=(0,o.createStackNavigator)();t.createChatStack=function(e){var t=function(t){return a.default.createElement(i.default,(0,r.default)({},t,e,{writeItem:e.writeItem,setPubCallback:e.setPubCallback,getPublicMessages:e.getPublicMessages,writePublicData:e.writePublicData,getUnreadMessages:e.getUnreadMessages,sendChatMessage:e.sendChatMessage,getUserData:e.getUserData,getById:e.getById}))},n=function(t){return a.default.createElement(d.default,{folderType:u.FolderType.contact,navigation:t.navigation,route:t.route,getFolderContent:e.getFolderContent,getById:e.getById,enqMedia:e.enqMedia,stopMedia:e.stopMedia,getFoldersByType:e.getFoldersByType,setWindowClosedCallback:e.setWindowClosedCallback,writeItem:e.writeItem})},o=function(t){return a.default.createElement(l.default,(0,r.default)({},t,{getUserData:e.getUserData,getFolderContent:e.getFolderContent,getFoldersByType:e.getFoldersByType,writeItem:e.writeItem,getPublicMessages:e.getPublicMessages,getPublicFolderContent:e.getPublicFolderContent,getCurrentFolder:e.getCurrentFolder,setCurrentFolder:e.setCurrentFolder,setPubCallback:e.setPubCallback,getContactsByFolderWithUnread:e.getContactsByFolderWithUnread,writePublicData:e.writePublicData,sendChatMessage:e.sendChatMessage,getPrevPartiesForChatId:e.getPrevPartiesForChatId,deleteById:e.deleteById,publicPartyPref:e.publicPartyPref,setNetworkUpdateCB:e.setNetworkUpdateCB,getPublicPartyList:e.getPublicPartyList,createNewParty:e.createNewParty,getById:e.getById,toggleSearch:e.toggleSearch}))};return function(){return a.default.createElement(s.Navigator,{screenOptions:{headerShown:!1,freezeOnBlur:!0,animationEnabled:!1}},a.default.createElement(s.Screen,{name:"Contacts",component:o,options:{freezeOnBlur:!0}}),a.default.createElement(s.Screen,{name:"Chat",component:t,options:function(e){var t;return{title:null==(t=e.route.params)?void 0:t.name,freezeOnBlur:!0}}}),a.default.createElement(s.Screen,{name:"Folder",component:n,options:function(e){var t;return{title:null==(t=e.route.params)?void 0:t.title,freezeOnBlur:!0}}}))}}}.apply(t,r))||(e.exports=a)},18078:(e,t,n)=>{var r,a;r=[t,n(27424),n(10434),n(95004),n(84862),n(7602),n(39385),n(7484),n(2145),n(89555),n(45288),n(22152),n(44104),n(84846),n(52254),n(32087),n(13896),n(3126)],void 0===(a=function(e,r,a,o,l,i,u,d,c,s,f,p,m,v,y,g,h,w){"use strict";var b=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0,r=b(r),a=b(a),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=P(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var l=a?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(o),i=b(i),u=b(u),d=b(d),c=b(c),s=b(s),f=b(f),p=b(p),w=b(w);function P(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(P=function(e){return e?n:t})(e)}t.default=function(e){var t,n=e.currentUserId,p=e.chatId,b=e.params,P=e.setPubCallback,x=e.getPublicMessages,E=e.getUnreadMessages,I=e.sendChatMessage,F=e.getFolderContent,C=e.getById,S=e.routeParams,k=e.isEmbeded,M=b.user,O=b.contact,T=(0,v.useMessages)(p,n,x,E,I,P,M,O),_=T.messages,j=T.loadingMessages,D=T.sendMessage,L=T.nextPage,A=T.isLoadingEarlier,B=(0,o.useCallback)((function(e){console.info("sendmessage",e),D(e)}),[]),R=(0,l.useRoute)(),U=(0,s.default)(),z=U.width,W=U.height,N=(0,l.useNavigation)(),Q=!(z>700),H=(null==S?void 0:S.parentFolderId)||(null==(t=R.params)?void 0:t.parentFolderId)||O&&O.folderId||null,V=(0,h.useFolder)(H,F,C),q=c.default.create({container:{flex:1,paddingTop:0,marginTop:0},item:{paddingTop:15,paddingLeft:5,fontSize:12,height:160,color:"black",width:z-80},tinyLogo:{marginTop:2,width:22,height:22},scroll:{height:W-65,display:"flex",position:"relative",backgroundColor:"black",width:"100%"},icon:{paddingLeft:10}}),K="#b4c0d1",G=(0,o.useContext)(m.UserCtx),J=(0,y.useTheme)().colors.surface;return console.info("messages",_.length),o.default.createElement(u.default,{style:{backgroundColor:G.colors.backgroundColor,height:"100%",width:"100%",flexDirection:"row"}},Q||k?null:o.default.createElement(u.default,{style:{width:"30%"}},V.folderContentQuery.isFetching?o.default.createElement(y.ActivityIndicator,{size:72}):o.default.createElement(i.default,{style:(0,a.default)({},q.scroll)},o.default.createElement(d.default,{onEndReached:function(){console.info("onEndReached")},data:V.folderContent,pagingEnabled:!0,initialNumToRender:1e3,renderItem:function(e){var t,n=e.item;return t=n,o.default.createElement(w.default,{i:t,key:t.id,dataHook:V,styles:q,width:Q?z:z/100*70,navigation:N,current:G})},keyExtractor:function(e){return e.id||e.date.toString()},getItemCount:V.getContentCount,getItem:V.getContentItem,onScrollToTop:function(){console.info("ontop")},getItemLayout:function(e,t){return{length:130,offset:130*t,index:t}}}))),o.default.createElement(u.default,{style:{width:Q||k?"100%":"70%"}},_.length>-1?o.default.createElement(g.GiftedChat,{scrollToBottom:!0,renderLoading:function(){return o.default.createElement(y.ActivityIndicator,{size:72})},messages:_.map((function(e){return(0,a.default)({},e,{_id:e.id,user:{_id:e.userId,name:e.userName}})})),onSend:function(e){var t=(0,r.default)(e,1)[0];return B(t.text)},user:{_id:M.id,avatar:M.photo},renderBubble:function(e){return o.default.createElement(g.Bubble,(0,a.default)({},e,{textStyle:{left:{color:K}},wrapperStyle:{right:{backgroundColor:"#871e69",alignSelf:"auto",maxWidth:"60%"},left:{backgroundColor:"#344868",alignSelf:"auto",maxWidth:"60%"}}}))},timeTextStyle:{},renderAvatar:function(e){return o.default.createElement(g.GiftedAvatar,(0,a.default)({},e,{user:e.currentMessage.user,avatarStyle:{backgroundColor:"transparent",borderWidth:1,borderColor:J}}))},listViewProps:{scrollEventThrottle:400,onEndReached:function(e){console.info("on end of chat reached",e,A),!0!==A&&L()}},isLoadingEarlier:A,loadEarlier:!0,onLoadEarlier:function(){console.info("on load earlier"),L(),console.info(j)},renderLoadEarlier:function(e){return o.default.createElement(u.default,{style:{height:100,width:"100%"}},e.isLoadingEarlier?o.default.createElement(y.ActivityIndicator,{size:32}):o.default.createElement(u.default,{style:{height:100}}))},renderChatEmpty:function(e){return o.default.createElement(u.default,{style:{transform:[{scaleY:-1}]}},o.default.createElement(y.List.Item,{left:function(e){return o.default.createElement(y.List.Icon,(0,a.default)({},e,{color:K,icon:"lock"}))},titleStyle:{color:K},title:"Decrypting Messages..."}),o.default.createElement(y.ProgressBar,{indeterminate:!0,visible:!0}))},renderInputToolbar:function(e){return o.default.createElement(g.InputToolbar,(0,a.default)({},e,{containerStyle:{backgroundColor:"black",borderColor:"gray"},primaryStyle:{borderColor:"white"},renderComposer:function(e){return o.default.createElement(g.Composer,(0,a.default)({},e,{textInputStyle:{color:K,padding:10},multiline:!1,textInputAutoFocus:!0,textInputProps:(0,a.default)({},e.textInputProps,{blurOnSubmit:!0,onSubmitEditing:function(){e.text&&e.onSend&&(e.onSend({text:e.text.trim()},!0),undefined.focus())}})}))},renderSend:function(e){return o.default.createElement(f.default,{onPress:function(){e.onSend([{text:e.text}],!0)}},o.default.createElement(y.List.Icon,(0,a.default)({style:{padding:10}},e,{icon:"send"})))}}))},placeholder:"Write your message",showUserAvatar:!1}):o.default.createElement(y.ActivityIndicator,{size:72})))}}.apply(t,r))||(e.exports=a)},99356:(e,t,n)=>{var r,a;r=[t,n(10434),n(95004),n(52254),n(84862)],void 0===(a=function(e,r,a,o,l){"use strict";var i=n(64836);function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0,r=i(r),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var l=a?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(a);t.default=(0,a.memo)((function(e){var t,n=e.navigation,i=e.i,u=(null==(t=(0,l.useRoute)().params)?void 0:t.chatId)===i.id,d=i,c=i.name||i.id,s=u?"chat":"chat-outline",f=u?a.default.createElement(a.default.Fragment,null):null;return a.default.createElement(a.default.Fragment,null,a.default.createElement(o.List.Accordion,{expanded:u,title:c,onPress:function(){console.info("onPressContact",n,i),n.dispatch(l.CommonActions.navigate({name:"Chat",params:{chatId:d.id,name:d.name,parentFolderId:d.folderId,mnemonic:d.mnemonic}}))},left:function(e){return a.default.createElement(o.List.Icon,(0,r.default)({},e,{icon:s}))},right:function(){return a.default.createElement(a.default.Fragment,null)}},f),a.default.createElement(o.Divider,null))}))}.apply(t,r))||(e.exports=a)},2857:(e,t,n)=>{var r,a;r=[t,n(95004),n(31401),n(91724)],void 0===(a=function(e,r,a,o){"use strict";var l=n(64836);function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0,r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var l=a?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(r),o=l(o);t.default=(0,r.memo)((function(e){var t=e.navigation,n=e.getFolderContent,l=e.getFoldersByType,i=e.sendChatMessage,u=e.getPrevPartiesForChatId,d=(e.getPublicFolderContent,e.isFocused,e.writeItem),c=(0,a.useContacts)(l,n,d);return r.default.createElement(o.default,{dataHook:c,navigation:t,sendChatMessage:i,getPrevPartiesForChatId:u})}))}.apply(t,r))||(e.exports=a)},3126:(e,t,n)=>{var r,a;r=[t,n(10434),n(95004),n(89555),n(2453),n(99356),n(83766),n(41811),n(84862)],void 0===(a=function(e,r,a,o,l,i,u,d,c){"use strict";var s=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0,r=s(r),a=s(a),o=s(o),l=s(l),i=s(i),u=s(u),d=s(d);var f=!1;t.default=function(e){var t,n=e.dataHook,s=e.styles,p=e.i,m=e.navigation,v=e.party,y=e.current,g=e.sendChatMessage,h=e.getPrevPartiesForChatId,w=null==(t=(0,c.useRoute)().params)?void 0:t.folderId,b=(0,o.default)().width>700?80:0,P=e.width-b;if(p.isMediaNew){var x=n,E=x.onMediaPress,I=x.onRemoveFolder,F=x.onDownloadMediaPress,C=x.onCopyLinkPress,S=x.onEditMediaPress,k=x.isLoadingMedia,M=x.currentContentId,O=x.currentMediaId;x.currentMediaPlaying;return a.default.createElement(l.default,{key:p.id,i:p,width:P,onMediaPress:E,onRemoveMediaPress:I,onDownloadMediaPress:F,onCopyLinkPress:C,onEditMediaPress:S,itemLoading:!(p.id!==O||!k)&&O,isOpen:p.id===M,isPlaying:p.id===O&&!k,enableMove:f})}if(p.isEncoderProject||p.isEditorProject)return a.default.createElement(d.default,{item:p,folderType:n.folderType,onRemoveFolder:n.onRemoveFolder});if(p.isContact)return a.default.createElement(i.default,{key:p.id,navigation:m,i:p,party:v,current:y,sendChatMessage:g,getPrevPartiesForChatId:h,width:P});if(p.isFolder){var T=n,_=T.onRemoveFolder,j=T.isEditingFolder,D=T.onFolderActionPress,L=T.setFolderEditorName,A=T.currentFolderEditorName,B=T.folderNameInputRef,R=T.abortEditFolder,U=T.onShareFolder;return a.default.createElement(u.default,{key:p.id,folder:(0,r.default)({},p,{isInfoOpen:p.id===j,isOpen:p.id===w}),styles:s,setFolderEditorName:L,currentFolderEditorName:A,folderNameInputRef:B,iconColor:"black",iconSize:30,enableMove:f,current:y,width:P,isOpen:p.id===w,onRemoveFolder:function(){return _(p)},onShareFolder:function(){return U(p)},onFolderActionPress:function(){return D(p.id)},onFolderPress:function(){return m.dispatch(c.CommonActions.navigate({name:"Folder",params:{folderId:p.id,title:p.title,parentFolderId:p.folderId}}))},isSecondLevel:!0,abortEditFolder:function(){return R()}},p.id===w?a.default.createElement(a.default.Fragment,null):null)}return a.default.createElement(a.default.Fragment,null)}}.apply(t,r))||(e.exports=a)},46026:(e,t,n)=>{var r,a;r=[t,n(10434),n(95004),n(52254),n(51641),n(39385)],void 0===(a=function(e,r,a,o,l,i){"use strict";var u=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),t.default=function(e){var t=(0,l.useQuery)("UserData",(function(){return e.getUserData()}),{refetchOnWindowFocus:!1}),n=t.isLoading,u=t.data;return n?a.default.createElement(o.ActivityIndicator,{size:72}):a.default.createElement(o.List.Section,null,u.devices.map((function(e){return a.default.createElement(i.default,{key:e.id},"unknown"!==e.id&&e.manufacturer?a.default.createElement(a.default.Fragment,null,a.default.createElement(o.Divider,null),a.default.createElement(o.List.Item,{key:e.id,left:function(t){return a.default.createElement(o.List.Icon,(0,r.default)({},t,{icon:e.manufacturer.toLowerCase()}))},right:function(e){return a.default.createElement(o.List.Icon,(0,r.default)({},e,{icon:"logout"}))},description:"Created: "+new Date(e.createdAt).toDateString(),title:e.model.replace(new RegExp("-")," ")+" on "+e.platform}),a.default.createElement(o.Divider,null)):null)})))},r=u(r),a=u(a),i=u(i)}.apply(t,r))||(e.exports=a)},79170:(e,t,n)=>{var r,a;r=[t,n(10434),n(95004),n(2145),n(54572),n(52254)],void 0===(a=function(e,r,a,o,l,i){"use strict";var u=n(64836);function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0,r=u(r),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=d(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var l=a?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(a),o=u(o);var c=[{label:"Media",focusedIcon:"folder",unfocusedIcon:"folder-outline",key:0,screen:"FilesTab"},{label:"Chat",focusedIcon:"forum",unfocusedIcon:"forum-outline",key:1,screen:"ContactsTab"},{label:"Encode\nCompress",focusedIcon:"state-machine",unfocusedIcon:"state-machine",key:2,screen:"EncoderTab"},{label:"Video\nEditor",focusedIcon:"scissors-cutting",unfocusedIcon:"scissors-cutting",key:3,screen:"EditorTab"},{label:"Settings",focusedIcon:"cog",unfocusedIcon:"cog-outline",key:4,screen:"SettingsTab"}];var s=o.default.create({drawerContent:{flex:1},preference:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:12,paddingHorizontal:16},v3Preference:{height:56,paddingHorizontal:28},badge:{alignSelf:"center"},collapsedSection:{marginTop:16,fontSize:12},annotation:{marginHorizontal:24,marginVertical:6}});t.default=function(e){var t=e.navigation,n=e.state.index,o=(0,i.useTheme)();return a.createElement(l.DrawerContentScrollView,{alwaysBounceVertical:!1,style:[s.drawerContent,{backgroundColor:o.colors.surface}],showsVerticalScrollIndicator:!1,showsHorizontalScrollIndicator:!1},a.createElement(a.Fragment,null,c.map((function(e,o){return a.createElement(i.Drawer.Section,{style:s.collapsedSection,key:e.key},a.createElement(i.Drawer.CollapsedItem,(0,r.default)({},e,{key:e.key,active:n===o,onPress:function(){t.navigate(e.screen)}})))}))))}}.apply(t,r))||(e.exports=a)},785:(e,t,n)=>{var r,a;r=[t,n(10434),n(95004),n(17342),n(33466),n(47683),n(91724),n(30463),n(37559)],void 0===(a=function(e,r,a,o,l,i,u,d,c){"use strict";var s=n(64836);function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(f=function(e){return e?n:t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),t.createEditor=void 0,r=s(r),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=f(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var l=a?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(a),l=s(l),u=s(u),c=s(c);var p=(0,o.createStackNavigator)(),m=i.FolderType.editor;t.createEditor=function(e){var t=(0,a.memo)((function(t){return a.default.createElement(l.default,{folderId:t.route.params.folderId,navigation:t.navigation,route:t.route,getFolderContent:e.getFolderContent,getById:e.getById,enqMedia:e.enqMedia,stopMedia:e.stopMedia,getFoldersByType:e.getFoldersByType,setWindowClosedCallback:e.setWindowClosedCallback,folderType:m,writeItem:e.writeItem})})),n=(0,a.memo)((function(t){return a.default.createElement(u.default,(0,r.default)({},t,e,{dataHook:(0,d.useFolders)(m,e.getFoldersByType,e.getFolderContent,e.writeItem)}))})),o=(0,a.memo)((function(t){return a.default.createElement(c.default,(0,r.default)({},t,{writeItem:e.writeItem,getById:e.getById,getFolderContent:e.getFolderContent}))}));return function(){return a.default.createElement(p.Navigator,{screenOptions:{headerShown:!1,freezeOnBlur:!0}},a.default.createElement(p.Screen,{name:"EditorProjects",component:n,options:{}}),a.default.createElement(p.Screen,{name:"EditorProject",component:o}),a.default.createElement(p.Screen,{name:"Folder",component:t}))}}}.apply(t,r))||(e.exports=a)},60183:(e,t,n)=>{var r,a;r=[t,n(10434),n(64687),n(95004),n(39385),n(89555),n(52254),n(51641),n(44187),n(84856),n(4061),n(16976),n(58660),n(82499)],void 0===(a=function(e,r,a,o,l,i,u,d,c,s,f,p,m,v){"use strict";var y=n(64836);function g(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(g=function(e){return e?n:t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0,r=y(r),a=y(a),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=g(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var l=a?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(o),l=y(l),i=y(i),c=y(c),s=y(s),f=y(f),v=y(v);t.default=(0,o.memo)((function(e){var t=e.getById,n=e.projectId,y=e.writeItem,g=e.height,h=e.routeParams,w=(0,u.useTheme)(),b=(0,d.useQuery)(["projectdata",n],(function(){return a.default.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.default.awrap(t(n));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),null,null,null,Promise)}),{enabled:!!n}),P=(0,o.useRef)(),x=b.data,E=(0,d.useQuery)(["projectLayers",n],(function(){var e,t;return a.default.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,a.default.awrap((0,m.getFolderContent)(n));case 2:return e=o.sent,o.next=5,a.default.awrap(Promise.all(e.map((function(e){return a.default.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=r.default,t.t1={},t.t2=e,t.next=5,a.default.awrap((0,m.getFolderContent)(null==e?void 0:e.id));case 5:return t.t3=t.sent,t.t4={media:t.t3},t.abrupt("return",(0,t.t0)(t.t1,t.t2,t.t4));case 8:case"end":return t.stop()}}),null,null,null,Promise)}))));case 5:return t=o.sent,o.abrupt("return",t);case 7:case"end":return o.stop()}}),null,null,null,Promise)})),I=.24*(0,i.default)().width-50,F=E.data;return o.default.createElement(l.default,{style:{margin:0,display:"flex"},className:"video-banner"},o.default.createElement(u.Divider,null),o.default.createElement(u.Banner,{visible:!!n,theme:w,style:{backgroundColor:"black",padding:0,margin:0,height:"100%",overflow:"hidden",display:"flex",flexDirection:"row"},contentStyle:{width:"100%",height:"100%",maxWidth:"auto",padding:0,margin:0,display:"flex",flexDirection:"row",alignItems:"stretch",overflow:"hidden"}},o.default.createElement(l.default,{style:{display:"flex",flexDirection:"row",width:"100%",height:"100%"}},o.default.createElement(p.ScrollView,{style:{width:"24%",height:g/2,display:"flex",marginRight:5},key:1,showsHorizontalScrollIndicator:!1,showsVerticalScrollIndicator:!1},o.default.createElement(s.default,{projectId:n,mediaRes:x,video2:P,layers:F,projectQuery:b,writeItem:y})),o.default.createElement(l.default,{style:{width:"50%",height:g/2,borderLeftWidth:1,borderRightWidth:1,borderLeftColor:"rgb(73, 69, 79)",borderRightColor:"rgb(73, 69, 79)",display:"flex"},key:2},o.default.createElement(f.default,{video2:P,projectId:n,mediaRes:x,layers:F})),o.default.createElement(l.default,{style:{width:"24%",height:g/2,display:"flex"},key:3},(null==h?void 0:h.encoder)&&o.default.createElement(c.default,{routeParams:h,writeItem:y,getById:t,codeWidth:I}),(null==h?void 0:h.chatId)&&o.default.createElement(v.default,{setPubCallback:m.setPubCallback,getPublicMessages:m.getPublicMessages,getUnreadMessages:m.getUnreadMessages,sendChatMessage:m.sendChatMessage,getUserData:m.getUserData,getById:t,writeItem:y,getFolderContent:m.getFolderContent,routeParams:h,isEmbeded:!0})))),o.default.createElement(u.Divider,null))}))}.apply(t,r))||(e.exports=a)},76597:(e,t,n)=>{var r,a;r=[t,n(95004),n(16976),n(76671),n(20555),n(17183),n(89555),n(39385)],void 0===(a=function(e,r,a,o,l,i,u,d){"use strict";var c=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0,r=c(r),i=c(i),u=c(u),d=c(d);t.default=function(){var e=(0,o.useAppDispatch)(),t=(0,o.useAppSelector)((function(e){return e.editor.caretPosition})),n=(0,u.default)(),c=n.width,s=n.height,f=new i.default.Value(0),p=i.default.event([{nativeEvent:{translationX:f}}],{listener:function(e){},useNativeDriver:!0});return r.default.createElement(d.default,{style:{cursor:"pointer",height:0}},r.default.createElement(a.PanGestureHandler,{onGestureEvent:p,onHandlerStateChange:function(n){if(n.nativeEvent.oldState===a.State.ACTIVE){var r=n.nativeEvent.translationX,o=t+r;return o<0&&(o=0),f.setOffset(o),f.setValue(0),e((0,l.setCaretPosition)(o)),o}}},r.default.createElement(i.default.View,{style:[{width:100,opacity:.5,height:s/2,justifyContent:"center",alignItems:"center",backgroundColor:"red",cursor:"pointer"},{transform:[{translateX:f.interpolate({inputRange:[0,c],outputRange:[t,c],extrapolate:"extend"})}]}]})))}}.apply(t,r))||(e.exports=a)},66352:(e,t,n)=>{var r,a;r=[t,n(10434),n(64687),n(84862),n(76671),n(17183),n(39385),n(51641),n(16976),n(52254),n(95004)],void 0===(a=function(e,r,a,o,l,i,u,d,c,s,f){"use strict";var p=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0,r=p(r),a=p(a),i=p(i),u=p(u),f=p(f);t.default=function(e){var t,n,p=e.item,m=e.onDragEnd,v=e.onDragStart,y=e.index,g=e.layerIndex,h=e.writeItem,w=e.parentDataHook,b=(0,o.useNavigation)(),P=(0,o.useRoute)(),x=(0,d.useQueryClient)(),E=(0,l.useAppSelector)((function(e){return e.editor})).pixelsPerSecond,I=P.params.projectId,F=(((null==p?void 0:p.duration)||0)-1)*E,C=(null==(t=p.encoding)?void 0:t.start)||0,S=(null==(n=p.encoding)?void 0:n.end)||p.duration,k=S?(S-C)*E:F,M=new i.default.Value(k),O=(0,d.useMutation)((function(e){return h(e)}),{onSuccess:function(){return a.default.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.default.awrap(x.refetchQueries(["projectLayers",I]));case 2:return e.next=4,a.default.awrap(x.refetchQueries(["encodedMedia",I]));case 4:return e.next=6,a.default.awrap(x.refetchQueries(["project_"+I]));case 6:case"end":return e.stop()}}),null,null,null,Promise)}}),T=i.default.event([{nativeEvent:{translationX:M}}],{listener:function(e){},useNativeDriver:!0}),_=y+g,j=_%2?"darkcyan":"green";_%3>1&&(j="darkslateblue");var D=function(){return a.default.async((function(e){for(;;)switch(e.prev=e.next){case 0:w.onRemoveFolder(p);case 1:case"end":return e.stop()}}),null,null,null,Promise)},L=function(e){var t,n,r;return a.default.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(e.nativeEvent.oldState!==c.State.ACTIVE){o.next=11;break}return(r=M._value)>F&&(r=F),r<40&&(r=40),M._value!==r&&M.setValue(r),p.encoding||(p.encoding={}),(r/=E)<(null==(t=p.encoding)?void 0:t.start)&&(r+=null==(n=p.encoding)?void 0:n.start),p.encoding.end=r,o.next=11,a.default.awrap(O.mutateAsync(p));case 11:case"end":return o.stop()}}),null,null,null,Promise)};return f.default.createElement(u.default,{key:p.id,style:{height:68,position:"relative"}},f.default.createElement(i.default.View,{style:{width:p.isContact?75:M.interpolate({inputRange:[C,F],outputRange:[C,F],extrapolate:"clamp"}),height:"100%",top:0,padding:0,margin:0,left:p.currentPosition?E*p.currentPosition:0,position:p.currentPosition?"absolute":"relative",backgroundColor:j,zIndex:2,borderWidth:p.id===P.params.encoder||p.id===P.params.chatId?1:0,borderRadius:p.isContact?100:0,borderColor:"white"}},!p.isContact&&f.default.createElement(f.default.Fragment,null,f.default.createElement(c.PanGestureHandler,{onGestureEvent:T,onHandlerStateChange:L},f.default.createElement(u.default,{style:{position:"absolute",left:0,bottom:0,transform:[{rotate:"90deg"}],cursor:"pointer",zIndex:100}},f.default.createElement(s.List.Icon,{icon:"resize-bottom-right",style:{padding:0,margin:0}}))),f.default.createElement(c.PanGestureHandler,{onGestureEvent:T,onHandlerStateChange:L},f.default.createElement(u.default,{style:{position:"absolute",right:0,bottom:0,cursor:"pointer",zIndex:100}},f.default.createElement(s.List.Icon,{icon:"resize-bottom-right",style:{padding:0,margin:0}})))),f.default.createElement(s.List.Item,{onPress:function(){return b.setParams((0,r.default)({},P.params,{encoder:!p.isContact&&p.id,chatId:p.isContact&&p.id}))},style:{height:"100%"},title:p.isContact?"":p.title,right:function(){var e,t;return f.default.createElement(f.default.Fragment,null,!p.isContact&&f.default.createElement(c.TouchableOpacity,{onPressIn:v,onPressOut:m,style:{pointerEvents:"auto"}},f.default.createElement(s.IconButton,{size:18,icon:"drag"})),p.isContact&&f.default.createElement(s.Avatar.Text,{size:30,label:[null==(e=p.title)?void 0:e.split(" ")[0][0],null==(t=p.title)?void 0:t.split(" ")[1][0]].join(""),style:{marginLeft:-10,marginTop:8,backgroundColor:"transparent"}}),f.default.createElement(s.IconButton,{size:18,icon:"delete",onPress:D}))}})))}}.apply(t,r))||(e.exports=a)},84856:(e,t,n)=>{var r,a;r=[t,n(64687),n(10434),n(27424),n(95004),n(7602),n(39385),n(89555),n(41792),n(52254),n(47683),n(77527),n(76671),n(20555),n(51641),n(78258),n(74019),n(45039)],void 0===(a=function(e,r,a,o,l,i,u,d,c,s,f,p,m,v,y,g,h,w){"use strict";var b=n(64836);function P(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(P=function(e){return e?n:t})(e)}function x(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=P(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var l=a?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0,r=b(r),a=b(a),o=b(o),l=x(l),i=b(i),u=b(u),d=b(d),c=b(c),g=b(g),w=x(w);t.default=function(e){var t=e.mediaRes,n=e.video2,b=e.layers,P=e.writeItem,x=e.projectQuery,E=(0,m.useAppDispatch)(),I=(0,m.useAppSelector)((function(e){return e.editor.caretPosition})),F=(0,m.useAppSelector)((function(e){return e.editor.scrollPosition})),C=(0,m.useAppSelector)((function(e){return e.editor.pixelsPerSecond})),S=(0,m.useAppSelector)((function(e){return e.editor.activeLayer})),k=(0,m.useAppSelector)((function(e){return e.editor.isPlaying})),M=(0,m.useAppSelector)((function(e){return e.editor.isRendering})),O=(0,m.useAppSelector)((function(e){return e.editor.renderOutputURL})),T=(0,m.useAppSelector)((function(e){return e.editor.renderProgress})),_=(0,m.useAppSelector)((function(e){return e.editor.ffmpegLogs})),j=(0,m.useAppSelector)((function(e){return e.editor.ffmpegError})),D=null!=b&&b.length?(0,p.getTotalTime)(b):0,L=(0,l.useState)(!1),A=(0,o.default)(L,2),B=A[0],R=A[1],U=(0,d.default)().width,z=(0,l.useRef)(),W=(I+F)/C,N=12,Q=120,H=.24*U-50,V=(0,l.useState)(!1),q=(0,o.default)(V,2),K=q[0],G=q[1],J=(0,l.useState)(!1),X=(0,o.default)(J,2),Y=X[0],$=X[1],Z=Object.keys(f.FFMpegOutputType),ee=(0,p.genRenderCmd)(t,b,!0).execCmd.join("\n"),te=function(){G(!1),$(!1)},ne=(0,y.useMutation)((function(e){return P(e)}),{onSuccess:function(){console.info("after writing project"),x.refetch()}}),re=(0,l.useCallback)((function(e){var t,r,a;if("ArrowLeft"===e.code){var o,l;if(null==(o=n.current)||!o.paused)null==(l=n.current)||l.pause();console.info("arrowLeft, caretPosition, scrollPosition",I,F),E(I>0?(0,v.setCaretPosition)(I-5):(0,v.setScrollPosition)(F-5))}if("ArrowRight"===e.code){var i,u;if(null==(i=n.current)||!i.paused)null==(u=n.current)||u.pause();console.info("arrowRight, caretPosition, scrollPosition",I,F),E((0,v.setCaretPosition)(I+5))}"Space"===e.code&&(null!=(t=n.current)&&t.paused?null==(r=n.current)||r.play():null==(a=n.current)||a.pause())}),[I,F]);(0,l.useEffect)((function(){document.onkeyup=function(e){return re(e)}}),[re]);var ae=function(e,n){var r=t,a=!["start","end"].includes(e);["width","height","start","end","framerate"].includes(e)&&isNaN(n)?console.info("invalid type"):(r.editor||(r.editor={}),r.editor[e]=n,a&&(r.editor.lastUpdated=(new Date).valueOf()),ne.mutateAsync(r),te())};return l.default.createElement(l.default.Fragment,null,l.default.createElement(s.List.Item,{left:function(e){return l.default.createElement(s.List.Icon,(0,a.default)({},e,{style:{fontSize:N},icon:"clock"}))},title:(0,p.genExecTime)(W),right:function(e){return l.default.createElement(s.IconButton,(0,a.default)({},e,{style:{fontSize:N},icon:k?"pause":"play",onPress:function(){var e;!0===(null==n||null==(e=n.current)?void 0:e.paused)?(E((0,v.setActiveLayer)({activeLayerId:S,caretPosition:I,scrollPosition:F})),null==n||n.current.play()):null==n||n.current.pause()}}))}}),l.default.createElement(s.Divider,{key:"div01"}),l.default.createElement(s.List.Item,{key:"start",left:function(e){return l.default.createElement(s.List.Icon,(0,a.default)({},e,{style:{fontSize:N},icon:"clock-plus"}))},titleStyle:{fontSize:N},title:"Start",right:function(e){return l.default.createElement(u.default,{style:{width:Q}},l.default.createElement(s.TextInput,{dense:!0,mode:"outlined",value:0,style:{textAlign:"right",pointerEvents:"auto"},keyboardType:"numeric",onChangeText:function(e){return ae("start",parseInt(e,10))}}))}}),l.default.createElement(s.Divider,{key:"div7"}),l.default.createElement(s.List.Item,{key:"end",left:function(e){return l.default.createElement(s.List.Icon,(0,a.default)({},e,{style:{fontSize:N},icon:"clock-minus"}))},titleStyle:{fontSize:N},title:"End",right:function(e){return l.default.createElement(u.default,{style:{width:Q}},l.default.createElement(s.TextInput,{dense:!0,mode:"outlined",value:(0,p.genExecTime)(D)||0,style:{textAlign:"right",pointerEvents:"auto"},keyboardType:"numeric",onChangeText:function(e){return ae("end",parseInt(e,10))}}))}}),l.default.createElement(s.Divider,{key:"div3"}),l.default.createElement(s.List.Item,{key:"width",left:function(e){return l.default.createElement(s.List.Icon,(0,a.default)({},e,{style:{fontSize:N},icon:"ruler"}))},title:"Width",titleStyle:{fontSize:N},right:function(e){var n;return l.default.createElement(u.default,{style:{width:Q}},l.default.createElement(s.TextInput,{dense:!0,mode:"outlined",value:null==t||null==(n=t.editor)?void 0:n.width,style:{textAlign:"right",pointerEvents:"auto"},keyboardType:"numeric",onChangeText:function(e){return ae("width",parseInt(e,10))}}))}}),l.default.createElement(s.Divider,{key:"div2"}),l.default.createElement(s.List.Item,{key:"height",left:function(e){return l.default.createElement(s.List.Icon,(0,a.default)({},e,{style:{fontSize:N},icon:"ruler"}))},title:"Height",titleStyle:{fontSize:N},right:function(e){var n;return l.default.createElement(u.default,{style:{width:Q}},l.default.createElement(s.TextInput,{dense:!0,mode:"outlined",value:null==t||null==(n=t.editor)?void 0:n.height,style:{textAlign:"right",pointerEvents:"auto"},keyboardType:"numeric",onChangeText:function(e){return ae("height",parseInt(e,10))}}))}}),l.default.createElement(s.Divider,{key:"divaspect"}),l.default.createElement(s.List.Item,{key:"aspect",left:function(e){return l.default.createElement(s.List.Icon,(0,a.default)({},e,{style:{fontSize:N},icon:"aspect-ratio"}))},titleStyle:{fontSize:N},title:"Aspect Ratio",right:function(e){var n;return l.default.createElement(u.default,{style:{width:Q}},l.default.createElement(s.TextInput,{dense:!0,mode:"outlined",value:(null==t||null==(n=t.editor)?void 0:n.aspectRatio)||"16/9",style:{textAlign:"right",pointerEvents:"auto"},keyboardType:"default",onChangeText:function(e){return ae("aspectRatio",e)}}))}}),l.default.createElement(s.Divider,{key:"divrate"}),l.default.createElement(s.List.Item,{key:"frames",left:function(e){return l.default.createElement(s.List.Icon,(0,a.default)({},e,{style:{fontSize:N},icon:"movie-roll"}))},titleStyle:{fontSize:N},title:"Frame Rate",right:function(e){var n;return l.default.createElement(u.default,{style:{width:Q}},l.default.createElement(s.TextInput,{dense:!0,mode:"outlined",value:(null==t||null==(n=t.editor)?void 0:n.framerate)||30,style:{textAlign:"right",pointerEvents:"auto"},keyboardType:"numeric",onChangeText:function(e){return ae("framerate",parseInt(e,10))}}))}}),l.default.createElement(s.Divider,{key:"div1"}),l.default.createElement(s.List.Item,{key:"output",left:function(e){return l.default.createElement(s.List.Icon,(0,a.default)({},e,{style:{fontSize:N},icon:"file-export"}))},title:"Output",titleStyle:{fontSize:N},right:function(e){var n;return l.default.createElement(u.default,{style:{width:Q}},l.default.createElement(s.Menu,{visible:K,onDismiss:te,anchor:l.default.createElement(s.Button,{mode:"outlined",onPress:function(){return G(!0)}},null==t||null==(n=t.editor)?void 0:n.output)},l.default.createElement(l.default.Fragment,null,Z.map((function(e){return l.default.createElement(s.Menu.Item,{key:e,onPress:function(){return ae("output",e)},title:e})})))))}}),l.default.createElement(s.Divider,{key:"divPreset"}),l.default.createElement(s.List.Item,{key:"preset",left:function(e){return l.default.createElement(s.List.Icon,(0,a.default)({},e,{style:{fontSize:N},icon:"file-export"}))},title:"Preset",titleStyle:{fontSize:N},right:function(e){var n;return l.default.createElement(u.default,{style:{width:Q}},l.default.createElement(s.Menu,{visible:Y,onDismiss:te,anchor:l.default.createElement(s.Button,{mode:"outlined",onPress:function(){return $(!0)}},null==t||null==(n=t.editor)?void 0:n.preset)},l.default.createElement(l.default.Fragment,null,Object.keys(f.FFMpegPreset).map((function(e){return l.default.createElement(s.Menu.Item,{key:e,onPress:function(){return ae("preset",e)},title:e})})))))}}),!0===B?l.default.createElement(u.default,null,l.default.createElement(s.Divider,{key:"divinputcode"}),l.default.createElement(s.List.Item,{key:"code",left:function(e){return l.default.createElement(s.List.Icon,(0,a.default)({},e,{icon:"code-brackets"}))},title:"",titleStyle:{fontSize:N},onPress:function(){var e;return null==z||null==(e=z.current)?void 0:e.focus()},right:function(e){var n,r;return l.default.createElement(i.default,{style:{width:H,zIndex:10}},l.default.createElement(w.default,{className:"codeEditor",ref:z,style:{fontSize:N,inputLineHeight:N,highlighterLineHeight:N,marginLeft:0},language:"bash",syntaxStyle:w.CodeEditorSyntaxStyles.xonokai,initialValue:(null==(n=t.editor)||null==(r=n.code)?void 0:r.join(","))||"",onChange:function(e){var n,r;e!==(null==(n=t.editor)||null==(r=n.code)?void 0:r.join(","))&&ae("code",e.split(","))},autoFocus:!1,showLineNumbers:!0}))}}),l.default.createElement(s.Divider,{key:"divoutputcode"}),ee&&l.default.createElement(s.List.Item,{key:"output_code",left:function(e){return l.default.createElement(s.List.Icon,(0,a.default)({},e,{icon:"code-tags"}))},title:"",onPress:function(){return c.default.setString(ee)},titleStyle:{fontSize:N},right:function(){return l.default.createElement(u.default,{style:{width:H}},l.default.createElement(g.default,{language:"bash",style:h.xonokai,fontSize:N,pointerEvents:!0,scroll:!0,highlighter:"prism"},ee)," ")}}),l.default.createElement(s.Divider,{key:"divlogs"}),ee&&l.default.createElement(s.List.Item,{key:"output_logs",left:function(e){return l.default.createElement(s.List.Icon,(0,a.default)({},e,{icon:"code-parentheses"}))},title:"",onPress:function(){return c.default.setString(_)},titleStyle:{fontSize:N},right:function(){return l.default.createElement(u.default,{style:{width:H,pointerEvents:"auto"}},l.default.createElement(g.default,{language:"bash",style:h.xonokai,customStyle:{pointerEvents:"auto",userSelect:"all"},fontSize:N,userSelect:!0,pointerEvents:!0,scroll:!0,highlighter:"prism"},_)," ")}}),l.default.createElement(s.Divider,{key:"div8"})):null,l.default.createElement(s.Divider,{key:"divinputcode2"}),l.default.createElement(s.Button,{icon:"code-brackets",onPress:function(){return R(!B)}},"Show FFMpeg Code"),l.default.createElement(s.Divider,{key:"divinputrender"}),l.default.createElement(s.Button,{icon:"movie",style:{pointerEvents:"auto",cursor:"pointer"},onPress:function(){var e;return r.default.async((function(n){for(;;)switch(n.prev=n.next){case 0:return E((0,v.setIsRendering)(!0)),n.next=3,r.default.awrap((0,p.encodeProject)(t,b,!1,(function(e){return E((0,v.setRenderProgress)(e))}),(function(e){return E((0,v.addNewLogLine)(e))})));case 3:e=n.sent,E((0,v.setRenderUrl)(e)),E((0,v.setIsRendering)(!1));case 6:case"end":return n.stop()}}),null,null,null,Promise)},loading:M,disabled:M,mode:"outlined"},M?"Rendering project: "+parseInt((100*T).toString(),10)+"%":j?"Render Project (Error! check logs)":"Render Project"),l.default.createElement(s.Divider,{key:"divinputdownload"}),O&&l.default.createElement("a",{href:O,download:!0,style:{width:"100%"}},l.default.createElement(s.Button,{icon:"film",style:{pointerEvents:"auto",cursor:"pointer",width:"100%"},mode:"outlined"},"Download video")))}}.apply(t,r))||(e.exports=a)},37559:(e,t,n)=>{var r,a;r=[t,n(64687),n(38416),n(10434),n(95004),n(39385),n(89555),n(7484),n(13896),n(47683),n(84862),n(52254),n(72304),n(16976),n(76671),n(20555),n(25707),n(51641),n(58660),n(55894),n(76597),n(66352)],void 0===(a=function(e,r,a,o,l,i,u,d,c,s,f,p,m,v,y,g,h,w,b,P,x,E){"use strict";var I=n(64836);function F(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(F=function(e){return e?n:t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0,r=I(r),a=I(a),o=I(o),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=F(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var l=a?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(l),i=I(i),u=I(u),d=I(d),m=I(m),h=I(h),x=I(x),E=I(E);var C=s.FolderType.editor;function S(e){var t=(0,c.useFolder)(e.folderId,e.getFolderContent,(function(t){return e.getById(t,e.parentFolderId)}),s.FolderType.editor,e.writeItem),n=t.folder,u=null==n?void 0:n.editor,d=(0,y.useAppSelector)((function(e){return e.editor.showComments})),f=function(n){return r.default.async((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,r.default.awrap(e.writeItem((0,o.default)({},t.folder,{editor:(0,o.default)({},u||{},(0,a.default)({},n,!u||!0!==u[n]))})));case 2:t.folderData.refetch();case 3:case"end":return l.stop()}}),null,null,null,Promise)},m=function(e){return f("muted")},g=function(e){return f("videoDisabled")},h=void 0!==(null==n?void 0:n.id)&&(null==u?void 0:u.isCommentLayer);return h&&!d?l.default.createElement(l.default.Fragment,null):l.default.createElement(i.default,{style:{display:"flex",flexDirection:"row",height:68}},l.default.createElement(i.default,{style:{width:"100%"}},l.default.createElement(p.Divider,null),l.default.createElement(p.List.Item,{title:function(){var n;return l.default.createElement(v.TouchableOpacity,{onPressIn:e.onDragStart,onPressOut:e.onDragEnd,style:{pointerEvents:"auto"}},l.default.createElement(p.Text,{style:{fontSize:14}},null==(n=t.folder)?void 0:n.title))},right:function(n){return h?l.default.createElement(p.IconButton,(0,o.default)({size:14},n,{mode:"outlined",icon:"forum"})):l.default.createElement(l.default.Fragment,null,l.default.createElement(p.IconButton,(0,o.default)({},n,{size:14,icon:null!=u&&u.muted?"volume-off":"volume-high",mode:"outlined",onPress:m})),l.default.createElement(p.IconButton,(0,o.default)({size:14},n,{mode:"outlined",icon:null!=u&&u.videoDisabled?"video-off":"video",onPress:g})),l.default.createElement(p.IconButton,(0,o.default)({size:14},n,{icon:"delete",onPress:function(){return r.default.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.default.awrap(t.onRemoveFolder({id:e.folderId}));case 2:e.parentHook.folderContentQuery.refetch();case 3:case"end":return n.stop()}}),null,null,null,Promise)},mode:"outlined"})))}})))}function k(e){var t=(0,y.useAppDispatch)(),n=(0,c.useFolder)(e.folderId,e.getFolderContent,(function(t){return e.getById(t,e.parentFolderId)}),s.FolderType.editor,e.writeItem),a=n.folder,u=null==a?void 0:a.editor,d=(0,y.useAppSelector)((function(e){return e.editor.showComments})),f=void 0!==(null==a?void 0:a.id)&&(null==u?void 0:u.isCommentLayer);if(f&&!d)return l.default.createElement(l.default.Fragment,null);var v=function(){var a,o,l,i,u;return r.default.async((function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,r.default.awrap(b.DocumentPicker.pickSingle({presentationStyle:"fullScreen"}));case 2:if(o=d.sent,console.info("pickerResult",o,n.folder),o){d.next=6;break}return d.abrupt("return");case 6:l=o.uri,i=e.folderId,u={id:h.default.v4().toString(),url:l,title:o.name,originalId:o.name,filename:o.name,fileType:o.type,folderId:i,userId:e.userId,date:(new Date).valueOf(),isMediaNew:!1,isEncoderProject:!0,type:o.file.type,size:o.file.size,extractor:null!=(a=n.folder)&&a.mnemonic?"wt":"local"},t((0,P.startOnboarding)({file:o.file,media:u}));case 10:case"end":return d.stop()}}),null,null,null,Promise)},g=n.folderContent;return l.default.createElement(i.default,{style:{display:"flex",flexDirection:"row"}},l.default.createElement(i.default,{style:{width:"80%",display:"flex",flexDirection:"row"}},!f&&l.default.createElement(l.default.Fragment,null,l.default.createElement(m.default,{horizontal:!0,renderItem:function(t){var r=t.item,a=t.onDragEnd,o=t.onDragStart,i=t.index;return l.default.createElement(E.default,{onDragEnd:a,onDragStart:o,item:r,index:i,layerIndex:e.layerIndex,writeItem:e.writeItem,parentDataHook:n})},keyExtractor:function(e){return e.id||e.date.toString()},data:g,onReordered:n.onReordered,style:{width:"100%"},showsHorizontalScrollIndicator:!1,showsVerticalScrollIndicator:!1}),l.default.createElement(p.List.Item,{title:"Add Content",titleStyle:{fontSize:14},style:{pointerEvents:"auto"},onPress:function(){return v()},right:function(e){return l.default.createElement(l.default.Fragment,null,l.default.createElement(p.IconButton,(0,o.default)({},e,{icon:"plus",onPress:function(){return v()},mode:"outlined"})))}})),f&&l.default.createElement(l.default.Fragment,null,null==g?void 0:g.map((function(t,r){return l.default.createElement(E.default,{item:t,index:r,layerIndex:e.layerIndex,writeItem:e.writeItem,parentDataHook:n})})),l.default.createElement(p.List.Item,{title:"",titleStyle:{fontSize:14},style:{pointerEvents:"auto",height:68}}))))}t.default=function(e){var t=(0,u.default)().width,n=(0,f.useRoute)(),a=e.userId,b=e.writeItem,P=(0,y.useAppSelector)((function(e){return e.editor.scrollPosition})),E=(0,y.useAppSelector)((function(e){return e.editor.scrollParams})),I=n.params,F=I.projectId,M=I.parentFolderId,O=(0,l.useCallback)((function(t){return e.getById(t,M)}),[M]),T=(0,y.useAppDispatch)(),_=(0,c.useFolder)(F,e.getFolderContent,O,s.FolderType.editor,e.writeItem),j=(0,w.useMutation)((function(e){return b(e)})),D=(0,l.useRef)();return l.default.createElement(v.ScrollView,{style:{width:t,height:"100%",position:"absolute"},showsHorizontalScrollIndicator:!1,showsVerticalScrollIndicator:!1},l.default.createElement(i.default,{style:{display:"flex",flexDirection:"column"}},l.default.createElement(i.default,{style:{width:"100%",flexDirection:"row"}},l.default.createElement(i.default,{style:{width:"20%"}},l.default.createElement(m.default,{renderItem:function(t){var n=t.item,r=t.onDragEnd,a=t.onDragStart,i=t.index;return l.default.createElement(S,(0,o.default)({},e,{key:n.id,onDragEnd:r,onDragStart:a,folderId:n.id,layerIndex:i,parentHook:_,parentFolderId:M}))},keyExtractor:function(e){return e.id||e.date.toString()},data:_.folderContent,onReordered:function(e,t){return r.default.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.default.awrap(_.onReordered(e,t));case 2:case"end":return n.stop()}}),null,null,null,Promise)},showsHorizontalScrollIndicator:!1,showsVerticalScrollIndicator:!1})),l.default.createElement(v.ScrollView,{horizontal:!0,style:{width:"80%",display:"flex",flexDirection:"row",height:"100%"},onScroll:function(e){T((0,g.setScrollPosition)(e.nativeEvent.contentOffset.x))},ref:function(e){var t,n,r;D.current=e;var a=null==D||null==(t=D.current)?void 0:t.clientWidth,o=null==(n=D.current)?void 0:n.scrollWidth;E.totalScroll===o&&E.totalWidth===a||T((0,g.setScrollParams)({totalWidth:a,totalScroll:o})),null==D||null==(r=D.current)||r.scrollTo({x:P})},scrollEventThrottle:50,showsHorizontalScrollIndicator:!1,showsVerticalScrollIndicator:!1},l.default.createElement(d.default,{renderItem:function(t){var n=t.item,r=t.index;return l.default.createElement(k,(0,o.default)({},e,{key:n.id,folderId:n.id,layerIndex:r,parentFolderId:M}))},keyExtractor:function(e){return e.id||e.date.toString()},getItem:_.getContentItem,getItemCount:_.getContentCount,data:_.folderContent,showsHorizontalScrollIndicator:!1,showsVerticalScrollIndicator:!1}))),l.default.createElement(i.default,{style:{width:"20%"}},l.default.createElement(p.Divider,null),l.default.createElement(p.List.Item,{title:"Add Layer",titleStyle:{fontSize:14},onPress:function(){return function(){var e,t;return r.default.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t={id:h.default.v4().toString(),title:"Layer"+parseInt(_.folderContent.length+1),folderId:F,userId:a,isEditorLayer:!0,orderId:_.folderContent.length+1,folderType:C,isFolder:!1,date:(new Date).valueOf(),mnemonic:null==(e=_.folder)?void 0:e.mnemonic},n.next=3,r.default.awrap(j.mutateAsync(t));case 3:_.folderContentQuery.refetch();case 4:case"end":return n.stop()}}),null,null,null,Promise)}()},right:function(e){return l.default.createElement(l.default.Fragment,null,l.default.createElement(p.IconButton,(0,o.default)({},e,{icon:"plus",mode:"outlined"})))}})),l.default.createElement(i.default,{style:{width:"80%",position:"absolute",height:0,left:"20%"}},l.default.createElement(x.default,null))))}}.apply(t,r))||(e.exports=a)},51979:(e,t,n)=>{var r,a;r=[t,n(64687),n(10434),n(27424),n(95004),n(52254),n(76671),n(20555),n(58660),n(51641),n(25707)],void 0===(a=function(e,r,a,o,l,i,u,d,c,s,f){"use strict";var p=n(64836);function m(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(m=function(e){return e?n:t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),t.default=function(e){var t=e.projectId,n=e.writeItem,p=e.routeParams,m=e.getById,v=p.encoder,y=(0,u.useAppDispatch)(),g=(0,s.useQueryClient)(),h=(0,u.useAppSelector)((function(e){return e.editor.caretPosition})),w=(0,u.useAppSelector)((function(e){return e.editor.scrollPosition})),b=(0,u.useAppSelector)((function(e){return e.editor.pixelsPerSecond})),P=(0,u.useAppSelector)((function(e){return e.editor.showComments})),x=(0,u.useAppSelector)((function(e){return e.editor.showEditor})),E=(h+w)/b,I=(0,l.useState)(!1),F=(0,o.default)(I,2),C=F[0],S=F[1],k=(0,s.useQuery)(["projectLayersToolbar",t],(function(){var e,n;return r.default.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,r.default.awrap((0,c.getFolderContent)(t));case 2:return e=o.sent,o.next=5,r.default.awrap(Promise.all(e.map((function(e){return r.default.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=a.default,t.t1={},t.t2=e,t.next=5,r.default.awrap((0,c.getFolderContent)(null==e?void 0:e.id));case 5:return t.t3=t.sent,t.t4={media:t.t3},t.abrupt("return",(0,t.t0)(t.t1,t.t2,t.t4));case 8:case"end":return t.stop()}}),null,null,null,Promise)}))));case 5:return n=o.sent,o.abrupt("return",n);case 7:case"end":return o.stop()}}),null,null,null,Promise)})),M=k.data,O=function(){var e,n,a;return r.default.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,r.default.awrap(k.refetch());case 2:return o.next=4,r.default.awrap(g.refetchQueries(["folderData_"+t]));case 4:return o.next=6,r.default.awrap(g.refetchQueries(["folderContent_"+t]));case 6:return o.next=8,r.default.awrap(g.refetchQueries(["project_"+t]));case 8:return o.next=10,r.default.awrap(g.refetchQueries(["projectLayers",t]));case 10:return o.next=12,r.default.awrap(g.refetchQueries(["encodedMedia",t]));case 12:return o.next=14,r.default.awrap(g.refetchQueries(["folderContent_"+t+"_comments"]));case 14:if(e=null==M?void 0:M.map((function(e){return e.id})),console.info("project.folders",e),null!=e&&e.length)for(n=0;n<e.length;n++)a=e[n],g.refetchQueries(["folderContent_"+a]);case 17:case"end":return o.stop()}}),null,null,null,Promise)},T=function(e){var t="+"===e?1.25*b:.75*b;t<.5&&(t=.5),y((0,d.setPixelsPerSecond)(t))};return l.default.createElement(l.default.Fragment,null,l.default.createElement(i.Appbar.Action,{icon:"refresh",disabled:C,onPress:function(){return r.default.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!C){e.next=3;break}return e.abrupt("return");case 3:if(S(!0),!dbConns[t]){e.next=7;break}return e.next=7,r.default.awrap(dbConns[t].sync());case 7:return e.next=9,r.default.awrap(O());case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("onClickRefresh",e.t0);case 14:S(!1);case 15:case"end":return e.stop()}}),null,null,[[0,11]],Promise)}}),P?l.default.createElement(i.Appbar.Action,{icon:"comment-plus",onPress:function(){return function(){var e,n,a,o,l;return r.default.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,r.default.awrap((0,c.getUserData)());case 2:return n=i.sent,a=f.default.v4().toString(),o=null==(e=M[0])?void 0:e.mnemonic,l={id:a,partyId:a,userId:n.id,title:n.name,currentPosition:E,isContact:!0,isParty:!0,authorName:n.name,name:n.name,mnemonic:o,folderId:t+"_comments",isFolder:!0,duration:10,encoding:{start:0,end:10}},i.next=8,r.default.awrap((0,c.createNewParty)(l));case 8:return i.next=10,r.default.awrap(O());case 10:return console.info(o),i.next=13,r.default.awrap((0,c.sendChatMessage)(l.id,n.name+" has created comment",o,{system:!0}));case 13:case"end":return i.stop()}}),null,null,null,Promise)}()}}):null,l.default.createElement(i.Appbar.Action,{icon:P?"comment-eye":"comment-eye-outline",onPress:function(){return y((0,d.setShowComments)(!P))}}),l.default.createElement(i.Appbar.Action,{icon:"magnify-plus-outline",onPress:function(){return T("+")}}),l.default.createElement(i.Appbar.Action,{icon:"magnify-minus-outline",onPress:function(){return T("-")}}),x&&l.default.createElement(i.Appbar.Action,{disabled:C,icon:"content-cut",onPress:function(){return function(){var e,o,l,i;return r.default.async((function(u){for(;;)switch(u.prev=u.next){case 0:if(!C){u.next=2;break}return u.abrupt("return");case 2:return S(!0),u.prev=3,e=(0,c.getActiveProjectLayer)(M,E),u.next=7,r.default.awrap(m(v,t));case 7:return o=u.sent,l=E-e.offset+(o.encoding.start||0),console.info("click cut",{encoder:v,currentPosition:E,currentData:e,offsetPosition:l}),(i=JSON.parse(JSON.stringify((0,a.default)({},o)))).isCopy=o.isCopy||o.id,i.id=f.default.v4().toString(),i.orderId-=1,i.encoding.start=l,i.encoding.end=o.encoding.end||o.duration||0,i.createdAt=(new Date).valueOf().toString(),o.encoding.end=l,u.next=20,r.default.awrap(n(o));case 20:return u.next=22,r.default.awrap(n(i));case 22:return u.next=24,r.default.awrap(O());case 24:u.next=29;break;case 26:u.prev=26,u.t0=u.catch(3),console.error("oncClickCut",u.t0);case 29:S(!1);case 30:case"end":return u.stop()}}),null,null,[[3,26]],Promise)}()}}),x&&l.default.createElement(i.Appbar.Action,{disabled:C,icon:"content-copy",onPress:function(){return function(){var e;return r.default.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!C){a.next=2;break}return a.abrupt("return");case 2:return S(!0),a.prev=3,a.next=6,r.default.awrap(m(v,t));case 6:return(e=a.sent).isCopy=e.isCopy||e.id,e.id=f.default.v4().toString(),e.orderId+=1,e.createdAt=(new Date).valueOf().toString(),console.info("click copy",{encoder:v,currentPosition:E,item:e}),a.next=14,r.default.awrap(n(e));case 14:return a.next=16,r.default.awrap(g.refetchQueries(["projectLayers",t]));case 16:return a.next=18,r.default.awrap(g.refetchQueries(["folderContent_"+e.folderId]));case 18:return a.next=20,r.default.awrap(O());case 20:a.next=25;break;case 22:a.prev=22,a.t0=a.catch(3),console.error("oncClickCopy",a.t0);case 25:S(!1);case 26:case"end":return a.stop()}}),null,null,[[3,22]],Promise)}()}}))},r=p(r),a=p(a),o=p(o),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=m(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var l=a?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(l),f=p(f)}.apply(t,r))||(e.exports=a)},4061:(e,t,n)=>{var r,a;r=[t,n(64687),n(95004),n(2145),n(52254),n(51641),n(77527),n(76671),n(84862),n(20555)],void 0===(a=function(e,r,a,o,l,i,u,d,c,s){"use strict";var f=n(64836);function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(p=function(e){return e?n:t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0,r=f(r),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=p(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var l=a?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(a);var m=(o=f(o)).default.create({video:{width:"100%",height:"100%",position:"absolute",top:0,bottom:0,left:0,right:0},chip:{fontSize:18}});t.default=function(e){var t,n,o,f,p=e.video2,v=e.mediaRes,y=e.layers,g=e.projectId,h=(0,d.useAppDispatch)(),w=(0,d.useAppSelector)((function(e){return e.editor.encoderProgress})),b=(0,d.useAppSelector)((function(e){return e.editor.pixelsPerSecond})),P=(0,d.useAppSelector)((function(e){return e.editor.videoCaretPosition})),x=(0,d.useAppSelector)((function(e){return e.editor.videoScrollPosition})),E=(0,d.useAppSelector)((function(e){return e.editor.isPlaying})),I=(0,d.useAppSelector)((function(e){return e.editor.canScroll})),F=(0,d.useAppSelector)((function(e){return e.editor.scroll})),C=(0,d.useAppSelector)((function(e){return e.editor.activeLayer})),S=(0,c.useIsFocused)(),k=(P+x)/b||0,M=(0,i.useQuery)(["encodedMedia",g,k,C],(function(){return r.default.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.default.awrap((0,u.getProjectMedia)(y,k,(function(e){return h((0,s.setEncoderProgress)(e))})));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),null,null,null,Promise)}),{enabled:void 0!==(null==v?void 0:v.id)&&void 0!==y&&S,keepPreviousData:!1,onSuccess:function(){var e;console.info("after query"),p.current&&(p.current.currentTime=(null==(e=M.data)?void 0:e.currentPosition)||0)}}),O=(null==(t=M.data)?void 0:t.currentPosition)||0,T=(null==(n=M.data)?void 0:n.offset)||0,_=(0,a.useCallback)((function(e){var t,n,r,a,o,l=e.nativeEvent.target,i=l.currentTime,d=l.paused,c=(T||0)+i-((null==(t=M.data)?void 0:t.activeMedia.encoding.start)||0);c>=(null==(n=M.data)?void 0:n.totalTime)&&(null==(r=p.current)||r.pause());var f=c*b,m=null==(a=(0,u.getActiveProjectLayer)(y,c))||null==(o=a.activeMedia)?void 0:o.id,v=m&&m!==C,g=0,w=P;if(!d){if(I){var x=f-F;if(x>0)g=f-x,w=x;else g=f-P}else w=f;h((0,s.setIsPlaying)(!0)),h((0,s.setCaretPosition)(w)),h((0,s.setScrollPosition)(g))}d&&E&&h((0,s.setIsPlaying)(!1)),v&&h((0,s.setActiveLayer)({activeLayerId:m,scrollPosition:g,caretPosition:w}))}),[M,I,E,y,T]);return a.default.createElement(a.default.Fragment,null,M.isFetching&&!E?a.default.createElement(l.ProgressBar,{style:{height:"100%",position:"absolute",top:0},progress:w}):a.default.createElement(a.default.Fragment,null,a.default.createElement("video",{controls:!1,style:m.video,src:null==(o=M.data)?void 0:o.url,muted:null==(f=M.data)?void 0:f.muted,ref:function(e){e&&(e.currentTime=O,p.current=e,E&&e.play())},onPlaying:function(e){h((0,s.setIsPlaying)(!0))},onPause:function(e){h((0,s.setIsPlaying)(!1))},onEnded:function(e){console.info("ended",e)},onTimeUpdate:_})))}}.apply(t,r))||(e.exports=a)},70997:(e,t,n)=>{var r,a;r=[t,n(10434),n(95004),n(17342),n(33466),n(47683),n(91724),n(30463),n(44187),n(84862)],void 0===(a=function(e,r,a,o,l,i,u,d,c,s){"use strict";var f=n(64836);function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(p=function(e){return e?n:t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),t.createEncoder=void 0,r=f(r),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=p(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var l=a?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(a),l=f(l),u=f(u),c=f(c);var m=(0,o.createStackNavigator)(),v=i.FolderType.encoder;t.createEncoder=function(e){var t=(0,a.memo)((function(t){return a.default.createElement(l.default,{folderId:t.route.params.folderId,navigation:t.navigation,route:t.route,getFolderContent:e.getFolderContent,getById:e.getById,enqMedia:e.enqMedia,stopMedia:e.stopMedia,getFoldersByType:e.getFoldersByType,setWindowClosedCallback:e.setWindowClosedCallback,folderType:v,writeItem:e.writeItem})})),n=(0,a.memo)((function(t){return a.default.createElement(u.default,(0,r.default)({},t,e,{dataHook:(0,d.useFolders)(v,e.getFoldersByType,e.getFolderContent,e.writeItem)}))})),o=(0,a.memo)((function(t){return a.default.createElement(c.default,(0,r.default)({},t,{writeItem:e.writeItem,routeParams:(0,s.useRoute)().params}))}));return function(){return a.default.createElement(m.Navigator,{screenOptions:{headerShown:!1,freezeOnBlur:!0}},a.default.createElement(m.Screen,{name:"EncoderProjects",component:n,options:{}}),a.default.createElement(m.Screen,{name:"EncoderProject",component:o}),a.default.createElement(m.Screen,{name:"Folder",component:t}))}}}.apply(t,r))||(e.exports=a)},25649:(e,t,n)=>{var r,a;r=[t,n(10434),n(64687),n(95004),n(46434),n(2145),n(39385),n(52254),n(51641),n(47683),n(58660),n(76671),n(84862),n(9280),n(63663)],void 0===(a=function(e,r,a,o,l,i,u,d,c,s,f,p,m,v,y){"use strict";var g=n(64836);function h(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(h=function(e){return e?n:t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),t.default=function(e){var t,n,i=e.getById,g=e.projectId,h=e.writeItem,b=e.height,P=e.folderId,x=(0,p.useAppDispatch)(),E=(0,p.useAppSelector)((function(e){return e.encoder})),I=(0,d.useTheme)(),F=(0,c.useQueryClient)(),C=(0,c.useQuery)(["projectdata",g],(function(){return a.default.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.default.awrap(i(g,P));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),null,null,null,Promise)}),{enabled:!!g}),S=(0,m.useIsFocused)(),k=C.data,M=(0,c.useQuery)(["localMedia",g],(function(){var e;return a.default.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=k&&k.id){t.next=2;break}return t.abrupt("return",void 0);case 2:return t.prev=2,t.next=5,a.default.awrap((0,f.getFileOpfs)(k));case 5:e=t.sent,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(2),console.error(t.t0);case 11:if("wt"!==k.extractor||e){t.next=15;break}return t.next=14,a.default.awrap((0,f.getVideoWT)(k));case 14:e=t.sent;case 15:return t.abrupt("return",e);case 16:case"end":return t.stop()}}),null,null,[[2,8]],Promise)}),{enabled:!(!C.isFetched||!S||void 0===(null==k?void 0:k.id))}),O=(0,c.useQuery)(["encodedMedia",g],(function(){return a.default.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,f.encodeMedia)(k,(function(e){return x((0,y.setEncoderProgress)(e))})));case 1:case"end":return e.stop()}}),null,null,null,Promise)}),{enabled:!(!C.isFetched||!S||void 0===(null==k?void 0:k.id))}),T=(0,c.useQuery)(["encodedFileSize",g],(function(){var e,t;return a.default.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(O.data){n.next=2;break}return n.abrupt("return","0");case 2:return n.next=4,a.default.awrap(fetch(O.data,{cache:"no-cache"}));case 4:return t=n.sent,n.abrupt("return",null==(e=t.headers.get("Content-Length"))?void 0:e.toString());case 6:case"end":return n.stop()}}),null,null,null,Promise)}),{enabled:!!(!C.isFetching&&S&&O.data&&O.data.search("blob")>-1),retry:!1}),_=(0,c.useMutation)((function(e){var t;return a.default.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,a.default.awrap(h(e));case 2:return t=n.sent,n.next=5,a.default.awrap(F.cancelQueries({queryKey:["encodedMedia"]}));case 5:return n.next=7,a.default.awrap(Promise.all([C.refetch(),O.refetch(),F.refetchQueries("project_"+g)]));case 7:return n.abrupt("return",t);case 8:case"end":return n.stop()}}),null,null,null,Promise)})),j=C.isFetching||M.isFetching;console.info("encodedFileSize",T.data);var D=M.data,L=(0,o.useRef)(),A=(0,o.useRef)();if(!k)return o.default.createElement(d.ActivityIndicator,{size:72});return o.default.createElement(o.default.Fragment,null,o.default.createElement(d.Divider,null),o.default.createElement(d.Banner,{visible:!!g,theme:I,style:{backgroundColor:"black",padding:0,margin:0},contentStyle:{width:"100%",height:"100%",maxWidth:"auto",padding:0,margin:0}},o.default.createElement(u.default,{style:{width:"50%",height:b/2,borderRightWidth:1,borderRightColor:"rgb(73, 69, 79)"}},o.default.createElement(d.Text,{style:{textAlign:"left",zIndex:10}},o.default.createElement(d.Chip,{textStyle:w.chip},"Before: ",(null==k?void 0:k.size)&&(0,v.niceBytes)(k.size))),j?o.default.createElement(d.ActivityIndicator,{size:72}):null,g&&!j&&S?o.default.createElement("video",{controls:!0,style:w.video,onPlaying:function(e){var t=e.nativeEvent.target.currentTime;window.video1=e.nativeEvent.target,L.current&&(L.current.currentTime=t),L.current&&L.current.paused&&L.current.play()},onPause:function(e){var t=e.nativeEvent.target.currentTime;L.current&&(L.current.currentTime=t),L.current&&!L.current.paused&&L.current.pause()},onEnded:function(e){console.info("ended",e)},onTimeUpdate:function(e){var t=e.nativeEvent.target,n=t.currentTime,r=t.paused;L.current&&r&&(L.current.currentTime=n)},onLoadedMetadata:function(e){var t=e.nativeEvent.target;if(!k.width||!k.height){var n=t.videoWidth,a=t.videoHeight;_.mutateAsync((0,r.default)({},k,{width:n,height:a,encoding:{width:n,height:a,output:s.FFMpegOutputType.mp4,compressionLevel:20,preset:s.FFMpegPreset.veryfast}}))}},ref:A,src:D}):null),o.default.createElement(u.default,{style:{width:"50%",height:b/2,borderLeftWidth:1,borderLeftColor:"rgb(73, 69, 79)"}},O.isFetching?o.default.createElement(o.default.Fragment,null,o.default.createElement(d.Text,{style:{textAlign:"right",zIndex:10}}," "),o.default.createElement(d.ProgressBar,{style:{height:"100%",position:"absolute",top:-25},progress:E.encoderProgress}),o.default.createElement(u.default,{style:{position:"absolute",top:"40%",display:"flex",textAlign:"center",width:"100%"}},o.default.createElement(d.Text,{style:{textAlign:"center",color:"coral"}},"Loading ",parseFloat(Math.abs(100*E.encoderProgress)).toFixed(2),"%"))):o.default.createElement(d.Text,{style:{textAlign:"right",zIndex:10}},o.default.createElement(d.Chip,{textStyle:w.chip},"After: ",!T.isFetching&&T.data&&(0,v.niceBytes)(T.data)),o.default.createElement("a",{href:O.data,download:!0},o.default.createElement(d.Chip,{textStyle:w.chip,onPress:function(){}},"Download"))),g&&!O.isFetching&&S?o.default.createElement(o.default.Fragment,null,"mp4"===(null==k||null==(t=k.encoding)?void 0:t.output)&&o.default.createElement("video",{controls:!0,style:w.video,onPlaying:function(e){e.nativeEvent.target.currentTime;A.current.paused&&A.current.play()},onPause:function(e){A.current.paused||A.current.pause()},ref:L,src:O.data}),"gif"===(null==k||null==(n=k.encoding)?void 0:n.output)&&o.default.createElement(l.default,{source:{uri:O.data},resizeMode:"contain",style:w.video})):null)),o.default.createElement(d.Divider,null))},r=g(r),a=g(a),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=h(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var l=a?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(o),l=g(l),i=g(i),u=g(u);var w=i.default.create({video:{width:"100%",height:"100%",position:"absolute",top:0,bottom:0,left:0,right:0},chip:{fontSize:18}})}.apply(t,r))||(e.exports=a)},44187:(e,t,n)=>{var r,a;r=[t,n(64687),n(10434),n(27424),n(95004),n(7602),n(39385),n(89555),n(52254),n(51641),n(58660),n(84862),n(47683),n(16976),n(78258),n(74019),n(45039)],void 0===(a=function(e,r,a,o,l,i,u,d,c,s,f,p,m,v,y,g,h){"use strict";var w=n(64836);function b(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(b=function(e){return e?n:t})(e)}function P(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=b(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var l=a?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0,r=w(r),a=w(a),o=w(o),l=P(l),i=w(i),u=w(u),d=w(d),y=w(y),h=P(h);t.default=(0,l.memo)((function(e){var t=e.writeItem,n=((0,p.useRoute)(),(0,s.useQueryClient)()),w=(0,l.useState)(!1),b=(0,o.default)(w,2),P=b[0],x=b[1],E=e.routeParams,I=E.projectId,F=E.encoder,C=E.folderId,S=E.parentFolderId;F&&(I=F);var k=(0,s.useQuery)("project_"+I,(function(){return r.default.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.default.awrap((0,f.getById)(I,S||C));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),null,null,null,Promise)})),M=k.data;console.info("projectData",M);var O=(0,l.useRef)(),T=(0,l.useRef)(),_=(0,d.default)().width,j=e.codeWidth||_-200,D=(0,s.useMutation)((function(e){var a;return r.default.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,r.default.awrap(t(e));case 2:return a=o.sent,clearTimeout(O.current),O.current=setTimeout((function(){n.refetchQueries({queryKey:["folderContent_"+(null==M?void 0:M.folderId)]}),n.refetchQueries({queryKey:["projectdata",I]}),n.resetQueries({queryKey:["encodedMedia",I],exact:!0}),n.resetQueries({queryKey:["encodedFileSize",I],exact:!0}),n.resetQueries({queryKey:["encodedFileSize",I],exact:!0}),k.refetch()}),1e3),o.abrupt("return",a);case 6:case"end":return o.stop()}}),null,null,null,Promise)})),L=(0,l.useState)(!1),A=(0,o.default)(L,2),B=A[0],R=A[1],U=(0,l.useState)(!1),z=(0,o.default)(U,2),W=z[0],N=z[1],Q=Object.keys(m.FFMpegOutputType),H=function(){R(!1),N(!1)},V=function(e,t){var n=M,r=!["start","end","soundVolume"].includes(e);["width","compressionLevel","height","start","end","soundVolume"].includes(e)&&isNaN(t)?console.info("invalid type"):""!==t&&(n.encoding||(n.encoding={}),n.encoding[e]=t,console.info(n),r&&(n.encoding.lastUpdated=(new Date).valueOf()),D.mutateAsync(n),H())};if(k.isFetching)return l.default.createElement(c.ActivityIndicator,{size:72});var q=(0,f.genExecCmd)(M).join("\n"),K=12,G=120;return l.default.createElement(v.ScrollView,{showsVerticalScrollIndicator:!1,showsHorizontalScrollIndicator:!1},l.default.createElement(c.Divider,{key:"div00"}),l.default.createElement(c.List.Item,{key:"info",left:function(e){return l.default.createElement(c.List.Icon,(0,a.default)({},e,{icon:"information"}))},title:null==M?void 0:M.title}),l.default.createElement(c.Divider,{key:"div01"}),l.default.createElement(c.List.Item,{key:"start",left:function(e){return l.default.createElement(c.List.Icon,(0,a.default)({},e,{icon:"clock-plus"}))},title:"Start",titleStyle:{fontSize:K},right:function(e){var t;return l.default.createElement(u.default,{style:{width:G}},l.default.createElement(c.TextInput,{dense:!0,mode:"outlined",value:(null==M||null==(t=M.encoding)?void 0:t.start)||0,style:{textAlign:"right",pointerEvents:"auto"},keyboardType:"numeric",onChangeText:function(e){return V("start",parseFloat(e))}}))}}),l.default.createElement(c.Divider,{key:"div7"}),l.default.createElement(c.List.Item,{key:"end",left:function(e){return l.default.createElement(c.List.Icon,(0,a.default)({},e,{icon:"clock-minus"}))},title:"End ("+(null==M?void 0:M.duration)+")",titleStyle:{fontSize:K},right:function(e){var t;return l.default.createElement(u.default,{style:{width:G}},l.default.createElement(c.TextInput,{dense:!0,mode:"outlined",value:(null==M||null==(t=M.encoding)?void 0:t.end)||(null==M?void 0:M.duration),style:{textAlign:"right",pointerEvents:"auto"},keyboardType:"numeric",onChangeText:function(e){return V("end",parseFloat(e))}}))}}),l.default.createElement(c.Divider,{key:"div4"}),l.default.createElement(c.List.Item,{key:"cl",left:function(e){return l.default.createElement(c.List.Icon,(0,a.default)({},e,{icon:"zip-box"}))},title:"Compression",titleStyle:{fontSize:K},right:function(e){var t;return l.default.createElement(u.default,{style:{width:G}},l.default.createElement(c.TextInput,{dense:!0,mode:"outlined",value:null==M||null==(t=M.encoding)?void 0:t.compressionLevel,style:{textAlign:"right",pointerEvents:"auto"},keyboardType:"numeric",onChangeText:function(e){return V("compressionLevel",parseInt(e,10))}}))}}),l.default.createElement(c.Divider,{key:"divvolume"}),l.default.createElement(c.List.Item,{key:"volume",left:function(e){return l.default.createElement(c.List.Icon,(0,a.default)({},e,{icon:"zip-box"}))},title:"Sound Volume",titleStyle:{fontSize:K},right:function(e){var t;return l.default.createElement(u.default,{style:{width:G}},l.default.createElement(c.TextInput,{dense:!0,mode:"outlined",value:(null==M||null==(t=M.encoding)?void 0:t.soundVolume)||100,style:{textAlign:"right",pointerEvents:"auto"},keyboardType:"numeric",onChangeText:function(e){return V("soundVolume",parseInt(e,10))}}))}}),l.default.createElement(c.Divider,{key:"div3"}),l.default.createElement(c.List.Item,{key:"width",left:function(e){return l.default.createElement(c.List.Icon,(0,a.default)({},e,{icon:"ruler"}))},title:"Width("+(null==M?void 0:M.width)+")",titleStyle:{fontSize:K},right:function(e){var t;return l.default.createElement(u.default,{style:{width:G}},l.default.createElement(c.TextInput,{dense:!0,mode:"outlined",value:null==M||null==(t=M.encoding)?void 0:t.width,style:{textAlign:"right",pointerEvents:"auto"},keyboardType:"numeric",onChangeText:function(e){return V("width",parseInt(e,10))}}))}}),l.default.createElement(c.Divider,{key:"div2"}),l.default.createElement(c.List.Item,{key:"height",left:function(e){return l.default.createElement(c.List.Icon,(0,a.default)({},e,{icon:"ruler"}))},title:"Height("+(null==M?void 0:M.height)+")",titleStyle:{fontSize:K},right:function(e){var t;return l.default.createElement(u.default,{style:{width:G}},l.default.createElement(c.TextInput,{dense:!0,mode:"outlined",value:null==M||null==(t=M.encoding)?void 0:t.height,style:{textAlign:"right",pointerEvents:"auto"},keyboardType:"numeric",onChangeText:function(e){return V("height",parseInt(e,10))}}))}}),l.default.createElement(c.Divider,{key:"div1"}),l.default.createElement(c.List.Item,{key:"output",left:function(e){return l.default.createElement(c.List.Icon,(0,a.default)({},e,{icon:"file-export"}))},title:"Output",titleStyle:{fontSize:K},right:function(e){var t;return l.default.createElement(u.default,{style:{width:G}},l.default.createElement(c.Menu,{visible:B,onDismiss:H,anchor:l.default.createElement(c.Button,{mode:"outlined",onPress:function(){return R(!0)}},null==M||null==(t=M.encoding)?void 0:t.output)},l.default.createElement(l.default.Fragment,null,Q.map((function(e){return l.default.createElement(c.Menu.Item,{key:e,onPress:function(){return V("output",e)},title:e})})))))}}),l.default.createElement(c.Divider,{key:"div"}),l.default.createElement(c.List.Item,{key:"preset",left:function(e){return l.default.createElement(c.List.Icon,(0,a.default)({},e,{icon:"cog"}))},title:"Preset",titleStyle:{fontSize:K},right:function(e){var t;return l.default.createElement(u.default,{style:{width:G}},l.default.createElement(c.Menu,{visible:W,onDismiss:H,anchor:l.default.createElement(c.Button,{mode:"outlined",onPress:function(){return N(!0)}},null==M||null==(t=M.encoding)?void 0:t.preset)},l.default.createElement(l.default.Fragment,null,Object.keys(m.FFMpegPreset).map((function(e){return l.default.createElement(c.Menu.Item,{key:e,onPress:function(){return V("preset",e)},title:e})})))))}}),!0===P?l.default.createElement(u.default,null,l.default.createElement(c.Divider,{key:"div5"}),l.default.createElement(c.List.Item,{key:"code",left:function(e){return l.default.createElement(c.List.Icon,(0,a.default)({},e,{icon:"code-brackets"}))},title:"",titleStyle:{fontSize:K},onPress:function(){var e;return null==T||null==(e=T.current)?void 0:e.focus()},right:function(e){var t,n;return l.default.createElement(i.default,{style:{width:j,zIndex:10}},l.default.createElement(h.default,{className:"codeEditor",ref:T,style:{fontSize:K,inputLineHeight:K,highlighterLineHeight:K,display:"flex"},language:"bash",syntaxStyle:h.CodeEditorSyntaxStyles.xonokai,initialValue:(null==M||null==(t=M.encoding)||null==(n=t.code)?void 0:n.join(","))||"",onChange:function(e){var t,n;e!==(null==M||null==(t=M.encoding)||null==(n=t.code)?void 0:n.join(","))&&V("code",e.split(","))},autoFocus:!1,showLineNumbers:!0}))}}),l.default.createElement(c.Divider,{key:"div6"}),q&&l.default.createElement(c.List.Item,{key:"output_code",left:function(e){return l.default.createElement(c.List.Icon,(0,a.default)({},e,{icon:"code-tags"}))},title:"",titleStyle:{fontSize:K},right:function(){return l.default.createElement(u.default,{style:{width:j}},l.default.createElement(y.default,{language:"bash",style:g.xonokai,highlighter:"prism",fontSize:K},q)," ")}}),l.default.createElement(c.Divider,{key:"div8"})):null,l.default.createElement(c.Button,{icon:"code-brackets",onPress:function(){return x(!P)}},"Show FFMpeg Code"))}))}.apply(t,r))||(e.exports=a)},54698:(e,t,n)=>{var r,a;r=[t,n(10434),n(95004),n(17342),n(33466),n(75372),n(47683)],void 0===(a=function(e,r,a,o,l,i,u){"use strict";var d=n(64836);function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),t.createFileStack=void 0,r=d(r),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var l=a?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(a),l=d(l),i=d(i);var s=(0,o.createStackNavigator)();t.createFileStack=function(e){var t=(0,a.memo)((function(t){return a.default.createElement(l.default,{folderId:t.route.params.folderId,navigation:t.navigation,getPrevPartiesForChatId:e.getPrevPartiesForChatId,sendChatMessage:e.sendChatMessage,route:t.route,getFolderContent:e.getFolderContent,getById:e.getById,enqMedia:e.enqMedia,stopMedia:e.stopMedia,getFoldersByType:e.getFoldersByType,setWindowClosedCallback:e.setWindowClosedCallback,folderType:u.FolderType.media,writeItem:e.writeItem})})),n=(0,a.memo)((function(t){return a.default.createElement(i.default,(0,r.default)({},t,e))}));return function(){return a.default.createElement(s.Navigator,{screenOptions:{headerShown:!1,freezeOnBlur:!0,animationEnabled:!1}},a.default.createElement(s.Screen,{name:"Files",component:n,options:{freezeOnBlur:!0}}),a.default.createElement(s.Screen,{name:"Folder",component:t,options:function(e){var t;return{title:null==(t=e.route.params)?void 0:t.title,freezeOnBlur:!0}}}))}}}.apply(t,r))||(e.exports=a)},11220:(e,t,n)=>{var r,a;r=[t,n(64687),n(10434),n(27424),n(97218),n(95004),n(16976),n(52254),n(51641),n(58794),n(47683),n(76671),n(55894),n(77527),n(84862),n(9280),n(25707),n(58660)],void 0===(a=function(e,r,a,o,l,i,u,d,c,s,f,p,m,v,y,g,h,w){"use strict";var b=n(64836);function P(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(P=function(e){return e?n:t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),t.default=function(e){var t,n=e.writeItem,b=e.userId,P=e.folderType,F=e.hideMedialModal,C=e.folderId,S=e.routeName,k=e.projectId,M=e.isEncoderProject,O=(0,d.useTheme)(),T=(0,c.useQueryClient)(),_=(0,p.useAppSelector)((function(e){return e.upload})),j=(0,p.useAppDispatch)(),D=(0,y.useNavigation)(),L=_.modalVisible,A=_.file,B=_.media,R=_.uploadToCloud,U=_.shareToWT,z=(_.encryption,_.fileUploadProgress),W=_.isUploadInProgress,N=(null==B?void 0:B.id)+"-"+(null==B?void 0:B.filename),Q=localStorage.getItem("authToken"),H=(0,c.useMutation)((function(e){return n(e)})),V=(0,i.useState)({}),q=(0,o.default)(V,2),K=q[0],G=q[1],J=(0,c.useMutation)((function(){return l.default.request({url:s.domain+"api/v1/backend/files/"+N+"?authToken="+Q,method:"PUT",data:A,withCredentials:!0,onUploadProgress:function(e){return j((0,m.setFileUploadProgress)(e))}})}),{retry:function(e){if(e<4)return!0}}),X=(0,c.useMutation)((function(e){return(0,v.writeFileOpfs)((0,a.default)({},e,K),A)})),Y=H.isLoading||J.isLoading,$=U;"wt"===(null==B?void 0:B.extractor)&&($=!0);return i.default.createElement(i.default.Fragment,null,i.default.createElement(d.Banner,{theme:O,visible:W},i.default.createElement(d.Card.Title,{titleStyle:{fontSize:20},title:"Uploading file",subtitle:null==B?void 0:B.filename,left:function(e){return i.default.createElement(d.Avatar.Icon,(0,a.default)({},e,{icon:"file"}))}}),i.default.createElement(d.Divider,null),i.default.createElement(d.ProgressBar,{animatedValue:(null==z?void 0:z.progress)||0})),i.default.createElement(d.Portal,null,i.default.createElement(d.Modal,{visible:L,onDismiss:F,theme:O,style:{padding:20}},i.default.createElement(d.Card,null,i.default.createElement(d.Card.Title,{titleStyle:{fontSize:20},title:"Adding a new file",subtitle:"Please confirm",left:function(e){return i.default.createElement(d.Avatar.Icon,(0,a.default)({},e,{icon:"file"}))}}),i.default.createElement(d.Divider,null),i.default.createElement(u.ScrollView,null,i.default.createElement(d.Card.Content,null,i.default.createElement(d.List.Section,null,i.default.createElement(d.List.Item,{title:"Filename",description:null==B?void 0:B.filename}),i.default.createElement(d.List.Item,{title:"Format",description:null==B?void 0:B.type}),i.default.createElement(d.List.Item,{title:"Duration",description:null==K?void 0:K.duration}),i.default.createElement(d.List.Item,{title:"Width",description:null==K?void 0:K.width}),i.default.createElement(d.List.Item,{title:"Height",description:null==K?void 0:K.height}),i.default.createElement(d.List.Item,{title:"Size",description:(0,g.niceBytes)(null==B||null==(t=B.size)?void 0:t.toString())}),i.default.createElement(d.List.Item,{title:"FolderId",description:null==B?void 0:B.folderId}),A&&i.default.createElement("video",{style:{display:"none"},src:URL.createObjectURL(A),onLoadedMetadata:function(e){G({width:e.nativeEvent.target.videoWidth,height:e.nativeEvent.target.videoHeight,duration:e.nativeEvent.target.duration})}})))),i.default.createElement(d.Divider,null),i.default.createElement(d.Card.Actions,null,i.default.createElement(d.Button,{disabled:Y,onPress:F},"Cancel"),i.default.createElement(d.Button,{loading:Y,onPress:function(){var e,t,n,o,l,i,u,d,c,p,y,g,F;return r.default.async((function(O){for(;;)switch(O.prev=O.next){case 0:return t=JSON.parse(JSON.stringify(B)),n=K.width,o=K.height,l=K.duration-1,console.info("routeName",S,"folderType",P),t.isDownloaded=!0,O.next=7,r.default.awrap((0,w.getById)(t.folderId));case 7:if(i=O.sent){O.next=12;break}return O.next=11,r.default.awrap((0,w.getById)(t.folderId,C));case 11:i=O.sent;case 12:if(console.info("project folder",i,C,t.folderId),null!=(e=i)&&e.mnemonic&&($=!0),P!==f.FolderType.editor||"EditorProject"===S){O.next=29;break}return console.info("creating a new editor project from file"),p={id:h.default.v4().toString(),title:t.title,userId:b,isEditorProject:!0,folderType:P,folderId:C,orderId:1,isFolder:!1,editor:{length:6e4,width:n,height:o,preset:x,output:E,lastUpdated:(new Date).valueOf(),compressionLevel:I,code:[]},mnemonic:null==(u=i)?void 0:u.mnemonic,date:(new Date).valueOf()},O.next=19,r.default.awrap(H.mutateAsync(p));case 19:return y={id:h.default.v4().toString(),title:"Layer 1",folderId:p.id,userId:b,isEditorLayer:!0,orderId:1,folderType:P,isFolder:!1,date:(new Date).valueOf(),editor:{videoDisabled:!1,muted:!1},mnemonic:null==(d=i)?void 0:d.mnemonic},O.next=22,r.default.awrap(H.mutateAsync(y));case 22:return g={id:p.id+"_comments",title:"Comments",folderId:p.id,userId:b,isEditorLayer:!0,orderId:1,folderType:P,isFolder:!1,date:(new Date).valueOf(),editor:{videoDisabled:!0,muted:!0,isCommentLayer:!0},mnemonic:null==(c=i)?void 0:c.mnemonic},O.next=25,r.default.awrap(H.mutateAsync(g));case 25:t.folderId=y.id,t.isMediaNew=M,t.isEncoderProject=M,t.encoding={end:l,width:n,height:o,preset:x,output:E,compressionLevel:I};case 29:return P===f.FolderType.editor&&(t.encoding={end:l,width:n,height:o,preset:x,output:E,compressionLevel:I}),console.info("foldertype saveitem",P,t),O.next=33,r.default.awrap(X.mutateAsync(t));case 33:return O.next=35,r.default.awrap(H.mutateAsync((0,a.default)({},t,K)));case 35:if(!$){O.next=39;break}return console.info("sharing file to wt",t),O.next=39,r.default.awrap((0,v.shareFileToWT)(t.id,t.folderId));case 39:if(!R){O.next=50;break}return j((0,m.setUploadInProgress)(!0)),j((0,m.setMediaModalVisible)(!1)),O.next=44,r.default.awrap(J.mutateAsync());case 44:F=s.cdndomain+b+"/"+N,t.webpage_url=F,t.hasCloud=!0,t.extractor="cloud",t.url=F,console.info("after upload File Mutation",t);case 50:return O.next=52,r.default.awrap(T.refetchQueries({queryKey:["folderContent_"+t.folderId]}));case 52:return O.next=54,r.default.awrap(T.refetchQueries({queryKey:["folderContent_"+C]}));case 54:return O.next=56,r.default.awrap(T.refetchQueries({queryKey:["projectLayers",k]}));case 56:return O.next=58,r.default.awrap(T.refetchQueries({queryKey:["encodedMedia",k]}));case 58:j((0,m.setUploadInProgress)(!1)),j((0,m.setMediaModalVisible)(!1)),C||D.navigate("Folder",{folderId:t.folderId});case 61:case"end":return O.stop()}}),null,null,null,Promise)}},"Confirm"))))))},r=b(r),a=b(a),o=b(o),l=b(l),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=P(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var l=a?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(i),h=b(h);var x=f.FFMpegPreset.superfast,E=f.FFMpegOutputType.mp4,I=20}.apply(t,r))||(e.exports=a)},83766:(e,t,n)=>{var r,a;r=[t,n(10434),n(64687),n(95004),n(39385),n(45288),n(58794),n(52254)],void 0===(a=function(e,r,a,o,l,i,u,d){"use strict";var c=n(64836);function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0,r=c(r),a=c(a),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var l=a?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(o),l=c(l),i=c(i);t.default=function(e){var t=e.folder,n=e.width,c=e.onFolderPress,s=e.onRemoveFolder,f=e.onFolderActionPress,p=e.isSecondLevel,m=e.children,v=e.isOpen,y=e.isLoadingContent,g=e.currentFolderEditorName,h=e.folderNameInputRef,w=e.setFolderEditorName,b=e.abortEditFolder,P=e.onShareFolder,x=(0,d.useTheme)(),E=t.isOpen?"folder-open":"folder-outline",I=t.isInfoOpen?"checkbox-outline":"pencil-outline",F=!1;u.defaultFolders.includes(t.id)&&(F=!0,I="star"),t.mnemonic&&(E=t.isOpen?"folder-network":"folder-network-outline"),t.isInfoOpen&&(E="arrow-left-circle");var C={pointerEvents:"auto",padding:v?5:0};(0,o.useMemo)((function(){t.isInfoOpen&&w(t.title)}),[t.isInfoOpen]);var S=function(){return a.default.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(!s){e.next=3;break}return e.next=3,a.default.awrap(s(t));case 3:case"end":return e.stop()}}),null,null,null,Promise)},k=function(){return a.default.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(!F){e.next=2;break}return e.abrupt("return");case 2:if(!f){e.next=5;break}return e.next=5,a.default.awrap(f(t,p));case 5:setTimeout((function(){var e;null==h||null==(e=h.current)||e.focus()}),300);case 6:case"end":return e.stop()}}),null,null,null,Promise)},M=function(e){return y?o.default.createElement(d.ActivityIndicator,{style:{paddingLeft:20}}):o.default.createElement(i.default,{onPress:function(){return c(t,p)},style:{pointerEvents:"auto",paddingTop:5}},o.default.createElement(d.List.Icon,(0,r.default)({},e,{icon:E})))};return o.default.createElement(o.default.Fragment,null,o.default.createElement(d.Divider,null),m?o.default.createElement(d.List.Accordion,{expanded:v,title:t.title,style:{width:n},left:M,right:function(){return o.default.createElement(o.default.Fragment,null)},onPress:function(){return c(t,p)},theme:x},m):o.default.createElement(d.List.Item,{style:{width:n},title:function(e){var n=e.ellipsizeMode,r=e.color,a=e.fontSize;return o.default.createElement(o.default.Fragment,null,t.isInfoOpen?o.default.createElement(d.TextInput,{mode:"outlined",style:{height:50,width:"100%",pointerEvents:"auto"},placeholder:"new folder name",theme:x,value:g,ref:h,onChangeText:w,left:o.default.createElement(d.TextInput.Icon,{onPress:function(){return b()},icon:E}),right:o.default.createElement(d.TextInput.Icon,{onPress:k,icon:I}),autoFocus:!0,id:"test-input"}):o.default.createElement(i.default,{style:{pointerEvents:"auto"},onPress:function(){return c(t,p)}},o.default.createElement(l.default,{style:{}},o.default.createElement(d.Text,{ellipsizeMode:n,style:{color:r,fontSize:a},numberOfLines:2},t.title))))},left:t.isInfoOpen?function(){return o.default.createElement(o.default.Fragment,null)}:M,right:function(e){return o.default.createElement(l.default,{style:{flexDirection:"row",flexWrap:"wrap"}},!t.isInfoOpen&&o.default.createElement(i.default,{onPress:k,style:C},o.default.createElement(d.List.Icon,(0,r.default)({},e,{icon:I}))),F||t.isInfoOpen?null:o.default.createElement(o.default.Fragment,null,o.default.createElement(i.default,{onPress:S,style:C},o.default.createElement(d.List.Icon,(0,r.default)({},e,{icon:"delete"}))),o.default.createElement(i.default,{onPress:P,style:C},o.default.createElement(d.List.Icon,(0,r.default)({},e,{icon:"share"})))))},theme:x}))}}.apply(t,r))||(e.exports=a)},91724:(e,t,n)=>{var r,a;r=[t,n(10434),n(95004),n(7602),n(2145),n(39385),n(89555),n(7484),n(44104),n(83766),n(52254),n(84862)],void 0===(a=function(e,r,a,o,l,i,u,d,c,s,f,p){"use strict";var m=n(64836);function v(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(v=function(e){return e?n:t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0,r=m(r),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=v(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var l=a?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(a),o=m(o),l=m(l),i=m(i),u=m(u),d=m(d),s=m(s);t.default=function(e){var t=e.dataHook,n=(0,u.default)(),m=n.height,v=n.width>700?80:0,y=n.width-v,g=((0,a.useContext)(c.PartyCtx),(0,a.useContext)(c.UserCtx)),h=(n.width,(0,p.useNavigation)()),w=t.folders,b=t.currentFolderId,P=t.getItem,x=t.getItemCount,E=t.isEditingFolder,I=t.currentFolderEditorName,F=t.setFolderEditorName,C=t.folderNameInputRef,S=t.onFolderActionPress,k=t.loadingContent,M=t.loadingFolders,O=t.onRemoveFolder,T=t.folderContentQuery,_=t.abortEditFolder,j=w.findIndex((function(e){return e.id===b}))||0,D=(T.isFetching,l.default.create({container:{flex:1,paddingTop:0,marginTop:0},item:{paddingLeft:5,fontSize:12,height:120,color:"black",width:"100%"},tinyLogo:{marginTop:2,width:22,height:22},scroll:{height:m-55,display:"flex",position:"relative",backgroundColor:"black",marginTop:0,width:"100%"},icon:{paddingLeft:10}}));return M?a.default.createElement(f.ActivityIndicator,{size:72}):a.default.createElement(o.default,{style:(0,r.default)({},D.scroll)},a.default.createElement(d.default,{onEndReached:function(){console.info("onEndReached")},data:w,initialNumToRender:100,renderItem:function(e){return function(e){return a.default.createElement(i.default,{style:{width:y},key:e.id},a.default.createElement(s.default,{key:e.id,folder:(0,r.default)({},e,{isOpen:e.id===b&&!E,isInfoOpen:e.id===E}),styles:D,abortEditFolder:_,folderNameInputRef:C,iconColor:"black",iconSize:30,enableMove:!1,current:g,width:y,isLoadingContent:b===e.id&&k,isOpen:e.id===b,currentFolderEditorName:I,setFolderEditorName:F,onFolderPress:function(){h.dispatch(p.CommonActions.navigate({name:"Folder",params:{folderId:e.id,title:e.title,parentFolderId:e.folderId}}))},onShareFolder:function(){return t.onShareFolder(e)},onFolderActionPress:function(){return S(e.id)},onRemoveFolder:function(){return O(e)}},e.id!==b||E?null:a.default.createElement(i.default,{style:{width:y,height:"auto"}})))}(e.item)},keyExtractor:function(e){return e.id||e.date.toString()},getItemCount:x,getItem:P,getItemLayout:function(e,t){return{length:50,offset:50*t,index:t}}}))}}.apply(t,r))||(e.exports=a)},33466:(e,t,n)=>{var r,a;r=[t,n(10434),n(95004),n(7602),n(2145),n(39385),n(89555),n(7484),n(22152),n(44104),n(72304),n(30463),n(3126),n(13896),n(52254),n(3916),n(84862),n(47683),n(2857),n(16976),n(91724)],void 0===(a=function(e,r,a,o,l,i,u,d,c,s,f,p,m,v,y,g,h,w,b,P,x){"use strict";var E=n(64836);function I(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(I=function(e){return e?n:t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0,r=E(r),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=I(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var l=a?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(a),o=E(o),l=E(l),i=E(i),u=E(u),d=E(d),c=E(c),f=E(f),m=E(m),g=E(g),b=E(b),x=E(x);var F=(0,a.memo)((function(e){var t=e.parentFolderId,n=e.getFolderContent,l=e.getFoldersByType,u=e.enqMedia,c=e.stopMedia,s=e.setWindowClosedCallback,f=e.parentFolderHook,m=e.styles,v=(e.folderId,e.renderContent),h=(e.initialScrollIndex,e.flatListRef),P=e.folderType,E=e.writeItem;return a.default.createElement(i.default,{style:{width:"30%"}},t?null:a.default.createElement(a.default.Fragment,null,P===w.FolderType.media?a.default.createElement(g.default,{getFolderContent:n,getFoldersByType:l,enqMedia:u,stopMedia:c,setWindowClosedCallback:s}):null,P===w.FolderType.contact?a.default.createElement(b.default,{getFolderContent:n,getFoldersByType:l}):null,P===w.FolderType.editor||P===w.FolderType.encoder?a.default.createElement(x.default,{dataHook:(0,p.useFolders)(P,l,n,E)}):null),t&&!f.isLoadingFolder?a.default.createElement(o.default,{style:(0,r.default)({},m.scroll)},f.folderContentQuery.isFetching?a.default.createElement(y.ActivityIndicator,{size:72}):a.default.createElement(d.default,{onEndReached:function(){console.info("onEndReached")},data:f.folderContent,pagingEnabled:!0,initialNumToRender:1e3,renderItem:v,keyExtractor:function(e){return e.id||e.date.toString()},getItemCount:f.getContentCount,getItem:f.getContentItem,onScrollToTop:function(){console.info("ontop")},ref:h,getItemLayout:function(e,t){return{length:130,offset:130*t,index:t}}})):null)}));t.default=(0,a.memo)((function(e){var t=e.navigation,n=e.getFolderContent,r=e.getById,d=e.enqMedia,c=e.stopMedia,p=e.getFoldersByType,g=e.setWindowClosedCallback,w=e.folderType,b=e.writeItem,x=(0,h.useIsFocused)(),E=(0,u.default)(),I=E.height,C=E.width,S=!(C>700),k=(0,a.useContext)(s.PartyCtx),M=(0,a.useContext)(s.UserCtx),O=(0,h.useRoute)(),T=(0,a.useRef)(),_=O.params,j=_.folderId,D=_.mnemonic,L=_.title,A=_.userId,B=(0,v.useFolder)(j,n,r,w,b,D,L,A),R=B.folderContent,U=(B.getContentCount,B.getContentItem,B.isLoadingFolder),z=(B.folderContentQuery,B.folder),W=B.onReordered,N=B.addMedia,Q=O.params.parentFolderId||z&&z.folderId||null,H=(0,v.useFolder)(Q,n,r,w,b),V=O.params.scrollIndex||!H.isLoadingFolder&&H.folderContent&&H.folderContent.findIndex((function(e){return e&&e.id===j}));if((!1===V||V<1)&&(V=0),!x)return a.default.createElement(a.default.Fragment,null);var q=l.default.create({container:{flex:1,paddingTop:0,marginTop:0},item:{paddingTop:15,paddingLeft:5,fontSize:12,height:160,color:"black",width:C-80},tinyLogo:{marginTop:2,width:22,height:22},scroll:{height:I-65,display:"flex",position:"relative",backgroundColor:"black",marginTop:0,width:"100%"},icon:{paddingLeft:10}}),K=function(e){var n=e.item,r=e.onDragEnd,o=e.onDragStart;return a.default.createElement(P.TouchableOpacity,{key:n.id,onPressIn:o,onPressOut:r},a.default.createElement(m.default,{i:n,key:n.id,dataHook:B,styles:q,width:S?C:C/100*70,navigation:t,party:k,current:M}))};return a.default.createElement(o.default,null,a.default.createElement(i.default,{style:{backgroundColor:M.colors.backgroundColor,height:B.currentMediaId?I/2:I,width:"100%",flexDirection:"row"}},S?null:a.default.createElement(F,{parentFolderId:Q,navgation:t,getFolderContent:n,getFoldersByType:p,enqMedia:d,stopMedia:c,setWindowClosedCallback:g,parentFolderHook:H,styles:q,folderId:j,renderContent:K,flatListRef:T,folderType:w,writeItem:b}),a.default.createElement(P.ScrollView,{style:{height:B.currentMediaId?I/2:I},showsHorizontalScrollIndicator:!1,showsVerticalScrollIndicator:!1},U?a.default.createElement(y.ActivityIndicator,{size:72}):a.default.createElement(f.default,{renderItem:K,keyExtractor:function(e){return e.id||e.date.toString()},data:R,ListEmptyComponent:function(){return a.default.createElement(y.List.Item,{title:"Create your first project",left:function(){return a.default.createElement(y.IconButton,{icon:"creation",mode:"outlined"})},style:{padding:10},onPress:function(){return N()}})},onReordered:W}),a.default.createElement(i.default,{style:{width:"100%",height:150,position:"relative"}}))))}))}.apply(t,r))||(e.exports=a)},94313:(e,t,n)=>{var r,a;r=[t,n(64687),n(95004),n(39385),n(52254),n(51641),n(77527),n(84862),n(45693),n(76671)],void 0===(a=function(e,r,a,o,l,i,u,d,c,s){"use strict";var f=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),t.default=function(e){var t=e.getById,n=e.height,f=(e.writeItem,e.media),p=e.routeParams,m=(0,l.useTheme)(),v=(0,s.useAppDispatch)(),y=f.currentMediaId,g=(0,i.useQuery)("mediaData_"+y,(function(){return t(f.currentMediaId,p.folderId)}),{enabled:!!f.currentMediaId}),h=(0,d.useIsFocused)(),w=g.data,b=(null==w||w.extractor,"wt"===(null==w?void 0:w.extractor)),P=(0,i.useMutation)((function(e){return r.default.async((function(t){for(;;)switch(t.prev=t.next){case 0:w&&(w.currentPosition=e);case 1:case"end":return t.stop()}}),null,null,null,Promise)}),{retry:!1}),x=(0,i.useQuery)("localMedia_"+y,(function(){var e;return r.default.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.default.awrap((0,u.getFileOpfs)(w));case 2:if(!(e=t.sent)){t.next=6;break}return v((0,c.loaded)({actionType:c.MediaActionType.loaded,mediaId:y})),t.abrupt("return",e);case 6:return t.abrupt("return",void 0);case 7:case"end":return t.stop()}}),null,null,null,Promise)}),{enabled:!(!h||null==w||!w.id)}),E=(0,i.useQuery)("wtMedia_"+y,(function(){var e;return r.default.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.default.awrap((0,u.getVideoWT)(w));case 2:return e=t.sent,v((0,c.loaded)({actionType:c.MediaActionType.loaded,mediaId:y})),t.abrupt("return",e);case 5:case"end":return t.stop()}}),null,null,null,Promise)}),{enabled:b&&x.isFetched&&!x.data&&h}),I=g.isLoading||E.isFetching||x.isFetching,F=E.data||x.data||(null==w?void 0:w.url),C=(null==w?void 0:w.currentPosition)||0;return a.default.createElement(a.default.Fragment,null,a.default.createElement(l.Divider,null),a.default.createElement(l.Banner,{visible:!!f.currentMediaId,theme:m,style:{backgroundColor:"black",padding:0,margin:0},contentStyle:{width:"100%",height:"100%",maxWidth:"auto",padding:0,margin:0}},a.default.createElement(o.default,{style:{width:"100%",height:n/2}},a.default.createElement(l.IconButton,{style:{position:"absolute",cursor:"pointer",right:0,pointerEvents:"auto",zIndex:100},icon:"close",mode:"outlined",onPress:function(){return f.onMediaPress("")}}),I?a.default.createElement(l.ActivityIndicator,{size:72}):null,y&&!I&&h?a.default.createElement("video",{controls:!0,style:{width:"100%",height:"100%"},onPlaying:function(e){var t=e.nativeEvent.target.currentTime;P.mutateAsync(t),v((0,c.togglePause)({pause:!1,actionType:c.MediaActionType.pause}))},onPause:function(e){v((0,c.togglePause)({pause:!0,actionType:c.MediaActionType.pause}))},onEnded:function(e){console.info("ended",e)},onTimeUpdate:function(e){var t=e.nativeEvent.target.currentTime;t>5&&t-C>5&&!P.isLoading&&P.mutateAsync(t)},onResize:function(){console.info("resize")},onLoadedData:function(e){f.isMediaPaused||e.nativeEvent.target.play()},ref:function(e){e&&e.paused&&e.currentTime},src:F},a.default.createElement("track",{label:"language one",kind:"subtitles",srcLang:"en",default:!0})):null)),a.default.createElement(l.Divider,null))},r=f(r),a=f(a),o=f(o),console.info("getFileOpfs",u.getFileOpfs)}.apply(t,r))||(e.exports=a)},2453:(e,t,n)=>{var r,a;r=[t,n(10434),n(64687),n(95004),n(39385),n(2145),n(46434),n(45288),n(76671),n(52254),n(51641),n(77527)],void 0===(a=function(e,r,a,o,l,i,u,d,c,s,f,p){"use strict";var m=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0,r=m(r),a=m(a),o=m(o),l=m(l),i=m(i),u=m(u),d=m(d);var v=i.default.create({container:{flex:1},row:{flexDirection:"row"},column:{flexDirection:"column"},customTitle:{alignItems:"center",justifyContent:"space-between"},additionalPadding:{paddingTop:8},image:{width:"100%",height:"auto",opacity:.6,position:"absolute",resizeMode:"cover",zIndex:-1,flex:1}});t.default=function(e){var t=e.i,n=e.itemLoading,i=e.width,m=e.onMediaPress,y=e.onRemoveMediaPress,g=e.onDownloadMediaPress,h=(e.onCopyLinkPress,e.onEditMediaPress,e.isPlaying),w=(0,s.useTheme)(),b=t.id===n,P=function(){return m(t.id)},x=function(){return a.default.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",y(t));case 1:case"end":return e.stop()}}),null,null,null,Promise)},E=(0,c.useAppSelector)((function(e){return e.fs.downloadingProgress[t.id]})),I=(0,f.useQuery)(["isDownloaded",t.id,t.isDownloaded],(function(){var e;return a.default.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,a.default.awrap((0,p.getFileReaderOpfs)(t));case 3:if(e=n.sent,console.info("hasfile",e),!e){n.next=9;break}return n.abrupt("return",!0);case 9:return n.abrupt("return",!1);case 10:n.next=15;break;case 12:return n.prev=12,n.t0=n.catch(0),n.abrupt("return",!1);case 15:case"end":return n.stop()}}),null,null,[[0,12]],Promise)}),{refetchOnMount:!1,refetchOnReconnect:!1,refetchOnWindowFocus:!1,staleTime:1/0}),F=I.data,C=function(){return a.default.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",F?null:g(t.id));case 1:case"end":return e.stop()}}),null,null,null,Promise)},S=(t.thumbnail,h?"stop-circle-outline":"play-circle-outline"),k=I.isFetched&&F?"floppy":"cloud-download-outline";var M=t.extractor.toLowerCase();"wt"===M&&(M="folder-network"),"local"===M&&(M="file");var O=100,T=void 0!==E?function(){return o.default.createElement(s.ActivityIndicator,{animating:!0,theme:w})}:k,_={pointerEvents:"auto",paddingTop:30};return o.default.createElement(l.default,{style:{width:i,height:O}},o.default.createElement(s.List.Item,{style:{height:O,zIndex:2,position:"absolute",width:i},left:function(e){return o.default.createElement(d.default,{onPress:P,style:_},o.default.createElement(s.List.Icon,(0,r.default)({},e,{icon:b?function(){return o.default.createElement(s.ActivityIndicator,{animating:!0,theme:w})}:S})))},right:function(e){return o.default.createElement(o.default.Fragment,null,o.default.createElement(d.default,{onPress:C,style:_},o.default.createElement(s.List.Icon,(0,r.default)({},e,{icon:T}))),o.default.createElement(d.default,{onPress:x,style:_},o.default.createElement(s.List.Icon,(0,r.default)({},e,{icon:"delete"}))))},title:function(e){var n=e.ellipsizeMode,r=e.color,a=e.fontSize;return o.default.createElement(l.default,{style:[v.container,v.row,v.customTitle]},o.default.createElement(s.Text,{ellipsizeMode:n,style:{color:r,fontSize:a},numberOfLines:2},t.title))},description:function(e){var n=e.ellipsizeMode,r=e.color,a=e.fontSize;return o.default.createElement(l.default,{style:[v.container,v.column]},o.default.createElement(s.Text,{numberOfLines:1,ellipsizeMode:n,style:{color:r,fontSize:a}},t.description),o.default.createElement(l.default,{style:[v.container,v.row,v.additionalPadding]},o.default.createElement(s.Chip,{icon:M,onPress:function(){},style:{height:30}},"From ",t.extractor),!F&&E&&100*E>1&&o.default.createElement(s.Chip,{icon:M,onPress:function(){},style:{height:30}},"Downloading ",parseInt((100*E).toString(),10),"%")))}}),t.thumbnail?o.default.createElement(u.default,{source:{uri:t.thumbnail,cache:"force-cache"},resizeMethod:"resize",resizeMode:"cover",style:(0,r.default)({},v.image,{height:O,width:i}),imageStyle:(0,r.default)({},v.image,{height:O,width:i})}):null,o.default.createElement(s.Divider,null))}}.apply(t,r))||(e.exports=a)},3916:(e,t,n)=>{var r,a;r=[t,n(95004),n(6664),n(91724)],void 0===(a=function(e,r,a,o){"use strict";var l=n(64836);function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0,r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var l=a?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(r),o=l(o);t.default=(0,r.memo)((function(e){var t=e.getFolderContent,n=e.getFoldersByType,l=e.enqMedia,i=e.stopMedia,u=e.setWindowClosedCallback,d=e.writeItem,c=(0,a.useMedia)(n,t,l,i,u,d);return r.default.createElement(o.default,{dataHook:c})}))}.apply(t,r))||(e.exports=a)},44780:(e,t,n)=>{var r,a;r=[t,n(10434),n(95004),n(7130),n(83114),n(43747),n(54572),n(29266),n(47683),n(58660),n(54698),n(89555),n(79170),n(16350),n(17382),n(70997),n(785),n(176),n(76671),n(82547),n(29290)],void 0===(a=function(e,r,a,o,l,i,u,d,c,s,f,p,m,v,y,g,h,w,b,P,x){"use strict";var E=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0,r=E(r),a=E(a),l=E(l),d=E(d),p=E(p),m=E(m);var I=(0,o.createMaterialBottomTabNavigator)(),F=(0,u.createDrawerNavigator)(),C=(0,w.createNativeStackNavigator)(),S={writeItem:s.writeItem,getUserData:s.getUserData,getPublicFolderContent:s.getPublicFolderContent,getFolderContent:s.getFolderContent,getFoldersByType:s.getFoldersByType,getById:s.getById,enqMedia:s.getMediaAndEnq,stopMedia:s.stopVideo,extractMedia:s.extractMedia,findByOriginalId:s.findByOriginalId,setNetworkUpdateCB:function(){},getPublicMessages:s.getPublicMessages,setPubCallback:s.setPubCallback,publicPartyPref:s.publicPartyPref,getPublicPartyList:s.getPublicPartyList,createNewParty:s.createNewParty,deleteById:s.deleteById,sendChatMessage:s.sendChatMessage,writePublicData:s.writePublicData,getUnreadMessages:s.getUnreadMessages,setWindowClosedCallback:s.setWindowClosedCallback,DocumentPicker:s.DocumentPicker,stopVideo:s.stopVideo,domain:s.domain},k=(0,f.createFileStack)(S),M=(0,v.createChatStack)(S),O=(0,y.createSettings)(S),T=(0,g.createEncoder)(S),_=(0,h.createEditor)(S),j=function(){var e=(0,p.default)(),t=(0,b.useAppDispatch)(),n=(0,b.useAppSelector)((function(e){return e.ui.isTabBarHidden}));return(0,x.useKeyboardDispatcher)(),e.width>700?a.default.createElement(i.SafeAreaInsetsContext.Consumer,null,(function(e){var t=e||{left:0,right:0},n=t.left,r=t.right,o=80+Math.max(n,r);return a.default.createElement(F.Navigator,{screenOptions:{drawerStyle:{width:o},drawerPosition:"left",drawerType:"permanent"},detachInactiveScreens:!0,defaultStatus:"open",drawerContent:function(e){return a.default.createElement(m.default,e)}},a.default.createElement(F.Screen,{name:"FilesTab",component:k,options:{headerShown:!1,drawerIcon:function(e){var t=e.color;e.size;return a.default.createElement(l.default,{name:"folder-outline",color:t,size:24})},title:"Files"}}),a.default.createElement(F.Screen,{name:"ContactsTab",component:M,options:{headerShown:!1,title:"Contacts"}}),a.default.createElement(F.Screen,{name:"EncoderTab",component:T,options:{headerShown:!1,title:"Encoder"}}),a.default.createElement(F.Screen,{name:"EditorTab",component:_,options:{headerShown:!1,title:"Editor"}}),a.default.createElement(F.Screen,{name:"SettingsTab",component:O,options:{headerShown:!1,drawerIcon:function(e){var t=e.color;e.size;return a.default.createElement(l.default,{name:"people-outline",color:t,size:24})},title:"Contacts"}}))})):a.default.createElement(I.Navigator,{barStyle:{display:n?"none":"flex"},screenListeners:{state:function(e){try{var n,r,a,o,l,i=e,u=(null==i||null==(n=i.data)||null==(r=n.state)?void 0:r.routes[(null==i||null==(a=i.data.state)?void 0:a.index)||0])||{},d=null==u||null==(o=u.state)?void 0:o.routes[(null==u||null==(l=u.state)?void 0:l.index)||0];t((0,P.setCurrentPage)({currentPage:null==d?void 0:d.name}))}catch(c){}}}},a.default.createElement(I.Screen,{name:"FilesTab",options:{tabBarLabel:"Files",tabBarIcon:"folder"},component:k}),a.default.createElement(I.Screen,{name:"Account",options:{tabBarIcon:"account"},component:O}),a.default.createElement(I.Screen,{name:"ContactsTab",component:M,options:{tabBarLabel:"Contacts",tabBarIcon:"contacts"}}),a.default.createElement(I.Screen,{name:"EditorTab",component:_,options:{tabBarLabel:"Editor",tabBarIcon:"scissors-cutting"}}))};t.default=function(){return a.default.createElement(C.Navigator,{screenOptions:{header:function(e){return a.default.createElement(d.default,(0,r.default)({},e,{ftsIndex:c.FTSIndex.title,writeItem:s.writeItem,findByOriginalId:s.findByOriginalId,searchDatabaseOnIndex:function(){},createNewParty:s.createNewParty,publicPartyPref:s.publicPartyPref,extractMedia:s.extractMedia,folderType:c.FolderType.contact,getById:s.getById,getUserData:s.getUserData,DocumentPicker:s.DocumentPicker}))}}},a.default.createElement(C.Screen,{name:"Starp",component:j,options:{title:"starpy.me",freezeOnBlur:!0}}))}}.apply(t,r))||(e.exports=a)},41811:(e,t,n)=>{var r,a;r=[t,n(95004),n(52254),n(47683),n(84862)],void 0===(a=function(e,r,a,o,l){"use strict";var i=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0,r=i(r);t.default=function(e){var t=e.item,n=e.folderType,i=e.onRemoveFolder,u=(0,l.useNavigation)(),d=n===o.FolderType.encoder?"EncoderProject":"EditorProject",c=n===o.FolderType.editor?"film":"matrix";return r.default.createElement(r.default.Fragment,null,r.default.createElement(a.Divider,null),r.default.createElement(a.List.Item,{style:{padding:19},title:t.title,onPress:function(){u.navigate(d,{projectId:t.id,parentFolderId:t.folderId})},left:function(){return r.default.createElement(a.List.Icon,{icon:c})},right:function(){return r.default.createElement(a.IconButton,{icon:"delete",onPress:function(){return i(t)}})}}))}}.apply(t,r))||(e.exports=a)},17382:(e,t,n)=>{var r,a;r=[t,n(10434),n(95004),n(17342),n(56105),n(46026)],void 0===(a=function(e,r,a,o,l,i){"use strict";var u=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),t.createSettings=void 0,r=u(r),a=u(a),l=u(l),i=u(i);var d=(0,o.createStackNavigator)();t.createSettings=function(e){var t=e.colorOptions,n=e.current,o=function(t){return a.default.createElement(l.default,(0,r.default)({},t,{domain:e.domain,getUserData:e.getUserData}))},u=function(t){return a.default.createElement(i.default,(0,r.default)({},t,{getUserData:e.getUserData}))};return function(){return a.default.createElement(d.Navigator,{screenOptions:{headerShown:!1,freezeOnBlur:!0}},a.default.createElement(d.Screen,{name:"Settings",component:o,options:(0,r.default)({},t)}),a.default.createElement(d.Screen,{name:"Devices",component:u,options:function(e){var a,o;e.route;return(0,r.default)({},t,{headerStyle:{backgroundColor:null==n||null==(a=n.colors)?void 0:a.backgroundColor,color:null==n||null==(o=n.colors)?void 0:o.navTextColor}})}}))}}}.apply(t,r))||(e.exports=a)},43228:(e,t,n)=>{var r,a;r=[t,n(95004)],void 0===(a=function(e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),t.UserDataState=t.UserDataDispatch=t.UserCtx=t.PeerCtx=t.PartyCtx=t.MediaCtx=t.LocalCtx=t.LoadingContext=void 0;t.PeerCtx=(0,n.createContext)(null),t.MediaCtx=(0,n.createContext)(null),t.PartyCtx=(0,n.createContext)(null),t.UserCtx=(0,n.createContext)(null),t.LocalCtx=(0,n.createContext)(null),t.LoadingContext=(0,n.createContext)(!1),t.UserDataState=(0,n.createContext)(null),t.UserDataDispatch=(0,n.createContext)(null)}.apply(t,r))||(e.exports=a)},44104:(e,t,n)=>{var r,a;r=[t,n(43228)],void 0===(a=function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(t).forEach((function(n){"default"!==n&&"__esModule"!==n&&(n in e&&e[n]===t[n]||Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[n]}}))}))}.apply(t,r))||(e.exports=a)},58794:(e,t,n)=>{var r,a;r=[t,n(47683)],void 0===(a=function(e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),t.userDocKey=t.publicPartyPref=t.migrationKey=t.loaderURI=t.googleDocumentKey=t.encoderProjectTypes=t.domain=t.defaultFolders=t.dbID=t.contactPrefix=t.colors=t.cdndomain=t.MEDIA=void 0;var r=t.migrationKey="afanassii25662",a=(t.dbID=r,t.userDocKey="userDoc",t.domain="https://www.starpy.me/",t.cdndomain="https://cdn.starpy.me/",t.contactPrefix="contact_",t.publicPartyPref="public_party_");t.encoderProjectTypes=[n.FolderType.encoder,n.FolderType.editor],t.googleDocumentKey="google_document",t.defaultFolders=["demo","new","nearby",a,"tutorial","new_editor","new_media","new_chat","new_encoder"],t.loaderURI="https://raw.githubusercontent.com/AboutReact/sampleresource/master/old_logo.png",t.MEDIA=[{id:"sintel",title:"Sintel",thumbnail:"https://starpy.me/webapp/sintel.jpg",folderId:"demo",extractor:"wt",url:"magnet:?xt=urn:btih:08ada5a7a6183aae1e09d831df6748d566095a10&dn=Sintel&tr=udp%3A%2F%2Fexplodie.org%3A6969&tr=udp%3A%2F%2Ftracker.coppersurfer.tk%3A6969&tr=udp%3A%2F%2Ftracker.empire-js.us%3A1337&tr=udp%3A%2F%2Ftracker.leechers-paradise.org%3A6969&tr=udp%3A%2F%2Ftracker.opentrackr.org%3A1337&tr=wss%3A%2F%2Ftracker.btorrent.xyz&tr=wss%3A%2F%2Ftracker.fastcast.nz&tr=wss%3A%2F%2Ftracker.openwebtorrent.com&ws=https%3A%2F%2Fwebtorrent.io%2Ftorrents%2F&xs=https%3A%2F%2Fwebtorrent.io%2Ftorrents%2Fsintel.torrent"},{id:"tears",title:"Tears of Steel",thumbnail:"https://starpy.me/webapp/tearsOfSteel.jpg",folderId:"demo",extractor:"wt",url:"magnet:?xt=urn:btih:209c8226b299b308beaf2b9cd3fb49212dbd13ec&dn=Tears+of+Steel&tr=udp%3A%2F%2Fexplodie.org%3A6969&tr=udp%3A%2F%2Ftracker.coppersurfer.tk%3A6969&tr=udp%3A%2F%2Ftracker.empire-js.us%3A1337&tr=udp%3A%2F%2Ftracker.leechers-paradise.org%3A6969&tr=udp%3A%2F%2Ftracker.opentrackr.org%3A1337&tr=wss%3A%2F%2Ftracker.btorrent.xyz&tr=wss%3A%2F%2Ftracker.fastcast.nz&tr=wss%3A%2F%2Ftracker.openwebtorrent.com&ws=https%3A%2F%2Fwebtorrent.io%2Ftorrents%2F&xs=https%3A%2F%2Fwebtorrent.io%2Ftorrents%2Ftears-of-steel.torrent"},{id:"cosmoslaundromat",title:"Cosmos Laundromat",thumbnail:"https://starpy.me/webapp/cosmosLaundromat.jpg",folderId:"demo",extractor:"wt",url:"magnet:?xt=urn:btih:c9e15763f722f23e98a29decdfae341b98d53056&dn=Cosmos+Laundromat&tr=udp%3A%2F%2Fexplodie.org%3A6969&tr=udp%3A%2F%2Ftracker.coppersurfer.tk%3A6969&tr=udp%3A%2F%2Ftracker.empire-js.us%3A1337&tr=udp%3A%2F%2Ftracker.leechers-paradise.org%3A6969&tr=udp%3A%2F%2Ftracker.opentrackr.org%3A1337&tr=wss%3A%2F%2Ftracker.btorrent.xyz&tr=wss%3A%2F%2Ftracker.fastcast.nz&tr=wss%3A%2F%2Ftracker.openwebtorrent.com&ws=https%3A%2F%2Fwebtorrent.io%2Ftorrents%2F&xs=https%3A%2F%2Fwebtorrent.io%2Ftorrents%2Fcosmos-laundromat.torrent"},{id:"bbb",title:"Big Buck Bunny",thumbnail:"https://starpy.me/webapp/bigBuckBunny.jpg",folderId:"demo",extractor:"wt",url:"magnet:?xt=urn:btih:dd8255ecdc7ca55fb0bbf81323d87062db1f6d1c&dn=Big+Buck+Bunny&tr=udp%3A%2F%2Fexplodie.org%3A6969&tr=udp%3A%2F%2Ftracker.coppersurfer.tk%3A6969&tr=udp%3A%2F%2Ftracker.empire-js.us%3A1337&tr=udp%3A%2F%2Ftracker.leechers-paradise.org%3A6969&tr=udp%3A%2F%2Ftracker.opentrackr.org%3A1337&tr=wss%3A%2F%2Ftracker.btorrent.xyz&tr=wss%3A%2F%2Ftracker.fastcast.nz&tr=wss%3A%2F%2Ftracker.openwebtorrent.com&ws=https%3A%2F%2Fwebtorrent.io%2Ftorrents%2F&xs=https%3A%2F%2Fwebtorrent.io%2Ftorrents%2Fbig-buck-bunny.torrent"}],t.colors={textColor:"white",backgroundColor:"black",mediaItemTextColor:"palegoldenrod",mediaBackgroundColor:"#2b2b2b",mediaBorderColor:"black",navTextColor:"#e1d76a",navInactiveColor:"#585858",folderColor:"#585858",folderTextColor:"black",deleteBackgroundColor:"red",deleteTextColor:"black",navBorderColor:"#585858",contactItemBackgroundColor:"#2b2b2b",contactItemTitleColor:"#e1d76a",contactItemOnlineColor:"green",theme:"dark",currentUserColor:"#585858",remoteUserColor:"cornflowerblue"}}.apply(t,r))||(e.exports=a)},76242:(e,t,n)=>{var r,a;r=[t,n(10434),n(861),n(64687),n(58794),n(69531),n(25707),n(47683)],void 0===(a=function(e,r,a,o,l,i,u,d){"use strict";var c=n(64836);Object.defineProperty(e,"__esModule",{value:!0});var s={createUser:!0,createNewUser:!0,doInitialMigration:!0};t.doInitialMigration=t.createUser=t.createNewUser=void 0,r=c(r),a=c(a),o=c(o),Object.keys(l).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(s,t)||t in e&&e[t]===l[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return l[t]}}))})),u=c(u);var f={id:"folder01",title:"My First Folder",isFolder:!0},p=t.createUser=function(){var e,t,n,r,a,d;return o.default.async((function(o){for(;;)switch(o.prev=o.next){case 0:return e=i.faker.image.cats(),t=i.faker.name.fullName(),n=i.faker.animal.cat(),r="19"+new Date(i.faker.date.birthdate()).getFullYear(),a=u.default.v4().toString(),d="@"+(t+n+r).replace(/[^A-Z0-9]+/gi,""),o.abrupt("return",{handle:d,photo:e,name:t,description:n,year:r,id:a,idHash:a,userDoc:!0,version:l.migrationKey,prevVersion:""});case 7:case"end":return o.stop()}}),null,null,null,Promise)},m=t.createNewUser=function(e){var t;return o.default.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,o.default.awrap(p());case 3:return t=n.sent,console.info("==== creating temp user ====",t),n.next=7,o.default.awrap(e(t));case 7:return n.abrupt("return",t);case 10:n.prev=10,n.t0=n.catch(0),console.error("==== error on creating a new user ====",n.t0);case 13:case"end":return n.stop()}}),null,null,[[0,10]],Promise)};t.doInitialMigration=function(e,t){var n,i;return o.default.async((function(u){for(;;)switch(u.prev=u.next){case 0:return console.info("==== do migration ===="),u.prev=1,u.next=4,o.default.awrap(t());case 4:if(n=u.sent,console.info("initialMigrationUserCheck",n),!n||!n.id){u.next=8;break}return u.abrupt("return",n);case 8:if(n&&n.id){u.next=12;break}return u.next=11,o.default.awrap(m(e));case 11:n=u.sent;case 12:return i=n.id,u.next=15,o.default.awrap(Promise.all([e((0,r.default)({},f,{title:"Demo",id:"demo",folderType:d.FolderType.media,date:(new Date).toISOString(),userId:i}))].concat((0,a.default)(l.MEDIA.map((function(t){return o.default.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",e((0,r.default)({},t,{isMediaNew:!0,folderId:"demo",date:(new Date).valueOf()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}))))));case 15:u.next=20;break;case 17:u.prev=17,u.t0=u.catch(1),console.error("====migration err===",u.t0);case 20:console.info("==== after migration ====");case 21:case"end":return u.stop()}}),null,null,[[1,17]],Promise)}}.apply(t,r))||(e.exports=a)},31401:(e,t,n)=>{var r,a;r=[t,n(64687),n(30463),n(47683)],void 0===(a=function(e,r,a,o){"use strict";var l=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),t.useContacts=void 0,r=l(r);t.useContacts=function(e,t,n){return(0,a.useFolders)(o.FolderType.contact,(function(){var t;return r.default.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.default.awrap(e(o.FolderType.contact));case 2:return t=n.sent,n.abrupt("return",t);case 4:case"end":return n.stop()}}),null,null,null,Promise)}),(function(e){var n;return r.default.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.default.awrap(t(e));case 2:return n=a.sent,a.abrupt("return",n);case 4:case"end":return a.stop()}}),null,null,null,Promise)}),n)}}.apply(t,r))||(e.exports=a)},13896:(e,t,n)=>{var r,a;r=[t,n(27424),n(10434),n(64687),n(51641),n(51005),n(95004),n(44104),n(48736),n(76671),n(84862),n(41792),n(58660),n(55894),n(25707)],void 0===(a=function(e,r,a,o,l,i,u,d,c,s,f,p,m,v,y){"use strict";var g=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),t.useFolder=function(e,t,n,g,h,w,b,P){var x,E=(0,f.useRoute)(),I=(0,i.useMediaPlayer)(e),F=(0,s.useAppDispatch)(),C=(0,l.useQuery)("folderData_"+e,(function(){var t,r;return o.default.async((function(a){for(;;)switch(a.prev=a.next){case 0:return console.info("useFolder",e,w),a.prev=1,a.next=4,o.default.awrap(n(e));case 4:if(t=a.sent,console.info("folder",t),void 0===(null==t?void 0:t.id)){a.next=8;break}return a.abrupt("return",t);case 8:a.next=13;break;case 10:a.prev=10,a.t0=a.catch(1),console.error(a.t0);case 13:if(console.info("mnemonic",w,b),!w||!b){a.next=19;break}return a.next=17,o.default.awrap(h({id:e,mnemonic:w,title:b,isFolder:!0,folderId:"new_"+g,folderType:g,userId:P}));case 17:r=a.sent,console.info("after create new folder, nf",r);case 19:return a.next=21,o.default.awrap(n(e));case 21:return a.abrupt("return",a.sent);case 22:case"end":return a.stop()}}),null,null,[[1,10]],Promise)}),{enabled:!!e,refetchOnWindowFocus:!1,refetchOnMount:!1,retry:function(e){return!(e>3)}}),S="folderContent_"+e,k=(0,l.useQueryClient)(),M=C.isFetching,O=C.data,T=w||(null==O?void 0:O.mnemonic),_=null!=T&&T.length&&T.length>1?1e3:void 0,j=(0,l.useQuery)(S,(function(){return t(e)}),{enabled:!!e,refetchOnWindowFocus:!1,refetchOnMount:!1,retry:!0,keepPreviousData:!0,refetchInterval:_}),D=(0,l.useMutation)((function(e){return o.default.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=o.default,t.t1=h,t.t2=a.default,t.t3={},t.next=6,o.default.awrap(n(e));case 6:return t.t4=t.sent,t.t5={isDeleted:!0},t.t6=(0,t.t2)(t.t3,t.t4,t.t5),t.t7=(0,t.t1)(t.t6),t.next=12,t.t0.awrap.call(t.t0,t.t7);case 12:return t.abrupt("return",t.sent);case 13:case"end":return t.stop()}}),null,null,null,Promise)})),L=j.data,A=j.isFetching,B=(0,l.useMutation)((function(e){return h(e)}),{onSuccess:function(){var e,t;return o.default.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.default.awrap(k.refetchQueries(S));case 2:if(null==(e=E.params)||!e.projectId){n.next=9;break}return t=E.params.projectId,console.info("onReordered project items",t),n.next=7,o.default.awrap(k.refetchQueries(["projectLayers",t]));case 7:return n.next=9,o.default.awrap(k.refetchQueries(["encodedMedia",t]));case 9:case"end":return n.stop()}}),null,null,null,Promise)}}),R=!M&&O&&O.files?null==O||null==(x=O.files)?void 0:x.map((function(e){return{id:e,url:e,title:e,filename:e,isMediaNew:!0,folderId:O.id,_id:e,date:O.date,originalId:O.originalId,webpage_url:O.webpage_url,thumbnail:O.thumbnail,extractor:O.extractor}})):[],U=(0,u.useContext)(d.UserDataState),z=(0,u.useContext)(d.UserDataDispatch),W=U.isEditingFolder[e],N=(0,u.useRef)(null),Q=(0,u.useState)(""),H=(0,r.default)(Q,2),V=H[0],q=H[1],K=null==L?void 0:L.find((function(e){return e.id===W})),G=M||A?[]:R.concat(L),J=(0,l.useMutation)((function(e){return o.default.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.default.awrap(h(e));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),null,null,null,Promise)})),X=function(){return z({actionType:c.UserDataActionType.setEditingFolder,folderId:void 0,folderType:e})},Y=function(t){return z({actionType:c.UserDataActionType.setEditingFolder,folderId:t,folderType:e})};return(0,a.default)({isLoadingFolder:M,isLoadingFolderError:C.error,folderData:C,isLoadingFolderContentError:j.error,isLoadingFolderContent:A,folderContentQuery:j,folder:O,folderContent:G,isEditingFolder:W,abortEditFolder:X,folderNameInputRef:N,currentFolderEditorName:V,setFolderEditorName:q,onFolderActionPress:function(e){return o.default.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.info("isEditingFolder: "+(e===W),e),(null==K?void 0:K.id)!==e){t.next=9;break}return K.title=V,t.next=5,o.default.awrap(J.mutateAsync(K));case 5:return X(),t.next=8,o.default.awrap(j.refetch());case 8:return t.abrupt("return");case 9:Y(e);case 10:case"end":return t.stop()}}),null,null,null,Promise)},onRemoveFolder:function(e){var t,n;return o.default.async((function(r){for(;;)switch(r.prev=r.next){case 0:return console.info("onRemoveFolder",e),r.next=3,o.default.awrap(D.mutateAsync(e.id));case 3:return r.next=5,o.default.awrap(j.refetch());case 5:if(null==(t=E.params)||!t.projectId){r.next=11;break}return n=E.params.projectId,r.next=9,o.default.awrap(dbConns[n].sync());case 9:return r.next=11,o.default.awrap(k.refetchQueries(["folderData_"+n]));case 11:console.info("after delete mutation");case 12:case"end":return r.stop()}}),null,null,null,Promise)},onShareFolder:function(e){var t,n,r,a,l,i,u;return o.default.async((function(d){for(;;)switch(d.prev=d.next){case 0:if(console.info("onShareFolder",e),t=e.id,n=e.title,r=e.userId,a=m.domain+"webapp/"+g+"/folder/"+t+"?title="+n+"&userId="+r+"&mnemonic=",e.mnemonic&&(console.info("folder has mnemonic"),l=a+encodeURIComponent(e.mnemonic),console.info(l),p.default.setString(l)),e.mnemonic){d.next=12;break}return i=(0,m.genMnemonic)(),e.mnemonic=i,d.next=9,o.default.awrap(J.mutateAsync(e));case 9:u=a+encodeURIComponent(i),console.info(u),p.default.setString(u);case 12:case"end":return d.stop()}}),null,null,null,Promise)},folderType:g,getContentItem:function(e,t){return G[t]},getContentCount:function(){return(null==G?void 0:G.length)||0}},I,{onReordered:function(e,t){if(console.info("dragend",e,t),e!==t){G[e].orderId=t+1;var n=G[t]?G[t].orderId=e+1:void 0;B.mutateAsync(G[e]),n&&B.mutateAsync(G[t])}},addMedia:function(){var t,n,r,a,l;return o.default.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,o.default.awrap(m.DocumentPicker.pickSingle({presentationStyle:"fullScreen"}));case 2:if(t=i.sent,console.info("pickerResult",t),t){i.next=6;break}return i.abrupt("return");case 6:return i.next=8,o.default.awrap((0,m.getUserData)());case 8:n=i.sent,r=t.uri,a=e,l={id:y.default.v4().toString(),url:r,title:t.name,originalId:t.name,filename:t.name,fileType:t.type,folderId:a,userId:n.id,date:(new Date).valueOf(),type:t.file.type,size:t.file.size,extractor:"local"},F((0,v.startOnboarding)({file:t.file,media:l}));case 13:case"end":return i.stop()}}),null,null,null,Promise)}})},r=g(r),a=g(a),o=g(o),p=g(p),y=g(y)}.apply(t,r))||(e.exports=a)},30463:(e,t,n)=>{var r,a;r=[t,n(64687),n(27424),n(95004),n(41792),n(44104),n(48736),n(51641),n(84862),n(58660)],void 0===(a=function(e,r,a,o,l,i,u,d,c,s){"use strict";var f,p=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),t.useFolders=t.FoldersActionType=void 0,r=p(r),a=p(a),l=p(l),function(e){e.edit="edit",e.select="select",e.deselect="deselect",e.abortEdit="abortEdit"}(f||(t.FoldersActionType=f={}));t.useFolders=function(e,t,n,f){var p,m=null==(p=(0,c.useRoute)().params)?void 0:p.folderId,v=(0,o.useContext)(i.UserDataState),y=(0,o.useContext)(i.UserDataDispatch),g=v.currentFolderIds[e],h=v.isEditingFolder[e],w=(0,o.useRef)(null),b=(0,o.useState)(""),P=(0,a.default)(b,2),x=P[0],E=P[1],I=(0,c.useIsFocused)(),F=(0,d.useQuery)("folders_"+e,(function(){var n;return r.default.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.default.awrap(t(e));case 2:return n=a.sent,n.find((function(t){return t.id==="new_"+e}))||n.unshift({id:"new_"+e,title:"New",isFolder:!0,date:(new Date).valueOf(),userId:"",folderType:e}),a.abrupt("return",n);case 6:case"end":return a.stop()}}),null,null,null,Promise)}),{refetchOnWindowFocus:!1,refetchOnMount:!1,retry:!0}),C=F.isFetching,S=F.data||[{id:"new_"+e,title:"New",isFolder:!0,date:(new Date).valueOf(),userId:"",folderType:e}],k=null==S?void 0:S.find((function(e){return e.id===h})),M=(0,d.useQuery)("folderContent_"+e,(function(){return n(g)}),{enabled:!1,retry:!0,refetchOnWindowFocus:!1}),O=M.isLoading||M.isFetching,T=M.data||[],_=(0,d.useMutation)((function(e){return r.default.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.default.awrap(f({id:e,isDeleted:!0}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),null,null,null,Promise)})),j=(0,d.useMutation)((function(e){return r.default.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.default.awrap(f(e));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),null,null,null,Promise)})),D=function(t){return r.default.async((function(n){for(;;)switch(n.prev=n.next){case 0:y({actionType:u.UserDataActionType.setActiveFolder,folderId:void 0,folderType:e}),g!==t&&y({actionType:u.UserDataActionType.setActiveFolder,folderId:t,folderType:e});case 2:case"end":return n.stop()}}),null,null,null,Promise)},L=function(t){return y({actionType:u.UserDataActionType.setEditingFolder,folderId:t,folderType:e})},A=function(){return y({actionType:u.UserDataActionType.setEditingFolder,folderId:void 0,folderType:e})};return{folderType:e,selectFolder:D,currentFolderId:m,getItem:function(e,t){return S[t]},getItemCount:function(){return S.length},getContentItem:function(e,t){return T[t]},getContentCount:function(){return T.length},folderContent:T,loadingContent:O,loadingFolders:C,folders:S,onRemoveFolder:function(e){return r.default.async((function(t){for(;;)switch(t.prev=t.next){case 0:return console.info("onRemoveFolder",e),t.next=3,r.default.awrap(_.mutateAsync(e.id));case 3:return t.next=5,r.default.awrap(F.refetch());case 5:console.info("after delete mutation");case 6:case"end":return t.stop()}}),null,null,null,Promise)},editFolder:L,abortEditFolder:A,onShareFolder:function(t){var n,a,o,i,u,d,c;return r.default.async((function(f){for(;;)switch(f.prev=f.next){case 0:if(console.info("onShareFolder",t),n=t.id,a=t.title,o=t.userId,i=s.domain+"webapp/"+e+"/folder/"+n+"?title="+a+"&userId="+o+"&mnemonic=",t.mnemonic&&(console.info("folder has mnemonic"),u=i+encodeURIComponent(t.mnemonic),console.info(u),l.default.setString(u)),t.mnemonic){f.next=12;break}return d=(0,s.genMnemonic)(),t.mnemonic=d,f.next=9,r.default.awrap(j.mutateAsync(t));case 9:c=i+encodeURIComponent(d),console.info(c),l.default.setString(c);case 12:case"end":return f.stop()}}),null,null,null,Promise)},folderContentQuery:M,currentFolderEditorName:x,setFolderEditorName:E,folderNameInputRef:w,onFolderPress:function(e){D(e)},onFolderActionPress:function(e){return r.default.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.info("isEditingFolder: "+(e===h),e),(null==k?void 0:k.id)!==e){t.next=9;break}return k.title=x,t.next=5,r.default.awrap(j.mutateAsync(k));case 5:return A(),t.next=8,r.default.awrap(F.refetch());case 8:return t.abrupt("return");case 9:L(e);case 10:case"end":return t.stop()}}),null,null,null,Promise)},userState:v,userDispatch:y,isFocused:I,isEditingFolder:h}}}.apply(t,r))||(e.exports=a)},29290:(e,t,n)=>{var r,a;r=[t,n(95004),n(4299),n(76671),n(82547)],void 0===(a=function(e,r,a,o,l){"use strict";var i=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),t.useKeyboardDispatcher=function(){var e=(0,o.useAppDispatch)();(0,r.useEffect)((function(){return a.default.addListener("keyboardDidShow",(function(t){return e((0,l.setKeyboardHeight)({keyboardHeight:t.endCoordinates.height}))})),a.default.addListener("keyboardDidHide",(function(){return e((0,l.setKeyboardHeight)({keyboardHeight:0}))})),function(){a.default.removeAllListeners("keyboardDidShow"),a.default.removeAllListeners("keyboardDidHide")}}),[])},a=i(a)}.apply(t,r))||(e.exports=a)},6664:(e,t,n)=>{var r,a;r=[t,n(10434),n(64687),n(30463),n(47683),n(76671),n(45693),n(95004),n(51005)],void 0===(a=function(e,r,a,o,l,i,u,d,c){"use strict";var s=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),t.useMedia=void 0,r=s(r),a=s(a);t.useMedia=function(e,t,n,s,f,p){var m=(0,i.useAppSelector)((function(e){return e.media})),v=(0,i.useAppDispatch)(),y=(0,o.useFolders)(l.FolderType.media,e,t,p),g=function(){return a.default.async((function(e){for(;;)switch(e.prev=e.next){case 0:return v((0,u.stop)()),e.next=3,a.default.awrap(s());case 3:case"end":return e.stop()}}),null,null,null,Promise)};(0,d.useCallback)((function(){f&&f(g)}),[])();var h=(0,c.useMediaPlayer)(n,s,p);return(0,r.default)({},y,m,h)}}.apply(t,r))||(e.exports=a)},51005:(e,t,n)=>{var r,a;r=[t,n(10434),n(64687),n(45693),n(76671),n(58660),n(58220)],void 0===(a=function(e,r,a,o,l,i,u){"use strict";var d=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),t.useMediaPlayer=void 0,r=d(r),a=d(a);t.useMediaPlayer=function(e){var t=(0,l.useAppSelector)((function(e){return e.media})),n=(0,l.useAppSelector)((function(e){return e.fs.downloadingProgress})),d=(0,l.useAppDispatch)();return(0,r.default)({},t,{onMediaPress:function(n){return a.default.async((function(r){for(;;)switch(r.prev=r.next){case 0:console.info("mediapress",n,e);try{d((0,o.stop)()),t.currentMediaId!==n&&""!==n&&d((0,o.play)({actionType:o.MediaActionType.play,mediaId:n}))}catch(a){console.error("mediapress error",a)}case 2:case"end":return r.stop()}}),null,null,null,Promise)},onRemoveMediaPress:function(e){console.info("onRemoveMediaPress",e)},onDownloadMediaPress:function(t){var r;return a.default.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(console.info("onDownloadMediaPress",t),!n[r=t]){o.next=4;break}return o.abrupt("return");case 4:return d((0,u.setDownloadingProgress)({itemId:r,progress:.001})),o.prev=5,o.next=8,a.default.awrap((0,i.downloadFileById)(t,e,(function(e){return d((0,u.setDownloadingProgress)({itemId:r,progress:e}))})));case 8:o.next=13;break;case 10:o.prev=10,o.t0=o.catch(5),console.error(o.t0);case 13:d((0,u.setDownloadingProgress)({itemId:t,progress:void 0}));case 14:case"end":return o.stop()}}),null,null,[[5,10]],Promise)},onCopyLinkPress:function(e){console.info("onShareMediaPress",e)},onEditMediaPress:function(e){console.info("onEditMediaPress",e)}})}}.apply(t,r))||(e.exports=a)},84846:(e,t,n)=>{var r,a;r=[t,n(64687),n(10434),n(38416),n(27424),n(51641),n(84862),n(76671),n(9383)],void 0===(a=function(e,r,a,o,l,i,u,d,c){"use strict";var s=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),t.useMessages=void 0,r=s(r),a=s(a),o=s(o),l=s(l);t.useMessages=function(e,t,n,s,f,p,m){var v,y,g,h,w,b=(0,d.useAppSelector)((function(t){return t.chat.loadingPagination[e]})),P=(0,d.useAppDispatch)(),x=(0,u.useRoute)(),E=(0,u.useIsFocused)(),I=(0,u.useNavigation)(),F=null==(v=x.params)?void 0:v.mnemonic,C=(null==(y=x.params)?void 0:y.page)||1,S=(null==(g=x.params)||g.name,null==(h=x.params)||h.parentFolderId,(0,i.useQuery)("chatMessages_"+e,(function(){var t,a,o;return r.default.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,r.default.awrap(Promise.all([n(e,F,25*C,0)]));case 2:return t=i.sent,a=(0,l.default)(t,1),o=a[0],i.abrupt("return",{messages:o});case 6:case"end":return i.stop()}}),null,null,null,Promise)}),{retry:!0,refetchInterval:5e3,enabled:E})),k=S.isFetching||b,M=(0,i.useMutation)((function(t){var n;return r.default.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,r.default.awrap(f(e,t,F));case 3:return n=a.sent,a.next=6,r.default.awrap(S.refetch());case 6:return a.abrupt("return",n);case 9:a.prev=9,a.t0=a.catch(0),console.error("==== sendMessage error ===",a.t0);case 12:case"end":return a.stop()}}),null,null,[[0,9]],Promise)}),{retry:!0});return{messages:(null==(w=S.data)?void 0:w.messages)||[],nextPage:function(){var t;return r.default.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(!b){n.next=2;break}return n.abrupt("return");case 2:return t=parseInt(C)+1,console.info("nextPage",t,k),P((0,c.setPaginationState)((0,o.default)({},e,!0))),I.dispatch((0,a.default)({},u.CommonActions.setParams({page:t}),{source:x.key})),n.next=8,r.default.awrap(S.refetch());case 8:setTimeout((function(){P((0,c.setPaginationState)((0,o.default)({},e,!1)))}),2e3);case 9:case"end":return n.stop()}}),null,null,null,Promise)},loadingMessages:k,sendingMessage:M.isLoading,messagesError:S.error,sendMessage:M.mutate,isLoadingEarlier:b}}}.apply(t,r))||(e.exports=a)},21337:(e,t,n)=>{var r,a;r=[t,n(64687),n(51641),n(95004),n(84862)],void 0===(a=function(e,r,a,o,l){"use strict";var i=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),t.useRouteContact=void 0,r=i(r);t.useRouteContact=function(e,t,n,i,u,d){var c=(0,a.useQueryClient)(),s=(0,l.useNavigation)(),f=(0,l.useRoute)(),p=d||f.params,m=p.chatId,v=p.name,y=p.mnemonic,g="new_contact",h=(0,a.useMutation)((function(e){var n={id:m,isContact:!0,folderId:g,name:v,mnemonic:y};console.info(n),t(n)}),{retry:!0,onSuccess:function(){return r.default.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.default.awrap(c.refetchQueries("contact_"+m));case 2:return s.navigate("Chat",{chatId:m,name:v,parentFolderId:g,mnemonic:y}),e.next=5,r.default.awrap(i(m,u.name+" has joined",y,{system:!0}));case 5:case"end":return e.stop()}}),null,null,null,Promise)}});(0,o.useMemo)((function(){n||e||h.isLoading||d||h.mutateAsync().then((function(){return r.default.async((function(e){for(;;)switch(e.prev=e.next){case 0:console.info("after create contact");case 1:case"end":return e.stop()}}),null,null,null,Promise)}))}),[n,e,h,d])}}.apply(t,r))||(e.exports=a)},48736:(e,t,n)=>{var r,a;r=[t,n(27424),n(38416),n(10434),n(95004)],void 0===(a=function(e,r,a,o,l){"use strict";var i,u=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),t.useUserData=t.UserDataActionType=void 0,r=u(r),a=u(a),o=u(o),function(e){e.setUser="setUser",e.setTheme="setTheme",e.setActiveFolder="setActiveFolder",e.setEditingFolder="setEditingFolder",e.setFolderType="setFolderType"}(i||(t.UserDataActionType=i={}));var d=function(e,t){switch(t.actionType){case i.setUser:return(0,o.default)({},e,{user:t.userData});case i.setActiveFolder:return(0,o.default)({},e,{currentFolderIds:(0,o.default)({},e.currentFolderIds||{},(0,a.default)({},t.folderType,t.folderId)),isEditingFolder:(0,o.default)({},e.isEditingFolder||{},(0,a.default)({},t.folderType,void 0))});case i.setFolderType:return(0,o.default)({},e,{currentFolderType:t.folderType});case i.setEditingFolder:return(0,o.default)({},e,{isEditingFolder:(0,o.default)({},e.isEditingFolder||{},(0,a.default)({},t.folderType,t.folderId)),currentFolderIds:(0,o.default)({},e.currentFolderIds||{},(0,a.default)({},t.folderType,t.folderId))});default:return e}};t.useUserData=function(){var e=(0,l.useReducer)(d,{user:{},currentFolderIds:{},colors:{},isEditingFolder:{}}),t=(0,r.default)(e,2);return{userDataState:t[0],userDataDispatch:t[1]}}}.apply(t,r))||(e.exports=a)},82499:(e,t,n)=>{var r,a;r=[t,n(95004),n(18078),n(51641),n(52254),n(21337),n(84862)],void 0===(a=function(e,r,a,o,l,i,u){"use strict";var d=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0,r=d(r),a=d(a);t.default=function(e){var t,n=e.setPubCallback,d=e.getPublicMessages,c=e.getUnreadMessages,s=e.sendChatMessage,f=e.getUserData,p=e.getById,m=e.writeItem,v=e.getFolderContent,y=e.routeParams,g=e.isEmbeded,h=(0,u.useRoute)(),w=(null==y?void 0:y.chatId)||(null==(t=h.params)?void 0:t.chatId),b=(0,o.useQuery)("UserData",(function(){return f()}),{refetchOnMount:!1,refetchOnReconnect:!1,refetchOnWindowFocus:!1}),P=(0,o.useQuery)("contact_"+w,(function(){return p(w)}),{refetchOnMount:!1,refetchOnReconnect:!1,refetchOnWindowFocus:!1,onError:function(e){console.error("on get contact error",e)}}),x=b.isLoading||P.isLoading;return console.info("contact",P.data),(0,i.useRouteContact)(P.data,m,x,s,b.data,y),r.default.createElement(r.default.Fragment,null,x?r.default.createElement(l.ActivityIndicator,{size:72}):r.default.createElement(a.default,{currentUserId:b.data.id,params:{user:b.data,contact:P.data},chatId:w,isLoading:x,setPubCallback:n,getPublicMessages:d,getById:p,getFolderContent:v,getUnreadMessages:c,sendChatMessage:s,disableExtraMessageButtons:!0,backgroundColor:"black",routeParams:y,isEmbeded:g}))}}.apply(t,r))||(e.exports=a)},59372:(e,t,n)=>{var r,a;r=[t,n(10434),n(95004),n(39385),n(2857)],void 0===(a=function(e,r,a,o,l){"use strict";var i=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0,r=i(r),a=i(a),o=i(o),l=i(l);t.default=function(e){return a.default.createElement(o.default,{style:{height:"100%",width:"100%"}},a.default.createElement(o.default,null,a.default.createElement(l.default,(0,r.default)({},e,{showPublicParty:!0}))))}}.apply(t,r))||(e.exports=a)},75372:(e,t,n)=>{var r,a;r=[t,n(95004),n(39385),n(3916)],void 0===(a=function(e,r,a,o){"use strict";var l=n(64836);function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0,r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var l=a?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(r),a=l(a),o=l(o);t.default=(0,r.memo)((function(e){return r.default.createElement(a.default,{style:{height:"100%",width:"100%"}},r.default.createElement(a.default,null,r.default.createElement(o.default,{getFolderContent:e.getFolderContent,getFoldersByType:e.getFoldersByType,enqMedia:e.enqMedia,stopMedia:e.stopVideo,setWindowClosedCallback:e.setWindowClosedCallback,writeItem:e.writeItem})))}))}.apply(t,r))||(e.exports=a)},56105:(e,t,n)=>{var r,a;r=[t,n(10434),n(95004),n(39385),n(25722),n(2145),n(13214),n(22152),n(51641),n(52254),n(84862)],void 0===(a=function(e,r,a,o,l,i,u,d,c,s,f){"use strict";var p=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0,r=p(r),a=p(a),o=p(o),l=p(l),i=p(i),u=p(u),d=p(d);var m=i.default.create({container:{flex:1},row:{flexDirection:"row"},column:{flexDirection:"column"},customTitle:{alignItems:"center",justifyContent:"space-between"},additionalPadding:{paddingTop:8},image:{width:"100%",height:"auto",opacity:.6,position:"absolute",resizeMode:"cover",zIndex:-1,flex:1}});t.default=function(e){var t=e.getUserData,n=(0,c.useQuery)("UserData",t),i=n.isLoading,d=(0,f.useNavigation)(),p=n.data,v=function(){console.info("onEditProfile")},y={pointerEvents:"auto",paddingTop:20};return a.default.createElement(o.default,{style:{height:"100%",width:"100%"}},i?a.default.createElement(s.ActivityIndicator,{animating:!0,size:72}):a.default.createElement(a.default.Fragment,null,a.default.createElement(s.List.Section,null,a.default.createElement(s.List.Item,{title:null==p?void 0:p.name,left:function(e){return null!=p&&p.photo?a.default.createElement(s.Avatar.Image,{style:e.style,source:{uri:null==p?void 0:p.photo,cache:"force-cache"},size:72}):a.default.createElement(s.Avatar.Text,{style:e.style,label:(null==p?void 0:p.name)&&(null==p?void 0:p.name.slice(0,2).toUpperCase()),size:72})},description:function(e){var t=e.ellipsizeMode,n=e.color,r=e.fontSize;return a.default.createElement(o.default,{style:[m.container,m.column]},a.default.createElement(s.Text,{numberOfLines:1,ellipsizeMode:t,style:{color:n,fontSize:r}},null==p?void 0:p.description),a.default.createElement(o.default,{style:[m.container,m.row,m.additionalPadding]},null,a.default.createElement(s.Chip,{icon:"web",onPress:function(){},style:{height:30}},"WEB")))},right:function(e){return a.default.createElement(u.default,{style:y,onPress:v},a.default.createElement(s.List.Icon,(0,r.default)({},e,{icon:"pencil-outline"})))}}),a.default.createElement(s.Divider,null),null,a.default.createElement(s.Divider,null),a.default.createElement(s.List.Item,{onPress:function(){},title:"Cloud Storage Status",left:function(e){return a.default.createElement(s.List.Icon,{icon:"cloud",style:e.style})}}),a.default.createElement(s.Divider,null),a.default.createElement(s.List.Item,{onPress:function(){l.default.openURL("https://www.starpy.me?appLogin=true")},title:"Login With Google",left:function(e){return a.default.createElement(s.List.Icon,{icon:"google",style:e.style})},right:function(e){return a.default.createElement(s.Switch,{value:!(null==p||!p.email)})}}),a.default.createElement(s.Divider,null),a.default.createElement(s.List.Item,{onPress:function(){d.navigate("Devices")},title:"Devices",left:function(e){return a.default.createElement(s.List.Icon,{icon:"devices",style:e.style})}}),a.default.createElement(s.Divider,null),a.default.createElement(s.List.Item,{onPress:function(){console.info("toggleTheme")},title:"Toggle Theme",left:function(e){return a.default.createElement(s.List.Icon,{icon:"theme-light-dark",style:e.style})},right:function(e){return a.default.createElement(s.Switch,null)}}),a.default.createElement(s.Divider,null),a.default.createElement(s.List.Item,{onPress:function(){},title:"Certificate",left:function(e){return a.default.createElement(s.List.Icon,{icon:"certificate",style:e.style})}}),a.default.createElement(s.Divider,null))))}}.apply(t,r))||(e.exports=a)},76671:(e,t,n)=>{var r,a;r=[t,n(82513)],void 0===(a=function(e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),t.useAppSelector=t.useAppDispatch=void 0;t.useAppDispatch=n.useDispatch,t.useAppSelector=n.useSelector}.apply(t,r))||(e.exports=a)},9383:(e,t,n)=>{var r,a;r=[t,n(44463)],void 0===(a=function(e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),t.setPaginationState=t.default=t.chatSlice=void 0;var r=t.chatSlice=(0,n.createSlice)({name:"chat",initialState:{loadingPagination:{}},reducers:{setPaginationState:function(e,t){var n=Object.keys(t.payload)[0];e.loadingPagination[n]=t.payload[n]}}});t.setPaginationState=r.actions.setPaginationState,t.default=r.reducer}.apply(t,r))||(e.exports=a)},20555:(e,t,n)=>{var r,a;r=[t,n(44463)],void 0===(a=function(e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),t.setShowEditor=t.setShowComments=t.setScrollPosition=t.setScrollParams=t.setRenderUrl=t.setRenderProgress=t.setPixelsPerSecond=t.setIsRendering=t.setIsPlaying=t.setEncoderProgress=t.setCaretPosition=t.setActiveLayer=t.editorSlice=t.default=t.addNewLogLine=void 0;var r=t.editorSlice=(0,n.createSlice)({name:"editor",initialState:{encoderProgress:0,caretPosition:0,scrollPosition:0,pixelsPerSecond:8,jobs:[],jobsProgress:{},isPlaying:!1,videoCaretPosition:0,videoScrollPosition:0,scrollParams:{totalWidth:0,totalScroll:0},canScroll:!0,activeLayer:"1",prevActiveLayer:"1",scroll:0,totalTime:0,showEditor:!0,showComments:!1,isRendering:!1,renderProgress:0,renderTime:0,ffmpegLogs:"",ffmpegError:!1},reducers:{setEncoderProgress:function(e,t){e.encoderProgress=t.payload},setActiveLayer:function(e,t){!0===e.isPlaying&&(e.videoCaretPosition=t.payload.caretPosition,e.videoScrollPosition=t.payload.scrollPosition,e.activeLayer=t.payload.activeLayerId)},setCaretPosition:function(e,t){e.caretPosition=t.payload,!1===e.isPlaying&&(e.videoCaretPosition=t.payload)},setScrollPosition:function(e,t){e.scrollPosition=t.payload,!1===e.isPlaying&&(e.videoScrollPosition=t.payload)},setPixelsPerSecond:function(e,t){e.pixelsPerSecond=t.payload},createBackgroundRenderJob:function(e,t){e.jobs.push(t.payload)},setJobProgress:function(e,t){e.jobsProgress[t.payload.id]=t.payload.progress},setIsPlaying:function(e,t){e.isPlaying=t.payload,!1===t.payload&&(e.videoCaretPosition=e.caretPosition,e.videoScrollPosition=e.scrollPosition)},setTotalTime:function(e,t){e.totalTime=t.payload},setScrollParams:function(e,t){e.scrollParams=t.payload;var n=e.scrollParams.totalScroll>e.scrollParams.totalWidth,r=e.scrollParams.totalScroll-e.scrollParams.totalWidth;e.canScroll!==n&&!1===e.isPlaying&&(e.canScroll=n),e.scroll===r||isNaN(r)||(e.scroll=r)},setShowEditor:function(e,t){e.showEditor=t.payload},setShowComments:function(e,t){e.showComments=t.payload},setIsRendering:function(e,t){e.isRendering=t.payload,e.isRendering&&(e.ffmpegLogs="",e.ffmpegError=!1)},setRenderUrl:function(e,t){e.renderOutputURL=t.payload},setRenderProgress:function(e,t){e.renderProgress=t.payload.progress,e.renderTime=t.payload.time/1e6,e.caretPosition=e.renderTime*e.pixelsPerSecond,e.videoCaretPosition=e.caretPosition},addNewLogLine:function(e,t){e.ffmpegLogs+="\n"+t.payload,t.payload.toLowerCase().search("error")>-1&&(e.ffmpegError=!0)}}}),a=r.actions;t.setEncoderProgress=a.setEncoderProgress,t.setCaretPosition=a.setCaretPosition,t.setScrollPosition=a.setScrollPosition,t.setPixelsPerSecond=a.setPixelsPerSecond,t.setIsPlaying=a.setIsPlaying,t.setScrollParams=a.setScrollParams,t.setActiveLayer=a.setActiveLayer,t.setShowComments=a.setShowComments,t.setShowEditor=a.setShowEditor,t.setIsRendering=a.setIsRendering,t.setRenderUrl=a.setRenderUrl,t.setRenderProgress=a.setRenderProgress,t.addNewLogLine=a.addNewLogLine,t.default=r.reducer}.apply(t,r))||(e.exports=a)},63663:(e,t,n)=>{var r,a;r=[t,n(44463)],void 0===(a=function(e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),t.setEncoderProgress=t.encoderSlice=t.default=void 0;var r=t.encoderSlice=(0,n.createSlice)({name:"encoder",initialState:{encoderProgress:0},reducers:{setEncoderProgress:function(e,t){e.encoderProgress=t.payload}}});t.setEncoderProgress=r.actions.setEncoderProgress,t.default=r.reducer}.apply(t,r))||(e.exports=a)},58220:(e,t,n)=>{var r,a;r=[t,n(44463)],void 0===(a=function(e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),t.setDownloadingProgress=t.setDeleteItem=t.default=t.FileSystemSlice=void 0;var r=t.FileSystemSlice=(0,n.createSlice)({name:"fs",initialState:{isDeleting:!1,downloadingProgress:{}},reducers:{setDeleteItem:function(e,t){var n=t.payload.deleteItemId;e.isDeleting=!!n,e.deleteItemId=n},setDownloadingProgress:function(e,t){var n=t.payload,r=n.itemId,a=n.progress;e.downloadingProgress[r]=a}}}),a=r.actions;t.setDeleteItem=a.setDeleteItem,t.setDownloadingProgress=a.setDownloadingProgress,t.default=r.reducer}.apply(t,r))||(e.exports=a)},45693:(e,t,n)=>{var r,a;r=[t,n(44463)],void 0===(a=function(e,n){"use strict";var r;Object.defineProperty(e,"__esModule",{value:!0}),t.togglePause=t.stop=t.selectIsPlayingMedia=t.selectIsLoadingMedia=t.selectCurrentMediaId=t.play=t.mediaSlice=t.loaded=t.default=t.MediaActionType=void 0,function(e){e.stop="stop",e.play="play",e.loaded="loaded",e.pause="pause"}(r||(t.MediaActionType=r={}));var a=t.mediaSlice=(0,n.createSlice)({name:"media",initialState:{},reducers:{stop:function(e){e.isLoadingMedia=void 0,e.currentMediaId=void 0},play:function(e,t){e.currentMediaId=t.payload.mediaId,e.isLoadingMedia=!0},togglePause:function(e,t){e.isMediaPaused=t.payload.pause},loaded:function(e,t){e.isLoadingMedia=!1,e.isMediaPlaying=!0}}}),o=a.actions;t.stop=o.stop,t.play=o.play,t.loaded=o.loaded,t.togglePause=o.togglePause,t.selectCurrentMediaId=function(e){return e.media.currentMediaId},t.selectIsLoadingMedia=function(e){return e.media.isLoadingMedia},t.selectIsPlayingMedia=function(e){return e.media.isMediaPlaying},t.default=a.reducer}.apply(t,r))||(e.exports=a)},82547:(e,t,n)=>{var r,a;r=[t,n(44463)],void 0===(a=function(e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),t.setKeyboardHeight=t.setIsSigned=t.setIsReady=t.setCurrentPage=t.default=void 0;var r=["Chat","EditorProject"],a=(0,n.createSlice)({name:"ui",initialState:{isTabBarHidden:!1,isKeyboardOpen:!1,keyboardHeight:0,currentPage:"Login",isReady:!1,isSignedIn:!1},reducers:{setCurrentPage:function(e,t){var n=t.payload.currentPage;e.currentPage=n,r.includes(n)?e.isTabBarHidden=!0:e.isTabBarHidden=!1},setKeyboardHeight:function(e,t){var n=t.payload.keyboardHeight;e.keyboardHeight=n,e.isKeyboardOpen=0!==n},setIsReady:function(e,t){var n=t.payload;e.isReady=n},setIsSigned:function(e,t){var n=t.payload;e.isSignedIn=n}}}),o=a.actions;t.setCurrentPage=o.setCurrentPage,t.setKeyboardHeight=o.setKeyboardHeight,t.setIsReady=o.setIsReady,t.setIsSigned=o.setIsSigned,t.default=a.reducer}.apply(t,r))||(e.exports=a)},55894:(e,t,n)=>{var r,a;r=[t,n(44463)],void 0===(a=function(e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),t.uploadSlice=t.startOnboarding=t.setUploadToCloud=t.setUploadInProgress=t.setShareToWt=t.setMetaForCloud=t.setMediaModalVisible=t.setFileUploadProgress=t.setEncrypt=t.selectIsPlayingMedia=t.selectIsLoadingMedia=t.selectCurrentMediaId=t.default=t.cancel=void 0;var r={modalVisible:!1,uploadToCloud:!1,persist:!0,shareToWT:!1,encryption:!1,fileUploadProgress:void 0,isUploadInProgress:!1,totalChunks:0},a=t.uploadSlice=(0,n.createSlice)({name:"upload",initialState:r,reducers:{startOnboarding:function(e,t){console.info("start",t),e.file=t.payload.file,e.media=t.payload.media,e.modalVisible=!0},continue:function(e,t){},cancel:function(e){e.modalVisible=!1},setMediaModalVisible:function(e,t){e.modalVisible=t.payload,t.payload||(e.file=void 0)},setFileUploadProgress:function(e,t){e.fileUploadProgress=t.payload},setUploadInProgress:function(e,t){e.isUploadInProgress=t.payload},setShareToWt:function(e,t){e.shareToWT=t.payload},setUploadToCloud:function(e,t){e.uploadToCloud=t.payload},setEncrypt:function(e,t){e.encryption=t.payload},setMetaForCloud:function(e,t){e.media.webpage_url=t.payload,e.media.hasCloud=!0,e.media.extractor="cloud",e.media.url=t.payload}}}),o=a.actions;t.startOnboarding=o.startOnboarding,t.cancel=o.cancel,t.setMediaModalVisible=o.setMediaModalVisible,t.setFileUploadProgress=o.setFileUploadProgress,t.setUploadInProgress=o.setUploadInProgress,t.setUploadToCloud=o.setUploadToCloud,t.setEncrypt=o.setEncrypt,t.setShareToWt=o.setShareToWt,t.setMetaForCloud=o.setMetaForCloud,t.selectCurrentMediaId=function(e){return e.media.currentMediaId},t.selectIsLoadingMedia=function(e){return e.media.isLoadingMedia},t.selectIsPlayingMedia=function(e){return e.media.isMediaPlaying},t.default=a.reducer}.apply(t,r))||(e.exports=a)},23774:(e,t,n)=>{var r,a;r=[t,n(44463),n(45693),n(55894),n(20555),n(9383),n(58220),n(63663),n(82547)],void 0===(a=function(e,r,a,o,l,i,u,d,c){"use strict";var s=n(64836);Object.defineProperty(e,"__esModule",{value:!0}),t.store=void 0,a=s(a),o=s(o),l=s(l),i=s(i),u=s(u),d=s(d),c=s(c);t.store=(0,r.configureStore)({reducer:{media:a.default,upload:o.default,encoder:d.default,chat:i.default,fs:u.default,editor:l.default,ui:c.default}})}.apply(t,r))||(e.exports=a)},11939:(e,t)=>{var n;void 0===(n=function(e){"use strict";var n,r;Object.defineProperty(e,"__esModule",{value:!0}),t.ChatMessageType=t.ChatMessageStatus=void 0,function(e){e.media="media",e.call="call",e.text="text",e.party_request="party_request",e.party_confirmation="party_confirmation",e.party_start="party_start",e.party_join="party_join",e.party_stop="party_stop",e.party_quit="party_quit",e.party_media="party_media",e.party_stop_media="party_media_stop",e.party_media_pause="party_media_pause",e.party_media_unpause="party_media_unpause",e.party_media_sync="party_media_sync"}(n||(t.ChatMessageType=n={})),function(e){e.created="created",e.sent="sent",e.delivered="delivered",e.read="read"}(r||(t.ChatMessageStatus=r={}))}.apply(t,[t]))||(e.exports=n)},54455:(e,t)=>{var n;void 0===(n=function(e){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),t.FolderType=void 0,function(e){e.contact="contact",e.media="media",e.settings="settings",e.encoder="encoder",e.editor="editor"}(n||(t.FolderType=n={}))}.apply(t,[t]))||(e.exports=n)},48029:(e,t)=>{var n;void 0===(n=function(e){"use strict";var n,r;Object.defineProperty(e,"__esModule",{value:!0}),t.FFMpegPreset=t.FFMpegOutputType=void 0,function(e){e.ultrafast="ultrafast",e.superfast="superfast",e.veryfast="veryfast",e.faster="faster",e.fast="fast",e.medium="medium"}(n||(t.FFMpegPreset=n={})),function(e){e.mp4="mp4",e.gif="gif"}(r||(t.FFMpegOutputType=r={}))}.apply(t,[t]))||(e.exports=n)},15356:(e,t)=>{var n;void 0===(n=function(){}.apply(t,[]))||(e.exports=n)},47683:(e,t,n)=>{var r,a;r=[t,n(11939),n(48029),n(15356),n(54455)],void 0===(a=function(e,n,r,a,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l,i={FTSIndex:!0};t.FTSIndex=void 0,Object.keys(n).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(i,t)||t in e&&e[t]===n[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return n[t]}}))})),Object.keys(r).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(i,t)||t in e&&e[t]===r[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return r[t]}}))})),Object.keys(a).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(i,t)||t in e&&e[t]===a[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return a[t]}}))})),Object.keys(o).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(i,t)||t in e&&e[t]===o[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return o[t]}}))})),function(e){e.title="titleFTSIndex",e.name="nameFTSIndex",e.text="textFTSIndex"}(l||(t.FTSIndex=l={}))}.apply(t,r))||(e.exports=a)},46601:()=>{},71922:()=>{},2363:()=>{},96419:()=>{},56353:()=>{},69386:()=>{},31616:()=>{},69862:()=>{},40964:()=>{}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=e,(()=>{var e=[];n.O=(t,r,a,o)=>{if(!r){var l=1/0;for(c=0;c<e.length;c++){for(var[r,a,o]=e[c],i=!0,u=0;u<r.length;u++)(!1&o||l>=o)&&Object.keys(n.O).every((e=>n.O[e](r[u])))?r.splice(u--,1):(i=!1,o<l&&(l=o));if(i){e.splice(c--,1);var d=a();void 0!==d&&(t=d)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[r,a,o]}})(),n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.u=e=>"bundle.web."+e+".js",n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{n.b=document.baseURI||self.location.href;var e={179:0};n.O.j=t=>0===e[t];var t=(t,r)=>{var a,o,[l,i,u]=r,d=0;if(l.some((t=>0!==e[t]))){for(a in i)n.o(i,a)&&(n.m[a]=i[a]);if(u)var c=u(n)}for(t&&t(r);d<l.length;d++)o=l[d],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(c)},r=self.webpackChunkStarpyApp=self.webpackChunkStarpyApp||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=n.O(void 0,[74,997,803],(()=>n(47488)));r=n.O(r)})();
//# sourceMappingURL=bundle.web.179.js.map